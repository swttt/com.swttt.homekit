(()=>{var __webpack_modules__={2601:(e,t,r)=>{e.exports=r(1643)},9085:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CiaoService=t.InternalServiceEvent=t.ServiceEvent=t.ServiceState=t.ServiceType=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(7031));const o=r(2361);const s=(0,i.__importDefault)(r(1808));const c=r(9352);const u=r(8059);const l=r(5398);const d=r(1425);const h=r(6366);const p=r(6130);const v=r(8297);const m=r(3285);const g=r(3729);const y=r(2253);const C=(0,i.__importStar)(r(35));const T=r(35);const E=(0,a.default)("ciao:CiaoService");const D=/^(.*) \((\d+)\)$/;const _=/^(.*)-\((\d+)\)(\.\w{2,}.)$/;var I;(function(e){e["AIRDROP"]="airdrop";e["AIRPLAY"]="airplay";e["AIRPORT"]="airport";e["COMPANION_LINK"]="companion-link";e["DACP"]="dacp";e["HAP"]="hap";e["HOMEKIT"]="homekit";e["HTTP"]="http";e["HTTP_ALT"]="http_alt";e["IPP"]="ipp";e["IPPS"]="ipps";e["RAOP"]="raop";e["scanner"]="scanner";e["TOUCH_ABLE"]="touch-able";e["DNS_SD"]="dns-sd";e["PRINTER"]="printer"})(I=t.ServiceType||(t.ServiceType={}));var b;(function(e){e["UNANNOUNCED"]="unannounced";e["PROBING"]="probing";e["PROBED"]="probed";e["ANNOUNCING"]="announcing";e["ANNOUNCED"]="announced"})(b=t.ServiceState||(t.ServiceState={}));var w;(function(e){e["NAME_CHANGED"]="name-change";e["HOSTNAME_CHANGED"]="hostname-change"})(w=t.ServiceEvent||(t.ServiceEvent={}));var R;(function(e){e["PUBLISH"]="publish";e["UNPUBLISH"]="unpublish";e["REPUBLISH"]="republish";e["RECORD_UPDATE"]="records-update";e["RECORD_UPDATE_ON_INTERFACE"]="records-update-interface"})(R=t.InternalServiceEvent||(t.InternalServiceEvent={}));class CiaoService extends o.EventEmitter{constructor(e,t){super();this.serviceState="unannounced";this.destroyed=false;(0,n.default)(e,"networkManager is required");(0,n.default)(t,"parameters options is required");(0,n.default)(t.name,"service options parameter 'name' is required");(0,n.default)(t.type,"service options parameter 'type' is required");(0,n.default)(t.type.length<=15,"service options parameter 'type' must not be longer than 15 characters");this.networkManager=e;this.name=t.name;this.type=t.type;this.subTypes=t.subtypes;this.protocol=t.protocol||"tcp";this.serviceDomain=t.domain||"local";this.fqdn=this.formatFQDN();this.loweredFqdn=(0,y.dnsLowerCase)(this.fqdn);this.typePTR=C.stringify({type:this.type,protocol:this.protocol,domain:this.serviceDomain});this.loweredTypePTR=(0,y.dnsLowerCase)(this.typePTR);if(this.subTypes){this.subTypePTRs=this.subTypes.map((e=>C.stringify({subtype:e,type:this.type,protocol:this.protocol,domain:this.serviceDomain}))).map(y.dnsLowerCase)}this.hostname=C.formatHostname(t.hostname||this.name,this.serviceDomain).replace(/ /g,"-");this.loweredHostname=(0,y.dnsLowerCase)(this.hostname);this.port=t.port;if(t.restrictedAddresses){(0,n.default)(t.restrictedAddresses.length,"The service property 'restrictedAddresses' cannot be an empty array!");this.restrictedAddresses=new Map;for(const e of t.restrictedAddresses){if(s.default.isIP(e)){if(e==="0.0.0.0"||e==="::"){throw new Error(`[${this.fqdn}] Unspecified ip address (${e}) cannot be used to restrict on to!`)}const t=g.NetworkManager.resolveInterface(e);if(!t){throw new Error(`[${this.fqdn}] Could not restrict service to address ${e} as we could not resolve it to an interface name!`)}const r=this.restrictedAddresses.get(t);if(r){if(r.length&&!r.includes(e)){r.push(e)}}else{this.restrictedAddresses.set(t,[e])}}else{this.restrictedAddresses.set(e,[])}}}this.disableIpv6=t.disabledIpv6;this.txt=t.txt?CiaoService.txtBuffersFromRecord(t.txt):[];this.incrementName(true)}advertise(){(0,n.default)(!this.destroyed,"Cannot publish destroyed service!");(0,n.default)(this.port,"Service port must be defined before advertising the service on the network!");if(this.listeners("name-change").length===0){E("[%s] WARN: No listeners found for a potential name change on the 'name-change' event!",this.name)}return new Promise(((e,t)=>{this.emit("publish",(r=>r?t(r):e()))}))}end(){(0,n.default)(!this.destroyed,"Cannot end destroyed service!");if(this.serviceState==="unannounced"){return Promise.resolve()}return new Promise(((e,t)=>{this.emit("unpublish",(r=>r?t(r):e()))}))}async destroy(){await this.end();this.destroyed=true;this.removeAllListeners()}getFQDN(){return this.fqdn}getTypePTR(){return this.typePTR}getLowerCasedSubtypePTRs(){return this.subTypePTRs}getHostname(){return this.hostname}getPort(){return this.port||-1}getTXT(){return this.txt}getLowerCasedFQDN(){return this.loweredFqdn}getLowerCasedTypePTR(){return this.loweredTypePTR}getLowerCasedHostname(){return this.loweredHostname}updateTxt(e,t=false){(0,n.default)(!this.destroyed,"Cannot update destroyed service!");(0,n.default)(e,"txt cannot be undefined");this.txt=CiaoService.txtBuffersFromRecord(e);E("[%s] Updating txt record%s...",this.name,t?" silently":"");if(this.serviceState==="announcing"){this.rebuildServiceRecords();if(t){return}if(this.currentAnnouncer.hasSentLastAnnouncement()){this.currentAnnouncer.awaitAnnouncement().then((()=>{this.queueTxtUpdate()}))}}else if(this.serviceState==="announced"){this.rebuildServiceRecords();if(t){return}this.queueTxtUpdate()}}queueTxtUpdate(){if(this.txtTimer){return}else{this.txtTimer=setTimeout((()=>{this.txtTimer=undefined;if(this.serviceState!=="announced"){return}this.emit("records-update",{answers:[this.txtRecord()],additionals:[this.serviceNSECRecord()]})}),50)}}updatePort(e){(0,n.default)(this.serviceState==="unannounced","Port number cannot be changed when service is already advertised!");this.port=e}updateName(e){if(this.serviceState==="unannounced"){this.name=e;this.fqdn=this.formatFQDN();this.loweredFqdn=(0,y.dnsLowerCase)(this.fqdn);return Promise.resolve()}else{return this.end().then((()=>{this.name=e;this.fqdn=this.formatFQDN();this.loweredFqdn=(0,y.dnsLowerCase)(this.fqdn);return this.advertise()}))}}static txtBuffersFromRecord(e){const t=[];Object.entries(e).forEach((([e,r])=>{const i=e+"="+r;t.push(Buffer.from(i))}));return t}handleNetworkInterfaceUpdate(e){(0,n.default)(!this.destroyed,"Cannot update network of destroyed service!");if(this.serviceState!=="announced"){if(this.serviceState==="announcing"){this.rebuildServiceRecords();if(this.currentAnnouncer.hasSentLastAnnouncement()){this.currentAnnouncer.awaitAnnouncement().then((()=>{this.handleNetworkInterfaceUpdate(e)}))}}return}this.rebuildServiceRecords();if(e.added||e.changes){this.emit("republish",(e=>{if(e){console.log("FATAL Error occurred trying to reannounce service "+this.fqdn+"! We can't recover from this!");console.log(e.stack);process.exit(1)}}))}}incrementName(e){if(this.serviceState!=="unannounced"){throw new Error("Service name can only be incremented when in state UNANNOUNCED!")}const t=this.name;const r=this.hostname;let i;let a;let o;let s;let c;const u=this.name.match(D);if(u){i=u[1];a=parseInt(u[2]);(0,n.default)(a,`Failed to extract name number from ${this.name}. Resulted in ${a}`)}else{i=this.name;a=1}const l=this.hostname.match(_);if(l){o=l[1];s=l[3];c=parseInt(l[2]);(0,n.default)(c,`Failed to extract hostname number from ${this.hostname}. Resulted in ${c}`)}else{const e=this.hostname.substring(0,this.hostname.length-1).lastIndexOf(".");o=this.hostname.slice(0,e);s=this.hostname.slice(e);c=1}if(!e){a++;c++}const d=Math.max(a,c);this.name=d===1?i:`${i} (${d})`;this.hostname=d===1?`${o}${s}`:`${o}-(${d})${s}`;this.loweredHostname=(0,y.dnsLowerCase)(this.hostname);this.fqdn=this.formatFQDN();this.loweredFqdn=(0,y.dnsLowerCase)(this.fqdn);if(this.name!==t||this.hostname!==r){E("[%s] Service changed name '%s' -> '%s', '%s' -> '%s'",this.name,t,this.name,r,this.hostname)}if(!e){this.rebuildServiceRecords()}}informAboutNameUpdates(){const e=this.emit("name-change",this.name);const t=this.emit("hostname-change",C.removeTLD(this.hostname));if(!e&&!t){console.warn(`CIAO: [${this.name}] Service changed name but nobody was listening on the 'name-change' event!`)}}formatFQDN(){if(this.serviceState!=="unannounced"){throw new Error("Name can't be changed after service was already announced!")}const e=C.stringify({name:this.name,type:this.type,protocol:this.protocol,domain:this.serviceDomain});(0,n.default)(e.length<=255,"A fully qualified domain name cannot be longer than 255 characters");return e}rebuildServiceRecords(){(0,n.default)(this.port,"port must be set before building records");E("[%s] Rebuilding service records...",this.name);const e={};const t={};const r={};const i={};const a={};let o=undefined;for(const[n,o]of this.networkManager.getInterfaceMap()){if(!this.advertisesOnInterface(n,true)){continue}let s=this.restrictedAddresses?this.restrictedAddresses.get(n):undefined;if(s&&s.length===0){s=undefined}if(o.ipv4&&(!s||s.includes(o.ipv4))){e[n]=new u.ARecord(this.hostname,o.ipv4,true);a[o.ipv4]=new d.PTRRecord((0,T.formatReverseAddressPTRName)(o.ipv4),this.hostname)}if(o.ipv6&&!this.disableIpv6&&(!s||s.includes(o.ipv6))){t[n]=new c.AAAARecord(this.hostname,o.ipv6,true);a[o.ipv6]=new d.PTRRecord((0,T.formatReverseAddressPTRName)(o.ipv6),this.hostname)}if(o.globallyRoutableIpv6&&!this.disableIpv6&&(!s||s.includes(o.globallyRoutableIpv6))){r[n]=new c.AAAARecord(this.hostname,o.globallyRoutableIpv6,true);a[o.globallyRoutableIpv6]=new d.PTRRecord((0,T.formatReverseAddressPTRName)(o.globallyRoutableIpv6),this.hostname)}if(o.uniqueLocalIpv6&&!this.disableIpv6&&(!s||s.includes(o.uniqueLocalIpv6))){i[n]=new c.AAAARecord(this.hostname,o.uniqueLocalIpv6,true);a[o.uniqueLocalIpv6]=new d.PTRRecord((0,T.formatReverseAddressPTRName)(o.uniqueLocalIpv6),this.hostname)}}if(this.subTypePTRs){o=[];for(const e of this.subTypePTRs){o.push(new d.PTRRecord(e,this.fqdn))}}this.serviceRecords={ptr:new d.PTRRecord(this.typePTR,this.fqdn),subtypePTRs:o,metaQueryPtr:new d.PTRRecord(m.Responder.SERVICE_TYPE_ENUMERATION_NAME,this.typePTR),srv:new h.SRVRecord(this.fqdn,this.hostname,this.port,true),txt:new p.TXTRecord(this.fqdn,this.txt,true),serviceNSEC:new l.NSECRecord(this.fqdn,this.fqdn,[16,33],4500,true),a:e,aaaa:t,aaaaR:r,aaaaULA:i,reverseAddressPTRs:a,addressNSEC:new l.NSECRecord(this.hostname,this.hostname,[1,28],120,true)}}advertisesOnInterface(e,t){var r,i,n,a;return!this.restrictedAddresses||this.restrictedAddresses.has(e)&&(t||!!((r=this.serviceRecords)===null||r===void 0?void 0:r.a[e])||!!((i=this.serviceRecords)===null||i===void 0?void 0:i.aaaa[e])||!!((n=this.serviceRecords)===null||n===void 0?void 0:n.aaaaR[e])||!!((a=this.serviceRecords)===null||a===void 0?void 0:a.aaaaULA[e]))}ptrRecord(){return this.serviceRecords.ptr.clone()}subtypePtrRecords(){return this.serviceRecords.subtypePTRs?v.ResourceRecord.clone(this.serviceRecords.subtypePTRs):[]}metaQueryPtrRecord(){return this.serviceRecords.metaQueryPtr.clone()}srvRecord(){return this.serviceRecords.srv.clone()}txtRecord(){return this.serviceRecords.txt.clone()}aRecord(e){const t=this.serviceRecords.a[e];return t?t.clone():undefined}aaaaRecord(e){const t=this.serviceRecords.aaaa[e];return t?t.clone():undefined}aaaaRoutableRecord(e){const t=this.serviceRecords.aaaaR[e];return t?t.clone():undefined}aaaaUniqueLocalRecord(e){const t=this.serviceRecords.aaaaULA[e];return t?t.clone():undefined}allAddressRecords(){const e=[];Object.values(this.serviceRecords.a).forEach((t=>{e.push(t.clone())}));Object.values(this.serviceRecords.aaaa).forEach((t=>{e.push(t.clone())}));Object.values(this.serviceRecords.aaaaR).forEach((t=>{e.push(t.clone())}));Object.values(this.serviceRecords.aaaaULA).forEach((t=>{e.push(t.clone())}));return e}addressNSECRecord(){return this.serviceRecords.addressNSEC.clone()}serviceNSECRecord(e=false){const t=this.serviceRecords.serviceNSEC.clone();if(e){t.ttl=120}return t}hasAddress(e){return!!this.serviceRecords.reverseAddressPTRs[e]}}t.CiaoService=CiaoService},633:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MDNSServer=t.SendResultFormatError=t.SendResultFailedRatio=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(7031));const o=(0,i.__importDefault)(r(1891));const s=r(1234);const c=r(3729);const u=r(35);const l=r(7645);const d=r(8064);const h=(0,a.default)("ciao:MDNSServer");function SendResultFailedRatio(e){if(e.length===0){return 0}let t=0;for(const r of e){if(r.status!=="fulfilled"){t++}}return t/e.length}t.SendResultFailedRatio=SendResultFailedRatio;function SendResultFormatError(e,t,r=false){let i=0;for(const t of e){if(t.status!=="fulfilled"){i++}}if(!t){t="Failed to send packets"}if(i<e.length){t+=` (${i}/${e.length}):`}else{t+=":"}if(r){let r="=============================\n"+t;for(const t of e){if(t.status==="rejected"){r+="\n--------------------\n"+"Failed to send packet on interface "+t.interface+": "+t.reason.stack}else if(t.status==="timeout"){r+="\n--------------------\n"+"Sending packet on interface "+t.interface+" timed out!"}}r+="\n=============================";return r}else{let r=t;for(const t of e){if(t.status==="rejected"){r+="\n- Failed to send packet on interface "+t.interface+": "+t.reason.message}else if(t.status==="timeout"){r+="\n- Sending packet on interface "+t.interface+" timed out!"}}return r}}t.SendResultFormatError=SendResultFormatError;class MDNSServer{constructor(e,t){this.sockets=new Map;this.sentPackets=new Map;this.suppressUnicastResponseFlag=false;this.bound=false;this.closed=false;(0,n.default)(e,"handler cannot be undefined");this.handler=e;this.networkManager=new c.NetworkManager({interface:t&&t.interface,excludeIpv6:t&&t.disableIpv6,excludeIpv6Only:true});this.networkManager.on("network-update",this.handleUpdatedNetworkInterfaces.bind(this))}getNetworkManager(){return this.networkManager}getBoundInterfaceNames(){return this.sockets.keys()}async bind(){if(this.closed){throw new Error("Cannot rebind closed server!")}this.suppressUnicastResponseFlag=true;await this.networkManager.waitForInit();const e=[];for(const[t,r]of this.networkManager.getInterfaceMap()){const i=this.createDgramSocket(t,true);const n=this.bindSocket(i,r,"IPv4").catch((e=>{console.log("Could not bind detected network interface: "+e.stack)}));e.push(n)}return Promise.all(e).then((()=>{this.bound=true}))}shutdown(){this.networkManager.shutdown();for(const e of this.sockets.values()){e.close()}this.bound=false;this.closed=true;this.sockets.clear()}sendQueryBroadcast(e,t){const r=s.DNSPacket.createDNSQueryPackets(e);if(r.length>1){h("Query broadcast is split into %d packets!",r.length)}const i=[];for(const e of r){i.push(this.sendOnAllNetworksForService(e,t))}return Promise.all(i).then((e=>{const t=[];for(const r of e){t.concat(r)}return t}))}sendResponseBroadcast(e,t){const r=s.DNSPacket.createDNSResponsePacketsFromRRSet(e);return this.sendOnAllNetworksForService(r,t)}sendResponse(e,t,r){this.send(e,t).then((e=>{if(e.status==="rejected"){if(r){r(new Error("Encountered socket error on "+e.reason.name+": "+e.reason.message))}else{MDNSServer.logSocketError(e.interface,e.reason)}}else if(r){r()}}))}sendOnAllNetworksForService(e,t){this.checkUnicastResponseFlag(e);const r=e.encode();this.assertBeforeSend(r,"IPv4");const i=[];for(const[e,n]of this.sockets){if(!t.advertisesOnInterface(e)){continue}const a=new Promise((t=>{n.send(r,MDNSServer.MDNS_PORT,MDNSServer.MULTICAST_IPV4,(i=>{if(i){if(!MDNSServer.isSilencedSocketError(i)){t({status:"rejected",interface:e,reason:i});return}}else{this.maintainSentPacketsInterface(e,r)}t({status:"fulfilled",interface:e})}))}));i.push(Promise.race([a,(0,d.PromiseTimeout)(MDNSServer.SEND_TIMEOUT).then((()=>({status:"timeout",interface:e})))]))}return Promise.all(i)}send(e,t){this.checkUnicastResponseFlag(e);const r=e.encode();this.assertBeforeSend(r,"IPv4");let i;let n;let a;if(typeof t==="string"){i=MDNSServer.MULTICAST_IPV4;n=MDNSServer.MDNS_PORT;a=t}else{i=t.address;n=t.port;a=t.interface}const o=this.sockets.get(a);if(!o){throw new l.InterfaceNotFoundError(`Could not find socket for given network interface '${a}'`)}return new Promise((e=>{o.send(r,n,i,(t=>{if(t){if(!MDNSServer.isSilencedSocketError(t)){e({status:"rejected",interface:a,reason:t});return}}else{this.maintainSentPacketsInterface(a,r)}e({status:"fulfilled",interface:a})}))}))}checkUnicastResponseFlag(e){if(this.suppressUnicastResponseFlag&&e.type===0){e.questions.forEach((e=>e.unicastResponseFlag=false))}}assertBeforeSend(e,t){if(this.closed){throw new l.ServerClosedError("Cannot send packets on a closed mdns server!")}(0,n.default)(this.bound,"Cannot send packets before server is not bound!");const r=t==="IPv4"?MDNSServer.DEFAULT_IP4_HEADER:MDNSServer.DEFAULT_IP6_HEADER;(0,n.default)(r+MDNSServer.UDP_HEADER+e.length<=9e3,"DNS cannot exceed the size of 9000 bytes even with IP Fragmentation!")}maintainSentPacketsInterface(e,t){const r=t.toString("base64");const i=this.sentPackets.get(e);if(!i){this.sentPackets.set(e,[r])}else{i.push(r)}}checkIfPacketWasPreviouslySentFromUs(e,t){const r=t.toString("base64");const i=this.sentPackets.get(e);if(i){const e=i.indexOf(r);if(e!==-1){i.splice(e,1);return true}}return false}createDgramSocket(e,t=false,r="udp4"){const i=o.default.createSocket({type:r,reuseAddr:t});i.on("message",this.handleMessage.bind(this,e));i.on("error",(t=>{if(!MDNSServer.isSilencedSocketError(t)){MDNSServer.logSocketError(e,t)}}));return i}bindSocket(e,t,r){return new Promise(((i,a)=>{const errorHandler=e=>a(new Error("Failed to bind on interface "+t.name+": "+e.message));e.once("error",errorHandler);e.on("close",(()=>{this.sockets.delete(t.name)}));e.bind(MDNSServer.MDNS_PORT,(()=>{e.setRecvBufferSize(800*1024);e.removeListener("error",errorHandler);const o=r==="IPv4"?MDNSServer.MULTICAST_IPV4:MDNSServer.MULTICAST_IPV6;const s=r==="IPv4"?t.ipv4:t.ipv6;(0,n.default)(s,"Interface address for "+t.name+" cannot be undefined!");try{e.addMembership(o,s);e.setMulticastInterface(s);e.setMulticastTTL(MDNSServer.MDNS_TTL);e.setTTL(MDNSServer.MDNS_TTL);e.setMulticastLoopback(true);this.sockets.set(t.name,e);i()}catch(r){try{e.close()}catch(e){h("Error while closing socket which failed to bind. Error may be expected: "+e.message)}a(new Error("Error binding socket on "+t.name+": "+r.stack))}}))}))}handleMessage(e,t,r){if(!this.bound){return}const i=this.networkManager.getInterface(e);if(!i){h("Received packet on non existing network interface: %s!",e);return}if(this.checkIfPacketWasPreviouslySentFromUs(i.name,t)){return}const n=(0,u.getNetAddress)(r.address,i.ip4Netmask);if(i.loopback){if(n!==i.ipv4Netaddress){return}}else if(this.networkManager.isLoopbackNetaddressV4(n)){h("Received packet on interface '%s' which is not coming from the same subnet: %o",e,{address:r.address,netaddress:n,interface:i.ipv4});return}let a;try{a=s.DNSPacket.decode(r,t)}catch(i){h("Received a malformed packet from %o on interface %s. This might or might not be a problem. "+"Here is the received packet for debugging purposes '%s'. "+"Packet decoding failed with %s",r,e,t.toString("base64"),i.stack);return}if(a.opcode!==0){return}if(a.rcode!==0){return}const o={address:r.address,port:r.port,interface:e};if(a.type===0){try{this.handler.handleQuery(a,o)}catch(t){console.warn("Error occurred handling incoming (on "+e+") dns query packet: "+t.stack)}}else if(a.type===1){if(r.port!==MDNSServer.MDNS_PORT){return}try{this.handler.handleResponse(a,o)}catch(t){console.warn("Error occurred handling incoming (on "+e+") dns response packet: "+t.stack)}}}static isSilencedSocketError(e){const t=e.message.includes("EADDRNOTAVAIL")||e.message.includes("EHOSTDOWN")||e.message.includes("ENETUNREACH")||e.message.includes("EHOSTUNREACH")||e.message.includes("EPERM")||e.message.includes("EINVAL");if(t){h("Silenced and ignored error (This is/should not be a problem, this message is only for informational purposes): "+e.message)}return t}static logSocketError(e,t){console.warn(`Encountered MDNS socket error on socket '${e}' : ${t.stack}`);return}handleUpdatedNetworkInterfaces(e){if(e.removed){for(const t of e.removed){const e=this.sockets.get(t.name);this.sockets.delete(t.name);if(e){e.close()}}}if(e.changes){for(const t of e.changes){const e=this.sockets.get(t.name);(0,n.default)(e,"Couldn't find socket for network change!");if(!t.outdatedIpv4&&t.updatedIpv4){n.default.fail("Reached illegal state! IPv4 address changed from undefined to defined!")}else if(t.outdatedIpv4&&!t.updatedIpv4){n.default.fail("Reached illegal state! IPV4 address change from defined to undefined!")}else if(t.outdatedIpv4&&t.updatedIpv4){try{e.dropMembership(MDNSServer.MULTICAST_IPV4,t.outdatedIpv4)}catch(e){h("Thrown expected error when dropping outdated address membership: "+e.message)}try{e.addMembership(MDNSServer.MULTICAST_IPV4,t.updatedIpv4)}catch(e){h("Thrown expected error when adding new address membership: "+e.message)}e.setMulticastInterface(t.updatedIpv4)}}}if(e.added){for(const t of e.added){const e=this.createDgramSocket(t.name,true);this.bindSocket(e,t,"IPv4").catch((e=>{console.log("Could not bind detected network interface: "+e.stack)}))}}}}t.MDNSServer=MDNSServer;MDNSServer.DEFAULT_IP4_HEADER=20;MDNSServer.DEFAULT_IP6_HEADER=40;MDNSServer.UDP_HEADER=8;MDNSServer.MDNS_PORT=5353;MDNSServer.MDNS_TTL=255;MDNSServer.MULTICAST_IPV4="224.0.0.251";MDNSServer.MULTICAST_IPV6="FF02::FB";MDNSServer.SEND_TIMEOUT=200},3729:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetworkManager=t.NetworkManagerEvent=t.WifiState=t.IPFamily=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(2081));const o=(0,i.__importDefault)(r(7031));const s=r(2361);const c=(0,i.__importDefault)(r(2409));const u=(0,i.__importDefault)(r(1808));const l=(0,i.__importDefault)(r(2037));const d=r(35);const h=(0,o.default)("ciao:NetworkManager");var p;(function(e){e["IPv4"]="IPv4";e["IPv6"]="IPv6"})(p=t.IPFamily||(t.IPFamily={}));var v;(function(e){e[e["UNDEFINED"]=0]="UNDEFINED";e[e["NOT_A_WIFI_INTERFACE"]=1]="NOT_A_WIFI_INTERFACE";e[e["NOT_ASSOCIATED"]=2]="NOT_ASSOCIATED";e[e["CONNECTED"]=3]="CONNECTED"})(v=t.WifiState||(t.WifiState={}));var m;(function(e){e["NETWORK_UPDATE"]="network-update"})(m=t.NetworkManagerEvent||(t.NetworkManagerEvent={}));class NetworkManager extends s.EventEmitter{constructor(e){super();this.currentInterfaces=new Map;this.loopbackInterfaces=new Map;this.setMaxListeners(100);if(e&&e.interface){let t;if(typeof e.interface==="string"){t=[e.interface]}else if(Array.isArray(e.interface)){t=e.interface}else{throw new Error("Found invalid type for 'interfaces' NetworkManager option!")}const r=[];for(const i of t){if(u.default.isIP(i)){const t=NetworkManager.resolveInterface(i);if(t){r.push(t)}else{console.log("CIAO: Interface was specified as ip (%s), though couldn't find a matching interface for the given address.",e.interface)}}else{r.push(i)}}if(r.length===0){console.log("CIAO: 'restrictedInterfaces' array was empty. Going to fallback to bind on all available interfaces.")}else{this.restrictedInterfaces=r}}this.excludeIpv6=!!(e&&e.excludeIpv6);this.excludeIpv6Only=this.excludeIpv6||!!(e&&e.excludeIpv6Only);if(e){h("Created NetworkManager with options: %s",JSON.stringify(e))}this.initPromise=new Promise((e=>{this.getCurrentNetworkInterfaces().then((t=>{this.currentInterfaces=t;const r=Object.keys(l.default.networkInterfaces());const i=[];for(const e of this.currentInterfaces.keys()){i.push(e);const t=r.indexOf(e);if(t!==-1){r.splice(t,1)}}h("Initial networks [%s] ignoring [%s]",i.join(", "),r.join(", "));this.initPromise=undefined;e();this.scheduleNextJob()}))}))}async waitForInit(){if(this.initPromise){await this.initPromise}}shutdown(){if(this.currentTimer){clearTimeout(this.currentTimer);this.currentTimer=undefined}this.removeAllListeners()}getInterfaceMap(){if(this.initPromise){n.default.fail("Not yet initialized!")}return this.currentInterfaces}getInterface(e){if(this.initPromise){n.default.fail("Not yet initialized!")}return this.currentInterfaces.get(e)}isLoopbackNetaddressV4(e){for(const t of this.loopbackInterfaces.values()){if(t.ipv4Netaddress===e){return true}}return false}scheduleNextJob(){this.currentTimer=setTimeout(this.checkForNewInterfaces.bind(this),NetworkManager.POLLING_TIME);this.currentTimer.unref()}async checkForNewInterfaces(){const e=await this.getCurrentNetworkInterfaces();if(!this.currentTimer){return}let t=undefined;let r=undefined;let i=undefined;for(const[r,n]of e){const e=this.currentInterfaces.get(r);if(e){if(!(0,c.default)(e,n)){const t={name:r};if(e.ipv4!==n.ipv4){if(e.ipv4){t.outdatedIpv4=e.ipv4}if(n.ipv4){t.updatedIpv4=n.ipv4}}if(e.ipv6!==n.ipv6){if(e.ipv6){t.outdatedIpv6=e.ipv6}if(n.ipv6){t.updatedIpv6=n.ipv6}}if(e.globallyRoutableIpv6!==n.globallyRoutableIpv6){if(e.globallyRoutableIpv6){t.outdatedGloballyRoutableIpv6=e.globallyRoutableIpv6}if(n.globallyRoutableIpv6){t.updatedGloballyRoutableIpv6=n.globallyRoutableIpv6}}if(e.uniqueLocalIpv6!==n.uniqueLocalIpv6){if(e.uniqueLocalIpv6){t.outdatedUniqueLocalIpv6=e.uniqueLocalIpv6}if(n.uniqueLocalIpv6){t.updatedUniqueLocalIpv6=n.uniqueLocalIpv6}}this.currentInterfaces.set(r,n);if(n.loopback){this.loopbackInterfaces.set(r,n)}(i!==null&&i!==void 0?i:i=[]).push(t)}}else{this.currentInterfaces.set(r,n);if(n.loopback){this.currentInterfaces.set(r,n)}(t!==null&&t!==void 0?t:t=[]).push(n)}}if(this.currentInterfaces.size!==e.size){for(const[t,i]of this.currentInterfaces){if(!e.has(t)){this.currentInterfaces.delete(t);this.loopbackInterfaces.delete(t);(r!==null&&r!==void 0?r:r=[]).push(i)}}}if(t||r||i){const e=t?t.map((e=>e.name)).join(","):"";const n=r?r.map((e=>e.name)).join(","):"";const a=i?i.map((e=>{let t=`{ name: ${e.name} `;if(e.outdatedIpv4||e.updatedIpv4){t+=`, ${e.outdatedIpv4} -> ${e.updatedIpv4} `}if(e.outdatedIpv6||e.updatedIpv6){t+=`, ${e.outdatedIpv6} -> ${e.updatedIpv6} `}if(e.outdatedGloballyRoutableIpv6||e.updatedGloballyRoutableIpv6){t+=`, ${e.outdatedGloballyRoutableIpv6} -> ${e.updatedGloballyRoutableIpv6} `}if(e.outdatedUniqueLocalIpv6||e.updatedUniqueLocalIpv6){t+=`, ${e.outdatedUniqueLocalIpv6} -> ${e.updatedUniqueLocalIpv6} `}return t+"}"})).join(","):"";h("Detected network changes: added: [%s], removed: [%s], changes: [%s]!",e,n,a);this.emit("network-update",{added:t,removed:r,changes:i})}this.scheduleNextJob()}async getCurrentNetworkInterfaces(){let e;if(this.restrictedInterfaces){e=this.restrictedInterfaces;const t=NetworkManager.getLoopbackInterface();if(!e.includes(t)){e.push(t)}}else{try{e=await NetworkManager.getNetworkInterfaceNames()}catch(t){h(`WARNING Detecting network interfaces for platform '${l.default.platform()}' failed. Trying to assume network interfaces! (${t.message})`);e=NetworkManager.assumeNetworkInterfaceNames()}}const t=new Map;const r=l.default.networkInterfaces();for(const i of e){const e=r[i];if(!e){continue}let a=undefined;let o=undefined;let s=undefined;let c=undefined;let u=false;for(const t of e){if(t.internal){u=true}if((t.family==="IPv4"||t.family===4)&&!a){a=t}else if(t.family==="IPv6"||t.family===6){if(this.excludeIpv6){continue}if(t.scopeid&&!o){o=t}else if(t.scopeid===0){if(t.address.startsWith("fc")||t.address.startsWith("fd")){if(!c){c=t}}else if(!s){s=t}}}if(a&&o&&s&&c){break}}(0,n.default)(a||o,"Could not find valid addresses for interface '"+i+"'");if(this.excludeIpv6Only&&!a){continue}const l={name:i,loopback:u,mac:(a===null||a===void 0?void 0:a.mac)||(o===null||o===void 0?void 0:o.mac)};if(a){l.ipv4=a.address;l.ip4Netmask=a.netmask;l.ipv4Netaddress=(0,d.getNetAddress)(a.address,a.netmask)}if(o){l.ipv6=o.address;l.ipv6Netmask=o.netmask}if(s){l.globallyRoutableIpv6=s.address;l.globallyRoutableIpv6Netmask=s.netmask}if(c){l.uniqueLocalIpv6=c.address;l.uniqueLocalIpv6Netmask=c.netmask}t.set(i,l)}return t}static resolveInterface(e){let t;e:for(const[r,i]of Object.entries(l.default.networkInterfaces())){for(const n of i){if(n.address===e){t=r;break e}}}return t}static async getNetworkInterfaceNames(){let e;switch(l.default.platform()){case"win32":e=NetworkManager.getWindowsNetworkInterfaces();break;case"linux":{e=NetworkManager.getLinuxNetworkInterfaces();break}case"darwin":e=NetworkManager.getDarwinNetworkInterfaces();break;case"freebsd":{e=NetworkManager.getFreeBSDNetworkInterfaces();break}case"openbsd":case"sunos":{e=NetworkManager.getOpenBSD_SUNOS_NetworkInterfaces();break}default:h("Found unsupported platform %s",l.default.platform());return Promise.reject(new Error("unsupported platform!"))}let t;try{t=await e}catch(e){if(e.message!==NetworkManager.NOTHING_FOUND_MESSAGE){throw e}t=[]}const r=NetworkManager.getLoopbackInterface();if(!t.includes(r)){t.unshift(r)}return e}static assumeNetworkInterfaceNames(){const e=[];Object.entries(l.default.networkInterfaces()).forEach((([t,r])=>{for(const i of r){if(i.internal||(i.family==="IPv4"||i.family===4)||(i.family==="IPv6"||i.family===6)&&i.scopeid===0){if(!e.includes(t)){e.push(t)}break}}}));return e}static getLoopbackInterface(){for(const[e,t]of Object.entries(l.default.networkInterfaces())){for(const r of t){if(r.internal){return e}}}throw new Error("Could not detect loopback interface!")}static getWindowsNetworkInterfaces(){return new Promise(((e,t)=>{a.default.exec('arp -a | findstr /C:"---"',((r,i)=>{if(r){t(r);return}const n=i.split(l.default.EOL);const a=[];for(let e=0;e<n.length-1;e++){const t=n[e].trim().split(" ");if(t[t.length-3]){a.push(t[t.length-3])}else{h(`WINDOWS: Failed to read interface name from line ${e}: '${n[e]}'`)}}const o=[];for(const e of a){const t=NetworkManager.resolveInterface(e);if(t){if(!o.includes(t)){o.push(t)}}else{h(`WINDOWS: Couldn't resolve to an interface name from '${e}'`)}}if(o.length){e(o)}else{t(new Error(NetworkManager.NOTHING_FOUND_MESSAGE))}}))}))}static getDarwinNetworkInterfaces(){return new Promise(((e,t)=>{a.default.exec("arp -a -n -l",(async(r,i)=>{if(r){t(r);return}const n=i.split(l.default.EOL);const a=[];for(let e=1;e<n.length-1;e++){const t=n[e].trim().split(NetworkManager.SPACE_PATTERN)[4];if(!t){h(`DARWIN: Failed to read interface name from line ${e}: '${n[e]}'`);continue}if(!a.includes(t)){a.push(t)}}const o=[];for(const e of a){const t=NetworkManager.getDarwinWifiNetworkState(e).then((t=>{if(t!==1&&t!==3){const t=a.indexOf(e);if(t!==-1){a.splice(t,1)}}}));o.push(t)}await Promise.all(o);if(a.length){e(a)}else{t(new Error(NetworkManager.NOTHING_FOUND_MESSAGE))}}))}))}static getLinuxNetworkInterfaces(){return new Promise(((e,t)=>{a.default.exec("ip neigh show",((r,i)=>{if(r){if(r.message.includes("ip: not found")){h("LINUX: ip was not found on the system. Falling back to assuming network interfaces!");e(NetworkManager.assumeNetworkInterfaceNames());return}t(r);return}const n=i.split(l.default.EOL);const a=[];for(let e=0;e<n.length-1;e++){const t=n[e].trim().split(NetworkManager.SPACE_PATTERN);let r=0;for(;r<t.length;r++){if(t[r]==="dev"){break}}if(r>=t.length){h(`LINUX: Out of bounds when reading interface name from line ${e}: '${n[e]}'`);continue}const i=t[r+1];if(!i){h(`LINUX: Failed to read interface name from line ${e}: '${n[e]}'`);continue}if(!a.includes(i)){a.push(i)}}if(a.length){e(a)}else{t(new Error(NetworkManager.NOTHING_FOUND_MESSAGE))}}))}))}static getFreeBSDNetworkInterfaces(){return new Promise(((e,t)=>{a.default.exec("arp -a -n",((r,i)=>{if(r){t(r);return}const n=i.split(l.default.EOL);const a=[];for(let e=0;e<n.length-1;e++){const t=n[e].trim().split(NetworkManager.SPACE_PATTERN)[5];if(!t){h(`FreeBSD: Failed to read interface name from line ${e}: '${n[e]}'`);continue}if(!a.includes(t)){a.push(t)}}if(a.length){e(a)}else{t(new Error(NetworkManager.NOTHING_FOUND_MESSAGE))}}))}))}static getOpenBSD_SUNOS_NetworkInterfaces(){return new Promise(((e,t)=>{a.default.exec("arp -a -n",((r,i)=>{if(r){t(r);return}const n=l.default.platform()==="sunos"?0:2;const a=i.split(l.default.EOL);const o=[];for(let e=1;e<a.length-1;e++){const t=a[e].trim().split(NetworkManager.SPACE_PATTERN)[n];if(!t){h(`${l.default.platform()}: Failed to read interface name from line ${e}: '${a[e]}'`);continue}if(!o.includes(t)){o.push(t)}}if(o.length){e(o)}else{t(new Error(NetworkManager.NOTHING_FOUND_MESSAGE))}}))}))}static getDarwinWifiNetworkState(e){return new Promise((t=>{a.default.exec("networksetup -getairportnetwork "+e,((r,i)=>{if(r){if(i.includes("not a Wi-Fi interface")){t(1);return}console.log(`CIAO WARN: While checking networksetup for ${e} encountered an error (${r.message}) with output: ${i.replace(l.default.EOL,"; ")}`);t(0);return}let n=0;if(i.includes("not a Wi-Fi interface")){n=1}else if(i.includes("Current Wi-Fi Network")){n=3}else if(i.includes("not associated")){n=2}else if(i.includes("All Wi-Fi network services are disabled")){n=1}else{console.log(`CIAO WARN: While checking networksetup for ${e} encountered an unknown output: ${i.replace(l.default.EOL,"; ")}`)}t(n)}))}))}}t.NetworkManager=NetworkManager;NetworkManager.SPACE_PATTERN=/\s+/g;NetworkManager.NOTHING_FOUND_MESSAGE="no interfaces found";NetworkManager.POLLING_TIME=15*1e3},6657:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Responder=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(7031));const o=r(9085);const s=r(1234);const c=r(3802);const u=r(9352);const l=r(8059);const d=r(1425);const h=r(6366);const p=r(6130);const v=r(633);const m=r(9042);const g=r(5331);const y=r(7053);const C=r(7340);const T=r(2305);const E=r(7645);const D=r(8064);const _=r(930);const I=(0,a.default)("ciao:Responder");const queuedResponseComparator=(e,t)=>e.estimatedTimeToBeSent-t.estimatedTimeToBeSent;var b;(function(e){e[e["NO_CONFLICT"]=0]="NO_CONFLICT";e[e["CONFLICTING_RDATA"]=1]="CONFLICTING_RDATA";e[e["CONFLICTING_TTL"]=2]="CONFLICTING_TTL"})(b||(b={}));class Responder{constructor(e){this.refCount=1;this.optionsString="";this.bound=false;this.announcedServices=new Map;this.servicePointer=new Map;this.truncatedQueries={};this.delayedMulticastResponses=[];this.server=new v.MDNSServer(this,e);this.promiseChain=this.start();this.server.getNetworkManager().on("network-update",this.handleNetworkUpdate.bind(this));this.ignoreUnicastResponseFlag=e===null||e===void 0?void 0:e.ignoreUnicastResponseFlag;if(e===null||e===void 0?void 0:e.periodicBroadcasts){this.broadcastInterval=setTimeout(this.handlePeriodicBroadcasts.bind(this),3e4).unref()}}static getResponder(e){const t=e?JSON.stringify(e):"";const r=this.INSTANCES.get(t);if(r){r.refCount++;return r}else{const r=new Responder(e);this.INSTANCES.set(t,r);r.optionsString=t;return r}}handlePeriodicBroadcasts(){this.broadcastInterval=undefined;I("Sending periodic announcement on "+Array.from(this.server.getNetworkManager().getInterfaceMap().keys()).join(", "));for(const e of this.server.getNetworkManager().getInterfaceMap().values()){const t=new c.Question("_hap._tcp.local.",12,false);const r=this.answerQuestion(t,{port:5353,address:e.ipv4Netaddress||e.globallyRoutableIpv6||e.uniqueLocalIpv6||e.ipv6,interface:e.name});y.QueryResponse.combineResponses(r);for(const t of r){if(!t.hasAnswers()){continue}this.server.sendResponse(t.asPacket(),e.name)}}this.broadcastInterval=setTimeout(this.handlePeriodicBroadcasts.bind(this),Math.random()*3e3+27e3).unref()}createService(e){const t=new o.CiaoService(this.server.getNetworkManager(),e);t.on("publish",this.advertiseService.bind(this,t));t.on("unpublish",this.unpublishService.bind(this,t));t.on("republish",this.republishService.bind(this,t));t.on("records-update",this.handleServiceRecordUpdate.bind(this,t));t.on("records-update-interface",this.handleServiceRecordUpdateOnInterface.bind(this,t));return t}shutdown(){this.refCount--;if(this.refCount>0){return Promise.resolve()}if(this.currentProber){this.currentProber.cancel()}if(this.broadcastInterval){clearTimeout(this.broadcastInterval)}Responder.INSTANCES.delete(this.optionsString);I("Shutting down Responder...");const e=[];for(const t of this.announcedServices.values()){e.push(this.unpublishService(t))}return Promise.all(e).then((()=>{this.server.shutdown();this.bound=false}))}getAnnouncedServices(){return this.announcedServices.values()}start(){if(this.bound){throw new Error("Server is already bound!")}this.bound=true;return this.server.bind()}advertiseService(e,t){if(e.serviceState==="announced"){throw new Error("Can't publish a service that is already announced. Received "+e.serviceState+" for service "+e.getFQDN())}else if(e.serviceState==="probing"){return this.promiseChain.then((()=>{if(e.currentAnnouncer){return e.currentAnnouncer.awaitAnnouncement()}}))}else if(e.serviceState==="announcing"){(0,n.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!");if(e.currentAnnouncer.isSendingGoodbye()){return e.currentAnnouncer.awaitAnnouncement().then((()=>this.advertiseService(e,t)))}else{return e.currentAnnouncer.cancel().then((()=>this.advertiseService(e,t)))}}I("[%s] Going to advertise service...",e.getFQDN());this.promiseChain=this.promiseChain.then((()=>e.rebuildServiceRecords())).then((()=>this.probe(e)));return this.promiseChain.then((()=>{this.announce(e).catch((t=>{console.log(`[${e.getFQDN()}] failed announcing with reason: ${t}. Trying again in 2 seconds!`);return(0,D.PromiseTimeout)(2e3).then((()=>this.advertiseService(e,(()=>{}))))}));t()}),(r=>{if(r===g.Prober.CANCEL_REASON){t()}else{console.log(`[${e.getFQDN()}] failed probing with reason: ${r}. Trying again in 2 seconds!`);return(0,D.PromiseTimeout)(2e3).then((()=>this.advertiseService(e,t)))}}))}republishService(e,t,r=false){if(e.serviceState!=="announced"&&e.serviceState!=="announcing"){throw new Error("Can't unpublish a service which isn't announced yet. Received "+e.serviceState+" for service "+e.getFQDN())}I("[%s] Readvertising service...",e.getFQDN());if(e.serviceState==="announcing"){(0,n.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!");const r=e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement():e.currentAnnouncer.cancel();return r.then((()=>this.advertiseService(e,t)))}this.clearService(e);e.serviceState="unannounced";if(r){return(0,D.PromiseTimeout)(1e3).then((()=>this.advertiseService(e,t)))}else{return this.advertiseService(e,t)}}unpublishService(e,t){if(e.serviceState==="unannounced"){throw new Error("Can't unpublish a service which isn't announced yet. Received "+e.serviceState+" for service "+e.getFQDN())}if(e.serviceState==="announced"||e.serviceState==="announcing"){if(e.serviceState==="announcing"){(0,n.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!");if(e.currentAnnouncer.isSendingGoodbye()){return e.currentAnnouncer.awaitAnnouncement()}return e.currentAnnouncer.cancel().then((()=>{e.serviceState="announced";return this.unpublishService(e,t)}))}I("[%s] Removing service from the network",e.getFQDN());this.clearService(e);e.serviceState="unannounced";let r=this.goodbye(e);if(t){r=r.then((()=>t()),(r=>{console.log(`[${e.getFQDN()}] failed goodbye with reason: ${r}.`);t()}))}return r}else if(e.serviceState==="probing"){I("[%s] Canceling probing",e.getFQDN());if(this.currentProber&&this.currentProber.getService()===e){this.currentProber.cancel();this.currentProber=undefined}e.serviceState="unannounced"}t&&t();return Promise.resolve()}clearService(e){const t=e.getLowerCasedFQDN();const r=e.getLowerCasedTypePTR();const i=e.getLowerCasedSubtypePTRs();this.removePTR(Responder.SERVICE_TYPE_ENUMERATION_NAME,r);this.removePTR(r,t);if(i){for(const e of i){this.removePTR(e,t)}}this.announcedServices.delete(e.getLowerCasedFQDN())}addPTR(e,t){const r=this.servicePointer.get(e);if(r){if(!r.includes(t)){r.push(t)}}else{this.servicePointer.set(e,[t])}}removePTR(e,t){const r=this.servicePointer.get(e);if(r){const i=r.indexOf(t);if(i!==-1){r.splice(i,1)}if(r.length===0){this.servicePointer.delete(e)}}}probe(e){if(e.serviceState!=="unannounced"){throw new Error("Can't probe for a service which is announced already. Received "+e.serviceState+" for service "+e.getFQDN())}e.serviceState="probing";(0,n.default)(this.currentProber===undefined,"Tried creating new Prober when there already was one active!");this.currentProber=new g.Prober(this,this.server,e);return this.currentProber.probe().then((()=>{this.currentProber=undefined;e.serviceState="probed"}),(t=>{e.serviceState="unannounced";this.currentProber=undefined;return Promise.reject(t)}))}announce(e){if(e.serviceState!=="probed"){throw new Error("Cannot announce service which was not probed unique. Received "+e.serviceState+" for service "+e.getFQDN())}(0,n.default)(e.currentAnnouncer===undefined,"Service "+e.getFQDN()+" is already announcing!");e.serviceState="announcing";const t=new m.Announcer(this.server,e,{repetitions:3});e.currentAnnouncer=t;const r=e.getLowerCasedFQDN();const i=e.getLowerCasedTypePTR();const a=e.getLowerCasedSubtypePTRs();this.addPTR(Responder.SERVICE_TYPE_ENUMERATION_NAME,i);this.addPTR(i,r);if(a){for(const e of a){this.addPTR(e,r)}}this.announcedServices.set(r,e);return t.announce().then((()=>{e.serviceState="announced";e.currentAnnouncer=undefined}),(t=>{e.serviceState="unannounced";e.currentAnnouncer=undefined;this.clearService(e);if(t!==m.Announcer.CANCEL_REASON){return Promise.reject(t)}}))}handleServiceRecordUpdate(e,t,r){var i;if(e.serviceState!=="announced"){throw new Error("Cannot update txt of service which is not announced yet. Received "+e.serviceState+" for service "+e.getFQDN())}I("[%s] Updating %d record(s) for given service!",e.getFQDN(),t.answers.length+(((i=t.additionals)===null||i===void 0?void 0:i.length)||0));this.server.sendResponseBroadcast(t,e).then((t=>{const i=(0,v.SendResultFailedRatio)(t);if(i===1){console.log((0,v.SendResultFormatError)(t,`Failed to send records update for '${e.getFQDN()}'`),true);if(r){r(new Error("Updating records failed as of socket errors!"))}return}if(i>0){I((0,v.SendResultFormatError)(t,`Some of the record updates for '${e.getFQDN()}' failed`))}if(r){r()}}))}handleServiceRecordUpdateOnInterface(e,t,r,i){if(e.serviceState!=="announced"){throw new Error("Cannot update txt of service which is not announced yet. Received "+e.serviceState+" for service "+e.getFQDN())}I("[%s] Updating %d record(s) for given service on interface %s!",e.getFQDN(),r.length,t);const n=s.DNSPacket.createDNSResponsePacketsFromRRSet({answers:r});this.server.sendResponse(n,t,i)}goodbye(e){(0,n.default)(e.currentAnnouncer===undefined,"Service "+e.getFQDN()+" is already announcing!");e.serviceState="announcing";const t=new m.Announcer(this.server,e,{repetitions:1,goodbye:true});e.currentAnnouncer=t;return t.announce().then((()=>{e.serviceState="unannounced";e.currentAnnouncer=undefined}),(t=>{e.serviceState="unannounced";e.currentAnnouncer=undefined;return Promise.reject(t)}))}handleNetworkUpdate(e){for(const t of this.announcedServices.values()){t.handleNetworkInterfaceUpdate(e)}}handleQuery(e,t){const r=(new Date).getTime();const i=t.address+":"+t.port+":"+t.interface;const n=this.truncatedQueries[i];if(n){const t=n.appendDNSPacket(e);switch(t){case 1:delete this.truncatedQueries[i];I("[%s] Aborting to wait for more truncated queries. Waited a total of %d ms receiving %d queries",i,n.getTotalWaitTime(),n.getArrivedPacketCount());return;case 2:I("[%s] Received a query marked as truncated, waiting for more to arrive",i);return;case 3:delete this.truncatedQueries[i];e=n.getPacket();I("[%s] Last part of the truncated query arrived. Received %d packets taking a total of %d ms",i,n.getArrivedPacketCount(),n.getTotalWaitTime());break}}else if(e.flags.truncation){I("Received truncated query from "+JSON.stringify(t)+" waiting for more to come!");const r=new T.TruncatedQuery(e);this.truncatedQueries[i]=r;r.on("timeout",(()=>{I("[%s] Timeout passed since the last truncated query was received. Discarding %d packets received in %d ms.",i,r.getArrivedPacketCount(),r.getTotalWaitTime());delete this.truncatedQueries[i]}));return}const a=t.port!==v.MDNSServer.MDNS_PORT;const o=e.authorities.size>0;let s=undefined;for(const t of e.additionals.values()){if(t.type===41){s=t.udpPayloadSize;break}}const c=[];const u=[];e.questions.forEach((r=>{const i=this.answerQuestion(r,t,e.answers);if(a||r.unicastResponseFlag&&!this.ignoreUnicastResponseFlag){u.push(...i)}else{c.push(...i)}}));if(this.currentProber){this.currentProber.handleQuery(e,t)}if(a){for(let t=0;t<u.length;t++){const r=u[t];r.markLegacyUnicastResponse(e.id,t===0?Array.from(e.questions.values()):undefined)}}y.QueryResponse.combineResponses(c,s);y.QueryResponse.combineResponses(u,s);if(a&&u.length>1){u.splice(1,u.length-1);u[0].markTruncated()}for(const e of u){if(!e.hasAnswers()){continue}this.server.sendResponse(e.asPacket(),t);const i=(new Date).getTime()-r;I("Sending response via unicast to %s (took %d ms): %s",JSON.stringify(t),i,e.asString(s))}for(const i of c){if(!i.hasAnswers()){continue}if((i.containsSharedAnswer()||e.questions.size>1)&&!o){const e=(new Date).getTime()-r;this.enqueueDelayedMulticastResponse(i.asPacket(),t.interface,e)}else{let e=false;for(let n=0;n<this.delayedMulticastResponses.length;n++){const a=this.delayedMulticastResponses[n];if(a.getTimeTillSent()>C.QueuedResponse.MAX_DELAY){break}if(a.combineWithUniqueResponseIfPossible(i,t.interface)){const i=(new Date).getTime()-r;e=true;I("Multicast response on interface %s containing unique records (took %d ms) was combined with response which is sent out later",t.interface,i);break}}if(!e){this.server.sendResponse(i.asPacket(),t.interface);const e=(new Date).getTime()-r;I("Sending response via multicast on network %s (took %d ms): %s",t.interface,e,i.asString(s))}}}}handleResponse(e,t){if(this.currentProber){this.currentProber.handleResponse(e,t)}for(const r of this.announcedServices.values()){let i=false;let n=0;for(const a of e.answers.values()){const e=Responder.checkRecordConflictType(r,a,t);if(e===1){i=true;break}else if(e===2){n++}}if(!i){for(const a of e.additionals.values()){const e=Responder.checkRecordConflictType(r,a,t);if(e===1){i=true;break}else if(e===2){n++}}}if(i){this.republishService(r,(e=>{if(e){console.log(`FATAL Error occurred trying to resolve conflict for service ${r.getFQDN()}! We can't recover from this!`);console.log(e.stack);process.exit(1)}}),true)}else if(n&&!r.currentAnnouncer){r.serviceState="announcing";const e=new m.Announcer(this.server,r,{repetitions:1});r.currentAnnouncer=e;e.announce().then((()=>{r.currentAnnouncer=undefined;r.serviceState="announced"}),(e=>{r.currentAnnouncer=undefined;r.serviceState="announced";if(e===m.Announcer.CANCEL_REASON){return}console.warn("When trying to resolve a ttl conflict on the network, we were unable to send our response packet: "+e.message)}))}}}static checkRecordConflictType(e,t,r){if(!e.advertisesOnInterface(r.interface)){return 0}const i=t.getLowerCasedName();if(i===e.getLowerCasedFQDN()){if(t.type===33){const r=t;if(r.getLowerCasedHostname()!==e.getLowerCasedHostname()){I("[%s] Noticed conflicting record on the network. SRV with hostname: %s",e.getFQDN(),r.hostname);return 1}else if(r.port!==e.getPort()){I("[%s] Noticed conflicting record on the network. SRV with port: %s",e.getFQDN(),r.port);return 1}if(r.ttl<h.SRVRecord.DEFAULT_TTL/2){return 2}}else if(t.type===16){const r=t;const i=e.getTXT();if(i.length!==r.txt.length){I("[%s] Noticed conflicting record on the network. TXT with differing data length",e.getFQDN());return 1}for(let t=0;t<i.length;t++){const n=i[t];const a=r.txt[t];if(n.length!==a.length||n.toString("hex")!==a.toString("hex")){I("[%s] Noticed conflicting record on the network. TXT with differing data.",e.getFQDN());return 1}}if(r.ttl<p.TXTRecord.DEFAULT_TTL/2){return 2}}}else if(i===e.getLowerCasedHostname()){if(t.type===1){const r=t;if(!e.hasAddress(r.ipAddress)){I("[%s] Noticed conflicting record on the network. A with ip address: %s",e.getFQDN(),r.ipAddress);return 1}if(r.ttl<l.ARecord.DEFAULT_TTL/2){return 2}}else if(t.type===28){const r=t;if(!e.hasAddress(r.ipAddress)){I("[%s] Noticed conflicting record on the network. AAAA with ip address: %s",e.getFQDN(),r.ipAddress);return 1}if(r.ttl<u.AAAARecord.DEFAULT_TTL/2){return 2}}}else if(t.type===12){const r=t;if(i===e.getLowerCasedTypePTR()){if(r.getLowerCasedPTRName()===e.getLowerCasedFQDN()&&r.ttl<d.PTRRecord.DEFAULT_TTL/2){return 2}}else if(i===Responder.SERVICE_TYPE_ENUMERATION_NAME){}else{const t=e.getLowerCasedSubtypePTRs();if(t&&t.includes(i)&&r.getLowerCasedPTRName()===e.getLowerCasedFQDN()&&r.ttl<d.PTRRecord.DEFAULT_TTL/2){return 2}}}return 0}enqueueDelayedMulticastResponse(e,t,r){const i=new C.QueuedResponse(e,t);i.calculateRandomDelay();(0,_.sortedInsert)(this.delayedMulticastResponses,i,queuedResponseComparator);for(let e=0;e<this.delayedMulticastResponses.length;e++){const t=this.delayedMulticastResponses[e];for(let r=e+1;r<this.delayedMulticastResponses.length;r++){const i=this.delayedMulticastResponses[r];if(!t.delayWouldBeInTimelyManner(i)){break}if(t.combineWithNextPacketIfPossible(i)){const r=this.delayedMulticastResponses.indexOf(t);if(r!==-1){this.delayedMulticastResponses.splice(r,1)}e--;break}}}if(!i.delayed){i.scheduleResponse((()=>{const e=this.delayedMulticastResponses.indexOf(i);if(e!==-1){this.delayedMulticastResponses.splice(e,1)}try{this.server.sendResponse(i.getPacket(),t);I("Sending (delayed %dms) response via multicast on network interface %s (took %d ms): %s",Math.round(i.getTimeSinceCreation()),t,r,i.getPacket().asLoggingString())}catch(e){if(e.name===E.ERR_INTERFACE_NOT_FOUND){I("Multicast response (delayed %dms) was cancelled as the network interface %s is no longer available!",Math.round(i.getTimeSinceCreation()),t)}else if(e.name===E.ERR_SERVER_CLOSED){I("Multicast response (delayed %dms) was cancelled as the server is about to be shutdown!",Math.round(i.getTimeSinceCreation()))}else{throw e}}}))}}answerQuestion(e,t,r){if(e.class!==1&&e.class!==255){return[]}const i=[];let n=undefined;if(e.type===12||e.type===255||e.type===5){const a=this.servicePointer.get(e.getLowerCasedName());if(a){for(const o of a){const a=this.announcedServices.get(o);if(a){if(a.advertisesOnInterface(t.interface)){const n=Responder.answerServiceQuestion(a,e,t,r);if(n.hasAnswers()){i.push(n)}}}else{if(!n){n=new y.QueryResponse(r);i.unshift(n)}n.addAnswer(new d.PTRRecord(e.name,o))}}return i}}for(const n of this.announcedServices.values()){if(!n.advertisesOnInterface(t.interface)){continue}const a=Responder.answerServiceQuestion(n,e,t,r);if(a.hasAnswers()){i.push(a)}}return i}static answerServiceQuestion(e,t,r,i){const a=new y.QueryResponse(i);const o=t.getLowerCasedName();const s=t.type===255||t.type===5;const c=a.addAnswer.bind(a);const u=a.addAdditional.bind(a);if(o===e.getLowerCasedTypePTR()){if(s||t.type===12){const t=a.addAnswer(e.ptrRecord());if(t){a.addAdditional(e.txtRecord(),e.srvRecord());this.addAddressRecords(e,r,1,u);this.addAddressRecords(e,r,28,u);a.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord())}}}else if(o===e.getLowerCasedFQDN()){if(s){a.addAnswer(e.txtRecord());const t=a.addAnswer(e.srvRecord());if(t){this.addAddressRecords(e,r,1,u);this.addAddressRecords(e,r,28,u);a.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord())}}else if(t.type===33){const t=a.addAnswer(e.srvRecord());if(t){this.addAddressRecords(e,r,1,u);this.addAddressRecords(e,r,28,u);a.addAdditional(e.serviceNSECRecord(true),e.addressNSECRecord())}}else if(t.type===16){a.addAnswer(e.txtRecord());a.addAdditional(e.serviceNSECRecord())}}else if(o===e.getLowerCasedHostname()||o+"local."===e.getLowerCasedHostname()){if(s){this.addAddressRecords(e,r,1,c);this.addAddressRecords(e,r,28,c);a.addAdditional(e.addressNSECRecord())}else if(t.type===1){const t=this.addAddressRecords(e,r,1,c);if(t){this.addAddressRecords(e,r,28,u)}a.addAdditional(e.addressNSECRecord())}else if(t.type===28){const t=this.addAddressRecords(e,r,28,c);if(t){this.addAddressRecords(e,r,1,u)}a.addAdditional(e.addressNSECRecord())}}else if(e.getLowerCasedSubtypePTRs()){if(s||t.type===12){const t=e.getLowerCasedSubtypePTRs();const i=t.indexOf(o);if(i!==-1){const t=e.subtypePtrRecords();const s=t[i];(0,n.default)(o===s.name,"Question Name didn't match selected sub type ptr record!");const c=a.addAnswer(s);if(c){a.addAdditional(e.txtRecord(),e.srvRecord());this.addAddressRecords(e,r,1,u);this.addAddressRecords(e,r,28,u);a.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord())}}}}return a}static addAddressRecords(e,t,r,i){if(r===1){const r=e.aRecord(t.interface);return r?i(r):false}else if(r===28){const r=e.aaaaRecord(t.interface);const n=e.aaaaRoutableRecord(t.interface);const a=e.aaaaUniqueLocalRecord(t.interface);let o=false;if(r){o=i(r)}if(n){const e=i(n);o=o||e}if(a){const e=i(a);o=o||e}return o}else{n.default.fail("Illegal argument!")}}}t.Responder=Responder;Responder.SERVICE_TYPE_ENUMERATION_NAME="_services._dns-sd._udp.local.";Responder.INSTANCES=new Map},2849:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NonCompressionLabelCoder=t.DNSLabelCoder=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));class DNSLabelCoder{constructor(e){this.trackedLengths=[];this.writtenNames=[];this.legacyUnicastEncoding=e||false}initBuf(e){this.buffer=e}initRRLocation(e,t,r){this.startOfRR=e;this.startOfRData=t;this.rDataLength=r}clearRRLocation(){this.startOfRR=undefined;this.startOfRData=undefined;this.rDataLength=undefined}getUncompressedNameLength(e){if(e==="."){return 1}(0,n.default)(e.endsWith("."),"Supplied illegal name which doesn't end with the root label!");let t=0;const r=e.split(".");for(let i=0;i<r.length;i++){const a=r[i];if(!a&&i<r.length-1){n.default.fail("Label "+i+" in name '"+e+"' was empty")}t+=DNSLabelCoder.getLabelLength(a)}return t}getNameLength(e){if(DNSLabelCoder.DISABLE_COMPRESSION){return this.getUncompressedNameLength(e)}if(e==="."){return 1}(0,n.default)(e.endsWith("."),"Supplied illegal name which doesn't end with the root label!");const t=e.split(".").map((e=>DNSLabelCoder.getLabelLength(e)));const r={name:e,length:0,labelLengths:t};let i=undefined;let a=0;for(let t=0;t<this.trackedLengths.length;t++){const r=this.trackedLengths[t];const n=DNSLabelCoder.computeLabelSuffixLength(r.name,e);if(n>a){i=r;a=n}}let o=0;if(i){const e=t.length-1-a;for(let r=0;r<e;r++){o+=t[r]}o+=2}else{for(let e=0;e<t.length;e++){o+=t[e]}}r.length=o;this.trackedLengths.push(r);return r.length}encodeUncompressedName(e,t){if(!this.buffer){n.default.fail("Illegal state. Buffer not initialized!")}return DNSLabelCoder.encodeUncompressedName(e,this.buffer,t)}static encodeUncompressedName(e,t,r){(0,n.default)(e.endsWith("."),"Name does not end with the root label");const i=r;const a=e==="."?[""]:e.split(".");for(let e=0;e<a.length;e++){const i=a[e];if(i===""){(0,n.default)(e===a.length-1,"Encountered root label being not at the end of the domain name");t.writeUInt8(0,r++);break}const o=t.write(i,r+1);t.writeUInt8(o,r);r+=o+1}return r-i}encodeName(e,t){if(DNSLabelCoder.DISABLE_COMPRESSION){return this.encodeUncompressedName(e,t)}if(!this.buffer){n.default.fail("Illegal state. Buffer not initialized!")}if(e==="."){this.buffer.writeUInt8(0,t);return 1}const r=t;const i=e.split(".");const a={name:e,writtenLabels:new Array(i.length).fill(-1)};let o=undefined;let s=0;for(let t=0;t<this.writtenNames.length;t++){const r=this.writtenNames[t];const i=DNSLabelCoder.computeLabelSuffixLength(r.name,e);if(i>s){o=r;s=i}}if(o){const e=i.length-1-s;const r=o.writtenLabels.length-1-s;for(let r=0;r<e;r++){a.writtenLabels[r]=t;t+=DNSLabelCoder.writeLabel(i[r],this.buffer,t)}const c=o.writtenLabels[r];(0,n.default)(c!==-1,"Label which was pointed at wasn't yet written to the buffer!");(0,n.default)(c<=DNSLabelCoder.NOT_POINTER_MASK,"Pointer exceeds to length of a maximum of 14 bits");(0,n.default)(c<t,"Pointer can only point to a prior location");const u=DNSLabelCoder.POINTER_MASK|c;this.buffer.writeUInt16BE(u,t);t+=2}else{for(let e=0;e<i.length;e++){a.writtenLabels[e]=t;t+=DNSLabelCoder.writeLabel(i[e],this.buffer,t)}}this.writtenNames.push(a);return t-r}decodeName(e,t=true){if(!this.buffer){n.default.fail("Illegal state. Buffer not initialized!")}const r=e;let i="";for(;;){const a=this.buffer.readUInt8(e++);if(a===0){i+=".";break}const o=a&DNSLabelCoder.POINTER_MASK_ONE_BYTE;if(o){if(o===DNSLabelCoder.POINTER_MASK_ONE_BYTE){const a=this.buffer.readUInt16BE(e-1)&DNSLabelCoder.NOT_POINTER_MASK;e++;if(!t){i+=i?".~":"~";break}(0,n.default)(a<r,"Pointer at "+(e-2)+" MUST point to a prior location!");i+=(i?".":"")+this.decodeName(a).data;break}else if(o===DNSLabelCoder.LOCAL_COMPRESSION_ONE_BYTE){let a=this.buffer.readUInt16BE(e-1)&DNSLabelCoder.NOT_POINTER_MASK;e++;if(!t){i+=i?".~":"~";break}if(a>=0&&a<255){(0,n.default)(this.startOfRR!==undefined,"Cannot decompress locally compressed name as record is not initialized!");a+=this.startOfRR;(0,n.default)(a<r,"LocalPointer <255 at "+(e-2)+" MUST point to a prior location!");i+=(i?".":"")+this.decodeName(a).data}else if(a>=256){(0,n.default)(this.startOfRData!==undefined&&this.rDataLength!==undefined,"Cannot decompress locally compressed name as record is not initialized!");a-=-256;a+=this.startOfRData;(0,n.default)(a<r,"LocationPoint >265 at "+(e+2)+" MUST point to a prior location!");i+=(i?".":"")+this.decodeName(a).data}else{n.default.fail("Encountered unknown pointer range "+a)}break}else if(o===DNSLabelCoder.EXTENDED_LABEL_TYPE_ONE_BYTE){const t=a&DNSLabelCoder.NOT_POINTER_MASK_ONE_BYTE;n.default.fail("Received extended label type "+t+" at "+(e-1))}else{n.default.fail("Encountered unknown pointer type: "+Buffer.from([o>>6]).toString("hex")+" (with original byte "+Buffer.from([a]).toString("hex")+")")}}const s=this.buffer.toString("utf-8",e,e+a);e+=a;i+=(i?".":"")+s}return{data:i,readBytes:e-r}}static getLabelLength(e){if(!e){return 1}else{const t=Buffer.byteLength(e);(0,n.default)(t<=63,"Label cannot be longer than 63 bytes ("+e+")");return 1+t}}static writeLabel(e,t,r){if(!e){t.writeUInt8(0,r);return 1}else{const i=t.write(e,r+1);t.writeUInt8(i,r);return i+1}}static computeLabelSuffixLength(e,t){(0,n.default)(e.length!==0&&t.length!==0,"Encountered empty name when comparing suffixes!");const r=e.length-1;const i=t.length-1;let a=0;let o=false;for(let s=1;s<=r&&s<=i;s++){const c=e.charAt(r-s);const u=t.charAt(i-s);(0,n.default)(!!c&&!!u,"Seemingly encountered out of bounds trying to calculate suffixes");if(c!==u){o=true;break}else if(c==="."){a++}}if(!o){a++}return a}}t.DNSLabelCoder=DNSLabelCoder;DNSLabelCoder.DISABLE_COMPRESSION=false;DNSLabelCoder.POINTER_MASK=49152;DNSLabelCoder.POINTER_MASK_ONE_BYTE=192;DNSLabelCoder.LOCAL_COMPRESSION_ONE_BYTE=128;DNSLabelCoder.EXTENDED_LABEL_TYPE_ONE_BYTE=64;DNSLabelCoder.NOT_POINTER_MASK=16383;DNSLabelCoder.NOT_POINTER_MASK_ONE_BYTE=63;class NonCompressionLabelCoder extends DNSLabelCoder{getNameLength(e){return this.getUncompressedNameLength(e)}encodeName(e,t){return this.encodeUncompressedName(e,t)}}t.NonCompressionLabelCoder=NonCompressionLabelCoder;NonCompressionLabelCoder.INSTANCE=new NonCompressionLabelCoder},1234:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DNSPacket=t.PacketType=t.QClass=t.RClass=t.QType=t.RType=t.RCode=t.OpCode=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(2409));const o=r(4320);const s=r(2849);const c=r(3802);r(3879);const u=r(8297);var l;(function(e){e[e["QUERY"]=0]="QUERY"})(l=t.OpCode||(t.OpCode={}));var d;(function(e){e[e["NoError"]=0]="NoError"})(d=t.RCode||(t.RCode={}));var h;(function(e){e[e["A"]=1]="A";e[e["CNAME"]=5]="CNAME";e[e["PTR"]=12]="PTR";e[e["TXT"]=16]="TXT";e[e["AAAA"]=28]="AAAA";e[e["SRV"]=33]="SRV";e[e["OPT"]=41]="OPT";e[e["NSEC"]=47]="NSEC"})(h=t.RType||(t.RType={}));var p;(function(e){e[e["A"]=1]="A";e[e["CNAME"]=5]="CNAME";e[e["PTR"]=12]="PTR";e[e["TXT"]=16]="TXT";e[e["AAAA"]=28]="AAAA";e[e["SRV"]=33]="SRV";e[e["NSEC"]=47]="NSEC";e[e["ANY"]=255]="ANY"})(p=t.QType||(t.QType={}));var v;(function(e){e[e["IN"]=1]="IN"})(v=t.RClass||(t.RClass={}));var m;(function(e){e[e["IN"]=1]="IN";e[e["ANY"]=255]="ANY"})(m=t.QClass||(t.QClass={}));var g;(function(e){e[e["QUERY"]=0]="QUERY";e[e["RESPONSE"]=1]="RESPONSE"})(g=t.PacketType||(t.PacketType={}));function isQuery(e){return"answers"in e}function isProbeQuery(e){return"authorities"in e}class DNSPacket{constructor(e){this.questions=new Map;this.answers=new Map;this.authorities=new Map;this.additionals=new Map;this.estimatedEncodingLength=0;this.lastCalculatedLength=0;this.lengthDirty=true;this.id=e.id||0;this.legacyUnicastEncoding=e.legacyUnicast||false;this.type=e.type;this.opcode=e.opcode||0;this.flags=e.flags||{};this.rcode=e.rCode||0;if(this.type===1){this.flags.authoritativeAnswer=true}if(e.questions){this.addQuestions(...e.questions)}if(e.answers){this.addAnswers(...e.answers)}if(e.authorities){this.addAuthorities(...e.authorities)}if(e.additionals){this.addAdditionals(...e.additionals)}}static createDNSQueryPacket(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=this.createDNSQueryPackets(e,t);(0,n.default)(r.length===1,"Cannot user short method createDNSQueryPacket when query packets are more than one: is "+r.length);return r[0]}static createDNSQueryPackets(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=[];const i=new DNSPacket({type:0,questions:e.questions,additionals:isQuery(e)?e.additionals:undefined});r.push(i);if(i.getEstimatedEncodingLength()>t){const e=i.getEncodingLength();if(e>t){n.default.fail("Cannot send query where already the query section is exceeding the udpPayloadSize ("+e+">"+t+")!")}}if(isQuery(e)&&e.answers){let n=i;let a=0;const o=e.answers.concat([]);o.sort(((e,t)=>e.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE)-t.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE)));while(a<o.length){for(;a<o.length;a++){const e=o[a];const r=e.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE);if(i.getEstimatedEncodingLength()+r<=t){n.addAnswers(e)}else if(i.getEncodingLength()+r<=t){n.addAnswers(e)}else{if(n.questions.size===0&&n.answers.size===0){i.addAnswers(e)}break}}if(a<o.length){n.flags.truncation=true;n=new DNSPacket({type:0});r.push(n)}}}else if(isProbeQuery(e)&&e.authorities){i.addAuthorities(...e.authorities);const r=i.getEncodingLength();if(r>t){n.default.fail(`Probe query packet exceeds the mtu size (${r}>${t}). Can't split probe queries at the moment!`)}}return r}static createDNSResponsePacketsFromRRSet(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=new DNSPacket({id:e.id,legacyUnicast:e.legacyUnicast,type:1,flags:{authoritativeAnswer:true},questions:e.questions,answers:e.answers,additionals:e.additionals});if(r.getEncodingLength()>t){n.default.fail("Couldn't construct a dns response packet from a rr set which fits in an udp payload sized packet!")}return r}canBeCombinedWith(e,t=DNSPacket.UDP_PAYLOAD_SIZE_IPV4){return this.id===e.id&&this.type===e.type&&this.opcode===e.opcode&&(0,a.default)(this.flags,e.flags)&&this.rcode===e.rcode&&this.getEncodingLength()+e.getEncodingLength()<=t}combineWith(e){this.setLegacyUnicastEncoding(this.legacyUnicastEncoding||e.legacyUnicastEncoding);this.addRecords(this.questions,e.questions.values());this.addRecords(this.answers,e.answers.values(),this.additionals);this.addRecords(this.authorities,e.authorities.values());this.addRecords(this.additionals,e.additionals.values())}addQuestions(...e){return this.addRecords(this.questions,e)}addAnswers(...e){return this.addRecords(this.answers,e,this.additionals)}addAuthorities(...e){return this.addRecords(this.authorities,e)}addAdditionals(...e){return this.addRecords(this.additionals,e)}addRecords(e,t,r){let i=false;for(const n of t){if(e.has(n.asString())){continue}if(this.estimatedEncodingLength){this.estimatedEncodingLength+=n.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE)}e.set(n.asString(),n);i=true;this.lengthDirty=true;if(r){r.delete(n.asString())}}return i}setLegacyUnicastEncoding(e){if(this.legacyUnicastEncoding!==e){this.lengthDirty=true}this.legacyUnicastEncoding=e}legacyUnicastEncodingEnabled(){return this.legacyUnicastEncoding}getEstimatedEncodingLength(){if(this.estimatedEncodingLength){return this.estimatedEncodingLength}const e=s.NonCompressionLabelCoder.INSTANCE;let t=DNSPacket.DNS_PACKET_HEADER_SIZE;for(const r of this.questions.values()){t+=r.getEncodingLength(e)}for(const r of this.answers.values()){t+=r.getEncodingLength(e)}for(const r of this.authorities.values()){t+=r.getEncodingLength(e)}for(const r of this.additionals.values()){t+=r.getEncodingLength(e)}this.estimatedEncodingLength=t;return t}getEncodingLength(e){if(!this.lengthDirty){return this.lastCalculatedLength}const t=e||new s.DNSLabelCoder(this.legacyUnicastEncoding);let r=DNSPacket.DNS_PACKET_HEADER_SIZE;for(const e of this.questions.values()){r+=e.getEncodingLength(t)}for(const e of this.answers.values()){r+=e.getEncodingLength(t)}for(const e of this.authorities.values()){r+=e.getEncodingLength(t)}for(const e of this.additionals.values()){r+=e.getEncodingLength(t)}this.lengthDirty=false;this.lastCalculatedLength=r;this.estimatedEncodingLength=r;return r}encode(){const e=new s.DNSLabelCoder(this.legacyUnicastEncoding);const t=this.getEncodingLength(e);const r=Buffer.allocUnsafe(t);e.initBuf(r);let i=0;r.writeUInt16BE(this.id,i);i+=2;let a=this.type<<15|this.opcode<<11|this.rcode;if(this.flags.authoritativeAnswer){a|=DNSPacket.AUTHORITATIVE_ANSWER_MASK}if(this.flags.truncation){a|=DNSPacket.TRUNCATION_MASK}if(this.flags.recursionDesired){a|=DNSPacket.RECURSION_DESIRED_MASK}if(this.flags.recursionAvailable){a|=DNSPacket.RECURSION_AVAILABLE_MASK}if(this.flags.zero){a|=DNSPacket.ZERO_HEADER_MASK}if(this.flags.authenticData){a|=DNSPacket.AUTHENTIC_DATA_MASK}if(this.flags.checkingDisabled){a|=DNSPacket.CHECKING_DISABLED_MASK}r.writeUInt16BE(a,i);i+=2;r.writeUInt16BE(this.questions.size,i);i+=2;r.writeUInt16BE(this.answers.size,i);i+=2;r.writeUInt16BE(this.authorities.size,i);i+=2;r.writeUInt16BE(this.additionals.size,i);i+=2;for(const t of this.questions.values()){const n=t.encode(e,r,i);i+=n}for(const t of this.answers.values()){const n=t.encode(e,r,i);i+=n}for(const t of this.authorities.values()){const n=t.encode(e,r,i);i+=n}for(const t of this.additionals.values()){const n=t.encode(e,r,i);i+=n}(0,n.default)(i===r.length,"Bytes written didn't match the buffer size!");return r}static decode(e,t,r=0){const i=new s.DNSLabelCoder;i.initBuf(t);const a=t.readUInt16BE(r);r+=2;const o=t.readUInt16BE(r);r+=2;const l=t.readUInt16BE(r);r+=2;const d=t.readUInt16BE(r);r+=2;const h=t.readUInt16BE(r);r+=2;const p=t.readUInt16BE(r);r+=2;const v=[];const m=[];const g=[];const y=[];r+=DNSPacket.decodeList(e,i,t,r,l,c.Question.decode.bind(c.Question),v);r+=DNSPacket.decodeList(e,i,t,r,d,u.ResourceRecord.decode.bind(u.ResourceRecord),m);r+=DNSPacket.decodeList(e,i,t,r,h,u.ResourceRecord.decode.bind(u.ResourceRecord),g);r+=DNSPacket.decodeList(e,i,t,r,p,u.ResourceRecord.decode.bind(u.ResourceRecord),y);(0,n.default)(r===t.length,"Didn't read the full buffer (offset="+r+", length="+t.length+")");const C=o>>15;const T=o>>11&15;const E=o&15;const D={};if(o&this.AUTHORITATIVE_ANSWER_MASK){D.authoritativeAnswer=true}if(o&this.TRUNCATION_MASK){D.truncation=true}if(o&this.RECURSION_DESIRED_MASK){D.recursionDesired=true}if(o&this.RECURSION_AVAILABLE_MASK){D.recursionAvailable=true}if(o&this.ZERO_HEADER_MASK){D.zero=true}if(o&this.AUTHENTIC_DATA_MASK){D.authenticData=true}if(o&this.CHECKING_DISABLED_MASK){D.checkingDisabled=true}return new DNSPacket({id:a,type:C,opcode:T,rCode:E,flags:D,questions:v,answers:m,authorities:g,additionals:y})}static decodeList(e,t,r,i,n,a,o){const s=i;for(let s=0;s<n;s++){const n=a(e,t,r,i);i+=n.readBytes;if(n.data){o.push(n.data)}}return i-s}asLoggingString(e){let t="";let r="";for(const e of this.answers.values()){if(t){t+=","}t+=(0,o.dnsTypeToString)(e.type)}for(const e of this.additionals.values()){if(r){r+=","}r+=(0,o.dnsTypeToString)(e.type)}const i=[];if(this.legacyUnicastEncodingEnabled()){i.push("U")}if(e){i.push("UPS: "+e)}const n=i.length!==0?` (${i})`:"";return`[${t}] answers and [${r}] additionals with size ${this.getEncodingLength()}B${n}`}}t.DNSPacket=DNSPacket;DNSPacket.UDP_PAYLOAD_SIZE_IPV4=process.env.CIAO_UPS?parseInt(process.env.CIAO_UPS):1440;DNSPacket.UDP_PAYLOAD_SIZE_IPV6=process.env.CIAO_UPS?parseInt(process.env.CIAO_UPS):1440;DNSPacket.AUTHORITATIVE_ANSWER_MASK=1024;DNSPacket.TRUNCATION_MASK=512;DNSPacket.RECURSION_DESIRED_MASK=256;DNSPacket.RECURSION_AVAILABLE_MASK=128;DNSPacket.ZERO_HEADER_MASK=64;DNSPacket.AUTHENTIC_DATA_MASK=32;DNSPacket.CHECKING_DISABLED_MASK=16;DNSPacket.DNS_PACKET_HEADER_SIZE=12},3802:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Question=void 0;const i=r(2253);class Question{constructor(e,t,r=false,i=1){this.unicastResponseFlag=false;if(!e.endsWith(".")){e+="."}this.name=e;this.type=t;this.class=i;this.unicastResponseFlag=r}getLowerCasedName(){return this.lowerCasedName||(this.lowerCasedName=(0,i.dnsLowerCase)(this.name))}getEncodingLength(e){return e.getNameLength(this.name)+4}encode(e,t,r){const i=r;const n=e.encodeName(this.name,r);r+=n;t.writeUInt16BE(this.type,r);r+=2;let a=this.class;if(this.unicastResponseFlag){a|=Question.QU_MASK}t.writeUInt16BE(a,r);r+=2;return r-i}clone(){return new Question(this.name,this.type,this.unicastResponseFlag,this.class)}asString(){return`Q ${this.name} ${this.type} ${this.class}`}static decode(e,t,r,i){const n=i;const a=t.decodeName(i);i+=a.readBytes;const o=r.readUInt16BE(i);i+=2;const s=r.readUInt16BE(i);i+=2;const c=s&this.NOT_QU_MASK;const u=!!(s&this.QU_MASK);const l=new Question(a.data,o,u,c);return{data:l,readBytes:i-n}}}t.Question=Question;Question.QU_MASK=32768;Question.NOT_QU_MASK=32767},8297:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ResourceRecord=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(7031));const o=r(2253);const s=r(4320);const c=r(2849);const u=(0,a.default)("ciao:decoder");class ResourceRecord{constructor(e,t,r=ResourceRecord.RR_DEFAULT_TTL,i=false,n=1){this.flushFlag=false;if(typeof e==="string"){if(!e.endsWith(".")){e=e+"."}this.name=e;this.type=t;this.class=n;this.ttl=r;this.flushFlag=i}else{this.name=e.name;this.type=e.type;this.class=e.class;this.ttl=e.ttl;this.flushFlag=e.flushFlag}}getLowerCasedName(){return this.lowerCasedName||(this.lowerCasedName=(0,o.dnsLowerCase)(this.name))}getEncodingLength(e){return e.getNameLength(this.name)+10+this.getRDataEncodingLength(e)}encode(e,t,r){const i=r;const n=e.encodeName(this.name,r);r+=n;t.writeUInt16BE(this.type,r);r+=2;let a=this.class;if(this.flushFlag){a|=ResourceRecord.FLUSH_MASK}t.writeUInt16BE(a,r);r+=2;t.writeUInt32BE(this.ttl,r);r+=4;const o=this.encodeRData(e,t,r+2);t.writeUInt16BE(o,r);r+=2+o;return r-i}getRawData(){const e=c.NonCompressionLabelCoder.INSTANCE;const t=this.getRDataEncodingLength(e);const r=Buffer.allocUnsafe(t);e.initBuf(r);const i=this.encodeRData(e,r,0);(0,n.default)(i===r.length,"Didn't completely write to the buffer! ("+i+"!="+r.length+")");e.initBuf();return r}static clone(e){return e.map((e=>e.clone()))}getRecordRepresentation(){return{name:this.name,type:this.type,class:this.class,ttl:this.ttl,flushFlag:this.flushFlag}}aboutEqual(e){return this.type===e.type&&this.name===e.name&&this.class===e.class&&this.dataEquals(e)}representsSameData(e){return this.type===e.type&&this.name===e.name&&this.class===e.class}asString(){return`RR ${this.name} ${this.type} ${this.class} ${this.dataAsString()}`}static decode(e,t,r,i){const n=i;const a=this.decodeRecordHeader(t,r,i);i+=a.readBytes;const o=a.data;const c=this.typeToRecordDecoder.get(o.type);if(!c){return{readBytes:i+o.rDataLength-n}}t.initRRLocation(n,i,o.rDataLength);const l=r.slice(0,i+o.rDataLength);let d;try{d=c(t,o,l,i)}catch(t){u(`Received malformed rdata section for ${(0,s.dnsTypeToString)(o.type)} ${o.name} ${o.ttl} from ${e.address}:${e.port} with data '${l.slice(i).toString("hex")}': ${t.stack}`);return{readBytes:i+o.rDataLength-n}}i+=d.readBytes;t.clearRRLocation();return{data:d.data,readBytes:i-n}}static decodeRecordHeader(e,t,r){const i=r;const n=e.decodeName(r);r+=n.readBytes;const a=t.readUInt16BE(r);r+=2;const o=t.readUInt16BE(r);r+=2;let s;let c=false;if(a!==41){s=o&this.NOT_FLUSH_MASK;c=!!(o&this.FLUSH_MASK)}else{s=o}const u=t.readUInt32BE(r);r+=4;const l=t.readUInt16BE(r);r+=2;const d={name:n.data,type:a,class:s,ttl:u,flushFlag:c,rDataLength:l};return{data:d,readBytes:r-i}}}t.ResourceRecord=ResourceRecord;ResourceRecord.typeToRecordDecoder=new Map;ResourceRecord.FLUSH_MASK=32768;ResourceRecord.NOT_FLUSH_MASK=32767;ResourceRecord.RR_DEFAULT_TTL_SHORT=120;ResourceRecord.RR_DEFAULT_TTL=4500},4320:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.dnsTypeToString=void 0;function dnsTypeToString(e){switch(e){case 1:return"A";case 5:return"CNAME";case 12:return"PTR";case 16:return"TXT";case 28:return"AAAA";case 33:return"SRV";case 41:return"OPT";case 47:return"NSEC";case 255:return"ANY"}return"UNSUPPORTED_"+e}t.dnsTypeToString=dnsTypeToString},9352:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AAAARecord=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(1808));const o=r(35);const s=r(8297);class AAAARecord extends s.ResourceRecord{constructor(e,t,r,i){if(typeof e==="string"){super(e,28,i||AAAARecord.RR_DEFAULT_TTL_SHORT,r)}else{(0,n.default)(e.type===28);super(e)}(0,n.default)(a.default.isIPv6(t),"IP address is not in v6 format!");this.ipAddress=t}getRDataEncodingLength(){return 16}encodeRData(e,t,r){const i=r;const a=(0,o.enlargeIPv6)(this.ipAddress);const s=a.split(":");(0,n.default)(s.length===8,"invalid ip address");for(const e of s){const i=parseInt(e,16);t.writeUInt16BE(i,r);r+=2}return r-i}static decodeData(e,t,r,i){const n=i;const a=new Array(8);for(let e=0;e<8;e++){const t=r.readUInt16BE(i);i+=2;a[e]=t.toString(16)}const s=(0,o.shortenIPv6)(a.join(":"));return{data:new AAAARecord(t,s),readBytes:i-n}}clone(){return new AAAARecord(this.getRecordRepresentation(),this.ipAddress)}dataAsString(){return this.ipAddress}dataEquals(e){return this.ipAddress===e.ipAddress}}t.AAAARecord=AAAARecord;AAAARecord.DEFAULT_TTL=120},8059:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ARecord=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(1808));const o=r(8297);class ARecord extends o.ResourceRecord{constructor(e,t,r,i){if(typeof e==="string"){super(e,1,i||ARecord.RR_DEFAULT_TTL_SHORT,r)}else{(0,n.default)(e.type===1);super(e)}(0,n.default)(a.default.isIPv4(t),"IP address is not in v4 format!");this.ipAddress=t}getRDataEncodingLength(){return 4}encodeRData(e,t,r){const i=r;const a=this.ipAddress.split(".");(0,n.default)(a.length===4,"invalid ip address");for(const e of a){const i=parseInt(e,10);t.writeUInt8(i,r++)}return r-i}static decodeData(e,t,r,i){const n=i;const a=new Array(4);for(let e=0;e<4;e++){const t=r.readUInt8(i++);a[e]=t.toString(10)}const o=a.join(".");return{data:new ARecord(t,o),readBytes:i-n}}clone(){return new ARecord(this.getRecordRepresentation(),this.ipAddress)}dataAsString(){return this.ipAddress}dataEquals(e){return this.ipAddress===e.ipAddress}}t.ARecord=ARecord;ARecord.DEFAULT_TTL=120},371:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CNAMERecord=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=r(2253);const o=r(8297);class CNAMERecord extends o.ResourceRecord{constructor(e,t,r,i){if(typeof e==="string"){super(e,5,i,r)}else{(0,n.default)(e.type===5);super(e)}if(!t.endsWith(".")){t+="."}this.cname=t}getLowerCasedCName(){return this.lowerCasedCName||(this.lowerCasedCName=(0,a.dnsLowerCase)(this.cname))}getRDataEncodingLength(e){return e.getNameLength(this.cname)}encodeRData(e,t,r){const i=r;const n=e.encodeName(this.cname,r);r+=n;return r-i}static decodeData(e,t,r,i){const n=i;const a=e.decodeName(i);i+=a.readBytes;return{data:new CNAMERecord(t,a.data),readBytes:i-n}}clone(){return new CNAMERecord(this.getRecordRepresentation(),this.cname)}dataAsString(){return this.cname}dataEquals(e){return this.getLowerCasedCName()===e.getLowerCasedCName()}}t.CNAMERecord=CNAMERecord;CNAMERecord.DEFAULT_TTL=o.ResourceRecord.RR_DEFAULT_TTL},5398:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NSECRecord=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(2409));const o=r(2253);const s=r(8297);class NSECRecord extends s.ResourceRecord{constructor(e,t,r,i,a){if(typeof e==="string"){super(e,47,i||NSECRecord.RR_DEFAULT_TTL_SHORT,a)}else{(0,n.default)(e.type===47);super(e)}if(!t.endsWith(".")){t+="."}this.nextDomainName=t;this.rrTypeWindows=NSECRecord.rrTypesToWindowMap(r)}getLowerCasedNextDomainName(){return this.lowerCasedNextDomainName||(this.lowerCasedNextDomainName=(0,o.dnsLowerCase)(this.nextDomainName))}getRRTypesBitMapEncodingLength(){let e=0;for(const t of this.rrTypeWindows){(0,n.default)(t.rrtypes.length>0,"types array for windowId "+t.windowId+" cannot be empty!");e+=2+t.bitMapSize}return e}getRDataEncodingLength(e){return(e.legacyUnicastEncoding?e.getUncompressedNameLength(this.nextDomainName):e.getUncompressedNameLength(this.nextDomainName))+this.getRRTypesBitMapEncodingLength()}encodeRData(e,t,r){const i=r;const n=e.legacyUnicastEncoding?e.encodeUncompressedName(this.nextDomainName,r):e.encodeUncompressedName(this.nextDomainName,r);r+=n;for(const e of this.rrTypeWindows){t.writeUInt8(e.windowId,r++);t.writeUInt8(e.bitMapSize,r++);const i=Buffer.alloc(e.bitMapSize);for(const t of e.rrtypes){const e=(t&255)>>3;let r=i.readUInt8(e);r|=1<<7-(t&7);i.writeUInt8(r,e)}i.copy(t,r);r+=i.length}return r-i}static decodeData(e,t,r,i){const n=i;const a=e.decodeName(i,false);i+=a.readBytes;const o=[];while(i<r.length){const e=r.readUInt8(i++);const t=r.readUInt8(i++);const n=e<<8;for(let e=0;e<t;e++){const t=r.readUInt8(i++);for(let r=0;r<8;r++){if(t&1<<7-r){const t=n|e<<3|r;o.push(t)}}}}return{data:new NSECRecord(t,a.data,o),readBytes:i-n}}clone(){return new NSECRecord(this.getRecordRepresentation(),this.nextDomainName,NSECRecord.windowsToRRTypes(this.rrTypeWindows))}dataAsString(){return`${this.nextDomainName} [${NSECRecord.windowsToRRTypes(this.rrTypeWindows).map((e=>""+e)).join(",")}]`}dataEquals(e){return this.getLowerCasedNextDomainName()===e.getLowerCasedNextDomainName()&&(0,a.default)(this.rrTypeWindows,e.rrTypeWindows)}static rrTypesToWindowMap(e){const t=[];for(const r of e){const e=r>>8;let i=undefined;for(const r of t){if(r.windowId===e){i=r;break}}if(!i){i={windowId:e,bitMapSize:Math.ceil((r&255)/8),rrtypes:[r]};t.push(i)}else{i.rrtypes.push(r);const e=Math.ceil((r&255)/8);if(e>i.bitMapSize){i.bitMapSize=e}}}t.sort(((e,t)=>e.windowId-t.windowId));t.forEach((e=>e.rrtypes.sort(((e,t)=>e-t))));return t}static windowsToRRTypes(e){const t=[];for(const r of e){t.push(...r.rrtypes)}return t}}t.NSECRecord=NSECRecord},8690:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.OPTRecord=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(2409));const o=r(8297);class OPTRecord extends o.ResourceRecord{constructor(e,t,r,i,a,o){if(typeof e==="number"){super(".",41,o,false,e);this.udpPayloadSize=e}else{(0,n.default)(e.type===41);super(e);this.udpPayloadSize=e.class}this.extendedRCode=r||0;this.ednsVersion=a||OPTRecord.EDNS_VERSION;this.flags={dnsSecOK:(i===null||i===void 0?void 0:i.dnsSecOK)||false,zero:(i===null||i===void 0?void 0:i.zero)||0,...i};this.options=t||[]}getRDataEncodingLength(){let e=0;for(const t of this.options){e+=2+2+t.data.length}return e}encodeRData(e,t,r){const i=r;const n=r-8;const a=r-6;t.writeUInt16BE(this.udpPayloadSize,n);t.writeUInt8(this.extendedRCode,a);t.writeUInt8(this.ednsVersion,a+1);let o=this.flags.zero||0;if(this.flags.dnsSecOK){o|=OPTRecord.DNS_SEC_OK_MASK}t.writeUInt16BE(o,a+2);for(const e of this.options){t.writeUInt16BE(e.code,r);r+=2;t.writeUInt16BE(e.data.length,r);r+=2;e.data.copy(t,r);r+=e.data.length}return r-i}static decodeData(e,t,r,i){const n=i;const a=i-8;const o=i-6;const s=r.readUInt16BE(a);const c=r.readUInt8(o);const u=r.readUInt8(o+1);const l=r.readUInt16BE(o+2);const d={dnsSecOK:!!(l&OPTRecord.DNS_SEC_OK_MASK),zero:l&OPTRecord.NOT_DNS_SEC_OK_MASK};const h=[];while(i<r.length){const e=r.readUInt16BE(i);i+=2;const t=r.readUInt16BE(i);i+=2;const n=r.slice(i,i+t);i+=t;h.push({code:e,data:n})}t.class=s;t.ttl=4500;return{data:new OPTRecord(t,h,c,d,u),readBytes:i-n}}clone(){return new OPTRecord(this.getRecordRepresentation(),this.options,this.extendedRCode,this.flags,this.ednsVersion)}dataAsString(){return`${this.udpPayloadSize} ${this.extendedRCode} ${this.ednsVersion} ${JSON.stringify(this.flags)} [${this.options.map((e=>`${e.code} ${e.data.toString("base64")}`)).join(",")}]`}dataEquals(e){return this.udpPayloadSize===e.udpPayloadSize&&this.extendedRCode===e.extendedRCode&&this.ednsVersion===e.ednsVersion&&OPTRecord.optionsEquality(this.options,e.options)&&(0,a.default)(this.flags,e.flags)}static optionsEquality(e,t){if(e.length!==t.length){return false}for(let r=0;r<e.length;r++){if(e[r].code!==t[r].code){return false}else if(e[r].data.toString("hex")!==t[r].data.toString("hex")){return false}}return true}}t.OPTRecord=OPTRecord;OPTRecord.EDNS_VERSION=0;OPTRecord.DNS_SEC_OK_MASK=32768;OPTRecord.NOT_DNS_SEC_OK_MASK=32767},1425:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PTRRecord=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=r(2253);const o=r(8297);class PTRRecord extends o.ResourceRecord{constructor(e,t,r,i){if(typeof e==="string"){super(e,12,i,r)}else{(0,n.default)(e.type===12);super(e)}if(!t.endsWith(".")){t+="."}this.ptrName=t}getLowerCasedPTRName(){return this.lowerCasedPtrName||(this.lowerCasedPtrName=(0,a.dnsLowerCase)(this.ptrName))}getRDataEncodingLength(e){return e.getNameLength(this.ptrName)}encodeRData(e,t,r){const i=r;const n=e.encodeName(this.ptrName,r);r+=n;return r-i}static decodeData(e,t,r,i){const n=i;const a=e.decodeName(i);i+=a.readBytes;return{data:new PTRRecord(t,a.data),readBytes:i-n}}clone(){return new PTRRecord(this.getRecordRepresentation(),this.ptrName)}dataAsString(){return this.ptrName}dataEquals(e){return this.getLowerCasedPTRName()===e.getLowerCasedPTRName()}}t.PTRRecord=PTRRecord;PTRRecord.DEFAULT_TTL=o.ResourceRecord.RR_DEFAULT_TTL},6366:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SRVRecord=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=r(2253);const o=r(8297);class SRVRecord extends o.ResourceRecord{constructor(e,t,r,i,a){if(typeof e==="string"){super(e,33,a||SRVRecord.RR_DEFAULT_TTL_SHORT,i)}else{(0,n.default)(e.type===33);super(e)}if(!t.endsWith(".")){this.hostname=t+"."}else{this.hostname=t}this.port=r;this.priority=0;this.weight=0}getLowerCasedHostname(){return this.lowerCasedHostname||(this.lowerCasedHostname=(0,a.dnsLowerCase)(this.hostname))}getRDataEncodingLength(e){return 6+(e.legacyUnicastEncoding?e.getUncompressedNameLength(this.hostname):e.getNameLength(this.hostname))}encodeRData(e,t,r){const i=r;t.writeUInt16BE(this.priority,r);r+=2;t.writeUInt16BE(this.weight,r);r+=2;t.writeUInt16BE(this.port,r);r+=2;const n=e.legacyUnicastEncoding?e.encodeUncompressedName(this.hostname,r):e.encodeName(this.hostname,r);r+=n;return r-i}static decodeData(e,t,r,i){const n=i;i+=2;i+=2;const a=r.readUInt16BE(i);i+=2;const o=e.decodeName(i);i+=o.readBytes;return{data:new SRVRecord(t,o.data,a),readBytes:i-n}}clone(){return new SRVRecord(this.getRecordRepresentation(),this.hostname,this.port)}dataAsString(){return`${this.hostname} ${this.port} ${this.priority} ${this.weight}`}dataEquals(e){return this.getLowerCasedHostname()===e.getLowerCasedHostname()&&this.port===e.port&&this.weight===e.weight&&this.priority===e.priority}}t.SRVRecord=SRVRecord;SRVRecord.DEFAULT_TTL=120},6130:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TXTRecord=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=r(8297);class TXTRecord extends a.ResourceRecord{constructor(e,t,r,i){if(typeof e==="string"){super(e,16,i,r)}else{(0,n.default)(e.type===16);super(e)}this.txt=t}getRDataEncodingLength(){let e=0;for(const t of this.txt){e+=1+t.length;(0,n.default)(t.length<=255,"One txt character-string can only have a length of 255 chars")}return e}encodeRData(e,t,r){const i=r;for(const e of this.txt){t.writeUInt8(e.length,r++);e.copy(t,r);r+=e.length}return r-i}clone(){return new TXTRecord(this.getRecordRepresentation(),this.txt)}dataAsString(){return`[${this.txt.map((e=>`${e.toString("base64")}`)).join(",")}]`}dataEquals(e){if(this.txt.length!==e.txt.length){return false}for(let t=0;t<this.txt.length;t++){if(this.txt[t].toString("hex")!==e.txt[t].toString("hex")){return false}}return true}static decodeData(e,t,r,i){const n=i;const a=[];while(i<r.length){const e=r.readUInt8(i++);a.push(r.slice(i,i+e));i+=e}return{data:new TXTRecord(t,a),readBytes:i-n}}}t.TXTRecord=TXTRecord;TXTRecord.DEFAULT_TTL=a.ResourceRecord.RR_DEFAULT_TTL},3879:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const i=r(8297);const n=r(9352);const a=r(8059);const o=r(371);const s=r(5398);const c=r(8690);const u=r(1425);const l=r(6366);const d=r(6130);i.ResourceRecord.typeToRecordDecoder.set(28,n.AAAARecord.decodeData);i.ResourceRecord.typeToRecordDecoder.set(1,a.ARecord.decodeData);i.ResourceRecord.typeToRecordDecoder.set(5,o.CNAMERecord.decodeData);i.ResourceRecord.typeToRecordDecoder.set(47,s.NSECRecord.decodeData);i.ResourceRecord.typeToRecordDecoder.set(12,u.PTRRecord.decodeData);i.ResourceRecord.typeToRecordDecoder.set(33,l.SRVRecord.decodeData);i.ResourceRecord.typeToRecordDecoder.set(41,c.OPTRecord.decodeData);i.ResourceRecord.typeToRecordDecoder.set(16,d.TXTRecord.decodeData)},3285:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getResponder=t.Protocol=void 0;const i=r(6867);r(5957);const n=(0,i.__importDefault)(r(7031));const a=r(1663).i8;if(a.includes("beta")||process.env.BCT){const e=process.env.DEBUG;if(!e||!e.includes("ciao")){if(!e){n.default.enable("ciao:*")}else{n.default.enable(e+",ciao:*")}}}r(3879);const o=r(6657);(0,i.__exportStar)(r(9085),t);(0,i.__exportStar)(r(6657),t);function printInitInfo(){const e=(0,n.default)("ciao:init");e("Loading ciao v"+a+"...")}printInitInfo();var s;(function(e){e["TCP"]="tcp";e["UDP"]="udp"})(s=t.Protocol||(t.Protocol={}));function getResponder(e){return o.Responder.getResponder(e)}t.getResponder=getResponder;t["default"]={getResponder:getResponder}},9042:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Announcer=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(7031));const o=r(1234);const s=r(633);const c=r(8064);const u=(0,a.default)("ciao:Announcer");class Announcer{constructor(e,t,r){this.repetitions=1;this.announceIntervalIncreaseFactor=2;this.goodbye=false;this.sentAnnouncements=0;this.sentLastAnnouncement=false;this.nextInterval=1e3;this.nextAnnouncementTime=0;(0,n.default)(e,"server must be defined");(0,n.default)(t,"service must be defined");this.server=e;this.service=t;if(r){if(r.repetitions!==undefined){this.repetitions=r.repetitions}if(r.goodbye){this.goodbye=true}}(0,n.default)(this.repetitions>0&&this.repetitions<=8,"repetitions must in [1;8]")}announce(){u("[%s] Sending %s for service",this.service.getFQDN(),this.goodbye?"goodbye":"announcement");if(!this.goodbye){this.service.rebuildServiceRecords()}return this.promise=new Promise(((e,t)=>{this.promiseResolve=e;this.promiseReject=t;this.timer=setTimeout(this.sendAnnouncement.bind(this),0);this.timer.unref();this.nextAnnouncementTime=(new Date).getTime()}))}async cancel(){u("[%s] Canceling %s",this.service.getFQDN(),this.goodbye?"goodbye":"announcement");if(this.timer){clearTimeout(this.timer);this.timer=undefined}this.promiseReject(Announcer.CANCEL_REASON);return this.awaitAnnouncement().catch((e=>{if(e!==Announcer.CANCEL_REASON){return Promise.reject(e)}}))}hasSentLastAnnouncement(){return this.sentLastAnnouncement}async awaitAnnouncement(){await this.promise}isSendingGoodbye(){return this.goodbye}sendAnnouncement(){u("[%s] Sending %s number %d",this.service.getFQDN(),this.goodbye?"goodbye":"announcement",this.sentAnnouncements+1);const e=[this.service.ptrRecord(),...this.service.subtypePtrRecords(),this.service.srvRecord(),this.service.txtRecord()];if(this.goodbye){for(const t of e){t.ttl=0}}else{e.push(this.service.metaQueryPtrRecord())}if(this.sentAnnouncements+1>=this.repetitions){this.sentLastAnnouncement=true}Announcer.sendResponseAddingAddressRecords(this.server,this.service,e,this.goodbye).then((e=>{const t=(0,s.SendResultFailedRatio)(e);if(t===1){console.error((0,s.SendResultFormatError)(e,`[${this.service.getFQDN()}] Failed to send ${this.goodbye?"goodbye":"announcement"} requests`),true);this.promiseReject(new Error(`${this.goodbye?"Goodbye":"Announcement"} failed as of socket errors!`));return}if(t>0){u((0,s.SendResultFormatError)(e,`Some of the ${this.goodbye?"goodbye":"announcement"} requests for '${this.service.getFQDN()}' encountered an error`))}if(this.service.serviceState!=="announcing"){u("[%s] Service is no longer in announcing state. Stopping. (Received %s)",this.service.getFQDN(),this.service.serviceState);return}this.sentAnnouncements++;if(this.sentAnnouncements>=this.repetitions){this.promiseResolve()}else{this.timer=setTimeout(this.sendAnnouncement.bind(this),this.nextInterval);this.timer.unref();this.nextAnnouncementTime=(new Date).getTime()+this.nextInterval;this.nextInterval*=this.announceIntervalIncreaseFactor}}))}static sendResponseAddingAddressRecords(e,t,r,i){const n=[];for(const a of e.getBoundInterfaceNames()){if(!t.advertisesOnInterface(a)){continue}const u=r.concat([]);const l=t.aRecord(a);const d=t.aaaaRecord(a);const h=t.aaaaRoutableRecord(a);const p=t.aaaaUniqueLocalRecord(a);const v=t.addressNSECRecord();const m=t.serviceNSECRecord();if(l){if(i){l.ttl=0}u.push(l)}if(d){if(i){d.ttl=0}u.push(d)}if(h){if(i){h.ttl=0}u.push(h)}if(p){if(i){p.ttl=0}u.push(p)}if(i){v.ttl=0;m.ttl=0}const g=[];g.push(v,m);const y=o.DNSPacket.createDNSResponsePacketsFromRRSet({answers:u,additionals:g});n.push(Promise.race([e.send(y,a),(0,c.PromiseTimeout)(s.MDNSServer.SEND_TIMEOUT).then((()=>({status:"timeout",interface:a})))]))}return Promise.all(n)}}t.Announcer=Announcer;Announcer.CANCEL_REASON="CIAO ANNOUNCEMENT CANCELLED"},5331:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Prober=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(7031));const o=r(3802);const s=r(633);const c=(0,i.__importStar)(r(7498));const u=r(7498);const l=250;const d=1e3;const h=(0,a.default)("ciao:Prober");class Prober{constructor(e,t,r){this.records=[];this.currentInterval=l;this.serviceEncounteredNameChange=false;this.sentFirstProbeQuery=false;this.sentQueriesForCurrentTry=0;this.sentQueries=0;(0,n.default)(e,"responder must be defined");(0,n.default)(t,"server must be defined");(0,n.default)(r,"service must be defined");this.responder=e;this.server=t;this.service=r}getService(){return this.service}probe(){h("Starting to probe for '%s'...",this.service.getFQDN());return new Promise(((e,t)=>{this.promiseResolve=e;this.promiseReject=t;this.timer=setTimeout(this.sendProbeRequest.bind(this),Math.random()*l);this.timer.unref()}))}cancel(){this.clear();this.promiseReject(Prober.CANCEL_REASON)}clear(){if(this.timer){clearTimeout(this.timer);this.timer=undefined}this.sentFirstProbeQuery=false;this.sentQueriesForCurrentTry=0}endProbing(e){this.clear();if(e){h("Probing for '%s' finished successfully",this.service.getFQDN());this.promiseResolve();if(this.serviceEncounteredNameChange){this.service.informAboutNameUpdates()}}}sendProbeRequest(){if(this.sentQueriesForCurrentTry===0){this.records=[this.service.srvRecord(),this.service.txtRecord(),this.service.ptrRecord(),...this.service.subtypePtrRecords(),...this.service.allAddressRecords()].sort(u.rrComparator);this.records.forEach((e=>e.flushFlag=false))}if(this.sentQueriesForCurrentTry>=3){this.endProbing(true);return}if(this.sentQueries>=15){this.currentInterval=d}h("Sending prober query number %d for '%s'...",this.sentQueriesForCurrentTry+1,this.service.getFQDN());(0,n.default)(this.records.length>0,"Tried sending probing request for zero record length!");const e=[new o.Question(this.service.getFQDN(),255,true),new o.Question(this.service.getHostname(),255,true)];this.server.sendQueryBroadcast({questions:e,authorities:this.records},this.service).then((e=>{const t=(0,s.SendResultFailedRatio)(e);if(t===1){console.error((0,s.SendResultFormatError)(e,`Failed to send probe queries for '${this.service.getFQDN()}'`),true);this.endProbing(false);this.promiseReject(new Error("Probing failed as of socket errors!"));return}if(t>0){h((0,s.SendResultFormatError)(e,`Some of the probe queries for '${this.service.getFQDN()}' encountered an error`))}if(this.service.serviceState!=="probing"){h("Service '%s' is no longer in probing state. Stopping.",this.service.getFQDN());return}this.sentFirstProbeQuery=true;this.sentQueriesForCurrentTry++;this.sentQueries++;this.timer=setTimeout(this.sendProbeRequest.bind(this),this.currentInterval);this.timer.unref();this.checkLocalConflicts()}))}checkLocalConflicts(){let e=false;for(const t of this.responder.getAnnouncedServices()){if(t.getLowerCasedFQDN()===this.service.getLowerCasedFQDN()||t.getLowerCasedHostname()===this.service.getLowerCasedHostname()){e=true;break}}if(e){h("Probing for '%s' failed as of local service. Doing a name change",this.service.getFQDN());this.handleNameChange()}}handleResponse(e,t){if(!this.sentFirstProbeQuery||!this.service.advertisesOnInterface(t.interface)){return}let r=false;for(const t of e.answers.values()){if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=true;break}}for(const t of e.additionals.values()){if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=true;break}}if(r){h("Probing for '%s' failed. Doing a name change",this.service.getFQDN());this.handleNameChange()}}handleNameChange(){this.endProbing(false);this.service.serviceState="unannounced";this.service.incrementName();this.service.serviceState="probing";this.serviceEncounteredNameChange=true;this.timer=setTimeout(this.sendProbeRequest.bind(this),1e3);this.timer.unref()}handleQuery(e,t){if(!this.sentFirstProbeQuery||!this.service.advertisesOnInterface(t.interface)){return}let r=false;for(const t of e.questions.values()){if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=true;break}}if(r){this.doTiebreaking(e)}}doTiebreaking(e){if(!this.sentFirstProbeQuery){return}let t=e.authorities.size===0;for(const r of e.authorities.values()){if(r.getLowerCasedName()===this.service.getLowerCasedFQDN()||r.getLowerCasedName()===this.service.getLowerCasedHostname()){t=true;break}}if(!t){return}const r=this.records;const i=Array.from(e.authorities.values()).sort(c.rrComparator);const n=c.runTiebreaking(r,i);if(n===1){h("'%s' won the tiebreak. We gonna ignore the other probing request!",this.service.getFQDN())}else if(n===-1){h("'%s' lost the tiebreak. We are waiting a second and try to probe again...",this.service.getFQDN());this.endProbing(false);this.timer=setTimeout(this.sendProbeRequest.bind(this),1e3);this.timer.unref()}else{}}}t.Prober=Prober;Prober.CANCEL_REASON="CIAO PROBING CANCELLED"},7053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryResponse=void 0;const i=r(1234);class QueryResponse{constructor(e){this.sharedAnswer=false;this.dnsPacket=new i.DNSPacket({type:1});this.knownAnswers=e}asPacket(){return this.dnsPacket}asString(e){return this.dnsPacket.asLoggingString(e)}containsSharedAnswer(){return this.sharedAnswer}addAnswer(...e){let t=false;for(const r of e){if(this.isKnownAnswer(r)){continue}const e=this.dnsPacket.addAnswers(r);if(e){t=true;if(!r.flushFlag){this.sharedAnswer=true}}}return t}addAdditional(...e){let t=false;for(const r of e){if(this.isKnownAnswer(r)){continue}if(this.dnsPacket.answers.has(r.asString())){continue}const e=this.dnsPacket.addAdditionals(r);if(e){t=true}}return t}markLegacyUnicastResponse(e,t){this.dnsPacket.id=e;if(t){this.dnsPacket.addQuestions(...t)}this.dnsPacket.answers.forEach((e=>{e.flushFlag=false;e.ttl=10}));this.dnsPacket.additionals.forEach((e=>{e.flushFlag=false;e.ttl=10}));this.dnsPacket.setLegacyUnicastEncoding(true)}markTruncated(){this.dnsPacket.flags.truncation=true}hasAnswers(){return this.dnsPacket.answers.size>0}isKnownAnswer(e){if(!this.knownAnswers){return false}const t=this.knownAnswers.get(e.asString());return t!==undefined&&t.ttl>e.ttl/2}static combineResponses(e,t){for(let r=0;r<e.length-1;r++){const i=e[r];const n=i.dnsPacket;const a=e[r+1];const o=a.dnsPacket;if(n.canBeCombinedWith(o,t)){n.combineWith(o);e.splice(r+1,1);i.sharedAnswer=i.sharedAnswer||a.sharedAnswer;r--}}}}t.QueryResponse=QueryResponse},7340:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueuedResponse=void 0;class QueuedResponse{constructor(e,t){this.timeOfCreation=(new Date).getTime();this.estimatedTimeToBeSent=0;this.delay=-1;this.packet=e;this.interfaceName=t}getPacket(){return this.packet}getTimeSinceCreation(){return(new Date).getTime()-this.timeOfCreation}getTimeTillSent(){return Math.max(0,this.estimatedTimeToBeSent-(new Date).getTime())}calculateRandomDelay(){this.delay=Math.random()*100+20;this.estimatedTimeToBeSent=(new Date).getTime()+this.delay}scheduleResponse(e){this.timer=setTimeout(e,this.delay);this.timer.unref()}delayWouldBeInTimelyManner(e){const t=e.estimatedTimeToBeSent-this.timeOfCreation;return t<=QueuedResponse.MAX_DELAY}combineWithNextPacketIfPossible(e){if(this.interfaceName!==e.interfaceName){return false}if(!e.packet.canBeCombinedWith(this.packet)){return false}e.packet.combineWith(this.packet);e.timeOfCreation=Math.min(this.timeOfCreation,e.timeOfCreation);if(this.timer){clearTimeout(this.timer);this.timer=undefined}this.delayed=true;return true}combineWithUniqueResponseIfPossible(e,t){if(this.interfaceName!==t){return false}if(!this.packet.canBeCombinedWith(e.asPacket())){return false}this.packet.combineWith(e.asPacket());return true}}t.QueuedResponse=QueuedResponse;QueuedResponse.MAX_DELAY=500},2305:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TruncatedQuery=t.TruncatedQueryEvent=t.TruncatedQueryResult=void 0;const i=r(2361);var n;(function(e){e[e["ABORT"]=1]="ABORT";e[e["AGAIN_TRUNCATED"]=2]="AGAIN_TRUNCATED";e[e["FINISHED"]=3]="FINISHED"})(n=t.TruncatedQueryResult||(t.TruncatedQueryResult={}));var a;(function(e){e["TIMEOUT"]="timeout"})(a=t.TruncatedQueryEvent||(t.TruncatedQueryEvent={}));class TruncatedQuery extends i.EventEmitter{constructor(e){super();this.arrivedPackets=1;this.timeOfArrival=(new Date).getTime();this.packet=e;this.timer=this.resetTimer()}getPacket(){return this.packet}getArrivedPacketCount(){return this.arrivedPackets}getTotalWaitTime(){return(new Date).getTime()-this.timeOfArrival}appendDNSPacket(e){this.packet.combineWith(e);this.arrivedPackets++;if(e.flags.truncation){const e=(new Date).getTime();if(e-this.timeOfArrival>5*1e3){return 1}this.resetTimer();return 2}else{clearTimeout(this.timer);this.removeAllListeners();return 3}}resetTimer(){if(this.timer){clearTimeout(this.timer)}return this.timer=setTimeout(this.timeout.bind(this),400+Math.random()*100)}timeout(){this.emit("timeout");this.removeAllListeners()}}t.TruncatedQuery=TruncatedQuery},2253:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.dnsLowerCase=void 0;const r=/[A-Z]/g;function dnsLowerCase(e){return e.replace(r,(e=>e.toLowerCase()))}t.dnsLowerCase=dnsLowerCase},35:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getNetAddress=t.ipAddressFromReversAddressName=t.formatReverseAddressPTRName=t.shortenIPv6=t.enlargeIPv6=t.removeTLD=t.formatHostname=t.stringify=t.parseFQDN=void 0;const i=r(6867);const n=(0,i.__importDefault)(r(9491));const a=(0,i.__importDefault)(r(1808));function isProtocol(e){return e==="_"+"tcp"||e==="_"+"udp"}function isSub(e){return e==="_sub"}function removePrefixedUnderscore(e){return e.startsWith("_")?e.slice(1):e}function isSubTypePTRParts(e){return"subtype"in e}function parseFQDN(e){const t=e.split(".");(0,n.default)(t.length>=3,"Received illegal fqdn: "+e);let r=t.length-1;let i="";while(!isProtocol(t[r])){i=removePrefixedUnderscore(t[r])+(i?"."+i:"");r--}(0,n.default)(r>=1,"Failed to parse illegal fqdn: "+e);const a=removePrefixedUnderscore(t[r--]);const o=removePrefixedUnderscore(t[r--]);if(r<0){return{domain:i,protocol:a,type:o}}else if(isSub(t[r])){r--;(0,n.default)(r===0,"Received illegal formatted sub type fqdn: "+e);const s=removePrefixedUnderscore(t[r]);return{domain:i,protocol:a,type:o,subtype:s}}else{const e=removePrefixedUnderscore(t.slice(0,r+1).join("."));return{domain:i,protocol:a,type:o,name:e}}}t.parseFQDN=parseFQDN;function stringify(e){(0,n.default)(e.type,"type cannot be undefined");(0,n.default)(e.type.length<=15,"type must not be longer than 15 characters");let t;if(isSubTypePTRParts(e)){t=`_${e.subtype}._sub.`}else{t=e.name?`${e.name}.`:""}return`${t}_${e.type}._${e.protocol||"tcp"}.${e.domain||"local"}.`}t.stringify=stringify;function formatHostname(e,t="local"){(0,n.default)(!e.endsWith("."),"hostname must not end with the root label!");const r="."+t;return(!e.endsWith(r)?e+r:e)+"."}t.formatHostname=formatHostname;function removeTLD(e){if(e.endsWith(".")){e=e.substring(0,e.length-1)}const t=e.lastIndexOf(".");return e.slice(0,t)}t.removeTLD=removeTLD;function enlargeIPv6(e){(0,n.default)(a.default.isIPv6(e),"Illegal argument. Must be ipv6 address!");(0,n.default)(!e.includes("."),"ipv4-mapped ipv6 addresses are currently unsupported!");const t=e.split(":");if(t[0]===""){t.splice(0,1);while(t.length<8){t.unshift("0000")}}else if(t[t.length-1]===""){t.splice(t.length-1,1);while(t.length<8){t.push("0000")}}else if(t.length<8){let e;for(e=0;e<t.length;e++){if(t[e]===""){break}}const r=new Array(9-t.length).fill("0000");t.splice(e,1,...r)}for(let e=0;e<t.length;e++){const r=t[e];if(r.length<4){const i=new Array(4-r.length).fill("0").join("");t.splice(e,1,i+r)}}const r=t.join(":");(0,n.default)(t.length<=8,`Resulting ipv6 address has more than 8 sections (${r})!`);return r}t.enlargeIPv6=enlargeIPv6;function shortenIPv6(e){if(typeof e==="string"){e=e.split(":")}for(let t=0;t<e.length;t++){const r=e[t];let i=0;for(;i<Math.min(3,r.length-1);i++){if(r.charAt(i)!=="0"){break}}e[t]=r.substr(i)}let t=-1;let r=0;for(let i=0;i<e.length;i++){if(e[i]!=="0"){continue}let n=1;let a=i+1;for(;a<e.length;a++){if(e[a]==="0"){n++}else{break}}if(n>r){t=i;r=n}i=a}if(t!==-1){const i=t===0||t+r===8;e[t]=i?":":"";if(r>1){e.splice(t+1,r-1)}}const i=e.join(":");if(i===":"){return"::"}return i}t.shortenIPv6=shortenIPv6;function formatReverseAddressPTRName(e){if(a.default.isIPv4(e)){const t=e.split(".").reverse();return t.join(".")+".in-addr.arpa"}else if(a.default.isIPv6(e)){e=enlargeIPv6(e).toUpperCase();const t=e.replace(/:/g,"").split("").reverse();(0,n.default)(t.length===32,"Encountered invalid ipv6 address length! "+t.length);return t.join(".")+".ip6.arpa"}else{throw new Error("Supplied illegal ip address format: "+e)}}t.formatReverseAddressPTRName=formatReverseAddressPTRName;function ipAddressFromReversAddressName(e){e=e.toLowerCase();if(e.endsWith(".in-addr.arpa")){const t=e.replace(".in-addr.arpa","").split(".").reverse();return t.join(".")}else if(e.endsWith(".ip6.arpa")){const t=e.replace(".ip6.arpa","").split(".").reverse();(0,n.default)(t.length===32,"Encountered illegal length for .ip6.arpa split!");const r=[];for(let e=0;e<t.length;e+=4){r.push(t.slice(e,e+4).join(""))}return shortenIPv6(r.join(":"))}else{throw new Error("Supplied unknown reverse address name format: "+e)}}t.ipAddressFromReversAddressName=ipAddressFromReversAddressName;function getNetAddress(e,t){(0,n.default)(a.default.isIP(e)===a.default.isIP(t),"IP address version must match. Netmask cannot have a version different from the address!");if(a.default.isIPv4(e)){const r=e.split(".");const i=t.split(".");const n=new Array(4);for(let e=0;e<r.length;e++){const t=parseInt(r[e]);const a=parseInt(i[e]);n[e]=(t&a).toString()}return n.join(".")}else if(a.default.isIPv6(e)){const r=enlargeIPv6(e).split(":");const i=enlargeIPv6(t).split(":");const n=new Array(8);for(let e=0;e<r.length;e++){const t=parseInt(r[e],16);const a=parseInt(i[e],16);n[e]=(t&a).toString(16)}return shortenIPv6(enlargeIPv6(n.join(":")))}else{throw new Error("Illegal argument. Address is not an ip address!")}}t.getNetAddress=getNetAddress},7645:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ServerClosedError=t.InterfaceNotFoundError=t.ERR_SERVER_CLOSED=t.ERR_INTERFACE_NOT_FOUND=void 0;t.ERR_INTERFACE_NOT_FOUND="ERR_INTERFACE_NOT_FOUND";t.ERR_SERVER_CLOSED="ERR_SERVER_CLOSED";class InterfaceNotFoundError extends Error{constructor(e){super(e);this.name="ERR_INTERFACE_NOT_FOUND"}}t.InterfaceNotFoundError=InterfaceNotFoundError;class ServerClosedError extends Error{constructor(e){super(e);this.name=t.ERR_SERVER_CLOSED}}t.ServerClosedError=ServerClosedError},8064:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PromiseTimeout=void 0;function PromiseTimeout(e){return new Promise((t=>{setTimeout((()=>t()),e)}))}t.PromiseTimeout=PromiseTimeout},930:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.sortedInsert=void 0;function sortedInsert(e,t,r){let i=0;let n=e.length-1;let a=-1;while(i<n){const o=Math.floor((i+n)/2);const s=r(t,e[o]);if(s===0){a=o+1;break}if(s<0){n=o-1}else{i=o+1}}if(e.length===0){a=0}else if(a<0){if(r(t,e[i])>0){a=i+1}else{a=i}}e.splice(a,0,t)}t.sortedInsert=sortedInsert},7498:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.runTiebreaking=t.TiebreakingResult=t.rrComparator=void 0;function rrComparator(e,t){if(e.class!==t.class){return e.class-t.class}if(e.type!==t.type){return e.type-t.type}const r=e.getRawData();const i=t.getRawData();const n=Math.max(r.length,i.length);for(let e=0;e<n;e++){if(e>=r.length&&e<i.length){return-1}else if(e>=i.length&&e<r.length){return 1}const t=r.readUInt8(e);const n=i.readUInt8(e);if(t!==n){return t<n?-1:1}}return 0}t.rrComparator=rrComparator;var r;(function(e){e[e["OPPONENT"]=-1]="OPPONENT";e[e["TIE"]=0]="TIE";e[e["HOST"]=1]="HOST"})(r=t.TiebreakingResult||(t.TiebreakingResult={}));function runTiebreaking(e,t){const r=Math.max(e.length,t.length);for(let i=0;i<r;i++){if(i>=e.length&&i<t.length){return-1}else if(i>=t.length&&i<e.length){return 1}const r=rrComparator(e[i],t[i]);if(r!==0){return r}}return 0}t.runTiebreaking=runTiebreaking},7933:(e,t,r)=>{const i=r(2361).EventEmitter;const n=r(1808);const a=r(756);const o=r(8408);const s=r(9634);const c=r(1651);const u=r(3188);const l=r(5980);function createStream(e){if(e.stream)return e.stream;var t=e.host;var i=e.port;var a=e.socket;if(a)return n.createConnection(a);if(i)return n.createConnection(i,t);var o=e.busAddress||process.env.DBUS_SESSION_BUS_ADDRESS;if(!o)throw new Error("unknown bus address");var s=o.split(";");for(var c=0;c<s.length;++c){var u=s[c];var l=u.split(":");var d=l[0];var h={};l[1].split(",").map((function(e){var t=e.split("=");h[t[0]]=t[1]}));try{switch(d.toLowerCase()){case"tcp":t=h.host||"localhost";i=h.port;return n.createConnection(i,t);case"unix":if(h.socket)return n.createConnection(h.socket);if(h.abstract){var p=r(9958);return p.connect("\0"+h.abstract)}if(h.path)return n.createConnection(h.path);throw new Error("not enough parameters for 'unix' connection - you need to specify 'socket' or 'abstract' or 'path' parameter");case"unixexec":var v=r(781);var m=r(2081).spawn;var g=[];for(var y=1;h["arg"+y];y++)g.push(h["arg"+y]);var C=m(h.path,g);return v.duplex(C.stdin,C.stdout);default:throw new Error("unknown address type:"+d)}}catch(e){if(c<s.length-1){console.warn(e.message);continue}else{throw e}}}}function createConnection(e){var t=new i;if(!e)e={};var r=t.stream=createStream(e);r.setNoDelay();r.on("error",(function(e){t.emit("error",e)}));r.on("end",(function(){t.emit("end");t.message=function(){console.warn("Didn't write bytes to closed stream")}}));t.end=function(){r.end();return t};var n=e.server?c:s;n(r,e,(function(i,n){if(i){return t.emit("error",i)}t.guid=n;t.emit("connect");o.unmarshalMessages(r,(function(e){t.emit("message",e)}),e)}));t._messages=[];t.message=function(e){t._messages.push(e)};t.once("connect",(function(){t.state="connected";for(var e=0;e<t._messages.length;++e){r.write(o.marshall(t._messages[e]))}t._messages.length=0;t.message=function(e){r.write(o.marshall(e))}}));return t}e.exports.createClient=function(e){var t=createConnection(e||{});return new u(t,e||{})};e.exports.systemBus=function(){return e.exports.createClient({busAddress:process.env.DBUS_SYSTEM_BUS_ADDRESS||"unix:path=/var/run/dbus/system_bus_socket"})};e.exports.sessionBus=function(t){return e.exports.createClient(t)};e.exports.messageType=a.messageType;e.exports.createConnection=createConnection;e.exports.createServer=l.createServer},1542:(e,t,r)=>{const i=r(1954).Buffer;function align(e,t){var r=t-e._offset%t;if(r===0||r===t)return;var n=i.alloc(r);e.put(i.from(n));e._offset+=r}t.A=align},3188:(e,t,r)=>{const i=r(2361).EventEmitter;const n=r(756);const a=r(3207);const o=r(9586).introspectBus;e.exports=function bus(e,t){if(!(this instanceof bus)){return new bus(e)}if(!t)t={};var r=this;this.connection=e;this.serial=1;this.cookies={};this.methodCallHandlers={};this.signals=new i;this.exportedObjects={};this.invoke=function(e,t){if(!e.type)e.type=n.messageType.methodCall;e.serial=r.serial++;this.cookies[e.serial]=t;r.connection.message(e)};this.invokeDbus=function(e,t){if(!e.path)e.path="/org/freedesktop/DBus";if(!e.destination)e.destination="org.freedesktop.DBus";if(!e["interface"])e["interface"]="org.freedesktop.DBus";r.invoke(e,t)};this.mangle=function(e,t,r){var i={};if(typeof e==="object"){i.path=e.path;i["interface"]=e["interface"];i.member=e.member}else{i.path=e;i["interface"]=t;i.member=r}return JSON.stringify(i)};this.sendSignal=function(e,t,i,a,o){var s={type:n.messageType.signal,serial:r.serial++,interface:t,path:e,member:i};if(a){s.signature=a;s.body=o}r.connection.message(s)};this.sendError=function(e,t,i){var a={type:n.messageType.error,serial:r.serial++,replySerial:e.serial,destination:e.sender,errorName:t,signature:"s",body:[i]};this.connection.message(a)};this.sendReply=function(e,t,i){var a={type:n.messageType.methodReturn,serial:r.serial++,replySerial:e.serial,destination:e.sender,signature:t,body:i};this.connection.message(a)};this.connection.on("message",(function(e){function invoke(t,i,a){Promise.resolve().then((function(){return i.apply(t,(e.body||[]).concat(e))})).then((function(t){var i={type:n.messageType.methodReturn,serial:r.serial++,destination:e.sender,replySerial:e.serial};if(t!==null){i.signature=a;i.body=[t]}r.connection.message(i)}),(function(t){r.sendError(e,t.dbusName||"org.freedesktop.DBus.Error.Failed",t.message||"")}))}var t;if(e.type===n.messageType.methodReturn||e.type===n.messageType.error){t=r.cookies[e.replySerial];if(t){delete r.cookies[e.replySerial];var i={connection:r.connection,bus:r,message:e,signature:e.signature};var o=e.body||[];if(e.type===n.messageType.methodReturn){o=[null].concat(o);t.apply(i,o)}else{t.call(i,{name:e.errorName,message:o})}}}else if(e.type===n.messageType.signal){r.signals.emit(r.mangle(e),e.body,e.signature)}else{if(a(e,r))return;var s,c,u;if(s=r.exportedObjects[e.path]){if(c=s[e["interface"]]){u=c[1];var l=u[e.member];if(!l){r.sendError(e,"org.freedesktop.DBus.Error.UnknownMethod",`Method "${e.member}" on interface "${e.interface}" doesn't exist`);return}var d=c[0].methods[e.member][1];invoke(u,l,d);return}else{console.error(`Interface ${e["interface"]} is not supported`)}}t=r.methodCallHandlers[r.mangle(e)];if(t){invoke(null,t[0],t[1])}else{r.sendError(e,"org.freedesktop.DBus.Error.UnknownService","Uh oh oh")}}}));this.setMethodCallHandler=function(e,t,i,n){var a=r.mangle(e,t,i);r.methodCallHandlers[a]=n};this.exportInterface=function(e,t,i){var a;if(!r.exportedObjects[t]){a=r.exportedObjects[t]={}}else{a=r.exportedObjects[t]}a[i.name]=[i,e];if(typeof e.emit==="function"){var o=e.emit;e.emit=function(){var a=Array.prototype.slice.apply(arguments);var s=a[0];if(!s)throw new Error("Trying to emit undefined signa");var c;if(i.signals&&i.signals[s]){c=i.signals[s];var u={type:n.messageType.signal,serial:r.serial++,interface:i.name,path:t,member:s};if(c[0]){u.signature=c[0];u.body=a.slice(1)}r.connection.message(u);r.serial++}o.apply(e,a)}}};if(t.direct!==true){this.invokeDbus({member:"Hello"},(function(e,t){if(e)throw new Error(e);r.name=t}))}else{r.name=null}function DBusObject(e,t){this.name=e;this.service=t;this.as=function(e){return this.proxy[e]}}function DBusService(e,t){this.name=e;this.bus=t;this.getObject=function(e,t){if(e===undefined)return t(new Error("Object name is null or undefined"));var r=new DBusObject(e,this);o(r,(function(e,i,n){if(e)return t(e);r.proxy=i;r.nodes=n;t(null,r)}))};this.getInterface=function(e,t,r){this.getObject(e,(function(e,i){if(e)return r(e);r(null,i.as(t))}))}}this.getService=function(e){return new DBusService(e,this)};this.getObject=function(e,t,r){var i=this.getService(e);return i.getObject(t,r)};this.getInterface=function(e,t,r,i){return this.getObject(e,t,(function(e,t){if(e)return i(e);i(null,t.as(r))}))};this.addMatch=function(e,t){this.invokeDbus({member:"AddMatch",signature:"s",body:[e]},t)};this.removeMatch=function(e,t){this.invokeDbus({member:"RemoveMatch",signature:"s",body:[e]},t)};this.getId=function(e){this.invokeDbus({member:"GetId"},e)};this.requestName=function(e,t,r){this.invokeDbus({member:"RequestName",signature:"su",body:[e,t]},(function(e,t){if(r)r(e,t)}))};this.releaseName=function(e,t){this.invokeDbus({member:"ReleaseName",signature:"s",body:[e]},t)};this.listNames=function(e){this.invokeDbus({member:"ListNames"},e)};this.listActivatableNames=function(e){this.invokeDbus({member:"ListActivatableNames"},e)};this.updateActivationEnvironment=function(e,t){this.invokeDbus({member:"UpdateActivationEnvironment",signature:"a{ss}",body:[e]},t)};this.startServiceByName=function(e,t,r){this.invokeDbus({member:"StartServiceByName",signature:"su",body:[e,t]},r)};this.getConnectionUnixUser=function(e,t){this.invokeDbus({member:"GetConnectionUnixUser",signature:"s",body:[e]},t)};this.getConnectionUnixProcessId=function(e,t){this.invokeDbus({member:"GetConnectionUnixProcessID",signature:"s",body:[e]},t)};this.getNameOwner=function(e,t){this.invokeDbus({member:"GetNameOwner",signature:"s",body:[e]},t)};this.nameHasOwner=function(e,t){this.invokeDbus({member:"NameHasOwner",signature:"s",body:[e]},t)}}},756:e=>{e.exports={messageType:{invalid:0,methodCall:1,methodReturn:2,error:3,signal:4},headerTypeName:[null,"path","interface","member","errorName","replySerial","destination","sender","signature"],fieldSignature:{path:"o",interface:"s",member:"s",errorName:"s",replySerial:"u",destination:"s",sender:"s",signature:"g"},headerTypeId:{path:1,interface:2,member:3,errorName:4,replySerial:5,destination:6,sender:7,signature:8},protocolVersion:1,flags:{noReplyExpected:1,noAutoStart:2},endianness:{le:108,be:66},messageSignature:"yyyyuua(yv)",defaultAuthMethods:["EXTERNAL","DBUS_COOKIE_SHA1","ANONYMOUS"]}},5724:(e,t,r)=>{const i=r(1143);const n=r(9154);function DBusBuffer(e,t,r){if(typeof r!=="object"){r={ayBuffer:true,ReturnLongjs:false}}else if(r.ayBuffer===undefined){r.ayBuffer=true}this.options=r;this.buffer=e;this.startPos=t?t:0,this.pos=0}DBusBuffer.prototype.align=function(e){var t=(1<<e)-1;var r=this.pos+this.startPos+t>>e<<e;this.pos=r-this.startPos};DBusBuffer.prototype.readInt8=function(){this.pos++;return this.buffer[this.pos-1]};DBusBuffer.prototype.readSInt16=function(){this.align(1);var e=this.buffer.readInt16LE(this.pos);this.pos+=2;return e};DBusBuffer.prototype.readInt16=function(){this.align(1);var e=this.buffer.readUInt16LE(this.pos);this.pos+=2;return e};DBusBuffer.prototype.readSInt32=function(){this.align(2);var e=this.buffer.readInt32LE(this.pos);this.pos+=4;return e};DBusBuffer.prototype.readInt32=function(){this.align(2);var e=this.buffer.readUInt32LE(this.pos);this.pos+=4;return e};DBusBuffer.prototype.readDouble=function(){this.align(3);var e=this.buffer.readDoubleLE(this.pos);this.pos+=8;return e};DBusBuffer.prototype.readString=function(e){if(e===0){this.pos++;return""}var t=this.buffer.toString("utf8",this.pos,this.pos+e);this.pos+=e+1;return t};DBusBuffer.prototype.readTree=function readTree(e){switch(e.type){case"(":case"{":case"r":this.align(3);return this.readStruct(e.child);case"a":if(!e.child||e.child.length!==1)throw new Error("Incorrect array element signature");var t=this.readInt32();return this.readArray(e.child[0],t);case"v":return this.readVariant();default:return this.readSimpleType(e.type)}};DBusBuffer.prototype.read=function read(e){var t=n(e);return this.readStruct(t)};DBusBuffer.prototype.readVariant=function readVariant(){var e=this.readSimpleType("g");var t=n(e);return[t,this.readStruct(t)]};DBusBuffer.prototype.readStruct=function readStruct(e){var t=[];for(var r=0;r<e.length;++r){t.push(this.readTree(e[r]))}return t};DBusBuffer.prototype.readArray=function readArray(e,t){var r;var i=this.pos;if(e.type==="y"&&this.options.ayBuffer){this.pos+=t;return this.buffer.slice(i,this.pos)}if(["x","t","d","{","(","r"].indexOf(e.type)!==-1)this.align(3);var n=this.pos+t;r=[];while(this.pos<n)r.push(this.readTree(e));return r};DBusBuffer.prototype.readSimpleType=function readSimpleType(e){var t,r,n,a;switch(e){case"y":return this.readInt8();case"b":return this.readInt32()?true:false;case"n":return this.readSInt16();case"q":return this.readInt16();case"u":return this.readInt32();case"i":return this.readSInt32();case"g":r=this.readInt8();return this.readString(r);case"s":case"o":r=this.readInt32();return this.readString(r);case"x":this.align(3);n=this.readInt32();a=this.readInt32();t=i.fromBits(n,a,false);if(this.options.ReturnLongjs)return t;return t.toNumber();case"t":this.align(3);n=this.readInt32();a=this.readInt32();t=i.fromBits(n,a,true);if(this.options.ReturnLongjs)return t;return t.toNumber();case"d":return this.readDouble();default:throw new Error(`Unsupported type: ${e}`)}};e.exports=DBusBuffer},9634:(e,t,r)=>{const i=r(1954).Buffer;const n=r(6113);const a=r(7147);const o=r(1017);const s=r(756);const c=r(5146);function sha1(e){var t=n.createHash("sha1");t.update(e);return t.digest("hex")}function getUserHome(){return process.env[process.platform.match(/$win/)?"USERPROFILE":"HOME"]}function getCookie(e,t,r){var i=o.join(getUserHome(),".dbus-keyrings");if(e.length===0)e="org_freedesktop_general";var n=o.join(i,e);a.stat(i,(function(e,i){if(e)return r(e);if(i.mode&18)return r(new Error("User keyrings directory is writeable by other users. Aborting authentication"));if(process.hasOwnProperty("getuid")&&i.uid!==process.getuid())return r(new Error("Keyrings directory is not owned by the current user. Aborting authentication!"));a.readFile(n,"ascii",(function(e,i){if(e)return r(e);var n=i.split("\n");for(var a=0;a<n.length;++a){var o=n[a].split(" ");if(t===o[0])return r(null,o[2])}return r(new Error("cookie not found"))}))}))}function hexlify(e){return i.from(e.toString(),"ascii").toString("hex")}e.exports=function auth(e,t,r){var i;if(t.authMethods){i=t.authMethods}else{i=s.defaultAuthMethods}e.write("\0");tryAuth(e,i.slice(),r)};function tryAuth(e,t,r){if(t.length===0){return r(new Error("No authentication methods left to try"))}var a=t.shift();var o=process.hasOwnProperty("getuid")?process.getuid():0;var s=hexlify(o);function beginOrNextAuth(){c(e,(function(i){var n=i.toString("ascii").match(/^([A-Za-z]+) (.*)/);if(n&&n[1]==="OK"){e.write("BEGIN\r\n");return r(null,n[2])}else{if(!t.empty){tryAuth(e,t,r)}else{return r(i)}}}))}switch(a){case"EXTERNAL":e.write(`AUTH ${a} ${s}\r\n`);beginOrNextAuth();break;case"DBUS_COOKIE_SHA1":e.write(`AUTH ${a} ${s}\r\n`);c(e,(function(t){var a=i.from(t.toString().split(" ")[1].trim(),"hex").toString().split(" ");var o=a[0];var s=a[1];var c=a[2];var u=n.randomBytes(16).toString("hex");getCookie(o,s,(function(t,i){if(t)return r(t);var n=sha1([c,u,i].join(":"));var a=hexlify(u+n);e.write(`DATA ${a}\r\n`);beginOrNextAuth()}))}));break;case"ANONYMOUS":e.write("AUTH ANONYMOUS \r\n");beginOrNextAuth();break;default:console.error(`Unsupported auth method: ${a}`);beginOrNextAuth();break}}},9586:(e,t,r)=>{const i=r(6682);e.exports.introspectBus=function(t,r){var i=t.service.bus;i.invoke({destination:t.service.name,path:t.name,interface:"org.freedesktop.DBus.Introspectable",member:"Introspect"},(function(i,n){e.exports.processXML(i,n,t,r)}))};e.exports.processXML=function(t,r,n,a){if(t)return a(t);var o=new i.Parser;o.parseString(r,(function(t,r){if(t)return a(t);if(!r.node)throw new Error("No root XML node");r=r.node;if(!r.interface){if(r.node&&r.node.length>0&&r.node[0]["$"]){var i=Object.assign(n,{});if(i.name.slice(-1)!=="/")i.name+="/";i.name+=r.node[0]["$"].name;return e.exports.introspectBus(i,a)}return a(new Error("No such interface found"))}var o={};var s=[];var c,u,l,d,h,p,v;var m=r["interface"];var g=r["node"]||[];for(var y=1;y<g.length;++y){s.push(g[y]["$"]["name"])}for(var C=0;C<m.length;++C){d=m[C];c=d["$"].name;v=o[c]=new DBusInterface(n,c);for(var T=0;d.method&&T<d.method.length;++T){u=d.method[T];p="";var E=u["$"].name;for(var D=0;u.arg&&D<u.arg.length;++D){h=u.arg[D]["$"];if(h.direction==="in")p+=h.type}v.$createMethod(E,p)}for(var _=0;d.property&&_<d.property.length;++_){l=d.property[_];v.$createProp(l["$"].name,l["$"].type,l["$"].access)}}a(null,o,s)}))};function DBusInterface(e,t){this.$parent=e;this.$name=t;this.$methods={};this.$properties={};this.$callbacks=[];this.$sigHandlers=[]}DBusInterface.prototype.$getSigHandler=function(e){var t;if((t=this.$callbacks.indexOf(e))===-1){t=this.$callbacks.push(e)-1;this.$sigHandlers[t]=function(t){e.apply(null,t)}}return this.$sigHandlers[t]};DBusInterface.prototype.addListener=DBusInterface.prototype.on=function(e,t){var r=this.$parent.service.bus;var i=r.mangle(this.$parent.name,this.$name,e);if(!r.signals.listeners(i).length){var n=getMatchRule(this.$parent.name,this.$name,e);r.addMatch(n,function(e){if(e)throw new Error(e);r.signals.on(i,this.$getSigHandler(t))}.bind(this))}else{r.signals.on(i,this.$getSigHandler(t))}};DBusInterface.prototype.removeListener=DBusInterface.prototype.off=function(e,t){var r=this.$parent.service.bus;var i=r.mangle(this.$parent.name,this.$name,e);r.signals.removeListener(i,this.$getSigHandler(t));if(!r.signals.listeners(i).length){var n=getMatchRule(this.$parent.name,this.$name,e);r.removeMatch(n,function(e){if(e)throw new Error(e);this.$callbacks.length=0;this.$sigHandlers.length=0}.bind(this))}};DBusInterface.prototype.$createMethod=function(e,t){this.$methods[e]=t;this[e]=function(){this.$callMethod(e,arguments)}};DBusInterface.prototype.$callMethod=function(e,t){var r=this.$parent.service.bus;if(!Array.isArray(t))t=Array.from(t);var i=typeof t[t.length-1]==="function"?t.pop():function(){};var n={destination:this.$parent.service.name,path:this.$parent.name,interface:this.$name,member:e};if(this.$methods[e]!==""){n.signature=this.$methods[e];n.body=t}r.invoke(n,i)};DBusInterface.prototype.$createProp=function(e,t,r){this.$properties[e]={type:t,access:r};Object.defineProperty(this,e,{enumerable:true,get:()=>t=>this.$readProp(e,t),set:function(t){this.$writeProp(e,t)}})};DBusInterface.prototype.$readProp=function(e,t){var r=this.$parent.service.bus;r.invoke({destination:this.$parent.service.name,path:this.$parent.name,interface:"org.freedesktop.DBus.Properties",member:"Get",signature:"ss",body:[this.$name,e]},(function(e,r){if(e){t(e)}else{var i=r[0];if(i.length===1){t(e,r[1][0])}else{t(e,r[1])}}}))};DBusInterface.prototype.$writeProp=function(e,t){var r=this.$parent.service.bus;r.invoke({destination:this.$parent.service.name,path:this.$parent.name,interface:"org.freedesktop.DBus.Properties",member:"Set",signature:"ssv",body:[this.$name,e,[this.$properties[e].type,t]]})};function getMatchRule(e,t,r){return`type='signal',path='${e}',interface='${t}',member='${r}'`}},9775:(e,t,r)=>{const i=r(9491);const n=r(9154);const a=r(2470);const o=r(4730);const s=r(1542).A;e.exports=function marshall(e,t,r){if(typeof r==="undefined")r=0;var i=n(e);if(!Array.isArray(t)||t.length!==i.length){throw new Error(`message body does not match message signature. Body:${JSON.stringify(t)}, signature:${e}`)}var o=a();o._offset=r;var s=writeStruct(o,i,t).buffer();return s};function writeStruct(e,t,r){if(t.length!==r.length){throw new Error("Invalid struct data")}for(var i=0;i<t.length;++i){write(e,t[i],r[i])}return e}function write(e,t,r){switch(t.type){case"(":case"{":s(e,8);writeStruct(e,t.child,r);break;case"a":var o=a();o._offset=e._offset;var c=o._offset;writeSimple(o,"u",0);var u=o._offset-4-c;if(["x","t","d","{","("].indexOf(t.child[0].type)!==-1)s(o,8);var l=o._offset;for(var d=0;d<r.length;++d)write(o,t.child[0],r[d]);var h=o.buffer();var p=o._offset-l;h.writeUInt32LE(p,u);e.put(h);e._offset+=h.length;break;case"v":i.equal(r.length,2,"variant data should be [signature, data]");var v={type:"g",child:[]};write(e,v,r[0]);var m=n(r[0]);i(m.length===1);write(e,m[0],r[1]);break;default:return writeSimple(e,t.type,r)}}var c=["g","o","s"];function writeSimple(e,t,r){if(typeof r==="undefined")throw new Error("Serialisation of JS 'undefined' type is not supported by d-bus");if(r===null)throw new Error("Serialisation of null value is not supported by d-bus");if(Buffer.isBuffer(r))r=r.toString();if(c.indexOf(t)!==-1&&typeof r!=="string"){throw new Error(`Expected string or buffer argument, got ${JSON.stringify(r)} of type '${t}'`)}var i=o.MakeSimpleMarshaller(t);i.marshall(e,r);return e}},4730:(e,t,r)=>{const i=r(1954).Buffer;const n=r(1542).A;const a=r(9154);const o=r(1143);var MakeSimpleMarshaller=function(e){var t={};function checkValidString(e){if(typeof e!=="string"){throw new Error(`Data: ${e} was not of type string`)}else if(e.indexOf("\0")!==-1){throw new Error("String contains null byte")}}function checkValidSignature(e){if(e.length>255){throw new Error(`Data: ${e} is too long for signature type (${e.length} > 255)`)}var t=0;for(var r=0;r<e.length;++r){if(t>32){throw new Error(`Maximum container type nesting exceeded in signature type:${e}`)}switch(e[r]){case"(":++t;break;case")":--t;break;default:break}}a(e)}switch(e){case"o":case"s":t.check=function(e){checkValidString(e)};t.marshall=function(e,t){this.check(t);n(e,4);const r=i.from(t,"utf8");e.word32le(r.length).put(r).word8(0);e._offset+=5+r.length};break;case"g":t.check=function(e){checkValidString(e);checkValidSignature(e)};t.marshall=function(e,t){this.check(t);const r=i.from(t,"ascii");e.word8(t.length).put(r).word8(0);e._offset+=2+r.length};break;case"y":t.check=function(e){checkInteger(e);checkRange(0,255,e)};t.marshall=function(e,t){this.check(t);e.word8(t);e._offset++};break;case"b":t.check=function(e){checkBoolean(e)};t.marshall=function(e,t){this.check(t);t=t?1:0;n(e,4);e.word32le(t);e._offset+=4};break;case"n":t.check=function(e){checkInteger(e);checkRange(-32767-1,32767,e)};t.marshall=function(e,t){this.check(t);n(e,2);const r=i.alloc(2);r.writeInt16LE(parseInt(t),0);e.put(r);e._offset+=2};break;case"q":t.check=function(e){checkInteger(e);checkRange(0,65535,e)};t.marshall=function(e,t){this.check(t);n(e,2);e.word16le(t);e._offset+=2};break;case"i":t.check=function(e){checkInteger(e);checkRange(-2147483647-1,2147483647,e)};t.marshall=function(e,t){this.check(t);n(e,4);const r=i.alloc(4);r.writeInt32LE(parseInt(t),0);e.put(r);e._offset+=4};break;case"u":t.check=function(e){checkInteger(e);checkRange(0,4294967295,e)};t.marshall=function(e,t){this.check(t);n(e,4);e.word32le(t);e._offset+=4};break;case"t":t.check=function(e){return checkLong(e,false)};t.marshall=function(e,t){t=this.check(t);n(e,8);e.word32le(t.low);e.word32le(t.high);e._offset+=8};break;case"x":t.check=function(e){return checkLong(e,true)};t.marshall=function(e,t){t=this.check(t);n(e,8);e.word32le(t.low);e.word32le(t.high);e._offset+=8};break;case"d":t.check=function(e){if(typeof e!=="number"){throw new Error(`Data: ${e} was not of type number`)}else if(Number.isNaN(e)){throw new Error(`Data: ${e} was not a number`)}else if(!Number.isFinite(e)){throw new Error("Number outside range")}};t.marshall=function(e,t){this.check(t);n(e,8);const r=i.alloc(8);r.writeDoubleLE(parseFloat(t),0);e.put(r);e._offset+=8};break;default:throw new Error(`Unknown data type format: ${e}`)}return t};t.MakeSimpleMarshaller=MakeSimpleMarshaller;var checkRange=function(e,t,r){if(r>t||r<e){throw new Error("Number outside range")}};var checkInteger=function(e){if(typeof e!=="number"){throw new Error(`Data: ${e} was not of type number`)}if(Math.floor(e)!==e){throw new Error(`Data: ${e} was not an integer`)}};var checkBoolean=function(e){if(!(typeof e==="boolean"||e===0||e===1))throw new Error(`Data: ${e} was not of type boolean`)};var makeLong=function(e,t){if(e instanceof o)return e;if(e instanceof Number)e=e.valueOf();if(typeof e==="number"){try{checkInteger(e);if(t){checkRange(-9007199254740991,9007199254740991,e)}else{checkRange(0,9007199254740991,e)}}catch(e){e.message+=" (Number type can only carry 53 bit integer)";throw e}try{return o.fromNumber(e,!t)}catch(e){e.message=`Error converting number to 64bit integer "${e.message}"`;throw e}}if(typeof e==="string"||e instanceof String){var r=10;e=e.trim().toUpperCase();if(e.substring(0,2)==="0X"){r=16;e=e.substring(2)}else if(e.substring(0,3)==="-0X"){r=16;e=`-${e.substring(3)}`}e=e.replace(/^0+(?=\d)/,"");var i;try{i=o.fromString(e,!t,r)}catch(e){e.message=`Error converting string to 64bit integer '${e.message}'`;throw e}if(i.toString(r).toUpperCase()!==e)throw new Error(`Data: '${e}' did not convert correctly to ${t?"signed":"unsigned"} 64 bit`);return i}try{return o.fromBits(e.low,e.high,e.unsigned)}catch(e){e.message=`Error converting object to 64bit integer '${e.message}'`;throw e}};var checkLong=function(e,t){if(!o.isLong(e)){e=makeLong(e,t)}if(t){if(e.unsigned)throw new Error("Longjs object is unsigned, but marshalling into signed 64 bit field");if(e.gt(o.MAX_VALUE)||e.lt(o.MIN_VALUE)){throw new Error(`Data: ${e} was out of range (64-bit signed)`)}}else{if(!e.unsigned)throw new Error("Longjs object is signed, but marshalling into unsigned 64 bit field");if(e.gt(o.MAX_UNSIGNED_VALUE)||e.lt(0)){throw new Error(`Data: ${e} was out of range (64-bit unsigned)`)}}return e}},8408:(e,t,r)=>{const i=r(1954).Buffer;const n=r(9775);const a=r(756);const o=r(5724);const s=r(6608);e.exports.unmarshalMessages=function messageParser(e,t,r){var i=0;var n,c;var u,l;var d=0;var h=0;e.on("readable",(function(){while(1){if(i===0){n=e.read(16);if(!n)break;i=1;u=n.readUInt32LE(12);l=u+7>>3<<3;h=n.readUInt32LE(4);d=l+h}else{c=e.read(d);if(!c)break;i=0;var p=new o(c,undefined,r);var v=p.readArray(s[0].child[0],u);p.align(3);var m;var g={};g.serial=n.readUInt32LE(8);for(var y=0;y<v.length;++y){m=a.headerTypeName[v[y][0]];g[m]=v[y][1][1][0]}g.type=n[1];g.flags=n[2];if(h>0&&g.signature){g.body=p.read(g.signature)}t(g)}}}))};e.exports.unmarshall=function unmarshall(e,t){var r=new o(e,undefined,t);var i=r.read("yyyyuua(yv)");var n={};for(var s=0;s<i[6].length;++s){var c=a.headerTypeName[i[6][s][0]];n[c]=i[6][s][1][1][0]}n.type=i[1];n.flags=i[2];n.serial=i[5];r.align(3);n.body=r.read(n.signature);return n};e.exports.marshall=function marshallMessage(e){if(!e.serial)throw new Error("Missing or invalid serial");var t=e.flags||0;var r=e.type||a.messageType.methodCall;var o=0;var s;if(e.signature&&e.body){s=n(e.signature,e.body);o=s.length}var c=[a.endianness.le,r,t,a.protocolVersion,o,e.serial];var u=n("yyyyuu",c);var l=[];a.headerTypeName.forEach((function(t){var r=e[t];if(r){l.push([a.headerTypeId[t],[a.fieldSignature[t],r]])}}));var d=n("a(yv)",[l],12);var h=u.length+d.length+7>>3<<3;var p=h+o;var v=i.alloc(p);u.copy(v);d.copy(v,u.length);if(o>0)s.copy(v,h);return v}},5146:(e,t,r)=>{const i=r(1954).Buffer;e.exports=function readOneLine(e,t){var r=[];function readable(){while(1){var n=e.read(1);if(!n)return;var a=n[0];if(a===10){try{t(i.from(r))}catch(t){e.emit("error",t)}e.removeListener("readable",readable);return}r.push(a)}}e.on("readable",readable)}},1651:(e,t,r)=>{const i=r(1954).Buffer;const n=r(5146);e.exports=function serverHandshake(e,t,r){e.name="SERVER SERVER";n(e,(function(t){console.log(["hello string: ",t.toString(),t]);e.write("REJECTED EXTERNAL DBUS_COOKIE_SHA1 ANONYMOUS\r\n");n(e,(function(){e.write(`DATA ${i.from("org_freedesktop_general 642038150 b9ce247a275f427c8586e4c9de9bb951").toString("hex")}\r\n`);n(e,(function(){e.write("OK 6f72675f667265656465736b746f705f67656e6572616c20353631303331333937206239636532343761323735663432376338353836653463396465396262393531\r\n");n(e,(function(e){console.log(["AFTER begin: ",e.toString()]);r(null)}))}))}))}))}},5980:(e,t,r)=>{const i=r(7933);const n=r(1808);e.exports.createServer=function(e){function Server(){var t=123;this.server=n.createServer((function(r){r.idd=t;t++;var n=i.createConnection({stream:r,server:true});if(e)e(n)}));this.listen=this.server.listen.bind(this.server)}return new Server}},9154:e=>{var t={"{":"}","(":")"};var r={};"(){}ybnqiuxtdsogarvehm*?@&^".split("").forEach((function(e){r[e]=true}));e.exports=function parseSignature(e){var i=0;function next(){if(i<e.length){var t=e[i];++i;return t}return null}function parseOne(i){function checkNotEnd(e){if(!e)throw new Error("Bad signature: unexpected end");return e}if(!r[i])throw new Error(`Unknown type: "${i}" in signature "${e}"`);var n;var a={type:i,child:[]};switch(i){case"a":n=next();checkNotEnd(n);a.child.push(parseOne(n));return a;case"{":case"(":while((n=next())!==null&&n!==t[i])a.child.push(parseOne(n));checkNotEnd(n);return a}return a}var n=[];var a;while((a=next())!==null)n.push(parseOne(a));return n}},3207:(e,t,r)=>{const i=r(756);const n=r(9154);var a='<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"\n'+'    "http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">';var o;e.exports=function(e,t){if(e["interface"]==="org.freedesktop.DBus.Introspectable"&&e.member==="Introspect"){if(e.path==="/")e.path="";var r=[a];var n={};for(var s in t.exportedObjects){if(s.indexOf(e.path)===0){var c=t.exportedObjects[e.path];if(c){n[e.path]=c}else{if(s[e.path.length]!=="/")continue;var u=s.substr(e.path.length);var l=u.split("/");var d=l[1];n[d]=null}}}var h=Object.keys(n).length;if(h===0){r.push("<node/>")}else if(h===1){var p=n[Object.keys(n)[0]];if(p){r.push("<node>");for(var v in p){r.push(interfaceToXML(p[v][0]))}r.push(o);r.push("</node>")}else{r.push(`<node>\n  <node name="${Object.keys(n)[0]}"/>\n  </node>`)}}else{r.push("<node>");for(var m in n){if(n[m]===null){r.push(`  <node name="${m}" />`)}else{p=n[m];r.push(`  <node name="${m}" >`);for(var g in p){r.push(interfaceToXML(p[g][0]))}r.push(o);r.push("  </node>")}}r.push("</node>")}const y={type:i.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender,signature:"s",body:[r.join("\n")]};t.connection.message(y);return 1}else if(e["interface"]==="org.freedesktop.DBus.Properties"){var y=e.body[0];var C=t.exportedObjects[e.path];if(!C||!C[y]){t.sendError(e,"org.freedesktop.DBus.Error.UnknownMethod","Uh oh oh");return 1}var T=C[y][1];const r={type:i.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender};if(e.member==="Get"||e.member==="Set"){var E=e.body[1];var D=C[y][0].properties[E];if(e.member==="Get"){var _=T[E];r.signature="v";r.body=[[D,_]]}else{T[E]=1234}}else if(e.member==="GetAll"){r.signature="a{sv}";var I=[];for(var b in C[y][0].properties){var w=C[y][0].properties[b];I.push([b,[w,T[b]]])}r.body=[I]}t.connection.message(r);return 1}else if(e["interface"]==="org.freedesktop.DBus.Peer"){const r={type:i.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender};if(e.member==="Ping"){}else if(e.member==="GetMachineId"){r.signature="s";r.body=["This is a machine id. TODO: implement"]}t.connection.message(r);return 1}return 0};function interfaceToXML(e){var t=[];var dumpArgs=function(e,r,i){if(!e)return;var a=n(e);a.forEach((function(e,n){var a=r?r[n]:i+n;var o=i==="signal"?"":`" direction="${i}`;t.push(`      <arg type="${dumpSignature([e])}" name="${a}${o}" />`)}))};t.push(`  <interface name="${e.name}">`);if(e.methods){for(var r in e.methods){var i=e.methods[r];t.push(`    <method name="${r}">`);dumpArgs(i[0],i[2],"in");dumpArgs(i[1],i[3],"out");t.push("    </method>")}}if(e.signals){for(var a in e.signals){var o=e.signals[a];t.push(`    <signal name="${a}">`);dumpArgs(o[0],o.slice(1),"signal");t.push("    </signal>")}}if(e.properties){for(const r in e.properties){t.push(`    <property name="${r}" type="${e.properties[r]}" access="readwrite"/>`)}}t.push("  </interface>");return t.join("\n")}function dumpSignature(e){var t=[];e.forEach((function(e){t.push(e.type+dumpSignature(e.child));if(e.type==="{")t.push("}");if(e.type==="(")t.push(")")}));return t.join("")}o='  <interface name="org.freedesktop.DBus.Properties">\n    <method name="Get">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="s" name="property_name" direction="in"/>\n      <arg type="v" name="value" direction="out"/>\n    </method>\n    <method name="GetAll">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="a{sv}" name="properties" direction="out"/>\n    </method>\n    <method name="Set">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="s" name="property_name" direction="in"/>\n      <arg type="v" name="value" direction="in"/>\n    </method>\n    <signal name="PropertiesChanged">\n      <arg type="s" name="interface_name"/>\n      <arg type="a{sv}" name="changed_properties"/>\n      <arg type="as" name="invalidated_properties"/>\n    </signal>\n  </interface>\n  <interface name="org.freedesktop.DBus.Introspectable">\n    <method name="Introspect">\n      <arg type="s" name="xml_data" direction="out"/>\n    </method>\n  </interface>\n  <interface name="org.freedesktop.DBus.Peer">\n    <method name="Ping"/>\n    <method name="GetMachineId">\n      <arg type="s" name="machine_uuid" direction="out"/>\n    </method>\n  </interface>'},2470:(e,t,r)=>{const i=r(9491);e.exports=Put;function Put(){if(!(this instanceof Put))return new Put;var e=[];var t=0;this.put=function(r){e.push({buffer:r});t+=r.length;return this};this.word8=function(r){e.push({bytes:1,value:r});t+=1;return this};this.floatle=function(r){e.push({bytes:"float",endian:"little",value:r});t+=4;return this};[8,16,24,32,64].forEach(function(r){this["word"+r+"be"]=function(i){e.push({endian:"big",bytes:r/8,value:i});t+=r/8;return this};this["word"+r+"le"]=function(i){e.push({endian:"little",bytes:r/8,value:i});t+=r/8;return this}}.bind(this));this.pad=function(r){i(Number.isInteger(r),"pad(bytes) must be supplied with an integer!");e.push({endian:"big",bytes:r,value:0});t+=r;return this};this.length=function(){return t};this.buffer=function(){var r=Buffer.alloc(t);var i=0;e.forEach((function(e){if(e.buffer){e.buffer.copy(r,i,0);i+=e.buffer.length}else if(e.bytes==="float"){var t=Math.abs(e.value);var n=(e.value>=0)*1;var a=Math.ceil(Math.log(t)/Math.LN2);var o=t/(1<<a);console.dir([n,a,o]);console.log(e.value);r[i++]=n<<7&~~(a/2);r[i++]=(a&1)<<7&~~(o/(1<<16));r[i++]=0;r[i++]=0;i+=4}else{var s=e.endian==="big";var c=s?[(e.bytes-1)*8,-8]:[0,8];for(var u=c[0];s?u>=0:u<e.bytes*8;u+=c[1]){if(u>=32){r[i++]=Math.floor(e.value/Math.pow(2,u))&255}else{r[i++]=e.value>>u&255}}}}));return r};this.write=function(e){e.write(this.buffer())}}},701:e=>{"use strict";e.exports=flatten;e.exports.from=flattenFrom;e.exports.depth=flattenDepth;e.exports.fromDepth=flattenFromDepth;function flatten(e){if(!Array.isArray(e)){throw new TypeError("Expected value to be an array")}return flattenFrom(e)}function flattenFrom(e){return flattenDown(e,[])}function flattenDepth(e,t){if(!Array.isArray(e)){throw new TypeError("Expected value to be an array")}return flattenFromDepth(e,t)}function flattenFromDepth(e,t){if(typeof t!=="number"){throw new TypeError("Expected the depth to be a number")}return flattenDownDepth(e,[],t)}function flattenDown(e,t){for(var r=0;r<e.length;r++){var i=e[r];if(Array.isArray(i)){flattenDown(i,t)}else{t.push(i)}}return t}function flattenDownDepth(e,t,r){r--;for(var i=0;i<e.length;i++){var n=e[i];if(r>-1&&Array.isArray(n)){flattenDownDepth(n,t,r)}else{t.push(n)}}return t}},6196:(e,t,r)=>{"use strict";const i=r(2924);const n=r(9913);const a=r(197);function Bonjour(e){if(!(this instanceof Bonjour)){return new Bonjour(e)}this._server=new n(e);this._registry=new i(this._server)}Bonjour.prototype={publish:function(e){return this._registry.publish(e)},unpublishAll:function(e){this._registry.unpublishAll(e)},find:function(e,t){return new a(this._server.mdns,e,t)},findOne:function(e,t){const r=new a(this._server.mdns,e);r.once("up",(function(e){r.stop();if(t)t(e)}));return r},destroy:function(){this._registry.destroy();this._server.mdns.destroy()}};e.exports=Bonjour},197:(e,t,r)=>{"use strict";const i=r(3837);const n=r(2361).EventEmitter;const a=r(576);const o=r(5849);const s=r(3922);const c=".local";const u="_services._dns-sd._udp"+c;e.exports=Browser;i.inherits(Browser,n);function Browser(e,t,r){if(typeof t==="function")return new Browser(e,null,t);n.call(this);this._mdns=e;this._onresponse=null;this._serviceMap={};this._txt=s(t.txt);if(!t||!t.type){this._name=u;this._wildcard=true}else{this._name=a.stringify(t.type,t.protocol||"tcp")+c;if(t.name)this._name=t.name+"."+this._name;this._wildcard=false}this.services=[];if(r)this.on("up",r);this.start()}Browser.prototype.start=function(){if(this._onresponse)return;const e=this;const t={};if(!this._wildcard)t[this._name]=true;this._onresponse=function(r,i){if(e._wildcard){r.answers.forEach((function(r){if(r.type!=="PTR"||r.name!==e._name||r.name in t)return;t[r.data]=true;e._mdns.query(r.data,"PTR")}))}Object.keys(t).forEach((function(t){goodbyes(t,r).forEach(e._removeService.bind(e));const n=buildServicesFor(t,r,e._txt,i);if(n.length===0)return;n.forEach((function(t){if(e._serviceMap[t.fqdn])return;e._addService(t)}))}))};this._mdns.on("response",this._onresponse);this.update()};Browser.prototype.stop=function(){if(!this._onresponse)return;this._mdns.removeListener("response",this._onresponse);this._onresponse=null};Browser.prototype.update=function(){this._mdns.query(this._name,"PTR")};Browser.prototype._addService=function(e){this.services.push(e);this._serviceMap[e.fqdn]=true;this.emit("up",e)};Browser.prototype._removeService=function(e){let t,r;this.services.some((function(i,n){if(o(i.fqdn,e)){t=i;r=n;return true}return false}));if(!t)return;this.services.splice(r,1);delete this._serviceMap[e];this.emit("down",t)};function goodbyes(e,t){return t.answers.concat(t.additionals).filter((function(t){return t.type==="PTR"&&t.ttl===0&&o(t.name,e)})).map((function(e){return e.data}))}function buildServicesFor(e,t,r,i){const n=t.answers.concat(t.additionals).filter((function(e){return e.ttl>0}));return n.filter((function(t){return t.type==="PTR"&&o(t.name,e)})).map((function(e){const t={addresses:[]};n.filter((function(t){return(t.type==="SRV"||t.type==="TXT")&&o(t.name,e.data)})).forEach((function(e){if(e.type==="SRV"){const r=e.name.split(".");const n=r[0];const o=a.parse(r.slice(1,-1).join("."));t.name=n;t.fqdn=e.name;t.host=e.data.target;t.referer=i;t.port=e.data.port;t.type=o.name;t.protocol=o.protocol;t.subtypes=o.subtypes}else if(e.type==="TXT"){t.rawTxt=e.data;t.txt=r.decodeBlocks(t.rawTxt)}}));if(!t.name)return undefined;n.filter((function(e){return(e.type==="A"||e.type==="AAAA")&&o(e.name,t.host)})).forEach((function(e){t.addresses.push(e.data)}));return t})).filter((function(e){return!!e}))}},1779:(e,t,r)=>{"use strict";const i=r(5849);const Prober=function(e,t,r){this.sent=false;this.retries=0;this.timer=null;this.cb=r;this.mdns=e;this.service=t;this.bound=this.onMDNSresponse.bind(this);this.matchRRBound=this.matchRR.bind(this)};Prober.prototype={start:function(){this.mdns.on("response",this.bound);setTimeout(this.try.bind(this),Math.random()*250)},try:function(){if(!this.service._activated||this.service._destroyed)return;this.mdns.query(this.service.fqdn,"ANY",function(){this.sent=true;this.timer=setTimeout(++this.retries<3?this.try.bind(this):this.done.bind(this,false),250);this.timer.unref()}.bind(this))},matchRR:function(e){return i(e.name,this.service.fqdn)},onMDNSresponse:function(e){if(!this.sent){return}if(e.answers.some(this.matchRRBound)||e.additionals.some(this.matchRRBound)){this.done(true)}},done:function(e){this.mdns.removeListener("response",this.bound);clearTimeout(this.timer);this.cb(e)}};e.exports=Prober},2924:(e,t,r)=>{"use strict";const i=r(701);const n=r(9500);const a=r(1779);const Registry=function(e){this._server=e;this._services=[]};Registry.prototype={publish:function(e){e=e||{};const t=new n(e);t.on("service-publish",this._onServicePublish.bind(this));t.on("service-unpublish",this._onServiceUnpublish.bind(this));t.on("service-announce-request",this._onAnnounceRequest.bind(this));t.on("service-packet-change",this._onServiceChange.bind(this));t.start();return t},unpublishAll:function(e){this._tearDown(this._services,e);this._services=[]},destroy:function(){for(let e=0;e<this._services.length;e++){this._services[e].destroy()}},_tearDown:function(e,t){if(!Array.isArray(e)){e=[e]}e=e.filter((function(e){return e._activated}));const r=i.depth(e.map((function(e){e.deactivate();const t=e._records(true);t.forEach((function(e){e.ttl=0}));return t})),1);if(r.length===0){return t&&t()}this._server.unregister(r);this._server.mdns.respond(r,this._onTearDownComplete.bind(this,e,t))},_onTearDownComplete:function(e,t){for(let t=0;t<e.length;t++){e[t].published=false}if(t){t.apply(null,Array.prototype.slice.call(arguments,2))}},_onServiceChange:function(e){this._server.unregister(e)},_onAnnounceRequest:function(e,t,r){this._server.register(e);if(!t){this._server.mdns.respond(e,r)}},_onServiceUnpublish:function(e,t){const r=this._services.indexOf(e);this._tearDown(e,t);if(r!==-1){this._services.splice(r,1)}},_onServicePublish:function(e){this._services.push(e);if(e.probe){new a(this._server.mdns,e,this._onProbeComplete.bind(this,e)).start()}else{e.announce()}},_onProbeComplete:function(e,t){if(!t){return e.announce()}e.stop();e.emit("error",new Error("Service name is already in use on the network"))}};e.exports=Registry},9913:(e,t,r)=>{"use strict";const i=r(9535);const n=r(5849);const a=r(701);const o=r(1354);const Server=function(e){this.mdns=i(e);this.mdns.setMaxListeners(0);this.registry={};this.mdns.on("query",this._respondToQuery.bind(this))};Server.prototype={_respondToQuery:function(e){for(let t=0;t<e.questions.length;t++){const r=e.questions[t];const i=r.type;const n=r.name;const s=i==="ANY"?a.depth(Object.keys(this.registry).map(this._recordsFor.bind(this,n)),1):this._recordsFor(n,i);if(s.length===0)return;let c=[];if(i!=="ANY"){s.forEach((e=>{if(e.type!=="PTR")return;c=c.concat(this._recordsFor(e.data,"SRV")).concat(this._recordsFor(e.data,"TXT"))}));c.filter((e=>e.type==="SRV")).map((e=>e.data.target)).filter(o.unique()).forEach((e=>{c=c.concat(this._recordsFor(e,"A")).concat(this._recordsFor(e,"AAAA"))}))}this.mdns.respond({answers:s,additionals:c},(e=>{if(e)throw e}))}},register:function(e){if(!Array.isArray(e)){e=[e]}for(let t=0;t<e.length;t++){const r=e[t];let i=this.registry[r.type];if(!i){i=this.registry[r.type]=[]}else if(i.some(o.isDuplicateRecord(r))){continue}i.push(r)}},unregister:function(e){if(!Array.isArray(e)){e=[e]}for(let t=0;t<e.length;t++){const r=e[t];const i=r.type;if(!(i in this.registry)){continue}this.registry[i]=this.registry[i].filter((e=>e.name!==r.name))}},_recordsFor:function(e,t){if(!(t in this.registry)){return[]}return this.registry[t].filter((t=>{const r=~e.indexOf(".")?t.name:t.name.split(".")[0];return n(r,e)}))}};e.exports=Server},9500:(e,t,r)=>{"use strict";const i=r(2037);const n=r(3837);const a=r(1808);const o=r(9491);const s=r(2361).EventEmitter;const c=r(576);const u=r(173);const l=".local";const d=60*60*1e3;const h=3;const Service=function(e){if(!e.name)throw new Error("Required name not given");if(!e.type)throw new Error("Required type not given");if(!e.port)throw new Error("Required port not given");this.name=e.name;this.protocol=e.protocol||"tcp";this.probe=e.probe!==false;this.type=c.stringify(e.type,this.protocol);this.host=e.host||i.hostname();this.port=e.port;this.fqdn=this.name+"."+this.type+l;this.subtypes=e.subtypes||null;this.txt=e.txt||null;this.published=false;this.addUnsafeServiceEnumerationRecord=e.addUnsafeServiceEnumerationRecord||false;this.restrictedAddresses=undefined;if(e.restrictedAddresses){o(e.restrictedAddresses.length,"The service property 'restrictedAddresses' cannot be an empty array!");this.restrictedAddresses=new Map;for(const t of e.restrictedAddresses){if(a.isIP(t)){if(t==="0.0.0.0"||t==="::"){throw new Error(`[${this.fqdn}] Unspecified ip address (${t}) cannot be used to restrict on to!`)}const e=u.resolveInterface(t);if(!e){throw new Error(`[${this.fqdn}] Could not restrict service to address ${t} as we could not resolve it to an interface name!`)}const r=this.restrictedAddresses.get(e);if(r){if(r.length&&!r.includes(t)){r.push(t)}}else{this.restrictedAddresses.set(e,[t])}}else{this.restrictedAddresses.set(t,[])}}}this.disabledIpv6=e.disabledIpv6||false;this._activated=false};n.inherits(Service,s);const p={start:function(){if(this._activated){return}this._activated=true;this.emit("service-publish",this)},stop:function(e){if(!this._activated){e();return}this.emit("service-unpublish",this,e)},updateTxt:function(e,t){if(this.packet){this.emit("service-packet-change",this.packet,this.onAnnounceComplete.bind(this))}this.packet=null;this.txt=e;if(!this.published){return}this._unpublish();this.announce(t)},announce:function(e){if(this._destroyed){return}if(!this.packet){this.packet=this._records()}if(this.timer){clearTimeout(this.timer)}this.delay=1e3;this.emit("service-announce-request",this.packet,e||false,this.onAnnounceComplete.bind(this))},onAnnounceComplete:function(){if(!this.published){this._activated=true;this.published=true;this.emit("up")}this.delay=this.delay*h;if(this.delay<d&&!this._destroyed&&this._activated){this.timer=setTimeout(this.announce.bind(this),this.delay).unref()}else{this.timer=undefined;this.delay=undefined}},deactivate:function(){this._unpublish();this._activated=false},destroy:function(){this._unpublish();this.removeAllListeners();this._destroyed=true},_unpublish:function(){if(this.timer){clearTimeout(this.timer)}this.published=false},_records:function(e){const t=[this._rrPtr(),this._rrSrv(),this._rrTxt()];t.push(...this._addressRecords());if(!e&&this.addUnsafeServiceEnumerationRecord){t.push(this._rrMetaPtr())}return t},_addressRecords:function(){const e=[];const t=[];Object.entries(i.networkInterfaces()).forEach((([r,i])=>{let n=this.restrictedAddresses?this.restrictedAddresses.get(r):undefined;if(this.restrictedAddresses&&!n){return}if(n&&n.length===0){n=undefined}i.forEach((r=>{if(r.internal||t.includes(r.address)){return}if(n&&n.includes(r.address)){return}if(r.family==="IPv4"){e.push(this._rrA(r.address));t.push(r.address)}else if(!this.disabledIpv6){e.push(this._rrAaaa(r.address));t.push(r.address)}}))}));return e},_rrMetaPtr:function(){return{name:"_services._dns-sd._udp.local",type:"PTR",ttl:4500,data:this.type+l}},_rrPtr:function(){return{name:this.type+l,type:"PTR",ttl:4500,data:this.fqdn}},_rrSrv:function(){return{name:this.fqdn,type:"SRV",ttl:120,flush:true,data:{port:this.port,target:this.host}}},_rrTxt:function(){const e=[];if(this.txt){const t=this.txt;const r=Object.keys(t);r.forEach((r=>{const i=t[r];e.push(r+"="+i)}))}return{name:this.fqdn,type:"TXT",ttl:4500,flush:true,data:e}},_rrA:function(e){return{name:this.host,type:"A",ttl:120,flush:true,data:e}},_rrAaaa:function(e){return{name:this.host,type:"AAAA",ttl:120,flush:true,data:e}}};for(const e in p){Service.prototype[e]=p[e]}e.exports=Service},1354:(e,t,r)=>{const i=r(519);e.exports={isDuplicateRecord:function(e){return function(t){return e.type===t.type&&e.name===t.name&&i(e.data,t.data)}},unique:function(){const e=[];return function(t){if(~e.indexOf(t))return false;e.push(t);return true}}}},5849:e=>{"use strict";const t=/[A-Z]/g;e.exports=function(e,r){e=e.replace(t,replacer);r=r.replace(t,replacer);return e===r};function replacer(e){return e.toLowerCase()}},173:(e,t,r)=>{const i=r(2037);function resolveInterface(e){for(const[t,r]of Object.entries(i.networkInterfaces())){for(const i of r){if(i.address===e){return t}}}return undefined}e.exports={resolveInterface:resolveInterface}},3922:e=>{"use strict";const t=Buffer.from("=");e.exports=function(e){const r=e?e.binary:false;const i={};i.decodeBlocks=function(e){const i={};e.forEach((e=>{if(e.length===0){return}const n=e.indexOf(t);if(n===-1){i[e.toString().toLowerCase()]=true}else if(n>0){const t=e.slice(0,n).toString().toLowerCase();if(t in i){return}const a=e.slice(n+1);i[t]=r?a:a.toString()}}));return i};return i}},8779:e=>{var t=Object.prototype.toString;var r=typeof Buffer!=="undefined"&&typeof Buffer.alloc==="function"&&typeof Buffer.allocUnsafe==="function"&&typeof Buffer.from==="function";function isArrayBuffer(e){return t.call(e).slice(8,-1)==="ArrayBuffer"}function fromArrayBuffer(e,t,i){t>>>=0;var n=e.byteLength-t;if(n<0){throw new RangeError("'offset' is out of bounds")}if(i===undefined){i=n}else{i>>>=0;if(i>n){throw new RangeError("'length' is out of bounds")}}return r?Buffer.from(e.slice(t,t+i)):new Buffer(new Uint8Array(e.slice(t,t+i)))}function fromString(e,t){if(typeof t!=="string"||t===""){t="utf8"}if(!Buffer.isEncoding(t)){throw new TypeError('"encoding" must be a valid string encoding')}return r?Buffer.from(e,t):new Buffer(e,t)}function bufferFrom(e,t,i){if(typeof e==="number"){throw new TypeError('"value" argument must not be a number')}if(isArrayBuffer(e)){return fromArrayBuffer(e,t,i)}if(typeof e==="string"){return fromString(e,t)}return r?Buffer.from(e):new Buffer(e)}e.exports=bufferFrom},6379:(e,t,r)=>{"use strict";var i=r(1626);var n=r(1743);var a=n(i("String.prototype.indexOf"));e.exports=function callBoundIntrinsic(e,t){var r=i(e,!!t);if(typeof r==="function"&&a(e,".prototype.")>-1){return n(r)}return r}},1743:(e,t,r)=>{"use strict";var i=r(7978);var n=r(1626);var a=n("%Function.prototype.apply%");var o=n("%Function.prototype.call%");var s=n("%Reflect.apply%",true)||i.call(o,a);var c=n("%Object.getOwnPropertyDescriptor%",true);var u=n("%Object.defineProperty%",true);var l=n("%Math.max%");if(u){try{u({},"a",{value:1})}catch(e){u=null}}e.exports=function callBind(e){var t=s(i,o,arguments);if(c&&u){var r=c(t,"length");if(r.configurable){u(t,"length",{value:1+l(0,e.length-(arguments.length-1))})}}return t};var d=function applyBind(){return s(i,a,arguments)};if(u){u(e.exports,"apply",{value:d})}else{e.exports.apply=d}},5243:(e,t,r)=>{t.formatArgs=formatArgs;t.save=save;t.load=load;t.useColors=useColors;t.storage=localstorage();t.destroy=(()=>{let e=false;return()=>{if(!e){e=true;console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}}})();t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function useColors(){if(typeof window!=="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)){return true}if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)){return false}return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function formatArgs(t){t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff);if(!this.useColors){return}const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let i=0;let n=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{if(e==="%%"){return}i++;if(e==="%c"){n=i}}));t.splice(n,0,r)}t.log=console.debug||console.log||(()=>{});function save(e){try{if(e){t.storage.setItem("debug",e)}else{t.storage.removeItem("debug")}}catch(e){}}function load(){let e;try{e=t.storage.getItem("debug")}catch(e){}if(!e&&typeof process!=="undefined"&&"env"in process){e=process.env.DEBUG}return e}function localstorage(){try{return localStorage}catch(e){}}e.exports=r(7818)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},7818:(e,t,r)=>{function setup(e){createDebug.debug=createDebug;createDebug.default=createDebug;createDebug.coerce=coerce;createDebug.disable=disable;createDebug.enable=enable;createDebug.enabled=enabled;createDebug.humanize=r(721);createDebug.destroy=destroy;Object.keys(e).forEach((t=>{createDebug[t]=e[t]}));createDebug.names=[];createDebug.skips=[];createDebug.formatters={};function selectColor(e){let t=0;for(let r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r);t|=0}return createDebug.colors[Math.abs(t)%createDebug.colors.length]}createDebug.selectColor=selectColor;function createDebug(e){let t;let r=null;let i;let n;function debug(...e){if(!debug.enabled){return}const r=debug;const i=Number(new Date);const n=i-(t||i);r.diff=n;r.prev=t;r.curr=i;t=i;e[0]=createDebug.coerce(e[0]);if(typeof e[0]!=="string"){e.unshift("%O")}let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((t,i)=>{if(t==="%%"){return"%"}a++;const n=createDebug.formatters[i];if(typeof n==="function"){const i=e[a];t=n.call(r,i);e.splice(a,1);a--}return t}));createDebug.formatArgs.call(r,e);const o=r.log||createDebug.log;o.apply(r,e)}debug.namespace=e;debug.useColors=createDebug.useColors();debug.color=createDebug.selectColor(e);debug.extend=extend;debug.destroy=createDebug.destroy;Object.defineProperty(debug,"enabled",{enumerable:true,configurable:false,get:()=>{if(r!==null){return r}if(i!==createDebug.namespaces){i=createDebug.namespaces;n=createDebug.enabled(e)}return n},set:e=>{r=e}});if(typeof createDebug.init==="function"){createDebug.init(debug)}return debug}function extend(e,t){const r=createDebug(this.namespace+(typeof t==="undefined"?":":t)+e);r.log=this.log;return r}function enable(e){createDebug.save(e);createDebug.namespaces=e;createDebug.names=[];createDebug.skips=[];let t;const r=(typeof e==="string"?e:"").split(/[\s,]+/);const i=r.length;for(t=0;t<i;t++){if(!r[t]){continue}e=r[t].replace(/\*/g,".*?");if(e[0]==="-"){createDebug.skips.push(new RegExp("^"+e.slice(1)+"$"))}else{createDebug.names.push(new RegExp("^"+e+"$"))}}}function disable(){const e=[...createDebug.names.map(toNamespace),...createDebug.skips.map(toNamespace).map((e=>"-"+e))].join(",");createDebug.enable("");return e}function enabled(e){if(e[e.length-1]==="*"){return true}let t;let r;for(t=0,r=createDebug.skips.length;t<r;t++){if(createDebug.skips[t].test(e)){return false}}for(t=0,r=createDebug.names.length;t<r;t++){if(createDebug.names[t].test(e)){return true}}return false}function toNamespace(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}function coerce(e){if(e instanceof Error){return e.stack||e.message}return e}function destroy(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}createDebug.enable(createDebug.load());return createDebug}e.exports=setup},7031:(e,t,r)=>{if(typeof process==="undefined"||process.type==="renderer"||process.browser===true||process.__nwjs){e.exports=r(5243)}else{e.exports=r(9125)}},9125:(e,t,r)=>{const i=r(6224);const n=r(3837);t.init=init;t.log=log;t.formatArgs=formatArgs;t.save=save;t.load=load;t.useColors=useColors;t.destroy=n.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");t.colors=[6,2,3,4,5,1];try{const e=r(430);if(e&&(e.stderr||e).level>=2){t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221]}}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let i=process.env[t];if(/^(yes|on|true|enabled)$/i.test(i)){i=true}else if(/^(no|off|false|disabled)$/i.test(i)){i=false}else if(i==="null"){i=null}else{i=Number(i)}e[r]=i;return e}),{});function useColors(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):i.isatty(process.stderr.fd)}function formatArgs(t){const{namespace:r,useColors:i}=this;if(i){const i=this.color;const n="[3"+(i<8?i:"8;5;"+i);const a=`  ${n};1m${r} [0m`;t[0]=a+t[0].split("\n").join("\n"+a);t.push(n+"m+"+e.exports.humanize(this.diff)+"[0m")}else{t[0]=getDate()+r+" "+t[0]}}function getDate(){if(t.inspectOpts.hideDate){return""}return(new Date).toISOString()+" "}function log(...e){return process.stderr.write(n.format(...e)+"\n")}function save(e){if(e){process.env.DEBUG=e}else{delete process.env.DEBUG}}function load(){return process.env.DEBUG}function init(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let i=0;i<r.length;i++){e.inspectOpts[r[i]]=t.inspectOpts[r[i]]}}e.exports=r(7818)(t);const{formatters:a}=e.exports;a.o=function(e){this.inspectOpts.colors=this.useColors;return n.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")};a.O=function(e){this.inspectOpts.colors=this.useColors;return n.inspect(e,this.inspectOpts)}},519:(e,t,r)=>{"use strict";var i=r(2738);var n=r(5078);var a=r(2324);var o=r(3089);var s=r(4174);var c=r(4774);var u=r(8753);var l=r(4135);var d=r(1626);var h=r(6379);var p=r(4991);var v=r(3870);var m=r(1357);var g=r(7538);var y=r(7835);var C=h("ArrayBuffer.prototype.byteLength",true);function isArrayBuffer(e){if(!e||typeof e!=="object"||!C){return false}try{C(e);return true}catch(e){return false}}var T=h("Date.prototype.getTime");var E=Object.getPrototypeOf;var D=h("Object.prototype.toString");var _=d("%Set%",true);var I=h("Map.prototype.has",true);var b=h("Map.prototype.get",true);var w=h("Map.prototype.size",true);var R=h("Set.prototype.add",true);var N=h("Set.prototype.delete",true);var U=h("Set.prototype.has",true);var P=h("Set.prototype.size",true);function setHasEqualElement(e,t,r,i){var n=v(e);var a;while((a=n.next())&&!a.done){if(internalDeepEqual(t,a.value,r,i)){N(e,a.value);return true}}return false}function findLooseMatchingPrimitives(e){if(typeof e==="undefined"){return null}if(typeof e==="object"){return void 0}if(typeof e==="symbol"){return false}if(typeof e==="string"||typeof e==="number"){return+e===+e}return true}function mapMightHaveLoosePrim(e,t,r,i,n,a){var o=findLooseMatchingPrimitives(r);if(o!=null){return o}var s=b(t,o);var c=y({},n,{strict:false});if(typeof s==="undefined"&&!I(t,o)||!internalDeepEqual(i,s,c,a)){return false}return!I(e,o)&&internalDeepEqual(i,s,c,a)}function setMightHaveLoosePrim(e,t,r){var i=findLooseMatchingPrimitives(r);if(i!=null){return i}return U(t,i)&&!U(e,i)}function mapHasEqualEntry(e,t,r,i,n,a){var o=v(e);var s;var c;while((s=o.next())&&!s.done){c=s.value;if(internalDeepEqual(r,c,n,a)&&internalDeepEqual(i,b(t,c),n,a)){N(e,c);return true}}return false}function internalDeepEqual(e,t,r,i){var n=r||{};if(n.strict?a(e,t):e===t){return true}var o=l(e);var s=l(t);if(o!==s){return false}if(!e||!t||typeof e!=="object"&&typeof t!=="object"){return n.strict?a(e,t):e==t}var c=i.has(e);var u=i.has(t);var d;if(c&&u){if(i.get(e)===i.get(t)){return true}}else{d={}}if(!c){i.set(e,d)}if(!u){i.set(t,d)}return objEquiv(e,t,n,i)}function isBuffer(e){if(!e||typeof e!=="object"||typeof e.length!=="number"){return false}if(typeof e.copy!=="function"||typeof e.slice!=="function"){return false}if(e.length>0&&typeof e[0]!=="number"){return false}return!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function setEquiv(e,t,r,i){if(P(e)!==P(t)){return false}var n=v(e);var a=v(t);var o;var s;var c;while((o=n.next())&&!o.done){if(o.value&&typeof o.value==="object"){if(!c){c=new _}R(c,o.value)}else if(!U(t,o.value)){if(r.strict){return false}if(!setMightHaveLoosePrim(e,t,o.value)){return false}if(!c){c=new _}R(c,o.value)}}if(c){while((s=a.next())&&!s.done){if(s.value&&typeof s.value==="object"){if(!setHasEqualElement(c,s.value,r.strict,i)){return false}}else if(!r.strict&&!U(e,s.value)&&!setHasEqualElement(c,s.value,r.strict,i)){return false}}return P(c)===0}return true}function mapEquiv(e,t,r,i){if(w(e)!==w(t)){return false}var n=v(e);var a=v(t);var o;var s;var c;var u;var l;var d;while((o=n.next())&&!o.done){u=o.value[0];l=o.value[1];if(u&&typeof u==="object"){if(!c){c=new _}R(c,u)}else{d=b(t,u);if(typeof d==="undefined"&&!I(t,u)||!internalDeepEqual(l,d,r,i)){if(r.strict){return false}if(!mapMightHaveLoosePrim(e,t,u,l,r,i)){return false}if(!c){c=new _}R(c,u)}}}if(c){while((s=a.next())&&!s.done){u=s.value[0];d=s.value[1];if(u&&typeof u==="object"){if(!mapHasEqualEntry(c,e,u,d,r,i)){return false}}else if(!r.strict&&(!e.has(u)||!internalDeepEqual(b(e,u),d,r,i))&&!mapHasEqualEntry(c,e,u,d,y({},r,{strict:false}),i)){return false}}return P(c)===0}return true}function objEquiv(e,t,r,a){var l,d;if(typeof e!==typeof t){return false}if(e==null||t==null){return false}if(D(e)!==D(t)){return false}if(n(e)!==n(t)){return false}var h=c(e);var v=c(t);if(h!==v){return false}var m=e instanceof Error;var y=t instanceof Error;if(m!==y){return false}if(m||y){if(e.name!==t.name||e.message!==t.message){return false}}var _=o(e);var I=o(t);if(_!==I){return false}if((_||I)&&(e.source!==t.source||s(e)!==s(t))){return false}var b=u(e);var w=u(t);if(b!==w){return false}if(b||w){if(T(e)!==T(t)){return false}}if(r.strict&&E&&E(e)!==E(t)){return false}if(g(e)!==g(t)){return false}var R=isBuffer(e);var N=isBuffer(t);if(R!==N){return false}if(R||N){if(e.length!==t.length){return false}for(l=0;l<e.length;l++){if(e[l]!==t[l]){return false}}return true}var U=isArrayBuffer(e);var P=isArrayBuffer(t);if(U!==P){return false}if(U||P){if(C(e)!==C(t)){return false}return typeof Uint8Array==="function"&&internalDeepEqual(new Uint8Array(e),new Uint8Array(t),r,a)}if(typeof e!==typeof t){return false}var O=i(e);var L=i(t);if(O.length!==L.length){return false}O.sort();L.sort();for(l=O.length-1;l>=0;l--){if(O[l]!=L[l]){return false}}for(l=O.length-1;l>=0;l--){d=O[l];if(!internalDeepEqual(e[d],t[d],r,a)){return false}}var B=p(e);var x=p(t);if(B!==x){return false}if(B==="Set"||x==="Set"){return setEquiv(e,t,r,a)}if(B==="Map"){return mapEquiv(e,t,r,a)}return true}e.exports=function deepEqual(e,t,r){return internalDeepEqual(e,t,r,m())}},9576:(e,t,r)=>{"use strict";var i=r(2738);var n=typeof Symbol==="function"&&typeof Symbol("foo")==="symbol";var a=Object.prototype.toString;var o=Array.prototype.concat;var s=Object.defineProperty;var isFunction=function(e){return typeof e==="function"&&a.call(e)==="[object Function]"};var c=r(6394)();var u=s&&c;var defineProperty=function(e,t,r,i){if(t in e&&(!isFunction(i)||!i())){return}if(u){s(e,t,{configurable:true,enumerable:false,value:r,writable:true})}else{e[t]=r}};var defineProperties=function(e,t){var r=arguments.length>2?arguments[2]:{};var a=i(t);if(n){a=o.call(a,Object.getOwnPropertySymbols(t))}for(var s=0;s<a.length;s+=1){defineProperty(e,a[s],t[a[s]],r[a[s]])}};defineProperties.supportsDescriptors=!!u;e.exports=defineProperties},2104:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+e};t.toClass=function(e){switch(e.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}},9594:(e,t,r)=>{"use strict";const i=r(4300).Buffer;const n=r(6398);const a=r(705);const o=r(7526);const s=r(2104);const c=r(8560);const u=r(6341);const l=0;const d=1<<15;const h=1<<15;const p=~h;const v=1<<15;const m=~v;const g=t.name={};g.encode=function(e,t,r){if(!t)t=i.alloc(g.encodingLength(e));if(!r)r=0;const n=r;const a=e.replace(/^\.|\.$/gm,"");if(a.length){const e=a.split(".");for(let i=0;i<e.length;i++){const n=t.write(e[i],r+1);t[r]=n;r+=n+1}}t[r++]=0;g.encode.bytes=r-n;return t};g.encode.bytes=0;g.decode=function(e,t){if(!t)t=0;const r=[];let i=t;let n=0;let a=0;let o=false;while(true){if(t>=e.length){throw new Error("Cannot decode name (buffer overflow)")}const s=e[t++];a+=o?0:1;if(s===0){break}else if((s&192)===0){if(t+s>e.length){throw new Error("Cannot decode name (buffer overflow)")}n+=s+1;if(n>254){throw new Error("Cannot decode name (name too long)")}r.push(e.toString("utf-8",t,t+s));t+=s;a+=o?0:s}else if((s&192)===192){if(t+1>e.length){throw new Error("Cannot decode name (buffer overflow)")}const r=e.readUInt16BE(t-1)-49152;if(r>=i){throw new Error("Cannot decode name (bad pointer)")}t=r;i=r;a+=o?0:1;o=true}else{throw new Error("Cannot decode name (bad label)")}}g.decode.bytes=a;return r.length===0?".":r.join(".")};g.decode.bytes=0;g.encodingLength=function(e){if(e==="."||e==="..")return 1;return i.byteLength(e.replace(/^\.|\.$/gm,""))+2};const y={};y.encode=function(e,t,r){if(!t)t=i.alloc(y.encodingLength(e));if(!r)r=0;const n=t.write(e,r+1);t[r]=n;y.encode.bytes=n+1;return t};y.encode.bytes=0;y.decode=function(e,t){if(!t)t=0;const r=e[t];const i=e.toString("utf-8",t+1,t+1+r);y.decode.bytes=r+1;return i};y.decode.bytes=0;y.encodingLength=function(e){return i.byteLength(e)+1};const C={};C.encode=function(e,t,r){if(!t)t=C.encodingLength(e);if(!r)r=0;const i=(e.flags||0)&32767;const n=e.type==="response"?d:l;t.writeUInt16BE(e.id||0,r);t.writeUInt16BE(i|n,r+2);t.writeUInt16BE(e.questions.length,r+4);t.writeUInt16BE(e.answers.length,r+6);t.writeUInt16BE(e.authorities.length,r+8);t.writeUInt16BE(e.additionals.length,r+10);return t};C.encode.bytes=12;C.decode=function(e,t){if(!t)t=0;if(e.length<12)throw new Error("Header must be 12 bytes");const r=e.readUInt16BE(t+2);return{id:e.readUInt16BE(t),type:r&d?"response":"query",flags:r&32767,flag_qr:(r>>15&1)===1,opcode:o.toString(r>>11&15),flag_aa:(r>>10&1)===1,flag_tc:(r>>9&1)===1,flag_rd:(r>>8&1)===1,flag_ra:(r>>7&1)===1,flag_z:(r>>6&1)===1,flag_ad:(r>>5&1)===1,flag_cd:(r>>4&1)===1,rcode:a.toString(r&15),questions:new Array(e.readUInt16BE(t+4)),answers:new Array(e.readUInt16BE(t+6)),authorities:new Array(e.readUInt16BE(t+8)),additionals:new Array(e.readUInt16BE(t+10))}};C.decode.bytes=12;C.encodingLength=function(){return 12};const T=t.unknown={};T.encode=function(e,t,r){if(!t)t=i.alloc(T.encodingLength(e));if(!r)r=0;t.writeUInt16BE(e.length,r);e.copy(t,r+2);T.encode.bytes=e.length+2;return t};T.encode.bytes=0;T.decode=function(e,t){if(!t)t=0;const r=e.readUInt16BE(t);const i=e.slice(t+2,t+2+r);T.decode.bytes=r+2;return i};T.decode.bytes=0;T.encodingLength=function(e){return e.length+2};const E=t.ns={};E.encode=function(e,t,r){if(!t)t=i.alloc(E.encodingLength(e));if(!r)r=0;g.encode(e,t,r+2);t.writeUInt16BE(g.encode.bytes,r);E.encode.bytes=g.encode.bytes+2;return t};E.encode.bytes=0;E.decode=function(e,t){if(!t)t=0;const r=e.readUInt16BE(t);const i=g.decode(e,t+2);E.decode.bytes=r+2;return i};E.decode.bytes=0;E.encodingLength=function(e){return g.encodingLength(e)+2};const D=t.soa={};D.encode=function(e,t,r){if(!t)t=i.alloc(D.encodingLength(e));if(!r)r=0;const n=r;r+=2;g.encode(e.mname,t,r);r+=g.encode.bytes;g.encode(e.rname,t,r);r+=g.encode.bytes;t.writeUInt32BE(e.serial||0,r);r+=4;t.writeUInt32BE(e.refresh||0,r);r+=4;t.writeUInt32BE(e.retry||0,r);r+=4;t.writeUInt32BE(e.expire||0,r);r+=4;t.writeUInt32BE(e.minimum||0,r);r+=4;t.writeUInt16BE(r-n-2,n);D.encode.bytes=r-n;return t};D.encode.bytes=0;D.decode=function(e,t){if(!t)t=0;const r=t;const i={};t+=2;i.mname=g.decode(e,t);t+=g.decode.bytes;i.rname=g.decode(e,t);t+=g.decode.bytes;i.serial=e.readUInt32BE(t);t+=4;i.refresh=e.readUInt32BE(t);t+=4;i.retry=e.readUInt32BE(t);t+=4;i.expire=e.readUInt32BE(t);t+=4;i.minimum=e.readUInt32BE(t);t+=4;D.decode.bytes=t-r;return i};D.decode.bytes=0;D.encodingLength=function(e){return 22+g.encodingLength(e.mname)+g.encodingLength(e.rname)};const _=t.txt={};_.encode=function(e,t,r){if(!Array.isArray(e))e=[e];for(let t=0;t<e.length;t++){if(typeof e[t]==="string"){e[t]=i.from(e[t])}if(!i.isBuffer(e[t])){throw new Error("Must be a Buffer")}}if(!t)t=i.alloc(_.encodingLength(e));if(!r)r=0;const n=r;r+=2;e.forEach((function(e){t[r++]=e.length;e.copy(t,r,0,e.length);r+=e.length}));t.writeUInt16BE(r-n-2,n);_.encode.bytes=r-n;return t};_.encode.bytes=0;_.decode=function(e,t){if(!t)t=0;const r=t;let i=e.readUInt16BE(t);t+=2;let n=[];while(i>0){const r=e[t++];--i;if(i<r){throw new Error("Buffer overflow")}n.push(e.slice(t,t+r));t+=r;i-=r}_.decode.bytes=t-r;return n};_.decode.bytes=0;_.encodingLength=function(e){if(!Array.isArray(e))e=[e];let t=2;e.forEach((function(e){if(typeof e==="string"){t+=i.byteLength(e)+1}else{t+=e.length+1}}));return t};const I=t["null"]={};I.encode=function(e,t,r){if(!t)t=i.alloc(I.encodingLength(e));if(!r)r=0;if(typeof e==="string")e=i.from(e);if(!e)e=i.alloc(0);const n=r;r+=2;const a=e.length;e.copy(t,r,0,a);r+=a;t.writeUInt16BE(r-n-2,n);I.encode.bytes=r-n;return t};I.encode.bytes=0;I.decode=function(e,t){if(!t)t=0;const r=t;const i=e.readUInt16BE(t);t+=2;const n=e.slice(t,t+i);t+=i;I.decode.bytes=t-r;return n};I.decode.bytes=0;I.encodingLength=function(e){if(!e)return 2;return(i.isBuffer(e)?e.length:i.byteLength(e))+2};const b=t.hinfo={};b.encode=function(e,t,r){if(!t)t=i.alloc(b.encodingLength(e));if(!r)r=0;const n=r;r+=2;y.encode(e.cpu,t,r);r+=y.encode.bytes;y.encode(e.os,t,r);r+=y.encode.bytes;t.writeUInt16BE(r-n-2,n);b.encode.bytes=r-n;return t};b.encode.bytes=0;b.decode=function(e,t){if(!t)t=0;const r=t;const i={};t+=2;i.cpu=y.decode(e,t);t+=y.decode.bytes;i.os=y.decode(e,t);t+=y.decode.bytes;b.decode.bytes=t-r;return i};b.decode.bytes=0;b.encodingLength=function(e){return y.encodingLength(e.cpu)+y.encodingLength(e.os)+2};const w=t.ptr={};const R=t.cname=w;const N=t.dname=w;w.encode=function(e,t,r){if(!t)t=i.alloc(w.encodingLength(e));if(!r)r=0;g.encode(e,t,r+2);t.writeUInt16BE(g.encode.bytes,r);w.encode.bytes=g.encode.bytes+2;return t};w.encode.bytes=0;w.decode=function(e,t){if(!t)t=0;const r=g.decode(e,t+2);w.decode.bytes=g.decode.bytes+2;return r};w.decode.bytes=0;w.encodingLength=function(e){return g.encodingLength(e)+2};const U=t.srv={};U.encode=function(e,t,r){if(!t)t=i.alloc(U.encodingLength(e));if(!r)r=0;t.writeUInt16BE(e.priority||0,r+2);t.writeUInt16BE(e.weight||0,r+4);t.writeUInt16BE(e.port||0,r+6);g.encode(e.target,t,r+8);const n=g.encode.bytes+6;t.writeUInt16BE(n,r);U.encode.bytes=n+2;return t};U.encode.bytes=0;U.decode=function(e,t){if(!t)t=0;const r=e.readUInt16BE(t);const i={};i.priority=e.readUInt16BE(t+2);i.weight=e.readUInt16BE(t+4);i.port=e.readUInt16BE(t+6);i.target=g.decode(e,t+8);U.decode.bytes=r+2;return i};U.decode.bytes=0;U.encodingLength=function(e){return 8+g.encodingLength(e.target)};const P=t.caa={};P.ISSUER_CRITICAL=1<<7;P.encode=function(e,t,r){const n=P.encodingLength(e);if(!t)t=i.alloc(P.encodingLength(e));if(!r)r=0;if(e.issuerCritical){e.flags=P.ISSUER_CRITICAL}t.writeUInt16BE(n-2,r);r+=2;t.writeUInt8(e.flags||0,r);r+=1;y.encode(e.tag,t,r);r+=y.encode.bytes;t.write(e.value,r);r+=i.byteLength(e.value);P.encode.bytes=n;return t};P.encode.bytes=0;P.decode=function(e,t){if(!t)t=0;const r=e.readUInt16BE(t);t+=2;const i=t;const n={};n.flags=e.readUInt8(t);t+=1;n.tag=y.decode(e,t);t+=y.decode.bytes;n.value=e.toString("utf-8",t,i+r);n.issuerCritical=!!(n.flags&P.ISSUER_CRITICAL);P.decode.bytes=r+2;return n};P.decode.bytes=0;P.encodingLength=function(e){return y.encodingLength(e.tag)+y.encodingLength(e.value)+2};const O=t.mx={};O.encode=function(e,t,r){if(!t)t=i.alloc(O.encodingLength(e));if(!r)r=0;const n=r;r+=2;t.writeUInt16BE(e.preference||0,r);r+=2;g.encode(e.exchange,t,r);r+=g.encode.bytes;t.writeUInt16BE(r-n-2,n);O.encode.bytes=r-n;return t};O.encode.bytes=0;O.decode=function(e,t){if(!t)t=0;const r=t;const i={};t+=2;i.preference=e.readUInt16BE(t);t+=2;i.exchange=g.decode(e,t);t+=g.decode.bytes;O.decode.bytes=t-r;return i};O.encodingLength=function(e){return 4+g.encodingLength(e.exchange)};const L=t.a={};L.encode=function(e,t,r){if(!t)t=i.alloc(L.encodingLength(e));if(!r)r=0;t.writeUInt16BE(4,r);r+=2;u.v4.encode(e,t,r);L.encode.bytes=6;return t};L.encode.bytes=0;L.decode=function(e,t){if(!t)t=0;t+=2;const r=u.v4.decode(e,t);L.decode.bytes=6;return r};L.decode.bytes=0;L.encodingLength=function(){return 6};const B=t.aaaa={};B.encode=function(e,t,r){if(!t)t=i.alloc(B.encodingLength(e));if(!r)r=0;t.writeUInt16BE(16,r);r+=2;u.v6.encode(e,t,r);B.encode.bytes=18;return t};B.encode.bytes=0;B.decode=function(e,t){if(!t)t=0;t+=2;const r=u.v6.decode(e,t);B.decode.bytes=18;return r};B.decode.bytes=0;B.encodingLength=function(){return 18};const x=t.option={};x.encode=function(e,t,r){if(!t)t=i.alloc(x.encodingLength(e));if(!r)r=0;const n=r;const a=c.toCode(e.code);t.writeUInt16BE(a,r);r+=2;if(e.data){t.writeUInt16BE(e.data.length,r);r+=2;e.data.copy(t,r);r+=e.data.length}else{switch(a){case 8:const n=e.sourcePrefixLength||0;const a=e.family||u.familyOf(e.ip);const o=u.encode(e.ip,i.alloc);const s=Math.ceil(n/8);t.writeUInt16BE(s+4,r);r+=2;t.writeUInt16BE(a,r);r+=2;t.writeUInt8(n,r++);t.writeUInt8(e.scopePrefixLength||0,r++);o.copy(t,r,0,s);r+=s;break;case 11:if(e.timeout){t.writeUInt16BE(2,r);r+=2;t.writeUInt16BE(e.timeout,r);r+=2}else{t.writeUInt16BE(0,r);r+=2}break;case 12:const c=e.length||0;t.writeUInt16BE(c,r);r+=2;t.fill(0,r,r+c);r+=c;break;case 14:const l=e.tags.length*2;t.writeUInt16BE(l,r);r+=2;for(const i of e.tags){t.writeUInt16BE(i,r);r+=2}break;default:throw new Error(`Unknown roption code: ${e.code}`)}}x.encode.bytes=r-n;return t};x.encode.bytes=0;x.decode=function(e,t){if(!t)t=0;const r={};r.code=e.readUInt16BE(t);r.type=c.toString(r.code);t+=2;const n=e.readUInt16BE(t);t+=2;r.data=e.slice(t,t+n);switch(r.code){case 8:r.family=e.readUInt16BE(t);t+=2;r.sourcePrefixLength=e.readUInt8(t++);r.scopePrefixLength=e.readUInt8(t++);const a=i.alloc(r.family===1?4:16);e.copy(a,0,t,t+n-4);r.ip=u.decode(a);break;case 11:if(n>0){r.timeout=e.readUInt16BE(t);t+=2}break;case 14:r.tags=[];for(let i=0;i<n;i+=2){r.tags.push(e.readUInt16BE(t));t+=2}}x.decode.bytes=n+4;return r};x.decode.bytes=0;x.encodingLength=function(e){if(e.data){return e.data.length+4}const t=c.toCode(e.code);switch(t){case 8:const t=e.sourcePrefixLength||0;return Math.ceil(t/8)+8;case 11:return typeof e.timeout==="number"?6:4;case 12:return e.length+4;case 14:return 4+e.tags.length*2}throw new Error(`Unknown roption code: ${e.code}`)};const k=t.opt={};k.encode=function(e,t,r){if(!t)t=i.alloc(k.encodingLength(e));if(!r)r=0;const n=r;const a=encodingLengthList(e,x);t.writeUInt16BE(a,r);r=encodeList(e,x,t,r+2);k.encode.bytes=r-n;return t};k.encode.bytes=0;k.decode=function(e,t){if(!t)t=0;const r=t;const i=[];let n=e.readUInt16BE(t);t+=2;let a=0;while(n>0){i[a++]=x.decode(e,t);t+=x.decode.bytes;n-=x.decode.bytes}k.decode.bytes=t-r;return i};k.decode.bytes=0;k.encodingLength=function(e){return 2+encodingLengthList(e||[],x)};const V=t.dnskey={};V.PROTOCOL_DNSSEC=3;V.ZONE_KEY=128;V.SECURE_ENTRYPOINT=32768;V.encode=function(e,t,r){if(!t)t=i.alloc(V.encodingLength(e));if(!r)r=0;const n=r;const a=e.key;if(!i.isBuffer(a)){throw new Error("Key must be a Buffer")}r+=2;t.writeUInt16BE(e.flags,r);r+=2;t.writeUInt8(V.PROTOCOL_DNSSEC,r);r+=1;t.writeUInt8(e.algorithm,r);r+=1;a.copy(t,r,0,a.length);r+=a.length;V.encode.bytes=r-n;t.writeUInt16BE(V.encode.bytes-2,n);return t};V.encode.bytes=0;V.decode=function(e,t){if(!t)t=0;const r=t;var i={};var n=e.readUInt16BE(t);t+=2;i.flags=e.readUInt16BE(t);t+=2;if(e.readUInt8(t)!==V.PROTOCOL_DNSSEC){throw new Error("Protocol must be 3")}t+=1;i.algorithm=e.readUInt8(t);t+=1;i.key=e.slice(t,r+n+2);t+=i.key.length;V.decode.bytes=t-r;return i};V.decode.bytes=0;V.encodingLength=function(e){return 6+i.byteLength(e.key)};const H=t.rrsig={};H.encode=function(e,t,r){if(!t)t=i.alloc(H.encodingLength(e));if(!r)r=0;const a=r;const o=e.signature;if(!i.isBuffer(o)){throw new Error("Signature must be a Buffer")}r+=2;t.writeUInt16BE(n.toType(e.typeCovered),r);r+=2;t.writeUInt8(e.algorithm,r);r+=1;t.writeUInt8(e.labels,r);r+=1;t.writeUInt32BE(e.originalTTL,r);r+=4;t.writeUInt32BE(e.expiration,r);r+=4;t.writeUInt32BE(e.inception,r);r+=4;t.writeUInt16BE(e.keyTag,r);r+=2;g.encode(e.signersName,t,r);r+=g.encode.bytes;o.copy(t,r,0,o.length);r+=o.length;H.encode.bytes=r-a;t.writeUInt16BE(H.encode.bytes-2,a);return t};H.encode.bytes=0;H.decode=function(e,t){if(!t)t=0;const r=t;var i={};var a=e.readUInt16BE(t);t+=2;i.typeCovered=n.toString(e.readUInt16BE(t));t+=2;i.algorithm=e.readUInt8(t);t+=1;i.labels=e.readUInt8(t);t+=1;i.originalTTL=e.readUInt32BE(t);t+=4;i.expiration=e.readUInt32BE(t);t+=4;i.inception=e.readUInt32BE(t);t+=4;i.keyTag=e.readUInt16BE(t);t+=2;i.signersName=g.decode(e,t);t+=g.decode.bytes;i.signature=e.slice(t,r+a+2);t+=i.signature.length;H.decode.bytes=t-r;return i};H.decode.bytes=0;H.encodingLength=function(e){return 20+g.encodingLength(e.signersName)+i.byteLength(e.signature)};const j=t.rp={};j.encode=function(e,t,r){if(!t)t=i.alloc(j.encodingLength(e));if(!r)r=0;const n=r;r+=2;g.encode(e.mbox||".",t,r);r+=g.encode.bytes;g.encode(e.txt||".",t,r);r+=g.encode.bytes;j.encode.bytes=r-n;t.writeUInt16BE(j.encode.bytes-2,n);return t};j.encode.bytes=0;j.decode=function(e,t){if(!t)t=0;const r=t;const i={};t+=2;i.mbox=g.decode(e,t)||".";t+=g.decode.bytes;i.txt=g.decode(e,t)||".";t+=g.decode.bytes;j.decode.bytes=t-r;return i};j.decode.bytes=0;j.encodingLength=function(e){return 2+g.encodingLength(e.mbox||".")+g.encodingLength(e.txt||".")};const W={};W.encode=function(e,t,r){if(!t)t=i.alloc(W.encodingLength(e));if(!r)r=0;const a=r;var o=[];for(var s=0;s<e.length;s++){var c=n.toType(e[s]);if(o[c>>8]===undefined){o[c>>8]=[]}o[c>>8][c>>3&31]|=1<<7-(c&7)}for(s=0;s<o.length;s++){if(o[s]!==undefined){var u=i.from(o[s]);t.writeUInt8(s,r);r+=1;t.writeUInt8(u.length,r);r+=1;u.copy(t,r);r+=u.length}}W.encode.bytes=r-a;return t};W.encode.bytes=0;W.decode=function(e,t,r){if(!t)t=0;const i=t;var a=[];while(t-i<r){var o=e.readUInt8(t);t+=1;var s=e.readUInt8(t);t+=1;for(var c=0;c<s;c++){var u=e.readUInt8(t+c);for(var l=0;l<8;l++){if(u&1<<7-l){var d=n.toString(o<<8|c<<3|l);a.push(d)}}}t+=s}W.decode.bytes=t-i;return a};W.decode.bytes=0;W.encodingLength=function(e){var t=[];for(var r=0;r<e.length;r++){var i=n.toType(e[r]);t[i>>8]=Math.max(t[i>>8]||0,i&255)}var a=0;for(r=0;r<t.length;r++){if(t[r]!==undefined){a+=2+Math.ceil((t[r]+1)/8)}}return a};const G=t.nsec={};G.encode=function(e,t,r){if(!t)t=i.alloc(G.encodingLength(e));if(!r)r=0;const n=r;r+=2;g.encode(e.nextDomain,t,r);r+=g.encode.bytes;W.encode(e.rrtypes,t,r);r+=W.encode.bytes;G.encode.bytes=r-n;t.writeUInt16BE(G.encode.bytes-2,n);return t};G.encode.bytes=0;G.decode=function(e,t){if(!t)t=0;const r=t;var i={};var n=e.readUInt16BE(t);t+=2;i.nextDomain=g.decode(e,t);t+=g.decode.bytes;i.rrtypes=W.decode(e,t,n-(t-r));t+=W.decode.bytes;G.decode.bytes=t-r;return i};G.decode.bytes=0;G.encodingLength=function(e){return 2+g.encodingLength(e.nextDomain)+W.encodingLength(e.rrtypes)};const X=t.nsec3={};X.encode=function(e,t,r){if(!t)t=i.alloc(X.encodingLength(e));if(!r)r=0;const n=r;const a=e.salt;if(!i.isBuffer(a)){throw new Error("salt must be a Buffer")}const o=e.nextDomain;if(!i.isBuffer(o)){throw new Error("nextDomain must be a Buffer")}r+=2;t.writeUInt8(e.algorithm,r);r+=1;t.writeUInt8(e.flags,r);r+=1;t.writeUInt16BE(e.iterations,r);r+=2;t.writeUInt8(a.length,r);r+=1;a.copy(t,r,0,a.length);r+=a.length;t.writeUInt8(o.length,r);r+=1;o.copy(t,r,0,o.length);r+=o.length;W.encode(e.rrtypes,t,r);r+=W.encode.bytes;X.encode.bytes=r-n;t.writeUInt16BE(X.encode.bytes-2,n);return t};X.encode.bytes=0;X.decode=function(e,t){if(!t)t=0;const r=t;var i={};var n=e.readUInt16BE(t);t+=2;i.algorithm=e.readUInt8(t);t+=1;i.flags=e.readUInt8(t);t+=1;i.iterations=e.readUInt16BE(t);t+=2;const a=e.readUInt8(t);t+=1;i.salt=e.slice(t,t+a);t+=a;const o=e.readUInt8(t);t+=1;i.nextDomain=e.slice(t,t+o);t+=o;i.rrtypes=W.decode(e,t,n-(t-r));t+=W.decode.bytes;X.decode.bytes=t-r;return i};X.decode.bytes=0;X.encodingLength=function(e){return 8+e.salt.length+e.nextDomain.length+W.encodingLength(e.rrtypes)};const q=t.ds={};q.encode=function(e,t,r){if(!t)t=i.alloc(q.encodingLength(e));if(!r)r=0;const n=r;const a=e.digest;if(!i.isBuffer(a)){throw new Error("Digest must be a Buffer")}r+=2;t.writeUInt16BE(e.keyTag,r);r+=2;t.writeUInt8(e.algorithm,r);r+=1;t.writeUInt8(e.digestType,r);r+=1;a.copy(t,r,0,a.length);r+=a.length;q.encode.bytes=r-n;t.writeUInt16BE(q.encode.bytes-2,n);return t};q.encode.bytes=0;q.decode=function(e,t){if(!t)t=0;const r=t;var i={};var n=e.readUInt16BE(t);t+=2;i.keyTag=e.readUInt16BE(t);t+=2;i.algorithm=e.readUInt8(t);t+=1;i.digestType=e.readUInt8(t);t+=1;i.digest=e.slice(t,r+n+2);t+=i.digest.length;q.decode.bytes=t-r;return i};q.decode.bytes=0;q.encodingLength=function(e){return 6+i.byteLength(e.digest)};const Y=t.sshfp={};Y.getFingerprintLengthForHashType=function getFingerprintLengthForHashType(e){switch(e){case 1:return 20;case 2:return 32}};Y.encode=function encode(e,t,r){if(!t)t=i.alloc(Y.encodingLength(e));if(!r)r=0;const n=r;r+=2;t[r]=e.algorithm;r+=1;t[r]=e.hash;r+=1;const a=i.from(e.fingerprint.toUpperCase(),"hex");if(a.length!==Y.getFingerprintLengthForHashType(e.hash)){throw new Error("Invalid fingerprint length")}a.copy(t,r);r+=a.byteLength;Y.encode.bytes=r-n;t.writeUInt16BE(Y.encode.bytes-2,n);return t};Y.encode.bytes=0;Y.decode=function decode(e,t){if(!t)t=0;const r=t;const i={};t+=2;i.algorithm=e[t];t+=1;i.hash=e[t];t+=1;const n=Y.getFingerprintLengthForHashType(i.hash);i.fingerprint=e.slice(t,t+n).toString("hex").toUpperCase();t+=n;Y.decode.bytes=t-r;return i};Y.decode.bytes=0;Y.encodingLength=function(e){return 4+i.from(e.fingerprint,"hex").byteLength};const K=t.record=function(e){switch(e.toUpperCase()){case"A":return L;case"PTR":return w;case"CNAME":return R;case"DNAME":return N;case"TXT":return _;case"NULL":return I;case"AAAA":return B;case"SRV":return U;case"HINFO":return b;case"CAA":return P;case"NS":return E;case"SOA":return D;case"MX":return O;case"OPT":return k;case"DNSKEY":return V;case"RRSIG":return H;case"RP":return j;case"NSEC":return G;case"NSEC3":return X;case"SSHFP":return Y;case"DS":return q}return T};const $=t.answer={};$.encode=function(e,t,r){if(!t)t=i.alloc($.encodingLength(e));if(!r)r=0;const a=r;g.encode(e.name,t,r);r+=g.encode.bytes;t.writeUInt16BE(n.toType(e.type),r);if(e.type.toUpperCase()==="OPT"){if(e.name!=="."){throw new Error("OPT name must be root.")}t.writeUInt16BE(e.udpPayloadSize||4096,r+2);t.writeUInt8(e.extendedRcode||0,r+4);t.writeUInt8(e.ednsVersion||0,r+5);t.writeUInt16BE(e.flags||0,r+6);r+=8;k.encode(e.options||[],t,r);r+=k.encode.bytes}else{let i=s.toClass(e.class===undefined?"IN":e.class);if(e.flush)i|=h;t.writeUInt16BE(i,r+2);t.writeUInt32BE(e.ttl||0,r+4);r+=8;const n=K(e.type);n.encode(e.data,t,r);r+=n.encode.bytes}$.encode.bytes=r-a;return t};$.encode.bytes=0;$.decode=function(e,t){if(!t)t=0;const r={};const i=t;r.name=g.decode(e,t);t+=g.decode.bytes;r.type=n.toString(e.readUInt16BE(t));if(r.type==="OPT"){r.udpPayloadSize=e.readUInt16BE(t+2);r.extendedRcode=e.readUInt8(t+4);r.ednsVersion=e.readUInt8(t+5);r.flags=e.readUInt16BE(t+6);r.flag_do=(r.flags>>15&1)===1;r.options=k.decode(e,t+8);t+=8+k.decode.bytes}else{const i=e.readUInt16BE(t+2);r.ttl=e.readUInt32BE(t+4);r.class=s.toString(i&p);r.flush=!!(i&h);const n=K(r.type);r.data=n.decode(e,t+8);t+=8+n.decode.bytes}$.decode.bytes=t-i;return r};$.decode.bytes=0;$.encodingLength=function(e){const t=e.data!==null&&e.data!==undefined?e.data:e.options;return g.encodingLength(e.name)+8+K(e.type).encodingLength(t)};const z=t.question={};z.encode=function(e,t,r){if(!t)t=i.alloc(z.encodingLength(e));if(!r)r=0;const a=r;g.encode(e.name,t,r);r+=g.encode.bytes;t.writeUInt16BE(n.toType(e.type),r);r+=2;t.writeUInt16BE(s.toClass(e.class===undefined?"IN":e.class),r);r+=2;z.encode.bytes=r-a;return e};z.encode.bytes=0;z.decode=function(e,t){if(!t)t=0;const r=t;const i={};i.name=g.decode(e,t);t+=g.decode.bytes;i.type=n.toString(e.readUInt16BE(t));t+=2;i.class=s.toString(e.readUInt16BE(t));t+=2;const a=!!(i.class&v);if(a)i.class&=m;z.decode.bytes=t-r;return i};z.decode.bytes=0;z.encodingLength=function(e){return g.encodingLength(e.name)+4};t.AUTHORITATIVE_ANSWER=1<<10;t.TRUNCATED_RESPONSE=1<<9;t.RECURSION_DESIRED=1<<8;t.RECURSION_AVAILABLE=1<<7;t.AUTHENTIC_DATA=1<<5;t.CHECKING_DISABLED=1<<4;t.DNSSEC_OK=1<<15;t.encode=function(e,r,n){const a=!r;if(a)r=i.alloc(t.encodingLength(e));if(!n)n=0;const o=n;if(!e.questions)e.questions=[];if(!e.answers)e.answers=[];if(!e.authorities)e.authorities=[];if(!e.additionals)e.additionals=[];C.encode(e,r,n);n+=C.encode.bytes;n=encodeList(e.questions,z,r,n);n=encodeList(e.answers,$,r,n);n=encodeList(e.authorities,$,r,n);n=encodeList(e.additionals,$,r,n);t.encode.bytes=n-o;if(a&&t.encode.bytes!==r.length){return r.slice(0,t.encode.bytes)}return r};t.encode.bytes=0;t.decode=function(e,r){if(!r)r=0;const i=r;const n=C.decode(e,r);r+=C.decode.bytes;r=decodeList(n.questions,z,e,r);r=decodeList(n.answers,$,e,r);r=decodeList(n.authorities,$,e,r);r=decodeList(n.additionals,$,e,r);t.decode.bytes=r-i;return n};t.decode.bytes=0;t.encodingLength=function(e){return C.encodingLength(e)+encodingLengthList(e.questions||[],z)+encodingLengthList(e.answers||[],$)+encodingLengthList(e.authorities||[],$)+encodingLengthList(e.additionals||[],$)};t.streamEncode=function(e){const r=t.encode(e);const n=i.alloc(2);n.writeUInt16BE(r.byteLength);const a=i.concat([n,r]);t.streamEncode.bytes=a.byteLength;return a};t.streamEncode.bytes=0;t.streamDecode=function(e){const r=e.readUInt16BE(0);if(e.byteLength<r+2){return null}const i=t.decode(e.slice(2));t.streamDecode.bytes=t.decode.bytes;return i};t.streamDecode.bytes=0;function encodingLengthList(e,t){let r=0;for(let i=0;i<e.length;i++)r+=t.encodingLength(e[i]);return r}function encodeList(e,t,r,i){for(let n=0;n<e.length;n++){t.encode(e[n],r,i);i+=t.encode.bytes}return i}function decodeList(e,t,r,i){for(let n=0;n<e.length;n++){e[n]=t.decode(r,i);i+=t.decode.bytes}return i}},7526:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+e};t.toOpcode=function(e){switch(e.toUpperCase()){case"QUERY":return 0;case"IQUERY":return 1;case"STATUS":return 2;case"OPCODE_3":return 3;case"NOTIFY":return 4;case"UPDATE":return 5;case"OPCODE_6":return 6;case"OPCODE_7":return 7;case"OPCODE_8":return 8;case"OPCODE_9":return 9;case"OPCODE_10":return 10;case"OPCODE_11":return 11;case"OPCODE_12":return 12;case"OPCODE_13":return 13;case"OPCODE_14":return 14;case"OPCODE_15":return 15}return 0}},8560:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}if(e<0){return null}return`OPTION_${e}`};t.toCode=function(e){if(typeof e==="number"){return e}if(!e){return-1}switch(e.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}const t=e.match(/_(\d+)$/);if(t){return parseInt(t[1],10)}return-1}},705:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+e};t.toRcode=function(e){switch(e.toUpperCase()){case"NOERROR":return 0;case"FORMERR":return 1;case"SERVFAIL":return 2;case"NXDOMAIN":return 3;case"NOTIMP":return 4;case"REFUSED":return 5;case"YXDOMAIN":return 6;case"YXRRSET":return 7;case"NXRRSET":return 8;case"NOTAUTH":return 9;case"NOTZONE":return 10;case"RCODE_11":return 11;case"RCODE_12":return 12;case"RCODE_13":return 13;case"RCODE_14":return 14;case"RCODE_15":return 15}return 0}},6398:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+e};t.toType=function(e){switch(e.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":return 255;case"*":return 255}if(e.toUpperCase().startsWith("UNKNOWN_"))return parseInt(e.slice(8));return 0}},9376:(e,t,r)=>{var i=r(2781);var n=["write","end","destroy"];var a=["resume","pause"];var o=["data","close"];var s=Array.prototype.slice;e.exports=duplex;function forEach(e,t){if(e.forEach){return e.forEach(t)}for(var r=0;r<e.length;r++){t(e[r],r)}}function duplex(e,t){var r=new i;var c=false;forEach(n,proxyWriter);forEach(a,proxyReader);forEach(o,proxyStream);t.on("end",handleEnd);e.on("drain",(function(){r.emit("drain")}));e.on("error",reemit);t.on("error",reemit);r.writable=e.writable;r.readable=t.readable;return r;function proxyWriter(t){r[t]=method;function method(){return e[t].apply(e,arguments)}}function proxyReader(e){r[e]=method;function method(){r.emit(e);var i=t[e];if(i){return i.apply(t,arguments)}t.emit(e)}}function proxyStream(e){t.on(e,reemit);function reemit(){var t=s.call(arguments);t.unshift(e);r.emit.apply(r,t)}}function handleEnd(){if(c){return}c=true;var e=s.call(arguments);e.unshift("end");r.emit.apply(r,e)}function reemit(e){r.emit("error",e)}}},781:(e,t,r)=>{var i=r(2781).Stream,n=t,a=r(4306),o=r(3670),s=r(9376),c=r(6582),u=r(1566),l=r(7607),d=r(6659),h=global.setImmediate||process.nextTick;n.Stream=i;n.through=a;n.from=o;n.duplex=s;n.map=c;n.pause=u;n.split=l;n.pipeline=n.connect=n.pipe=d;n.concat=n.merge=function(){var e=[].slice.call(arguments);if(e.length===1&&e[0]instanceof Array){e=e[0]}var t=new i;t.setMaxListeners(0);var r=0;t.writable=t.readable=true;if(e.length){e.forEach((function(i){i.pipe(t,{end:false});var n=false;i.on("end",(function(){if(n)return;n=true;r++;if(r==e.length)t.emit("end")}))}))}else{process.nextTick((function(){t.emit("end")}))}t.write=function(e){this.emit("data",e)};t.destroy=function(){e.forEach((function(e){if(e.destroy)e.destroy()}))};return t};n.collect=n.writeArray=function(e){if("function"!==typeof e)throw new Error("function writeArray (done): done must be function");var t=new i,r=[],n=false;t.write=function(e){r.push(e)};t.end=function(){n=true;e(null,r)};t.writable=true;t.readable=false;t.destroy=function(){t.writable=t.readable=false;if(n)return;e(new Error("destroyed before end"),r)};return t};n.readArray=function(e){var t=new i,r=0,n=false,a=false;t.readable=true;t.writable=false;if(!Array.isArray(e))throw new Error("event-stream.read expects an array");t.resume=function(){if(a)return;n=false;var i=e.length;while(r<i&&!n&&!a){t.emit("data",e[r++])}if(r==i&&!a)a=true,t.readable=false,t.emit("end")};process.nextTick(t.resume);t.pause=function(){n=true};t.destroy=function(){a=true;t.emit("close")};return t};n.readable=function(e,t){var r=new i,n=0,a=false,o=false,s=false;r.readable=true;r.writable=false;if("function"!==typeof e)throw new Error("event-stream.readable expects async function");r.on("end",(function(){o=true}));function get(i,c){if(i){r.emit("error",i);if(!t)r.emit("end")}else if(arguments.length>1)r.emit("data",c);h((function(){if(o||a||s)return;try{s=true;e.call(r,n++,(function(){s=false;get.apply(null,arguments)}))}catch(e){r.emit("error",e)}}))}r.resume=function(){a=false;get()};process.nextTick(get);r.pause=function(){a=true};r.destroy=function(){r.emit("end");r.emit("close");o=true};return r};n.mapSync=function(e){return n.through((function write(t){var r;try{r=e(t)}catch(e){return this.emit("error",e)}if(r!==undefined)this.emit("data",r)}))};n.filterSync=function(e){return n.through((function(t){var r=this;if(e(t)){r.queue(t)}}))};n.flatmapSync=function(e){return n.through((function(t){var r=this;t.forEach((function(t){r.queue(e(t))}))}))};n.log=function(e){return n.through((function(t){var r=[].slice.call(arguments);if(e)console.error(e,t);else console.error(t);this.emit("data",t)}))};n.child=function(e){return n.duplex(e.stdin,e.stdout)};n.parse=function(e){var t=!!(e?e.error:false);return n.through((function(e){var r;try{if(e)r=JSON.parse(e.toString())}catch(r){if(t)return this.emit("error",r);return console.error(r,"attempting to parse:",e)}if(r!==undefined)this.emit("data",r)}))};n.stringify=function(){var e=r(4300).Buffer;return n.mapSync((function(t){return JSON.stringify(e.isBuffer(t)?t.toString():t)+"\n"}))};n.replace=function(e,t){return n.pipeline(n.split(e),n.join(t))};n.join=function(e){if("function"===typeof e)return n.wait(e);var t=true;return n.through((function(r){if(!t)this.emit("data",e);t=false;this.emit("data",r);return true}))};n.wait=function(e){var t=[];return n.through((function(e){t.push(e)}),(function(){var r=Buffer.isBuffer(t[0])?Buffer.concat(t):t.join("");this.emit("data",r);this.emit("end");if(e)e(null,r)}))};n.pipeable=function(){throw new Error("[EVENT-STREAM] es.pipeable is deprecated")}},2409:e=>{"use strict";e.exports=function equal(e,t){if(e===t)return true;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return false;var r,i,n;if(Array.isArray(e)){r=e.length;if(r!=t.length)return false;for(i=r;i--!==0;)if(!equal(e[i],t[i]))return false;return true}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();n=Object.keys(e);r=n.length;if(r!==Object.keys(t).length)return false;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,n[i]))return false;for(i=r;i--!==0;){var a=n[i];if(!equal(e[a],t[a]))return false}return true}return e!==e&&t!==t}},4319:(e,t,r)=>{var i=r(6113);var n;var a=0xdeadbeefcafe;var o=(a&16777215)==15715070;function BigInteger(e,t){if(e!=null){if("number"==typeof e){this.fromNumber(e,t)}else if(Buffer.isBuffer(e)){this.fromBuffer(e)}else if(t==null&&"string"!=typeof e){this.fromByteArray(e)}else{this.fromString(e,t)}}}function nbi(){return new BigInteger(null)}function am1(e,t,r,i,n,a){while(--a>=0){var o=t*this[e++]+r[i]+n;n=Math.floor(o/67108864);r[i++]=o&67108863}return n}function am2(e,t,r,i,n,a){var o=t&32767,s=t>>15;while(--a>=0){var c=this[e]&32767;var u=this[e++]>>15;var l=s*c+u*o;c=o*c+((l&32767)<<15)+r[i]+(n&1073741823);n=(c>>>30)+(l>>>15)+s*u+(n>>>30);r[i++]=c&1073741823}return n}function am3(e,t,r,i,n,a){var o=t&16383,s=t>>14;while(--a>=0){var c=this[e]&16383;var u=this[e++]>>14;var l=s*c+u*o;c=o*c+((l&16383)<<14)+r[i]+n;n=(c>>28)+(l>>14)+s*u;r[i++]=c&268435455}return n}BigInteger.prototype.am=am3;n=28;BigInteger.prototype.DB=n;BigInteger.prototype.DM=(1<<n)-1;BigInteger.prototype.DV=1<<n;var s=52;BigInteger.prototype.FV=Math.pow(2,s);BigInteger.prototype.F1=s-n;BigInteger.prototype.F2=2*n-s;var c="0123456789abcdefghijklmnopqrstuvwxyz";var u=new Array;var l,d;l="0".charCodeAt(0);for(d=0;d<=9;++d)u[l++]=d;l="a".charCodeAt(0);for(d=10;d<36;++d)u[l++]=d;l="A".charCodeAt(0);for(d=10;d<36;++d)u[l++]=d;function int2char(e){return c.charAt(e)}function intAt(e,t){var r=u[e.charCodeAt(t)];return r==null?-1:r}function bnpCopyTo(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t;e.s=this.s}function bnpFromInt(e){this.t=1;this.s=e<0?-1:0;if(e>0)this[0]=e;else if(e<-1)this[0]=e+DV;else this.t=0}function nbv(e){var t=nbi();t.fromInt(e);return t}function bnpFromString(e,t,r){var i;switch(t){case 2:i=1;break;case 4:i=2;break;case 8:i=3;break;case 16:i=4;break;case 32:i=5;break;case 256:i=8;break;default:this.fromRadix(e,t);return}this.t=0;this.s=0;var n=e.length;var a=false;var o=0;while(--n>=0){var s=i==8?e[n]&255:intAt(e,n);if(s<0){if(e.charAt(n)=="-")a=true;continue}a=false;if(o===0)this[this.t++]=s;else if(o+i>this.DB){this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o;this[this.t++]=s>>this.DB-o}else this[this.t-1]|=s<<o;o+=i;if(o>=this.DB)o-=this.DB}if(!r&&i==8&&(e[0]&128)!=0){this.s=-1;if(o>0)this[this.t-1]|=(1<<this.DB-o)-1<<o}this.clamp();if(a)BigInteger.ZERO.subTo(this,this)}function bnpFromByteArray(e,t){this.fromString(e,256,t)}function bnpFromBuffer(e){this.fromString(e,256,true)}function bnpClamp(){var e=this.s&this.DM;while(this.t>0&&this[this.t-1]==e)--this.t}function bnToString(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,i,n=false,a="",o=this.t;var s=this.DB-o*this.DB%t;if(o-- >0){if(s<this.DB&&(i=this[o]>>s)>0){n=true;a=int2char(i)}while(o>=0){if(s<t){i=(this[o]&(1<<s)-1)<<t-s;i|=this[--o]>>(s+=this.DB-t)}else{i=this[o]>>(s-=t)&r;if(s<=0){s+=this.DB;--o}}if(i>0)n=true;if(n)a+=int2char(i)}}
//! Fix to be compatible with node >0.12.7 Buffer.js
if(e==16&&a.length%2!=0)a="0"+a;return n?a:"0"}function bnNegate(){var e=nbi();BigInteger.ZERO.subTo(this,e);return e}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;t=r-e.t;if(t!=0)return this.s<0?-t:t;while(--r>=0)if((t=this[r]-e[r])!=0)return t;return 0}function bnEqual(e){console.log(this.compareTo(e));return this.compareTo(e)==0?true:false}function bnGreater(e){return this.compareTo(e)>0?true:false}function bnGreaterOrEqual(e){return this.compareTo(e)>=0?true:false}function bnLesser(e){return this.compareTo(e)<0?true:false}function bnLesserOrEqual(e){return this.compareTo(e)<=0?true:false}function nbits(e){var t=1,r;if((r=e>>>16)!=0){e=r;t+=16}if((r=e>>8)!=0){e=r;t+=8}if((r=e>>4)!=0){e=r;t+=4}if((r=e>>2)!=0){e=r;t+=2}if((r=e>>1)!=0){e=r;t+=1}return t}function bnBitLength(){if(this.t<=0)return 0;return this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e;t.s=this.s}function bnpDRShiftTo(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0);t.s=this.s}function bnpLShiftTo(e,t){var r=e%this.DB;var i=this.DB-r;var n=(1<<i)-1;var a=Math.floor(e/this.DB),o=this.s<<r&this.DM,s;for(s=this.t-1;s>=0;--s){t[s+a+1]=this[s]>>i|o;o=(this[s]&n)<<r}for(s=a-1;s>=0;--s)t[s]=0;t[a]=o;t.t=this.t+a+1;t.s=this.s;t.clamp()}function bnpRShiftTo(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var i=e%this.DB;var n=this.DB-i;var a=(1<<i)-1;t[0]=this[r]>>i;for(var o=r+1;o<this.t;++o){t[o-r-1]|=(this[o]&a)<<n;t[o-r]=this[o]>>i}if(i>0)t[this.t-r-1]|=(this.s&a)<<n;t.t=this.t-r;t.clamp()}function bnpSubTo(e,t){var r=0,i=0,n=Math.min(e.t,this.t);while(r<n){i+=this[r]-e[r];t[r++]=i&this.DM;i>>=this.DB}if(e.t<this.t){i-=e.s;while(r<this.t){i+=this[r];t[r++]=i&this.DM;i>>=this.DB}i+=this.s}else{i+=this.s;while(r<e.t){i-=e[r];t[r++]=i&this.DM;i>>=this.DB}i-=e.s}t.s=i<0?-1:0;if(i<-1)t[r++]=this.DV+i;else if(i>0)t[r++]=i;t.t=r;t.clamp()}function bnpMultiplyTo(e,t){var r=this.abs(),i=e.abs();var n=r.t;t.t=n+i.t;while(--n>=0)t[n]=0;for(n=0;n<i.t;++n)t[n+r.t]=r.am(0,i[n],t,n,0,r.t);t.s=0;t.clamp();if(this.s!=e.s)BigInteger.ZERO.subTo(t,t)}function bnpSquareTo(e){var t=this.abs();var r=e.t=2*t.t;while(--r>=0)e[r]=0;for(r=0;r<t.t-1;++r){var i=t.am(r,t[r],e,2*r,0,1);if((e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,i,t.t-r-1))>=t.DV){e[r+t.t]-=t.DV;e[r+t.t+1]=1}}if(e.t>0)e[e.t-1]+=t.am(r,t[r],e,2*r,0,1);e.s=0;e.clamp()}function bnpDivRemTo(e,t,r){var i=e.abs();if(i.t<=0)return;var n=this.abs();if(n.t<i.t){if(t!=null)t.fromInt(0);if(r!=null)this.copyTo(r);return}if(r==null)r=nbi();var a=nbi(),o=this.s,s=e.s;var c=this.DB-nbits(i[i.t-1]);if(c>0){i.lShiftTo(c,a);n.lShiftTo(c,r)}else{i.copyTo(a);n.copyTo(r)}var u=a.t;var l=a[u-1];if(l===0)return;var d=l*(1<<this.F1)+(u>1?a[u-2]>>this.F2:0);var h=this.FV/d,p=(1<<this.F1)/d,v=1<<this.F2;var m=r.t,g=m-u,y=t==null?nbi():t;a.dlShiftTo(g,y);if(r.compareTo(y)>=0){r[r.t++]=1;r.subTo(y,r)}BigInteger.ONE.dlShiftTo(u,y);y.subTo(a,a);while(a.t<u)a[a.t++]=0;while(--g>=0){var C=r[--m]==l?this.DM:Math.floor(r[m]*h+(r[m-1]+v)*p);if((r[m]+=a.am(0,C,r,g,0,u))<C){a.dlShiftTo(g,y);r.subTo(y,r);while(r[m]<--C)r.subTo(y,r)}}if(t!=null){r.drShiftTo(u,t);if(o!=s)BigInteger.ZERO.subTo(t,t)}r.t=u;r.clamp();if(c>0)r.rShiftTo(c,r);if(o<0)BigInteger.ZERO.subTo(r,r)}function bnMod(e){var t=nbi();this.abs().divRemTo(e,null,t);if(this.s<0&&t.compareTo(BigInteger.ZERO)>0)e.subTo(t,t);return t}function Classic(e){this.m=e}function cConvert(e){if(e.s<0||e.compareTo(this.m)>=0)return e.mod(this.m);else return e}function cRevert(e){return e}function cReduce(e){e.divRemTo(this.m,null,e)}function cMulTo(e,t,r){e.multiplyTo(t,r);this.reduce(r)}function cSqrTo(e,t){e.squareTo(t);this.reduce(t)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var e=this[0];if((e&1)===0)return 0;var t=e&3;t=t*(2-(e&15)*t)&15;t=t*(2-(e&255)*t)&255;t=t*(2-((e&65535)*t&65535))&65535;t=t*(2-e*t%this.DV)%this.DV;return t>0?this.DV-t:-t}function Montgomery(e){this.m=e;this.mp=e.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<e.DB-15)-1;this.mt2=2*e.t}function montConvert(e){var t=nbi();e.abs().dlShiftTo(this.m.t,t);t.divRemTo(this.m,null,t);if(e.s<0&&t.compareTo(BigInteger.ZERO)>0)this.m.subTo(t,t);return t}function montRevert(e){var t=nbi();e.copyTo(t);this.reduce(t);return t}function montReduce(e){while(e.t<=this.mt2)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e[t]&32767;var i=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;r=t+this.m.t;e[r]+=this.m.am(0,i,e,t,0,this.m.t);while(e[r]>=e.DV){e[r]-=e.DV;e[++r]++}}e.clamp();e.drShiftTo(this.m.t,e);if(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function montSqrTo(e,t){e.squareTo(t);this.reduce(t)}function montMulTo(e,t,r){e.multiplyTo(t,r);this.reduce(r)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this[0]&1:this.s)===0}function bnpExp(e,t){if(e>4294967295||e<1)return BigInteger.ONE;var r=nbi(),i=nbi(),n=t.convert(this),a=nbits(e)-1;n.copyTo(r);while(--a>=0){t.sqrTo(r,i);if((e&1<<a)>0)t.mulTo(i,n,r);else{var o=r;r=i;i=o}}return t.revert(r)}function bnModPowInt(e,t){var r;if(e<256||t.isEven())r=new Classic(t);else r=new Montgomery(t);return this.exp(e,r)}function bnClone(){var e=nbi();this.copyTo(e);return e}function bnIntValue(){if(this.s<0){if(this.t==1)return this[0]-this.DV;else if(this.t===0)return-1}else if(this.t==1)return this[0];else if(this.t===0)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return this.t==0?this.s:this[0]<<24>>24}function bnShortValue(){return this.t==0?this.s:this[0]<<16>>16}function bnpChunkSize(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function bnSigNum(){if(this.s<0)return-1;else if(this.t<=0||this.t==1&&this[0]<=0)return 0;else return 1}function bnpToRadix(e){if(e==null)e=10;if(this.signum()===0||e<2||e>36)return"0";var t=this.chunkSize(e);var r=Math.pow(e,t);var i=nbv(r),n=nbi(),a=nbi(),o="";this.divRemTo(i,n,a);while(n.signum()>0){o=(r+a.intValue()).toString(e).substr(1)+o;n.divRemTo(i,n,a)}return a.intValue().toString(e)+o}function bnpFromRadix(e,t){this.fromInt(0);if(t==null)t=10;var r=this.chunkSize(t);var i=Math.pow(t,r),n=false,a=0,o=0;for(var s=0;s<e.length;++s){var c=intAt(e,s);if(c<0){if(e.charAt(s)=="-"&&this.signum()===0)n=true;continue}o=t*o+c;if(++a>=r){this.dMultiply(i);this.dAddOffset(o,0);a=0;o=0}}if(a>0){this.dMultiply(Math.pow(t,a));this.dAddOffset(o,0)}if(n)BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(e,t){if("number"==typeof t){if(e<2)this.fromInt(1);else{this.fromNumber(e);if(!this.testBit(e-1))this.bitwiseTo(BigInteger.ONE.shiftLeft(e-1),op_or,this);if(this.isEven())this.dAddOffset(1,0);while(!this.isProbablePrime(t)){this.dAddOffset(2,0);if(this.bitLength()>e)this.subTo(BigInteger.ONE.shiftLeft(e-1),this)}}}else{var r=i.randomBytes((e>>3)+1);var n=e&7;if(n>0)r[0]&=(1<<n)-1;else r[0]=0;this.fromByteArray(r)}}function bnToByteArray(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,i,n=0;if(e-- >0){if(r<this.DB&&(i=this[e]>>r)!=(this.s&this.DM)>>r)t[n++]=i|this.s<<this.DB-r;while(e>=0){if(r<8){i=(this[e]&(1<<r)-1)<<8-r;i|=this[--e]>>(r+=this.DB-8)}else{i=this[e]>>(r-=8)&255;if(r<=0){r+=this.DB;--e}}if((i&128)!=0)i|=-256;if(n===0&&(this.s&128)!=(i&128))++n;if(n>0||i!=this.s)t[n++]=i}}return t}function bnToBuffer(e){var t=Buffer.from(this.toByteArray());if(e===true&&t[0]===0){t=t.slice(1)}else if(typeof e=="number"){if(t.length>e){for(var r=0;r<t.length-e;r++){if(t[r]!==0){return null}}return t.slice(t.length-e)}else if(t.length<e){var i=Buffer.alloc(e);i.fill(0,0,e-t.length);t.copy(i,e-t.length);return i}}return t}function bnEquals(e){return this.compareTo(e)==0}function bnMin(e){return this.compareTo(e)<0?this:e}function bnMax(e){return this.compareTo(e)>0?this:e}function bnpBitwiseTo(e,t,r){var i,n,a=Math.min(e.t,this.t);for(i=0;i<a;++i)r[i]=t(this[i],e[i]);if(e.t<this.t){n=e.s&this.DM;for(i=a;i<this.t;++i)r[i]=t(this[i],n);r.t=this.t}else{n=this.s&this.DM;for(i=a;i<e.t;++i)r[i]=t(n,e[i]);r.t=e.t}r.s=t(this.s,e.s);r.clamp()}function op_and(e,t){return e&t}function bnAnd(e){var t=nbi();this.bitwiseTo(e,op_and,t);return t}function op_or(e,t){return e|t}function bnOr(e){var t=nbi();this.bitwiseTo(e,op_or,t);return t}function op_xor(e,t){return e^t}function bnXor(e){var t=nbi();this.bitwiseTo(e,op_xor,t);return t}function op_andnot(e,t){return e&~t}function bnAndNot(e){var t=nbi();this.bitwiseTo(e,op_andnot,t);return t}function bnNot(){var e=nbi();for(var t=0;t<this.t;++t)e[t]=this.DM&~this[t];e.t=this.t;e.s=~this.s;return e}function bnShiftLeft(e){var t=nbi();if(e<0)this.rShiftTo(-e,t);else this.lShiftTo(e,t);return t}function bnShiftRight(e){var t=nbi();if(e<0)this.lShiftTo(-e,t);else this.rShiftTo(e,t);return t}function lbit(e){if(e===0)return-1;var t=0;if((e&65535)===0){e>>=16;t+=16}if((e&255)===0){e>>=8;t+=8}if((e&15)===0){e>>=4;t+=4}if((e&3)===0){e>>=2;t+=2}if((e&1)===0)++t;return t}function bnGetLowestSetBit(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+lbit(this[e]);if(this.s<0)return this.t*this.DB;return-1}function cbit(e){var t=0;while(e!=0){e&=e-1;++t}return t}function bnBitCount(){var e=0,t=this.s&this.DM;for(var r=0;r<this.t;++r)e+=cbit(this[r]^t);return e}function bnTestBit(e){var t=Math.floor(e/this.DB);if(t>=this.t)return this.s!=0;return(this[t]&1<<e%this.DB)!=0}function bnpChangeBit(e,t){var r=BigInteger.ONE.shiftLeft(e);this.bitwiseTo(r,t,r);return r}function bnSetBit(e){return this.changeBit(e,op_or)}function bnClearBit(e){return this.changeBit(e,op_andnot)}function bnFlipBit(e){return this.changeBit(e,op_xor)}function bnpAddTo(e,t){var r=0,i=0,n=Math.min(e.t,this.t);while(r<n){i+=this[r]+e[r];t[r++]=i&this.DM;i>>=this.DB}if(e.t<this.t){i+=e.s;while(r<this.t){i+=this[r];t[r++]=i&this.DM;i>>=this.DB}i+=this.s}else{i+=this.s;while(r<e.t){i+=e[r];t[r++]=i&this.DM;i>>=this.DB}i+=e.s}t.s=i<0?-1:0;if(i>0)t[r++]=i;else if(i<-1)t[r++]=this.DV+i;t.t=r;t.clamp()}function bnAdd(e){var t=nbi();this.addTo(e,t);return t}function bnSubtract(e){var t=nbi();this.subTo(e,t);return t}function bnMultiply(e){var t=nbi();this.multiplyTo(e,t);return t}function bnSquare(){var e=nbi();this.squareTo(e);return e}function bnDivide(e){var t=nbi();this.divRemTo(e,t,null);return t}function bnRemainder(e){var t=nbi();this.divRemTo(e,null,t);return t}function bnDivideAndRemainder(e){var t=nbi(),r=nbi();this.divRemTo(e,t,r);return new Array(t,r)}function bnpDMultiply(e){this[this.t]=this.am(0,e-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(e,t){if(e===0)return;while(this.t<=t)this[this.t++]=0;this[t]+=e;while(this[t]>=this.DV){this[t]-=this.DV;if(++t>=this.t)this[this.t++]=0;++this[t]}}function NullExp(){}function nNop(e){return e}function nMulTo(e,t,r){e.multiplyTo(t,r)}function nSqrTo(e,t){e.squareTo(t)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(e){return this.exp(e,new NullExp)}function bnpMultiplyLowerTo(e,t,r){var i=Math.min(this.t+e.t,t);r.s=0;r.t=i;while(i>0)r[--i]=0;var n;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,e[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e[i],r,i,0,t-i);r.clamp()}function bnpMultiplyUpperTo(e,t,r){--t;var i=r.t=this.t+e.t-t;r.s=0;while(--i>=0)r[i]=0;for(i=Math.max(t-this.t,0);i<e.t;++i)r[this.t+i-t]=this.am(t-i,e[i],r,0,0,this.t+i-t);r.clamp();r.drShiftTo(1,r)}function Barrett(e){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*e.t,this.r2);this.mu=this.r2.divide(e);this.m=e}function barrettConvert(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);else if(e.compareTo(this.m)<0)return e;else{var t=nbi();e.copyTo(t);this.reduce(t);return t}}function barrettRevert(e){return e}function barrettReduce(e){e.drShiftTo(this.m.t-1,this.r2);if(e.t>this.m.t+1){e.t=this.m.t+1;e.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(e.compareTo(this.r2)<0)e.dAddOffset(1,this.m.t+1);e.subTo(this.r2,e);while(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function barrettSqrTo(e,t){e.squareTo(t);this.reduce(t)}function barrettMulTo(e,t,r){e.multiplyTo(t,r);this.reduce(r)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(e,t){var r=e.bitLength(),i,n=nbv(1),a;if(r<=0)return n;else if(r<18)i=1;else if(r<48)i=3;else if(r<144)i=4;else if(r<768)i=5;else i=6;if(r<8)a=new Classic(t);else if(t.isEven())a=new Barrett(t);else a=new Montgomery(t);var o=new Array,s=3,c=i-1,u=(1<<i)-1;o[1]=a.convert(this);if(i>1){var l=nbi();a.sqrTo(o[1],l);while(s<=u){o[s]=nbi();a.mulTo(l,o[s-2],o[s]);s+=2}}var d=e.t-1,h,p=true,v=nbi(),m;r=nbits(e[d])-1;while(d>=0){if(r>=c)h=e[d]>>r-c&u;else{h=(e[d]&(1<<r+1)-1)<<c-r;if(d>0)h|=e[d-1]>>this.DB+r-c}s=i;while((h&1)===0){h>>=1;--s}if((r-=s)<0){r+=this.DB;--d}if(p){o[h].copyTo(n);p=false}else{while(s>1){a.sqrTo(n,v);a.sqrTo(v,n);s-=2}if(s>0)a.sqrTo(n,v);else{m=n;n=v;v=m}a.mulTo(v,o[h],n)}while(d>=0&&(e[d]&1<<r)===0){a.sqrTo(n,v);m=n;n=v;v=m;if(--r<0){r=this.DB-1;--d}}}return a.revert(n)}function bnGCD(e){var t=this.s<0?this.negate():this.clone();var r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var i=t;t=r;r=i}var n=t.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return t;if(n<a)a=n;if(a>0){t.rShiftTo(a,t);r.rShiftTo(a,r)}while(t.signum()>0){if((n=t.getLowestSetBit())>0)t.rShiftTo(n,t);if((n=r.getLowestSetBit())>0)r.rShiftTo(n,r);if(t.compareTo(r)>=0){t.subTo(r,t);t.rShiftTo(1,t)}else{r.subTo(t,r);r.rShiftTo(1,r)}}if(a>0)r.lShiftTo(a,r);return r}function bnpModInt(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t===0)r=this[0]%e;else for(var i=this.t-1;i>=0;--i)r=(t*r+this[i])%e;return r}function bnModInverse(e){var t=e.isEven();if(this.isEven()&&t||e.signum()===0)return BigInteger.ZERO;var r=e.clone(),i=this.clone();var n=nbv(1),a=nbv(0),o=nbv(0),s=nbv(1);while(r.signum()!=0){while(r.isEven()){r.rShiftTo(1,r);if(t){if(!n.isEven()||!a.isEven()){n.addTo(this,n);a.subTo(e,a)}n.rShiftTo(1,n)}else if(!a.isEven())a.subTo(e,a);a.rShiftTo(1,a)}while(i.isEven()){i.rShiftTo(1,i);if(t){if(!o.isEven()||!s.isEven()){o.addTo(this,o);s.subTo(e,s)}o.rShiftTo(1,o)}else if(!s.isEven())s.subTo(e,s);s.rShiftTo(1,s)}if(r.compareTo(i)>=0){r.subTo(i,r);if(t)n.subTo(o,n);a.subTo(s,a)}else{i.subTo(r,i);if(t)o.subTo(n,o);s.subTo(a,s)}}if(i.compareTo(BigInteger.ONE)!=0)return BigInteger.ZERO;if(s.compareTo(e)>=0)return s.subtract(e);if(s.signum()<0)s.addTo(e,s);else return s;if(s.signum()<0)return s.add(e);else return s}var h=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var p=(1<<26)/h[h.length-1];function bnIsProbablePrime(e){var t,r=this.abs();if(r.t==1&&r[0]<=h[h.length-1]){for(t=0;t<h.length;++t)if(r[0]==h[t])return true;return false}if(r.isEven())return false;t=1;while(t<h.length){var i=h[t],n=t+1;while(n<h.length&&i<p)i*=h[n++];i=r.modInt(i);while(t<n)if(i%h[t++]===0)return false}return r.millerRabin(e)}function bnpMillerRabin(e){var t=this.subtract(BigInteger.ONE);var r=t.getLowestSetBit();if(r<=0)return false;var i=t.shiftRight(r);e=e+1>>1;if(e>h.length)e=h.length;var n=nbi();for(var a=0;a<e;++a){n.fromInt(h[Math.floor(Math.random()*h.length)]);var o=n.modPow(i,this);if(o.compareTo(BigInteger.ONE)!=0&&o.compareTo(t)!=0){var s=1;while(s++<r&&o.compareTo(t)!=0){o=o.modPowInt(2,this);if(o.compareTo(BigInteger.ONE)===0)return false}if(o.compareTo(t)!=0)return false}}return true}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.fromByteArray=bnpFromByteArray;BigInteger.prototype.fromBuffer=bnpFromBuffer;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.toBuffer=bnToBuffer;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.eq=bnEqual;BigInteger.prototype.gt=bnGreater;BigInteger.prototype.gte=bnGreaterOrEqual;BigInteger.prototype.lt=bnLesser;BigInteger.prototype.lte=bnLesserOrEqual;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.int2char=int2char;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);BigInteger.prototype.square=bnSquare;e.exports=BigInteger},5661:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.params=t.hex=void 0;const i=r(4319);function hex(e){return new i(e.split(/\s|\n/).join(""),16)}t.hex=hex;t.params={1024:{N_length_bits:1024,N:hex(`\n      EEAF0AB9 ADB38DD6 9C33F80A FA8FC5E8 60726187 75FF3C0B 9EA2314C\n      9C256576 D674DF74 96EA81D3 383B4813 D692C6E0 E0D5D8E2 50B98BE4\n      8E495C1D 6089DAD1 5DC7D7B4 6154D6B6 CE8EF4AD 69B15D49 82559B29\n      7BCF1885 C529F566 660E57EC 68EDBC3C 05726CC0 2FD4CBF4 976EAA9A\n      FD5138FE 8376435B 9FC61D2F C0EB06E3\n    `),g:hex("02"),hash:"sha1"},1536:{N_length_bits:1536,N:hex(`\n      9DEF3CAF B939277A B1F12A86 17A47BBB DBA51DF4 99AC4C80 BEEEA961\n      4B19CC4D 5F4F5F55 6E27CBDE 51C6A94B E4607A29 1558903B A0D0F843\n      80B655BB 9A22E8DC DF028A7C EC67F0D0 8134B1C8 B9798914 9B609E0B\n      E3BAB63D 47548381 DBC5B1FC 764E3F4B 53DD9DA1 158BFD3E 2B9C8CF5\n      6EDF0195 39349627 DB2FD53D 24B7C486 65772E43 7D6C7F8C E442734A\n      F7CCB7AE 837C264A E3A9BEB8 7F8A2FE9 B8B5292E 5A021FFF 5E91479E\n      8CE7A28C 2442C6F3 15180F93 499A234D CF76E3FE D135F9BB\n    `),g:hex("02"),hash:"sha1"},2048:{N_length_bits:2048,N:hex(`\n      AC6BDB41 324A9A9B F166DE5E 1389582F AF72B665 1987EE07 FC319294\n      3DB56050 A37329CB B4A099ED 8193E075 7767A13D D52312AB 4B03310D\n      CD7F48A9 DA04FD50 E8083969 EDB767B0 CF609517 9A163AB3 661A05FB\n      D5FAAAE8 2918A996 2F0B93B8 55F97993 EC975EEA A80D740A DBF4FF74\n      7359D041 D5C33EA7 1D281E44 6B14773B CA97B43A 23FB8016 76BD207A\n      436C6481 F1D2B907 8717461A 5B9D32E6 88F87748 544523B5 24B0D57D\n      5EA77A27 75D2ECFA 032CFBDB F52FB378 61602790 04E57AE6 AF874E73\n      03CE5329 9CCC041C 7BC308D8 2A5698F3 A8D0C382 71AE35F8 E9DBFBB6\n      94B5C803 D89F7AE4 35DE236D 525F5475 9B65E372 FCD68EF2 0FA7111F\n      9E4AFF73\n    `),g:hex("02"),hash:"sha256"},3072:{N_length_bits:3072,N:hex(`\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A93AD2CA FFFFFFFF FFFFFFFF\n    `),g:hex("05"),hash:"sha256"},hap:{N_length_bits:3072,N:hex(`\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A93AD2CA FFFFFFFF FFFFFFFF\n    `),g:hex("05"),hash:"sha512"},4096:{N_length_bits:4096,N:hex(`\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34063199\n      FFFFFFFF FFFFFFFF\n    `),g:hex("05"),hash:"sha256"},6244:{N_length_bits:6244,N:hex(`\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492\n      36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD F8FF9406\n      AD9E530E E5DB382F 413001AE B06A53ED 9027D831 179727B0 865A8918\n      DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B DB7F1447 E6CC254B 33205151\n      2BD7AF42 6FB8F401 378CD2BF 5983CA01 C64B92EC F032EA15 D1721D03\n      F482D7CE 6E74FEF6 D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F\n      BEC7E8F3 23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA\n      CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328 06A1D58B\n      B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C DA56C9EC 2EF29632\n      387FE8D7 6E3C0468 043E8F66 3F4860EE 12BF2D5B 0B7474D6 E694F91E\n      6DCC4024 FFFFFFFF FFFFFFFF\n    `),g:hex("05"),hash:"sha256"},8192:{N_length_bits:8192,N:hex(`\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492\n      36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD F8FF9406\n      AD9E530E E5DB382F 413001AE B06A53ED 9027D831 179727B0 865A8918\n      DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B DB7F1447 E6CC254B 33205151\n      2BD7AF42 6FB8F401 378CD2BF 5983CA01 C64B92EC F032EA15 D1721D03\n      F482D7CE 6E74FEF6 D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F\n      BEC7E8F3 23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA\n      CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328 06A1D58B\n      B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C DA56C9EC 2EF29632\n      387FE8D7 6E3C0468 043E8F66 3F4860EE 12BF2D5B 0B7474D6 E694F91E\n      6DBE1159 74A3926F 12FEE5E4 38777CB6 A932DF8C D8BEC4D0 73B931BA\n      3BC832B6 8D9DD300 741FA7BF 8AFC47ED 2576F693 6BA42466 3AAB639C\n      5AE4F568 3423B474 2BF1C978 238F16CB E39D652D E3FDB8BE FC848AD9\n      22222E04 A4037C07 13EB57A8 1A23F0C7 3473FC64 6CEA306B 4BCBC886\n      2F8385DD FA9D4B7F A2C087E8 79683303 ED5BDD3A 062B3CF5 B3A278A6\n      6D2A13F8 3F44F82D DF310EE0 74AB6A36 4597E899 A0255DC1 64F31CC5\n      0846851D F9AB4819 5DED7EA1 B1D510BD 7EE74D73 FAF36BC3 1ECFA268\n      359046F4 EB879F92 4009438B 481C6CD7 889A002E D5EE382B C9190DA6\n      FC026E47 9558E447 5677E9AA 9E3050E2 765694DF C81F56E8 80B96E71\n      60C980DD 98EDD3DF FFFFFFFF FFFFFFFF\n    `),g:hex("13"),hash:"sha256"}};t["default"]=t.params},3823:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.SrpServer=t.SrpClient=t.SRP=void 0;const n=i(r(6113));const a=i(r(9491));const o=r(4319);const s=r(5661);const c=new o(0,10);function assert_(e,t){if(!e){throw new Error(t||"assertion")}}function assertIsBuffer(e,t="arg"){assert_(Buffer.isBuffer(e),`Type error: ${t} must be a buffer`)}function assertIsBigInteger(e,t="arg"){assert_(e instanceof o,`Type error: ${t} must be a BigInteger`)}function padTo(e,t){assertIsBuffer(e,"n");const r=t-e.length;assert_(r>-1,"Negative padding.  Very uncomfortable.");const i=Buffer.alloc(t);i.fill(0,0,r);e.copy(i,r);a.default.strictEqual(i.length,t);return i}function padToN(e,t){assertIsBigInteger(e);const r=e.toString(16).length%2!==0?"0"+e.toString(16):e.toString(16);return padTo(Buffer.from(r,"hex"),t.N_length_bits/8)}function getx(e,t,r,i){assertIsBuffer(t,"salt (salt)");assertIsBuffer(r,"identity (I)");assertIsBuffer(i,"password (P)");const a=n.default.createHash(e.hash).update(Buffer.concat([r,Buffer.from(":"),i])).digest();const s=n.default.createHash(e.hash).update(t).update(a).digest();return new o(s)}class SRP{static computeVerifier(e,t,r,i){assertIsBuffer(t,"salt (salt)");assertIsBuffer(r,"identity (I)");assertIsBuffer(i,"password (P)");const n=e.g.modPow(getx(e,t,r,i),e.N);return n.toBuffer(e.N_length_bits/8)}static genKey(e=32,t){if(typeof e!=="number"){t=e;e=32}if(!t){return new Promise(((t,r)=>SRP.genKey(e,((e,i)=>e?r(e):t(i)))))}n.default.randomBytes(e,((e,r)=>{if(e){return t(e,null)}return t(null,r)}))}}t.SRP=SRP;SRP.params=s.params;function getk(e){const t=n.default.createHash(e.hash).update(padToN(e.N,e)).update(padToN(e.g,e)).digest();return new o(t)}function getB(e,t,r,i){assertIsBigInteger(r);assertIsBigInteger(t);assertIsBigInteger(i);const n=t.multiply(r).add(e.g.modPow(i,e.N)).mod(e.N);return n.toBuffer(e.N_length_bits/8)}function getA(e,t){assertIsBigInteger(t);if(Math.ceil(t.toString(16).length/2)<32){console.warn("getA: client key length %d is less than the recommended 256 bits",t.bitLength())}return e.g.modPow(t,e.N).toBuffer(e.N_length_bits/8)}function getu(e,t,r){assertIsBuffer(t,"A");assertIsBuffer(r,"B");const i=n.default.createHash(e.hash).update(padTo(t,e.N_length_bits/8)).update(padTo(r,e.N_length_bits/8)).digest();return new o(i)}function client_getS(e,t,r,i,n,a){assertIsBigInteger(t);assertIsBigInteger(r);assertIsBigInteger(i);assertIsBigInteger(n);assertIsBigInteger(a);if(c.compareTo(n)>=0||e.N.compareTo(n)<=0){throw new Error('invalid server-supplied "B", must be 1..N-1')}const o=n.subtract(t.multiply(e.g.modPow(r,e.N))).modPow(i.add(a.multiply(r)),e.N).mod(e.N);return o.toBuffer(e.N_length_bits/8)}function server_getS(e,t,r,i,n){assertIsBigInteger(t);assertIsBigInteger(r);assertIsBigInteger(i);assertIsBigInteger(n);if(c.compareTo(r)>=0||e.N.compareTo(r)<=0){throw new Error('invalid client-supplied "A", must be 1..N-1')}const a=r.multiply(t.modPow(n,e.N)).modPow(i,e.N).mod(e.N);return a.toBuffer(e.N_length_bits/8)}function getK(e,t){assertIsBuffer(t,"S");if(e.hash==="sha1"){return Buffer.concat([n.default.createHash(e.hash).update(t).update(Buffer.from([0,0,0,0])).digest(),n.default.createHash(e.hash).update(t).update(Buffer.from([0,0,0,1])).digest()])}else{return n.default.createHash(e.hash).update(t).digest()}}function getM1(e,t,r,i,a,o){if(arguments.length>4){assertIsBuffer(t,"identity (I)");assertIsBuffer(r,"salt (s)");assertIsBuffer(i,"client public key (A)");assertIsBuffer(a,"server public key (B)");assertIsBuffer(o,"session key (K)");const s=n.default.createHash(e.hash).update(e.N.toBuffer(true)).digest();const c=n.default.createHash(e.hash).update(e.g.toBuffer(true)).digest();for(let e=0;e<s.length;e++){s[e]^=c[e]}const u=n.default.createHash(e.hash).update(t).digest();return n.default.createHash(e.hash).update(s).update(u).update(r).update(i).update(a).update(o).digest()}else{[i,a,r]=[t,r,i];assertIsBuffer(i,"A");assertIsBuffer(a,"B");assertIsBuffer(r,"S");return n.default.createHash(e.hash).update(i).update(a).update(r).digest()}}function getM2(e,t,r,i){assertIsBuffer(t,"A");assertIsBuffer(r,"M1");assertIsBuffer(i,"K");return n.default.createHash(e.hash).update(t).update(r).update(i).digest()}function equal(e,t){return e.toString("hex")===t.toString("hex")}class SrpClient{constructor(e,t,r,i,n,a=true){assertIsBuffer(t,"salt (s)");assertIsBuffer(r,"identity (I)");assertIsBuffer(i,"password (P)");assertIsBuffer(n,"secret1");this._params=e;this._k=getk(e);this._x=getx(e,t,r,i);this._a=new o(n);if(a){this._I=r;this._s=t}this._A=getA(e,this._a)}computeA(){return this._A}setB(e){const t=getu(this._params,this._A,e);const r=client_getS(this._params,this._k,this._x,this._a,new o(e),t);this._K=getK(this._params,r);this._u=t;this._S=r;this._B=e;if(this._I&&this._s){this._M1=getM1(this._params,this._I,this._s,this._A,this._B,this._K)}else{this._M1=getM1(this._params,this._A,this._B,this._S)}this._M2=getM2(this._params,this._A,this._M1,this._K)}computeM1(){if(this._M1===undefined){throw new Error("incomplete protocol")}return this._M1}checkM2(e){if(!equal(this._M2,e)){throw new Error("server is not authentic")}}computeK(){if(this._K===undefined){throw new Error("incomplete protocol")}return this._K}}t.SrpClient=SrpClient;class SrpServer{constructor(e,t,r,i,n){this._params=e;this._k=getk(e);if(arguments.length>3){assertIsBuffer(t,"salt (salt)");assertIsBuffer(r,"identity (I)");assertIsBuffer(i,"password (P)");assertIsBuffer(n,"secret2");this._b=new o(n);this._v=new o(SRP.computeVerifier(e,t,r,i));this._I=r;this._s=t}else if(t instanceof Buffer){const e=t;[n,t,r,i]=[r,undefined,undefined,undefined];assertIsBuffer(e,"verifier (v)");assertIsBuffer(n,"secret2");this._b=new o(n);this._v=new o(e)}else{const s=t;[n,t,r,i]=[r,undefined,undefined,undefined];(0,a.default)(s.username instanceof Buffer||typeof s.username==="string","identity.username (I) must be a string or Buffer");assertIsBuffer(s.salt,"identity.salt (s)");(0,a.default)("password"in s||"verifier"in s,"identity requires a password or verifier");if("verifier"in s){assertIsBuffer(s.verifier,"identity.verifier (v)")}else{(0,a.default)(s.password instanceof Buffer||typeof s.password==="string","identity.password (p) must be a string or Buffer")}assertIsBuffer(n,"secret2");const c=typeof s.username==="string"?Buffer.from(s.username):s.username;this._b=new o(n);if("verifier"in s){this._v=new o(s.verifier)}else{this._v=new o(SRP.computeVerifier(e,s.salt,c,typeof s.password==="string"?Buffer.from(s.password):s.password))}this._I=c;this._s=s.salt}this._B=getB(e,this._k,this._v,this._b)}computeB(){return this._B}setA(e){const t=getu(this._params,e,this._B);const r=server_getS(this._params,this._v,new o(e),this._b,t);this._K=getK(this._params,r);this._u=t;this._S=r;if(this._I&&this._s){this._M1=getM1(this._params,this._I,this._s,e,this._B,this._K)}else{this._M1=getM1(this._params,e,this._B,this._S)}this._M2=getM2(this._params,e,this._M1,this._K)}checkM1(e){if(this._M1===undefined){throw new Error("incomplete protocol")}if(!equal(this._M1,e)){throw new Error("client did not use the same password")}}computeK(){if(this._K===undefined){throw new Error("incomplete protocol")}return this._K}computeM2(){if(this._M2===undefined){throw new Error("incomplete protocol")}return this._M2}}t.SrpServer=SrpServer},8958:(e,t,r)=>{"use strict";var i=r(8443);var n=Object.prototype.toString;var a=Object.prototype.hasOwnProperty;var o=function forEachArray(e,t,r){for(var i=0,n=e.length;i<n;i++){if(a.call(e,i)){if(r==null){t(e[i],i,e)}else{t.call(r,e[i],i,e)}}}};var s=function forEachString(e,t,r){for(var i=0,n=e.length;i<n;i++){if(r==null){t(e.charAt(i),i,e)}else{t.call(r,e.charAt(i),i,e)}}};var c=function forEachObject(e,t,r){for(var i in e){if(a.call(e,i)){if(r==null){t(e[i],i,e)}else{t.call(r,e[i],i,e)}}}};var u=function forEach(e,t,r){if(!i(t)){throw new TypeError("iterator must be a function")}var a;if(arguments.length>=3){a=r}if(n.call(e)==="[object Array]"){o(e,t,a)}else if(typeof e==="string"){s(e,t,a)}else{c(e,t,a)}};e.exports=u},3670:(e,t,r)=>{"use strict";var i=r(2781);e.exports=function from(e){if(Array.isArray(e)){var t=0,r=e.length;return from((function(i){if(t<r)this.emit("data",e[t++]);else this.emit("end");return true}))}var n=new i,a=0;n.ended=false;n.started=false;n.readable=true;n.writable=false;n.paused=false;n.ended=false;n.pause=function(){n.started=true;n.paused=true};function next(){n.started=true;if(n.ended)return;while(!n.ended&&!n.paused&&e.call(n,a++,(function(){if(!n.ended&&!n.paused)process.nextTick(next)})));}n.resume=function(){n.started=true;n.paused=false;next()};n.on("end",(function(){n.ended=true;n.readable=false;process.nextTick(n.destroy)}));n.destroy=function(){n.ended=true;n.emit("close")};process.nextTick((function(){if(!n.started)n.resume()}));return n}},4576:e=>{"use strict";var t="Function.prototype.bind called on incompatible ";var r=Array.prototype.slice;var i=Object.prototype.toString;var n="[object Function]";e.exports=function bind(e){var a=this;if(typeof a!=="function"||i.call(a)!==n){throw new TypeError(t+a)}var o=r.call(arguments,1);var s;var binder=function(){if(this instanceof s){var t=a.apply(this,o.concat(r.call(arguments)));if(Object(t)===t){return t}return this}else{return a.apply(e,o.concat(r.call(arguments)))}};var c=Math.max(0,a.length-o.length);var u=[];for(var l=0;l<c;l++){u.push("$"+l)}s=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(binder);if(a.prototype){var d=function Empty(){};d.prototype=a.prototype;s.prototype=new d;d.prototype=null}return s}},7978:(e,t,r)=>{"use strict";var i=r(4576);e.exports=Function.prototype.bind||i},1253:e=>{"use strict";var t=function functionsHaveNames(){return typeof function f(){}.name==="string"};var r=Object.getOwnPropertyDescriptor;if(r){try{r([],"length")}catch(e){r=null}}t.functionsHaveConfigurableNames=function functionsHaveConfigurableNames(){if(!t()||!r){return false}var e=r((function(){}),"name");return!!e&&!!e.configurable};var i=Function.prototype.bind;t.boundFunctionsHaveNames=function boundFunctionsHaveNames(){return t()&&typeof i==="function"&&function f(){}.bind().name!==""};e.exports=t},1473:(e,t,r)=>{"use strict";const{createHash:i,createHmac:n}=r(6113);const a={};const hash_length=e=>{switch(e){case"sha256":return 32;case"sha512":return 64;case"sha224":return 28;case"sha384":return 48;case"sha3-256":return 32;case"sha3-512":return 64;case"sha3-224":return 28;case"sha3-384":return 48;case"blake2s256":return 32;case"blake2b512":return 64;case"sha1":return 20;case"md5":return 16;default:{let t=a[e];if(t===undefined){t=i(e).digest().length;a[e]=t}return t}}};const hkdf_extract=(e,t,r,i)=>{const a=Buffer.isBuffer(r)?r:Buffer.from(r);const o=i&&i.length?Buffer.from(i):Buffer.alloc(t,0);return n(e,o).update(a).digest()};const hkdf_expand=(e,t,r,i,a)=>{const o=Buffer.isBuffer(a)?a:Buffer.from(a||"");const s=o.length;const c=Math.ceil(i/t);if(c>255){throw new Error(`OKM length ${i} is too long for ${e} hash`)}const u=Buffer.alloc(t*c+s+1);for(let i=1,a=0,l=0;i<=c;++i){o.copy(u,l);u[l+s]=i;n(e,r).update(u.slice(a,l+s+1)).digest().copy(u,l);a=l;l+=t}return u.slice(0,i)};function hkdf(e,t,{salt:r="",info:i="",hash:n="SHA-256"}={}){n=n.toLowerCase().replace("-","");const a=hash_length(n);const o=hkdf_extract(n,a,e,r);return hkdf_expand(n,a,o,t,i)}Object.defineProperties(hkdf,{hash_length:{configurable:false,enumerable:false,writable:false,value:hash_length},extract:{configurable:false,enumerable:false,writable:false,value:hkdf_extract},expand:{configurable:false,enumerable:false,writable:false,value:hkdf_expand}});e.exports=hkdf},1626:(e,t,r)=>{"use strict";var i;var n=SyntaxError;var a=Function;var o=TypeError;var getEvalledConstructor=function(e){try{return a('"use strict"; return ('+e+").constructor;")()}catch(e){}};var s=Object.getOwnPropertyDescriptor;if(s){try{s({},"")}catch(e){s=null}}var throwTypeError=function(){throw new o};var c=s?function(){try{arguments.callee;return throwTypeError}catch(e){try{return s(arguments,"callee").get}catch(e){return throwTypeError}}}():throwTypeError;var u=r(9299)();var l=Object.getPrototypeOf||function(e){return e.__proto__};var d={};var h=typeof Uint8Array==="undefined"?i:l(Uint8Array);var p={"%AggregateError%":typeof AggregateError==="undefined"?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer==="undefined"?i:ArrayBuffer,"%ArrayIteratorPrototype%":u?l([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":d,"%AsyncGenerator%":d,"%AsyncGeneratorFunction%":d,"%AsyncIteratorPrototype%":d,"%Atomics%":typeof Atomics==="undefined"?i:Atomics,"%BigInt%":typeof BigInt==="undefined"?i:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView==="undefined"?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array==="undefined"?i:Float32Array,"%Float64Array%":typeof Float64Array==="undefined"?i:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry==="undefined"?i:FinalizationRegistry,"%Function%":a,"%GeneratorFunction%":d,"%Int8Array%":typeof Int8Array==="undefined"?i:Int8Array,"%Int16Array%":typeof Int16Array==="undefined"?i:Int16Array,"%Int32Array%":typeof Int32Array==="undefined"?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u?l(l([][Symbol.iterator]())):i,"%JSON%":typeof JSON==="object"?JSON:i,"%Map%":typeof Map==="undefined"?i:Map,"%MapIteratorPrototype%":typeof Map==="undefined"||!u?i:l((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise==="undefined"?i:Promise,"%Proxy%":typeof Proxy==="undefined"?i:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect==="undefined"?i:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set==="undefined"?i:Set,"%SetIteratorPrototype%":typeof Set==="undefined"||!u?i:l((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer==="undefined"?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":u?l(""[Symbol.iterator]()):i,"%Symbol%":u?Symbol:i,"%SyntaxError%":n,"%ThrowTypeError%":c,"%TypedArray%":h,"%TypeError%":o,"%Uint8Array%":typeof Uint8Array==="undefined"?i:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray==="undefined"?i:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array==="undefined"?i:Uint16Array,"%Uint32Array%":typeof Uint32Array==="undefined"?i:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap==="undefined"?i:WeakMap,"%WeakRef%":typeof WeakRef==="undefined"?i:WeakRef,"%WeakSet%":typeof WeakSet==="undefined"?i:WeakSet};var v=function doEval(e){var t;if(e==="%AsyncFunction%"){t=getEvalledConstructor("async function () {}")}else if(e==="%GeneratorFunction%"){t=getEvalledConstructor("function* () {}")}else if(e==="%AsyncGeneratorFunction%"){t=getEvalledConstructor("async function* () {}")}else if(e==="%AsyncGenerator%"){var r=doEval("%AsyncGeneratorFunction%");if(r){t=r.prototype}}else if(e==="%AsyncIteratorPrototype%"){var i=doEval("%AsyncGenerator%");if(i){t=l(i.prototype)}}p[e]=t;return t};var m={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]};var g=r(7978);var y=r(9143);var C=g.call(Function.call,Array.prototype.concat);var T=g.call(Function.apply,Array.prototype.splice);var E=g.call(Function.call,String.prototype.replace);var D=g.call(Function.call,String.prototype.slice);var _=g.call(Function.call,RegExp.prototype.exec);var I=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g;var b=/\\(\\)?/g;var w=function stringToPath(e){var t=D(e,0,1);var r=D(e,-1);if(t==="%"&&r!=="%"){throw new n("invalid intrinsic syntax, expected closing `%`")}else if(r==="%"&&t!=="%"){throw new n("invalid intrinsic syntax, expected opening `%`")}var i=[];E(e,I,(function(e,t,r,n){i[i.length]=r?E(n,b,"$1"):t||e}));return i};var R=function getBaseIntrinsic(e,t){var r=e;var i;if(y(m,r)){i=m[r];r="%"+i[0]+"%"}if(y(p,r)){var a=p[r];if(a===d){a=v(r)}if(typeof a==="undefined"&&!t){throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!")}return{alias:i,name:r,value:a}}throw new n("intrinsic "+e+" does not exist!")};e.exports=function GetIntrinsic(e,t){if(typeof e!=="string"||e.length===0){throw new o("intrinsic name must be a non-empty string")}if(arguments.length>1&&typeof t!=="boolean"){throw new o('"allowMissing" argument must be a boolean')}if(_(/^%?[^%]*%?$/,e)===null){throw new n("`%` may not be present anywhere but at the beginning and end of the intrinsic name")}var r=w(e);var a=r.length>0?r[0]:"";var c=R("%"+a+"%",t);var u=c.name;var l=c.value;var d=false;var h=c.alias;if(h){a=h[0];T(r,C([0,1],h))}for(var v=1,m=true;v<r.length;v+=1){var g=r[v];var E=D(g,0,1);var I=D(g,-1);if((E==='"'||E==="'"||E==="`"||(I==='"'||I==="'"||I==="`"))&&E!==I){throw new n("property names with quotes must have matching quotes")}if(g==="constructor"||!m){d=true}a+="."+g;u="%"+a+"%";if(y(p,u)){l=p[u]}else if(l!=null){if(!(g in l)){if(!t){throw new o("base intrinsic for "+e+" exists, but the property is not available.")}return void i}if(s&&v+1>=r.length){var b=s(l,g);m=!!b;if(m&&"get"in b&&!("originalValue"in b.get)){l=b.get}else{l=l[g]}}else{m=y(l,g);l=l[g]}if(m&&!d){p[u]=l}}}return l}},3833:(e,t,r)=>{"use strict";var i=r(1626);var n=i("%Object.getOwnPropertyDescriptor%",true);if(n){try{n([],"length")}catch(e){n=null}}e.exports=n},3137:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MANUFACTURER_CTYPE=t.LOGS_CTYPE=t.LOCK_MECHANISM_LAST_KNOWN_ACTION_CTYPE=t.LOCK_MANAGEMENT_CONTROL_POINT_CTYPE=t.LOCK_MANAGEMENT_AUTO_SECURE_TIMEOUT_CTYPE=t.IDENTIFY_CTYPE=t.HUE_CTYPE=t.HEATING_THRESHOLD_CTYPE=t.CURRENT_TEMPERATURE_CTYPE=t.CURRENT_RELATIVE_HUMIDITY_CTYPE=t.CURRENT_LOCK_MECHANISM_STATE_CTYPE=t.CURRENT_DOOR_STATE_CTYPE=t.CONTACT_SENSOR_STATE_CTYPE=t.COOLING_THRESHOLD_CTYPE=t.BATTERY_LEVEL_CTYPE=t.BRIGHTNESS_CTYPE=t.AUDIO_FEEDBACK_CTYPE=t.ADMIN_ONLY_ACCESS_CTYPE=t.ALARM_TARGET_STATE_CTYPE=t.ALARM_CURRENT_STATE_CTYPE=t.TEMPERATURE_SENSOR_STYPE=t.HUMIDITY_SENSOR_STYPE=t.MOTION_SENSOR_STYPE=t.CONTACT_SENSOR_STYPE=t.OCCUPANCY_SENSOR_STYPE=t.WINDOW_COVERING_STYPE=t.ALARM_STYPE=t.LOCK_MANAGEMENT_STYPE=t.LOCK_MECHANISM_STYPE=t.OUTLET_STYPE=t.FAN_STYPE=t.ACCESSORY_INFORMATION_STYPE=t.GARAGE_DOOR_OPENER_STYPE=t.THERMOSTAT_STYPE=t.SWITCH_STYPE=t.LIGHTBULB_STYPE=t.PROGRAMMABLE_SWITCH_TCTYPE=t.WINDOW_COVERING_TCTYPE=t.WINDOW_TCTYPE=t.DOOR_TCTYPE=t.ALARM_SYSTEM_TCTYPE=t.SENSOR_TCTYPE=t.THERMOSTAT_TCTYPE=t.SWITCH_TCTYPE=t.OUTLET_TCTYPE=t.DOOR_LOCK_TCTYPE=t.LIGHTBULB_TCTYPE=t.GARAGE_DOOR_OPENER_TCTYPE=t.FAN_TCTYPE=t.OTHER_TCTYPE=void 0;t.TARGETHEATINGCOOLING_CTYPE=t.CURRENTHEATINGCOOLING_CTYPE=t.WINDOW_COVERING_OPERATION_STATE_CTYPE=t.WINDOW_COVERING_CURRENT_POSITION_CTYPE=t.WINDOW_COVERING_TARGET_POSITION_CTYPE=t.VERSION_CTYPE=t.TEMPERATURE_UNITS_CTYPE=t.TARGET_TEMPERATURE_CTYPE=t.TARGET_RELATIVE_HUMIDITY_CTYPE=t.TARGET_LOCK_MECHANISM_STATE_CTYPE=t.TARGET_DOORSTATE_CTYPE=t.STATUS_FAULT_CTYPE=t.STATUS_LOW_BATTERY_CTYPE=t.FIRMWARE_REVISION_CTYPE=t.SERIAL_NUMBER_CTYPE=t.SATURATION_CTYPE=t.ROTATION_SPEED_CTYPE=t.ROTATION_DIRECTION_CTYPE=t.PROGRAMMABLE_SWITCH_OUTPUT_STATE_CTYPE=t.PROGRAMMABLE_SWITCH_SWITCH_EVENT_CTYPE=t.POWER_STATE_CTYPE=t.OCCUPANCY_DETECTED_CTYPE=t.OUTLET_IN_USE_CTYPE=t.OBSTRUCTION_DETECTED_CTYPE=t.NAME_CTYPE=t.MOTION_DETECTED_CTYPE=t.MODEL_CTYPE=void 0;var r="000000";var i="-0000-1000-8000-0026BB765291";t.OTHER_TCTYPE=1;t.FAN_TCTYPE=3;t.GARAGE_DOOR_OPENER_TCTYPE=4;t.LIGHTBULB_TCTYPE=5;t.DOOR_LOCK_TCTYPE=6;t.OUTLET_TCTYPE=7;t.SWITCH_TCTYPE=8;t.THERMOSTAT_TCTYPE=9;t.SENSOR_TCTYPE=10;t.ALARM_SYSTEM_TCTYPE=11;t.DOOR_TCTYPE=12;t.WINDOW_TCTYPE=13;t.WINDOW_COVERING_TCTYPE=14;t.PROGRAMMABLE_SWITCH_TCTYPE=15;t.LIGHTBULB_STYPE=r+"43"+i;t.SWITCH_STYPE=r+"49"+i;t.THERMOSTAT_STYPE=r+"4A"+i;t.GARAGE_DOOR_OPENER_STYPE=r+"41"+i;t.ACCESSORY_INFORMATION_STYPE=r+"3E"+i;t.FAN_STYPE=r+"40"+i;t.OUTLET_STYPE=r+"47"+i;t.LOCK_MECHANISM_STYPE=r+"45"+i;t.LOCK_MANAGEMENT_STYPE=r+"44"+i;t.ALARM_STYPE=r+"7E"+i;t.WINDOW_COVERING_STYPE=r+"8C"+i;t.OCCUPANCY_SENSOR_STYPE=r+"86"+i;t.CONTACT_SENSOR_STYPE=r+"80"+i;t.MOTION_SENSOR_STYPE=r+"85"+i;t.HUMIDITY_SENSOR_STYPE=r+"82"+i;t.TEMPERATURE_SENSOR_STYPE=r+"8A"+i;t.ALARM_CURRENT_STATE_CTYPE=r+"66"+i;t.ALARM_TARGET_STATE_CTYPE=r+"67"+i;t.ADMIN_ONLY_ACCESS_CTYPE=r+"01"+i;t.AUDIO_FEEDBACK_CTYPE=r+"05"+i;t.BRIGHTNESS_CTYPE=r+"08"+i;t.BATTERY_LEVEL_CTYPE=r+"68"+i;t.COOLING_THRESHOLD_CTYPE=r+"0D"+i;t.CONTACT_SENSOR_STATE_CTYPE=r+"6A"+i;t.CURRENT_DOOR_STATE_CTYPE=r+"0E"+i;t.CURRENT_LOCK_MECHANISM_STATE_CTYPE=r+"1D"+i;t.CURRENT_RELATIVE_HUMIDITY_CTYPE=r+"10"+i;t.CURRENT_TEMPERATURE_CTYPE=r+"11"+i;t.HEATING_THRESHOLD_CTYPE=r+"12"+i;t.HUE_CTYPE=r+"13"+i;t.IDENTIFY_CTYPE=r+"14"+i;t.LOCK_MANAGEMENT_AUTO_SECURE_TIMEOUT_CTYPE=r+"1A"+i;t.LOCK_MANAGEMENT_CONTROL_POINT_CTYPE=r+"19"+i;t.LOCK_MECHANISM_LAST_KNOWN_ACTION_CTYPE=r+"1C"+i;t.LOGS_CTYPE=r+"1F"+i;t.MANUFACTURER_CTYPE=r+"20"+i;t.MODEL_CTYPE=r+"21"+i;t.MOTION_DETECTED_CTYPE=r+"22"+i;t.NAME_CTYPE=r+"23"+i;t.OBSTRUCTION_DETECTED_CTYPE=r+"24"+i;t.OUTLET_IN_USE_CTYPE=r+"26"+i;t.OCCUPANCY_DETECTED_CTYPE=r+"71"+i;t.POWER_STATE_CTYPE=r+"25"+i;t.PROGRAMMABLE_SWITCH_SWITCH_EVENT_CTYPE=r+"73"+i;t.PROGRAMMABLE_SWITCH_OUTPUT_STATE_CTYPE=r+"74"+i;t.ROTATION_DIRECTION_CTYPE=r+"28"+i;t.ROTATION_SPEED_CTYPE=r+"29"+i;t.SATURATION_CTYPE=r+"2F"+i;t.SERIAL_NUMBER_CTYPE=r+"30"+i;t.FIRMWARE_REVISION_CTYPE=r+"52"+i;t.STATUS_LOW_BATTERY_CTYPE=r+"79"+i;t.STATUS_FAULT_CTYPE=r+"77"+i;t.TARGET_DOORSTATE_CTYPE=r+"32"+i;t.TARGET_LOCK_MECHANISM_STATE_CTYPE=r+"1E"+i;t.TARGET_RELATIVE_HUMIDITY_CTYPE=r+"34"+i;t.TARGET_TEMPERATURE_CTYPE=r+"35"+i;t.TEMPERATURE_UNITS_CTYPE=r+"36"+i;t.VERSION_CTYPE=r+"37"+i;t.WINDOW_COVERING_TARGET_POSITION_CTYPE=r+"7C"+i;t.WINDOW_COVERING_CURRENT_POSITION_CTYPE=r+"6D"+i;t.WINDOW_COVERING_OPERATION_STATE_CTYPE=r+"72"+i;t.CURRENTHEATINGCOOLING_CTYPE=r+"0F"+i;t.TARGETHEATINGCOOLING_CTYPE=r+"33"+i},1643:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.init=t.HAPLibraryVersion=t.LegacyTypes=t.uuid=t.AccessoryLoader=void 0;var i=r(6867);r(5957);r(9696);var n=i.__importDefault(r(7031));var a=r(3949);t.AccessoryLoader=i.__importStar(r(7097));t.uuid=i.__importStar(r(5752));i.__exportStar(r(3949),t);i.__exportStar(r(8719),t);i.__exportStar(r(3554),t);i.__exportStar(r(877),t);i.__exportStar(r(8117),t);i.__exportStar(r(7097),t);i.__exportStar(r(7270),t);i.__exportStar(r(6753),t);i.__exportStar(r(4080),t);i.__exportStar(r(4658),t);i.__exportStar(r(5691),t);i.__exportStar(r(3476),t);i.__exportStar(r(5164),t);i.__exportStar(r(7417),t);i.__exportStar(r(2571),t);i.__exportStar(r(2716),t);i.__exportStar(r(3223),t);i.__exportStar(r(9727),t);i.__exportStar(r(3939),t);i.__exportStar(r(1624),t);t.LegacyTypes=i.__importStar(r(3137));var o=(0,n.default)("HAP-NodeJS:Advertiser");function HAPLibraryVersion(){var e=r(6064);return e.version}t.HAPLibraryVersion=HAPLibraryVersion;function printInit(){o("Initializing HAP-NodeJS v%s ...",HAPLibraryVersion())}printInit();function init(e){console.log("DEPRECATED: The need to manually initialize HAP (by calling the init method) was removed. "+"If you want to set a custom storage path location, please ust HAPStorage.setCustomStoragePath directly. "+"This method will be removed in the next major update!");if(e){a.HAPStorage.setCustomStoragePath(e)}}t.init=init;var s=i.__importStar(r(6017));var c=i.__importStar(r(5893))},6711:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HAPMimeTypes=t.PairingStates=t.PairMethods=t.TLVValues=t.consideredTrue=void 0;function consideredTrue(e){if(!e){return false}return e==="true"||e==="1"}t.consideredTrue=consideredTrue;var r;(function(e){e[e["REQUEST_TYPE"]=0]="REQUEST_TYPE";e[e["METHOD"]=0]="METHOD";e[e["USERNAME"]=1]="USERNAME";e[e["IDENTIFIER"]=1]="IDENTIFIER";e[e["SALT"]=2]="SALT";e[e["PUBLIC_KEY"]=3]="PUBLIC_KEY";e[e["PASSWORD_PROOF"]=4]="PASSWORD_PROOF";e[e["ENCRYPTED_DATA"]=5]="ENCRYPTED_DATA";e[e["SEQUENCE_NUM"]=6]="SEQUENCE_NUM";e[e["STATE"]=6]="STATE";e[e["ERROR_CODE"]=7]="ERROR_CODE";e[e["RETRY_DELAY"]=8]="RETRY_DELAY";e[e["CERTIFICATE"]=9]="CERTIFICATE";e[e["PROOF"]=10]="PROOF";e[e["SIGNATURE"]=10]="SIGNATURE";e[e["PERMISSIONS"]=11]="PERMISSIONS";e[e["FRAGMENT_DATA"]=12]="FRAGMENT_DATA";e[e["FRAGMENT_LAST"]=13]="FRAGMENT_LAST";e[e["SEPARATOR"]=255]="SEPARATOR"})(r=t.TLVValues||(t.TLVValues={}));var i;(function(e){e[e["PAIR_SETUP"]=0]="PAIR_SETUP";e[e["PAIR_SETUP_WITH_AUTH"]=1]="PAIR_SETUP_WITH_AUTH";e[e["PAIR_VERIFY"]=2]="PAIR_VERIFY";e[e["ADD_PAIRING"]=3]="ADD_PAIRING";e[e["REMOVE_PAIRING"]=4]="REMOVE_PAIRING";e[e["LIST_PAIRINGS"]=5]="LIST_PAIRINGS"})(i=t.PairMethods||(t.PairMethods={}));var n;(function(e){e[e["M1"]=1]="M1";e[e["M2"]=2]="M2";e[e["M3"]=3]="M3";e[e["M4"]=4]="M4";e[e["M5"]=5]="M5";e[e["M6"]=6]="M6"})(n=t.PairingStates||(t.PairingStates={}));var a;(function(e){e["PAIRING_TLV8"]="application/pairing+tlv8";e["HAP_JSON"]="application/hap+json";e["IMAGE_JPEG"]="image/jpeg"})(a=t.HAPMimeTypes||(t.HAPMimeTypes={}))},8719:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Accessory=t.AccessoryEventTypes=t.MDNSAdvertiser=t.CharacteristicWarningType=t.Categories=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=i.__importDefault(r(6113));var o=i.__importDefault(r(7031));var s=r(2361);var c=i.__importDefault(r(1808));var u=r(3524);var l=r(7270);var d=r(8117);var h=r(5691);var p=r(4080);var v=r(3476);var m=r(786);var g=r(4245);var y=r(877);var C=r(5164);var T=r(1996);var E=i.__importStar(r(5752));var D=r(5752);var _=(0,o.default)("HAP-NodeJS:Accessory");var I=149;var b=100;var w;(function(e){e[e["OTHER"]=1]="OTHER";e[e["BRIDGE"]=2]="BRIDGE";e[e["FAN"]=3]="FAN";e[e["GARAGE_DOOR_OPENER"]=4]="GARAGE_DOOR_OPENER";e[e["LIGHTBULB"]=5]="LIGHTBULB";e[e["DOOR_LOCK"]=6]="DOOR_LOCK";e[e["OUTLET"]=7]="OUTLET";e[e["SWITCH"]=8]="SWITCH";e[e["THERMOSTAT"]=9]="THERMOSTAT";e[e["SENSOR"]=10]="SENSOR";e[e["ALARM_SYSTEM"]=11]="ALARM_SYSTEM";e[e["SECURITY_SYSTEM"]=11]="SECURITY_SYSTEM";e[e["DOOR"]=12]="DOOR";e[e["WINDOW"]=13]="WINDOW";e[e["WINDOW_COVERING"]=14]="WINDOW_COVERING";e[e["PROGRAMMABLE_SWITCH"]=15]="PROGRAMMABLE_SWITCH";e[e["RANGE_EXTENDER"]=16]="RANGE_EXTENDER";e[e["CAMERA"]=17]="CAMERA";e[e["IP_CAMERA"]=17]="IP_CAMERA";e[e["VIDEO_DOORBELL"]=18]="VIDEO_DOORBELL";e[e["AIR_PURIFIER"]=19]="AIR_PURIFIER";e[e["AIR_HEATER"]=20]="AIR_HEATER";e[e["AIR_CONDITIONER"]=21]="AIR_CONDITIONER";e[e["AIR_HUMIDIFIER"]=22]="AIR_HUMIDIFIER";e[e["AIR_DEHUMIDIFIER"]=23]="AIR_DEHUMIDIFIER";e[e["APPLE_TV"]=24]="APPLE_TV";e[e["HOMEPOD"]=25]="HOMEPOD";e[e["SPEAKER"]=26]="SPEAKER";e[e["AIRPORT"]=27]="AIRPORT";e[e["SPRINKLER"]=28]="SPRINKLER";e[e["FAUCET"]=29]="FAUCET";e[e["SHOWER_HEAD"]=30]="SHOWER_HEAD";e[e["TELEVISION"]=31]="TELEVISION";e[e["TARGET_CONTROLLER"]=32]="TARGET_CONTROLLER";e[e["ROUTER"]=33]="ROUTER";e[e["AUDIO_RECEIVER"]=34]="AUDIO_RECEIVER";e[e["TV_SET_TOP_BOX"]=35]="TV_SET_TOP_BOX";e[e["TV_STREAMING_STICK"]=36]="TV_STREAMING_STICK"})(w=t.Categories||(t.Categories={}));var R;(function(e){e["SLOW_WRITE"]="slow-write";e["TIMEOUT_WRITE"]="timeout-write";e["SLOW_READ"]="slow-read";e["TIMEOUT_READ"]="timeout-read";e["WARN_MESSAGE"]="warn-message";e["ERROR_MESSAGE"]="error-message";e["DEBUG_MESSAGE"]="debug-message"})(R=t.CharacteristicWarningType||(t.CharacteristicWarningType={}));var N;(function(e){e["CIAO"]="ciao";e["BONJOUR"]="bonjour-hap";e["AVAHI"]="avahi";e["RESOLVED"]="resolved"})(N=t.MDNSAdvertiser||(t.MDNSAdvertiser={}));var U;(function(e){e[e["REGULAR_REQUEST"]=0]="REGULAR_REQUEST";e[e["TIMED_WRITE_AUTHENTICATED"]=1]="TIMED_WRITE_AUTHENTICATED";e[e["TIMED_WRITE_REJECTED"]=2]="TIMED_WRITE_REJECTED"})(U||(U={}));var P;(function(e){e["IDENTIFY"]="identify";e["LISTENING"]="listening";e["ADVERTISED"]="advertised";e["SERVICE_CONFIGURATION_CHANGE"]="service-configurationChange";e["SERVICE_CHARACTERISTIC_CHANGE"]="service-characteristic-change";e["PAIRED"]="paired";e["UNPAIRED"]="unpaired";e["CHARACTERISTIC_WARNING"]="characteristic-warning"})(P=t.AccessoryEventTypes||(t.AccessoryEventTypes={}));var O=function(e){i.__extends(Accessory,e);function Accessory(t,r){var i=e.call(this)||this;i.displayName=t;i.UUID=r;i.aid=null;i._isBridge=false;i.bridged=false;i.bridgedAccessories=[];i.reachable=true;i.category=1;i.services=[];i.shouldPurgeUnusedIDs=true;i.initialized=false;i.controllers={};i._setupID=null;i.controllerStorage=new m.ControllerStorage(i);i.lastAccessoriesRequest=0;i.getPrimaryAccessory=function(){return i.bridged?i.bridge:i};(0,n.default)(t,"Accessories must be created with a non-empty displayName.");(0,n.default)(r,"Accessories must be created with a valid UUID.");(0,n.default)(E.isValid(r),"UUID '"+r+"' is not a valid UUID. Try using the provided 'generateUUID' function to create a "+"valid UUID from any arbitrary string, like a serial number.");i.addService(y.Service.AccessoryInformation).setCharacteristic(d.Characteristic.Name,t);i.getService(y.Service.AccessoryInformation).getCharacteristic(d.Characteristic.Identify).on("set",(function(e,t){if(e){var r=true;i.identificationRequest(r,t)}}));return i}Accessory.prototype.identificationRequest=function(e,t){_("[%s] Identification request",this.displayName);if(this.listeners("identify").length>0){this.emit("identify",e,t)}else{_("[%s] Identification request ignored; no listeners to 'identify' event",this.displayName);t()}};Accessory.prototype.addService=function(e){var t,r;var n=[];for(var a=1;a<arguments.length;a++){n[a-1]=arguments[a]}var o=typeof e==="function"?new e(n[0],n[1],n[2]):e;try{for(var s=i.__values(this.services),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.UUID===o.UUID){if(!o.subtype){throw new Error("Cannot add a Service with the same UUID '"+u.UUID+"' as another Service in this Accessory without also defining a unique 'subtype' property.")}if(o.subtype===u.subtype){throw new Error("Cannot add a Service with the same UUID '"+u.UUID+"' and subtype '"+u.subtype+"' as another Service in this Accessory.")}}}}catch(e){t={error:e}}finally{try{if(c&&!c.done&&(r=s.return))r.call(s)}finally{if(t)throw t.error}}if(this.services.length>=b){throw new Error("Cannot add more than "+b+" services to a single accessory!")}this.services.push(o);if(o.isPrimaryService){if(this.primaryService!==undefined){this.primaryService.isPrimaryService=false}this.primaryService=o}if(!this.bridged){this.enqueueConfigurationUpdate()}else{this.emit("service-configurationChange",{service:o})}this.setupServiceEventHandlers(o);return o};Accessory.prototype.setPrimaryService=function(e){e.setPrimaryService()};Accessory.prototype.removeService=function(e){var t=this.services.indexOf(e);if(t>=0){this.services.splice(t,1);if(this.primaryService===e){this.primaryService=undefined}this.removeLinkedService(e);if(!this.bridged){this.enqueueConfigurationUpdate()}else{this.emit("service-configurationChange",{service:e})}e.removeAllListeners()}};Accessory.prototype.removeLinkedService=function(e){var t,r;try{for(var n=i.__values(this.services),a=n.next();!a.done;a=n.next()){var o=a.value;o.removeLinkedService(e)}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}};Accessory.prototype.getService=function(e){var t,r;try{for(var n=i.__values(this.services),a=n.next();!a.done;a=n.next()){var o=a.value;if(typeof e==="string"&&(o.displayName===e||o.name===e||o.subtype===e)){return o}else if(typeof e==="function"&&(o instanceof e||e.UUID===o.UUID)){return o}}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}return undefined};Accessory.prototype.getServiceById=function(e,t){var r,n;try{for(var a=i.__values(this.services),o=a.next();!o.done;o=a.next()){var s=o.value;if(typeof e==="string"&&(s.displayName===e||s.name===e)&&s.subtype===t){return s}else if(typeof e==="function"&&(s instanceof e||e.UUID===s.UUID)&&s.subtype===t){return s}}}catch(e){r={error:e}}finally{try{if(o&&!o.done&&(n=a.return))n.call(a)}finally{if(r)throw r.error}}return undefined};Accessory.prototype.updateReachability=function(e){if(!this.bridged){throw new Error("Cannot update reachability on non-bridged accessory!")}this.reachable=e;_("Reachability update is no longer being supported.")};Accessory.prototype.addBridgedAccessory=function(e,t){var r=this;if(t===void 0){t=false}if(e._isBridge||e===this){throw new Error("Illegal state: either trying to bridge a bridge or trying to bridge itself!")}if(e.initialized){throw new Error("Tried to bridge an accessory which was already published once!")}if(e.bridge!=null){throw new Error("Tried to bridge "+e.displayName+" while it was already bridged by "+e.bridge.displayName)}if(this.bridgedAccessories.length>=I){throw new Error("Cannot Bridge more than "+I+" Accessories")}e.on("service-characteristic-change",(function(t){return r.handleCharacteristicChangeEvent(e,t.service,t)}));e.on("service-configurationChange",this.enqueueConfigurationUpdate.bind(this));e.on("characteristic-warning",this.handleCharacteristicWarning.bind(this));e.bridged=true;e.bridge=this;this.bridgedAccessories.push(e);this.controllerStorage.linkAccessory(e);if(!t){this.enqueueConfigurationUpdate()}return e};Accessory.prototype.addBridgedAccessories=function(e){var t,r;try{for(var n=i.__values(e),a=n.next();!a.done;a=n.next()){var o=a.value;this.addBridgedAccessory(o,true)}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}this.enqueueConfigurationUpdate()};Accessory.prototype.removeBridgedAccessory=function(e,t){if(t===void 0){t=false}var r=this.bridgedAccessories.indexOf(e);if(r===-1){throw new Error("Cannot find the bridged Accessory to remove.")}this.bridgedAccessories.splice(r,1);e.bridged=false;e.bridge=undefined;e.removeAllListeners();if(!t){this.enqueueConfigurationUpdate()}};Accessory.prototype.removeBridgedAccessories=function(e){var t,r;try{for(var n=i.__values(e),a=n.next();!a.done;a=n.next()){var o=a.value;this.removeBridgedAccessory(o,true)}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}this.enqueueConfigurationUpdate()};Accessory.prototype.removeAllBridgedAccessories=function(){for(var e=this.bridgedAccessories.length-1;e>=0;e--){this.removeBridgedAccessory(this.bridgedAccessories[e],true)}this.enqueueConfigurationUpdate()};Accessory.prototype.getCharacteristicByIID=function(e){var t,r;try{for(var n=i.__values(this.services),a=n.next();!a.done;a=n.next()){var o=a.value;var s=o.getCharacteristicByIID(e);if(s){return s}}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}};Accessory.prototype.getAccessoryByAID=function(e){if(this.aid===e){return this}return this.bridgedAccessories.find((function(t){return t.aid===e}))};Accessory.prototype.findCharacteristic=function(e,t){var r=this.getAccessoryByAID(e);return r&&r.getCharacteristicByIID(t)};Accessory.prototype.configureCameraSource=function(e){var t=this;if(e.streamControllers.length===0){throw new Error("Malformed legacy CameraSource. Did not expose any StreamControllers!")}var r=e.streamControllers[0].options;var i={cameraStreamCount:e.streamControllers.length,streamingOptions:r,delegate:new l.LegacyCameraSourceAdapter(e)};var n=new h.CameraController(i,true);this.configureController(n);e.services.forEach((function(e){if(e.UUID===y.Service.CameraRTPStreamManagement.UUID||e.UUID===y.Service.CameraOperatingMode.UUID||e.UUID===y.Service.CameraRecordingManagement.UUID){return}t.addService(e)}));e.streamControllers=n.streamManagements;return n};Accessory.prototype.configureController=function(e){var t=this;var r=typeof e==="function"?new e:e;var i=r.controllerId();if(this.controllers[i]){throw new Error("A Controller with the type/id '".concat(i,"' was already added to the accessory ").concat(this.displayName))}var n=this.serializedControllers&&this.serializedControllers[i];var a;if(n){var o=(0,C.clone)(n);var s=r.initWithServices(n);a=s||n;if(s){this.handleUpdatedControllerServiceMap(o,s)}r.configureServices();delete this.serializedControllers[i];if(Object.entries(this.serializedControllers).length===0){this.serializedControllers=undefined}}else{a=r.constructServices();r.configureServices();Object.values(a).forEach((function(e){if(e&&!t.services.includes(e)){t.addService(e)}}))}var c={controller:r,serviceMap:a};if((0,h.isSerializableController)(r)){this.controllerStorage.trackController(r)}this.controllers[i]=c;if(r instanceof h.CameraController){this.activeCameraController=r}};Accessory.prototype.removeController=function(e){var t=this;var r=e.controllerId();var i=this.controllers[r];if(i){if(i.controller!==e){throw new Error("["+this.displayName+"] tried removing a controller with the id/type '"+r+"' though provided controller isn't the same instance that is registered!")}if((0,h.isSerializableController)(e)){this.controllerStorage.untrackController(e)}if(e.handleFactoryReset){e.handleFactoryReset()}e.handleControllerRemoved();delete this.controllers[r];if(this.activeCameraController===e){this.activeCameraController=undefined}Object.values(i.serviceMap).forEach((function(e){if(e){t.removeService(e)}}))}if(this.serializedControllers){delete this.serializedControllers[r]}};Accessory.prototype.handleAccessoryUnpairedForControllers=function(){var e,t;try{for(var r=i.__values(Object.values(this.controllers)),n=r.next();!n.done;n=r.next()){var a=n.value;var o=a.controller;if(o.handleFactoryReset){o.handleFactoryReset()}if((0,h.isSerializableController)(o)){this.controllerStorage.purgeControllerData(o)}}}catch(t){e={error:t}}finally{try{if(n&&!n.done&&(t=r.return))t.call(r)}finally{if(e)throw e.error}}};Accessory.prototype.handleUpdatedControllerServiceMap=function(e,t){var r=this;t=(0,C.clone)(t);Object.keys(e).forEach((function(i){var n=e[i];var a=t[i];if(n&&a){delete e[i];delete t[i];if(n!==a){r.removeService(n);r.addService(a)}}}));Object.values(e).forEach((function(e){if(e){r.removeService(e)}}));Object.values(t).forEach((function(e){if(e){r.addService(e)}}))};Accessory.prototype.setupURI=function(){if(this._setupURI){return this._setupURI}(0,n.default)(!!this._accessoryInfo,"Cannot generate setupURI on an accessory that isn't published yet!");var e=Buffer.alloc(8);var t=parseInt(this._accessoryInfo.pincode.replace(/-/g,""),10);var r=this._accessoryInfo.category>>1;t|=1<<28;e.writeUInt32BE(t,4);if(this._accessoryInfo.category&1){e[4]=e[4]|1<<7}e.writeUInt32BE(r,0);var i=(e.readUInt32BE(4)+e.readUInt32BE(0)*4294967296).toString(36).toUpperCase();if(i.length!==9){for(var a=0;a<=9-i.length;a++){i="0"+i}}this._setupURI="X-HM://"+i+this._setupID;return this._setupURI};Accessory.prototype.validateAccessory=function(e){var t=this;var r=this.getService(y.Service.AccessoryInformation);if(!r){console.log("HAP-NodeJS WARNING: The accessory '"+this.displayName+"' is getting published without a AccessoryInformation service. "+"This might prevent the accessory from being added to the Home app or leading to the accessory being unresponsive!")}else{var checkValue=function(e,r){if(!r){console.log("HAP-NodeJS WARNING: The accessory '"+t.displayName+"' is getting published with the characteristic '"+e+"'"+" (of the AccessoryInformation service) not having a value set. "+"This might prevent the accessory from being added to the Home App or leading to the accessory being unresponsive!")}};var i=r.getCharacteristic(d.Characteristic.Model).value;var a=r.getCharacteristic(d.Characteristic.SerialNumber).value;var o=r.getCharacteristic(d.Characteristic.FirmwareRevision).value;var s=r.getCharacteristic(d.Characteristic.Name).value;checkValue("Model",i);checkValue("SerialNumber",a);checkValue("FirmwareRevision",o);checkValue("Name",s)}if(e){(0,n.default)(Buffer.from(this.displayName,"utf8").length<=63,"Accessory displayName cannot be longer than 63 bytes!")}if(this.bridged){this.bridgedAccessories.forEach((function(e){return e.validateAccessory()}))}};Accessory.prototype._assignIDs=function(e){var t,r,n,a;if(this._identifierCache&&this.shouldPurgeUnusedIDs){this._identifierCache.startTrackingUsage()}if(this.bridged){this.aid=e.getAID(this.UUID)}else{this.aid=1}try{for(var o=i.__values(this.services),s=o.next();!s.done;s=o.next()){var c=s.value;if(this._isBridge){c._assignIDs(e,this.UUID,2e9)}else{c._assignIDs(e,this.UUID)}}}catch(e){t={error:e}}finally{try{if(s&&!s.done&&(r=o.return))r.call(o)}finally{if(t)throw t.error}}try{for(var u=i.__values(this.bridgedAccessories),l=u.next();!l.done;l=u.next()){var d=l.value;d._assignIDs(e)}}catch(e){n={error:e}}finally{try{if(l&&!l.done&&(a=u.return))a.call(u)}finally{if(n)throw n.error}}if(this._identifierCache){if(this.shouldPurgeUnusedIDs){this._identifierCache.stopTrackingUsageAndExpireUnused()}this._identifierCache.save()}};Accessory.prototype.disableUnusedIDPurge=function(){this.shouldPurgeUnusedIDs=false};Accessory.prototype.enableUnusedIDPurge=function(){this.shouldPurgeUnusedIDs=true};Accessory.prototype.purgeUnusedIDs=function(){var e=this.shouldPurgeUnusedIDs;this.shouldPurgeUnusedIDs=true;this._assignIDs(this._identifierCache);this.shouldPurgeUnusedIDs=e};Accessory.prototype.toHAP=function(e,t){if(t===void 0){t=true}return i.__awaiter(this,void 0,void 0,(function(){var r,a,o,s,c,u;var l;return i.__generator(this,(function(d){switch(d.label){case 0:(0,n.default)(this.aid,"aid cannot be undefined for accessory '"+this.displayName+"'");(0,n.default)(this.services.length,"accessory '"+this.displayName+"' does not have any services!");l={aid:this.aid};return[4,Promise.all(this.services.map((function(r){return r.toHAP(e,t)})))];case 1:r=(l.services=d.sent(),l);a=[r];if(!!this.bridged)return[3,3];s=(o=a.push).apply;c=[a];u=[[]];return[4,Promise.all(this.bridgedAccessories.map((function(r){return r.toHAP(e,t).then((function(e){return e[0]}))})))];case 2:s.apply(o,c.concat([i.__spreadArray.apply(void 0,u.concat([i.__read.apply(void 0,[d.sent()]),false]))]));d.label=3;case 3:return[2,a]}}))}))};Accessory.prototype.internalHAPRepresentation=function(e){var t,r;if(e===void 0){e=true}if(e){this._assignIDs(this._identifierCache)}(0,n.default)(this.aid,"aid cannot be undefined for accessory '"+this.displayName+"'");(0,n.default)(this.services.length,"accessory '"+this.displayName+"' does not have any services!");var a={aid:this.aid,services:this.services.map((function(e){return e.internalHAPRepresentation()}))};var o=[a];if(!this.bridged){try{for(var s=i.__values(this.bridgedAccessories),c=s.next();!c.done;c=s.next()){var u=c.value;o.push(u.internalHAPRepresentation(false)[0])}}catch(e){t={error:e}}finally{try{if(c&&!c.done&&(r=s.return))r.call(s)}finally{if(t)throw t.error}}}return o};Accessory.prototype.publish=function(e,t){var r,n,o;return i.__awaiter(this,void 0,void 0,(function(){var s,c,l,h,m,C,T;var E=this;return i.__generator(this,(function(i){switch(i.label){case 0:if(this.bridged){throw new Error("Can't publish in accessory which is bridged by another accessory. Bridged by "+((r=this.bridge)===null||r===void 0?void 0:r.displayName))}if(!e.advertiser&&e.useLegacyAdvertiser!=null){e.advertiser=e.useLegacyAdvertiser?"bonjour-hap":"ciao";console.warn("DEPRECATED The PublishInfo.useLegacyAdvertiser option has been removed. "+'Please use the PublishInfo.advertiser property to enable "ciao" (useLegacyAdvertiser=false) '+'or "bonjour-hap" (useLegacyAdvertiser=true) mdns advertiser libraries!')}if(e.mdns&&e.advertiser!=="bonjour-hap"){console.log("DEPRECATED user supplied a custom 'mdns' option. This option is deprecated and ignored. "+"Please move to the new 'bind' option.")}s=this.getService(y.Service.ProtocolInformation);if(!s){s=this.addService(y.Service.ProtocolInformation)}s.setCharacteristic(d.Characteristic.Version,u.CiaoAdvertiser.protocolVersionService);if(this.lastKnownUsername&&this.lastKnownUsername!==e.username){Accessory.cleanupAccessoryData(this.lastKnownUsername)}if(!this.initialized&&((n=e.addIdentifyingMaterial)!==null&&n!==void 0?n:true)){this.displayName=this.displayName+" "+a.default.createHash("sha512").update(e.username,"utf8").digest("hex").slice(0,4).toUpperCase();this.getService(y.Service.AccessoryInformation).updateCharacteristic(d.Characteristic.Name,this.displayName)}this._accessoryInfo=v.AccessoryInfo.load(e.username);if(!this._accessoryInfo){_("[%s] Creating new AccessoryInfo for our HAP server",this.displayName);this._accessoryInfo=v.AccessoryInfo.create(e.username)}if(e.setupID){this._setupID=e.setupID}else if(this._accessoryInfo.setupID===undefined||this._accessoryInfo.setupID===""){this._setupID=Accessory._generateSetupID()}else{this._setupID=this._accessoryInfo.setupID}this._accessoryInfo.setupID=this._setupID;this._accessoryInfo.displayName=this.displayName;this._accessoryInfo.model=this.getService(y.Service.AccessoryInformation).getCharacteristic(d.Characteristic.Model).value;this._accessoryInfo.category=e.category||1;this._accessoryInfo.pincode=e.pincode;this._accessoryInfo.save();this._identifierCache=g.IdentifierCache.load(e.username);if(!this._identifierCache){_("[%s] Creating new IdentifierCache",this.displayName);this._identifierCache=new g.IdentifierCache(e.username)}if(this._isBridge&&this.bridgedAccessories.length===0){this.disableUnusedIDPurge();this.controllerStorage.purgeUnidentifiedAccessoryData=false}if(!this.initialized){this.controllerStorage.load(e.username)}this._assignIDs(this._identifierCache);c=this.internalHAPRepresentation(false);this._accessoryInfo.checkForCurrentConfigurationNumberIncrement(c,true);this.validateAccessory(true);l=Accessory.parseBindOption(e);h=(o=e.advertiser)!==null&&o!==void 0?o:"bonjour-hap";C=e.advertiser==="avahi";if(!C)return[3,2];return[4,u.AvahiAdvertiser.isAvailable()];case 1:C=!i.sent();i.label=2;case 2:m=C;if(m)return[3,5];T=e.advertiser==="resolved";if(!T)return[3,4];return[4,u.ResolvedAdvertiser.isAvailable()];case 3:T=!i.sent();i.label=4;case 4:m=T;i.label=5;case 5:if(m){console.error("[".concat(this.displayName,'] The selected advertiser, "').concat(e.advertiser,"\", isn't available on this platform. ")+'Reverting to "'.concat("bonjour-hap",'"'));h="bonjour-hap"}switch(h){case"ciao":this._advertiser=new u.CiaoAdvertiser(this._accessoryInfo,{interface:l.advertiserAddress},{restrictedAddresses:l.serviceRestrictedAddress,disabledIpv6:l.serviceDisableIpv6});break;case"bonjour-hap":this._advertiser=new u.BonjourHAPAdvertiser(this._accessoryInfo,e.mdns,{restrictedAddresses:l.serviceRestrictedAddress,disabledIpv6:l.serviceDisableIpv6});break;case"avahi":this._advertiser=new u.AvahiAdvertiser(this._accessoryInfo);break;case"resolved":this._advertiser=new u.ResolvedAdvertiser(this._accessoryInfo);break;default:throw new Error("Unsupported advertiser setting: '"+e.advertiser+"'")}this._advertiser.on("updated-name",(function(e){E.displayName=e;if(E._accessoryInfo){E._accessoryInfo.displayName=e;E._accessoryInfo.save()}E.getService(y.Service.AccessoryInformation).updateCharacteristic(d.Characteristic.Name,e)}));this._server=new p.HAPServer(this._accessoryInfo);this._server.allowInsecureRequest=!!t;this._server.on("listening",this.onListening.bind(this));this._server.on("identify",this.identificationRequest.bind(this,false));this._server.on("pair",this.handleInitialPairSetupFinished.bind(this));this._server.on("add-pairing",this.handleAddPairing.bind(this));this._server.on("remove-pairing",this.handleRemovePairing.bind(this));this._server.on("list-pairings",this.handleListPairings.bind(this));this._server.on("accessories",this.handleAccessories.bind(this));this._server.on("get-characteristics",this.handleGetCharacteristics.bind(this));this._server.on("set-characteristics",this.handleSetCharacteristics.bind(this));this._server.on("connection-closed",this.handleHAPConnectionClosed.bind(this));this._server.on("request-resource",this.handleResource.bind(this));this._server.listen(e.port,l.serverAddress);this.initialized=true;return[2]}}))}))};Accessory.prototype.destroy=function(){var e=this.unpublish();if(this._accessoryInfo){Accessory.cleanupAccessoryData(this._accessoryInfo.username);this._accessoryInfo=undefined;this._identifierCache=undefined;this.controllerStorage=new m.ControllerStorage(this)}this.removeAllListeners();return e};Accessory.prototype.unpublish=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:if(this._server){this._server.destroy();this._server=undefined}if(!this._advertiser)return[3,2];return[4,this._advertiser.destroy()];case 1:e.sent();this._advertiser=undefined;e.label=2;case 2:return[2]}}))}))};Accessory.prototype.enqueueConfigurationUpdate=function(){var e=this;if(this.configurationChangeDebounceTimeout){return}this.configurationChangeDebounceTimeout=setTimeout((function(){var t;e.configurationChangeDebounceTimeout=undefined;if(e._advertiser&&e._advertiser){var r=e.internalHAPRepresentation();if((t=e._accessoryInfo)===null||t===void 0?void 0:t.checkForCurrentConfigurationNumberIncrement(r)){e._advertiser.updateAdvertisement()}}}),1e3);this.configurationChangeDebounceTimeout.unref()};Accessory.prototype.onListening=function(e,t){var r=this;(0,n.default)(this._advertiser,"Advertiser wasn't created at onListening!");this._advertiser.initPort(e);this._advertiser.startAdvertising().then((function(){return r.emit("advertised")})).catch((function(e){return console.error("Could not create mDNS advertisement. The HAP-Server won't be discoverable: "+e)}));this.emit("listening",e,t)};Accessory.prototype.handleInitialPairSetupFinished=function(e,t,r){_("[%s] Paired with client %s",this.displayName,e);this._accessoryInfo&&this._accessoryInfo.addPairedClient(e,t,1);this._accessoryInfo&&this._accessoryInfo.save();this._advertiser&&this._advertiser.updateAdvertisement();r();this.emit("paired")};Accessory.prototype.handleAddPairing=function(e,t,r,i,n){if(!this._accessoryInfo){n(6);return}if(!this._accessoryInfo.hasAdminPermissions(e.username)){n(2);return}var a=this._accessoryInfo.getClientPublicKey(t);if(a){if(a.toString()!==r.toString()){n(1);return}this._accessoryInfo.updatePermission(t,i)}else{this._accessoryInfo.addPairedClient(t,r,i)}this._accessoryInfo.save();n(0)};Accessory.prototype.handleRemovePairing=function(e,t,r){var n,a;if(!this._accessoryInfo){r(6);return}if(!this._accessoryInfo.hasAdminPermissions(e.username)){r(2);return}this._accessoryInfo.removePairedClient(e,t);this._accessoryInfo.save();r(0);if(!this._accessoryInfo.paired()){this._advertiser&&this._advertiser.updateAdvertisement();this.emit("unpaired");this.handleAccessoryUnpairedForControllers();try{for(var o=i.__values(this.bridgedAccessories),s=o.next();!s.done;s=o.next()){var c=s.value;c.handleAccessoryUnpairedForControllers()}}catch(e){n={error:e}}finally{try{if(s&&!s.done&&(a=o.return))a.call(o)}finally{if(n)throw n.error}}}};Accessory.prototype.handleListPairings=function(e,t){if(!this._accessoryInfo){t(6);return}if(!this._accessoryInfo.hasAdminPermissions(e.username)){t(2);return}t(0,this._accessoryInfo.listPairings())};Accessory.prototype.handleAccessories=function(e,t){var r=this;this._assignIDs(this._identifierCache);var i=Date.now();var n=i-this.lastAccessoriesRequest>5e3;this.lastAccessoriesRequest=i;this.toHAP(e,n).then((function(e){t(undefined,{accessories:e})}),(function(e){console.error("["+r.displayName+"] /accessories request error with: "+e.stack);t({httpCode:500,status:-70402})}))};Accessory.prototype.handleGetCharacteristics=function(e,t,r){var n,a;var o=this;var s=[];var c={characteristics:s};var u=new Set(t.ids.map((function(e){return e.aid+"."+e.iid})));if(u.size!==t.ids.length){r({httpCode:422,status:-70410});return}var l=setTimeout((function(){var e,t;try{for(var n=i.__values(u),a=n.next();!a.done;a=n.next()){var d=a.value;var h=d.split(".");var p=parseInt(h[0],10);var v=parseInt(h[1],10);var m=o.getAccessoryByAID(p);var g=m.getCharacteristicByIID(v);o.sendCharacteristicWarning(g,"slow-read","The read handler for the characteristic '"+g.displayName+"' on the accessory '"+m.displayName+"' was slow to respond!")}}catch(t){e={error:t}}finally{try{if(a&&!a.done&&(t=n.return))t.call(n)}finally{if(e)throw e.error}}l=setTimeout((function(){var e,t;l=undefined;try{for(var n=i.__values(u),a=n.next();!a.done;a=n.next()){var d=a.value;var h=d.split(".");var p=parseInt(h[0],10);var v=parseInt(h[1],10);var m=o.getAccessoryByAID(p);var g=m.getCharacteristicByIID(v);o.sendCharacteristicWarning(g,"timeout-read","The read handler for the characteristic '"+g.displayName+"' on the accessory '"+m.displayName+"' didn't respond at all!. "+"Please check that you properly call the callback!");s.push({aid:p,iid:v,status:-70408})}}catch(t){e={error:t}}finally{try{if(a&&!a.done&&(t=n.return))t.call(n)}finally{if(e)throw e.error}}u.clear();r(undefined,c)}),Accessory.TIMEOUT_AFTER_WARNING);l.unref()}),Accessory.TIMEOUT_WARNING);l.unref();var _loop_1=function(n){var a=n.aid+"."+n.iid;d.handleCharacteristicRead(e,n,t).then((function(e){return i.__assign({aid:n.aid,iid:n.iid},e)}),(function(e){console.error("[".concat(o.displayName,"] Read request for characteristic ").concat(a," encountered an error: ").concat(e.stack));return{aid:n.aid,iid:n.iid,status:-70402}})).then((function(e){if(!l){return}u.delete(a);s.push(e);if(u.size===0){if(l){clearTimeout(l);l=undefined}r(undefined,c)}}))};var d=this;try{for(var h=i.__values(t.ids),p=h.next();!p.done;p=h.next()){var v=p.value;_loop_1(v)}}catch(e){n={error:e}}finally{try{if(p&&!p.done&&(a=h.return))a.call(h)}finally{if(n)throw n.error}}};Accessory.prototype.handleCharacteristicRead=function(e,t,r){return i.__awaiter(this,void 0,void 0,(function(){var n,a;var o=this;return i.__generator(this,(function(i){n=this.findCharacteristic(t.aid,t.iid);if(!n){_("[%s] Could not find a Characteristic with aid of %s and iid of %s",this.displayName,t.aid,t.iid);return[2,{status:-70410}]}if(!n.props.perms.includes("pr")){_("[%s] Tried reading from characteristic which does not allow reading (aid of %s and iid of %s)",this.displayName,t.aid,t.iid);return[2,{status:-70405}]}if(n.props.adminOnlyAccess&&n.props.adminOnlyAccess.includes(0)){a=this._accessoryInfo&&e.username;if(!a){_("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for reading (aid of %s and iid of %s)",this.displayName,t.aid,t.iid)}if(!a||!this._accessoryInfo.hasAdminPermissions(e.username)){return[2,{status:-70401}]}}return[2,n.handleGetRequest(e).then((function(i){i=(0,T.formatOutgoingCharacteristicValue)(i,n.props);_('[%s] Got Characteristic "%s" value: "%s"',o.displayName,n.displayName,i);var a={value:i==null?null:i};if(r.includeMeta){a.format=n.props.format;a.unit=n.props.unit;a.minValue=n.props.minValue;a.maxValue=n.props.maxValue;a.minStep=n.props.minStep;a.maxLen=n.props.maxLen||n.props.maxDataLen}if(r.includePerms){a.perms=n.props.perms}if(r.includeType){a.type=(0,D.toShortForm)(n.UUID)}if(r.includeEvent){a.ev=e.hasEventNotifications(t.aid,t.iid)}return a}),(function(e){_('[%s] Error getting value for characteristic "%s": %s',o.displayName,n.displayName,p.HAPStatus[e]);return{status:e}}))]}))}))};Accessory.prototype.handleSetCharacteristics=function(e,t,r){var n,a;var o=this;_("[%s] Processing characteristic set: %s",this.displayName,JSON.stringify(t));var s=0;if(t.pid!==undefined){if(e.timedWritePid===t.pid){s=1;clearTimeout(e.timedWriteTimeout);e.timedWritePid=undefined;e.timedWriteTimeout=undefined;_("[%s] Timed write request got acknowledged for pid %d",this.displayName,t.pid)}else{s=2;_("[%s] TTL for timed write request has probably expired for pid %d",this.displayName,t.pid)}}var c=[];var u={characteristics:c};var l=new Set(t.characteristics.map((function(e){return e.aid+"."+e.iid})));if(l.size!==t.characteristics.length){r({httpCode:422,status:-70410});return}var d=setTimeout((function(){var e,t;try{for(var n=i.__values(l),a=n.next();!a.done;a=n.next()){var s=a.value;var h=s.split(".");var p=parseInt(h[0],10);var v=parseInt(h[1],10);var m=o.getAccessoryByAID(p);var g=m.getCharacteristicByIID(v);o.sendCharacteristicWarning(g,"slow-write","The write handler for the characteristic '"+g.displayName+"' on the accessory '"+m.displayName+"' was slow to respond!")}}catch(t){e={error:t}}finally{try{if(a&&!a.done&&(t=n.return))t.call(n)}finally{if(e)throw e.error}}d=setTimeout((function(){var e,t;d=undefined;try{for(var n=i.__values(l),a=n.next();!a.done;a=n.next()){var s=a.value;var h=s.split(".");var p=parseInt(h[0],10);var v=parseInt(h[1],10);var m=o.getAccessoryByAID(p);var g=m.getCharacteristicByIID(v);o.sendCharacteristicWarning(g,"timeout-write","The write handler for the characteristic '"+g.displayName+"' on the accessory '"+m.displayName+"' didn't respond at all!. "+"Please check that you properly call the callback!");c.push({aid:p,iid:v,status:-70408})}}catch(t){e={error:t}}finally{try{if(a&&!a.done&&(t=n.return))t.call(n)}finally{if(e)throw e.error}}l.clear();r(undefined,u)}),Accessory.TIMEOUT_AFTER_WARNING);d.unref()}),Accessory.TIMEOUT_WARNING);d.unref();var _loop_2=function(t){var n=t.aid+"."+t.iid;h.handleCharacteristicWrite(e,t,s).then((function(e){return i.__assign({aid:t.aid,iid:t.iid},e)}),(function(e){console.error("[".concat(o.displayName,"] Write request for characteristic ").concat(n," encountered an error: ").concat(e.stack));return{aid:t.aid,iid:t.iid,status:-70402}})).then((function(e){if(!d){return}l.delete(n);c.push(e);if(l.size===0){if(d){clearTimeout(d);d=undefined}r(undefined,u)}}))};var h=this;try{for(var p=i.__values(t.characteristics),v=p.next();!v.done;v=p.next()){var m=v.value;_loop_2(m)}}catch(e){n={error:e}}finally{try{if(v&&!v.done&&(a=p.return))a.call(p)}finally{if(n)throw n.error}}};Accessory.prototype.handleCharacteristicWrite=function(e,t,r){return i.__awaiter(this,void 0,void 0,(function(){var n,a,o,a,s;var c=this;return i.__generator(this,(function(i){n=this.findCharacteristic(t.aid,t.iid);if(!n){_("[%s] Could not find a Characteristic with aid of %s and iid of %s",this.displayName,t.aid,t.iid);return[2,{status:-70410}]}if(r===2){return[2,{status:-70410}]}if(t.ev==null&&t.value==null){return[2,{status:-70410}]}if(t.ev!=null){if(!n.props.perms.includes("ev")){_("[%s] Tried %s notifications for Characteristic which does not allow notify (aid of %s and iid of %s)",this.displayName,t.ev?"enabling":"disabling",t.aid,t.iid);return[2,{status:-70406}]}if(n.props.adminOnlyAccess&&n.props.adminOnlyAccess.includes(2)){a=e.username&&this._accessoryInfo;if(!a){_("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for notify (aid of %s and iid of %s)",this.displayName,t.aid,t.iid)}if(!a||!this._accessoryInfo.hasAdminPermissions(e.username)){return[2,{status:-70401}]}}o=e.hasEventNotifications(t.aid,t.iid);if(t.ev&&!o){e.enableEventNotifications(t.aid,t.iid);n.subscribe();_('[%s] Registered Characteristic "%s" on "%s" for events',e.remoteAddress,n.displayName,this.displayName)}else if(!t.ev&&o){n.unsubscribe();e.disableEventNotifications(t.aid,t.iid);_('[%s] Unregistered Characteristic "%s" on "%s" for events',e.remoteAddress,n.displayName,this.displayName)}}if(t.value!=null){if(!n.props.perms.includes("pw")){_("[%s] Tried writing to Characteristic which does not allow writing (aid of %s and iid of %s)",this.displayName,t.aid,t.iid);return[2,{status:-70404}]}if(n.props.adminOnlyAccess&&n.props.adminOnlyAccess.includes(1)){a=e.username&&this._accessoryInfo;if(!a){_("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for write (aid of %s and iid of %s)",this.displayName,t.aid,t.iid)}if(!a||!this._accessoryInfo.hasAdminPermissions(e.username)){return[2,{status:-70401}]}}if(n.props.perms.includes("aa")&&n.additionalAuthorizationHandler){s=void 0;try{s=n.additionalAuthorizationHandler(t.authData)}catch(e){console.warn("["+this.displayName+"] Additional authorization handler has thrown an error when checking authData: "+e.stack);s=false}if(!s){return[2,{status:-70411}]}}if(n.props.perms.includes("tw")&&r!==1){_("[%s] Tried writing to a timed write only Characteristic without properly preparing (iid of %s and aid of %s)",this.displayName,t.aid,t.iid);return[2,{status:-70410}]}return[2,n.handleSetRequest(t.value,e).then((function(e){_('[%s] Setting Characteristic "%s" to value %s',c.displayName,n.displayName,t.value);return{value:t.r&&e?(0,T.formatOutgoingCharacteristicValue)(e,n.props):undefined,status:0}}),(function(e){_('[%s] Error setting Characteristic "%s" to value %s: ',c.displayName,n.displayName,t.value,p.HAPStatus[e]);return{status:e}}))]}return[2,{status:0}]}))}))};Accessory.prototype.handleResource=function(e,t){var r;if(e["resource-type"]==="image"){var i=e.aid;var n=undefined;var a=undefined;if(i){n=this.getAccessoryByAID(i);if(n&&n.activeCameraController){a=n.activeCameraController}}else if(this.activeCameraController){n=this;a=this.activeCameraController}if(!a){_("[%s] received snapshot request though no camera controller was associated!");t({httpCode:404,status:-70409});return}a.handleSnapshotRequest(e["image-height"],e["image-width"],n===null||n===void 0?void 0:n.displayName,e.reason).then((function(e){t(undefined,e)}),(function(e){t({httpCode:207,status:e})}));return}_("[%s] received request for unsupported image type: "+e["resource-type"],(r=this._accessoryInfo)===null||r===void 0?void 0:r.username);t({httpCode:404,status:-70409})};Accessory.prototype.handleHAPConnectionClosed=function(e){var t,r;if(this.activeCameraController){this.activeCameraController.handleCloseConnection(e.sessionID)}try{for(var n=i.__values(e.getRegisteredEvents()),a=n.next();!a.done;a=n.next()){var o=a.value;var s=o.split(".");var c=parseInt(s[0],10);var u=parseInt(s[1],10);var l=this.findCharacteristic(c,u);if(l){l.unsubscribe()}}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}e.clearRegisteredEvents()};Accessory.prototype.handleServiceConfigurationChangeEvent=function(e){if(!e.isPrimaryService&&e===this.primaryService){this.primaryService=undefined}else if(e.isPrimaryService&&e!==this.primaryService){if(this.primaryService!==undefined){this.primaryService.isPrimaryService=false}this.primaryService=e}if(this.bridged){this.emit("service-configurationChange",{service:e})}else{this.enqueueConfigurationUpdate()}};Accessory.prototype.handleCharacteristicChangeEvent=function(e,t,r){if(this.bridged){this.emit("service-characteristic-change",i.__assign(i.__assign({},r),{service:t}))}else{if(!this._server){return}if(e.aid==null||r.characteristic.iid==null){_("[%s] Muting event notification for %s as ids aren't yet assigned!",e.displayName,r.characteristic.displayName);return}if(r.context!=null&&typeof r.context==="object"&&r.context.omitEventUpdate){_("[%s] Omitting event updates for %s as specified in the context object!",e.displayName,r.characteristic.displayName);return}if(!(r.reason==="event"||r.oldValue!==r.newValue||r.characteristic.UUID===d.Characteristic.ProgrammableSwitchEvent.UUID||r.characteristic.UUID===d.Characteristic.ButtonEvent.UUID)){return}var n=r.characteristic.UUID;var a=n===d.Characteristic.ButtonEvent.UUID||n===d.Characteristic.ProgrammableSwitchEvent.UUID||n===d.Characteristic.MotionDetected.UUID||n===d.Characteristic.ContactSensorState.UUID;var o=(0,T.formatOutgoingCharacteristicValue)(r.newValue,r.characteristic.props);this._server.sendEventNotifications(e.aid,r.characteristic.iid,o,r.originator,a)}};Accessory.prototype.sendCharacteristicWarning=function(e,t,r){this.handleCharacteristicWarning({characteristic:e,type:t,message:r,originatorChain:[e.displayName],stack:(new Error).stack})};Accessory.prototype.handleCharacteristicWarning=function(e){var t;e.originatorChain=i.__spreadArray([this.displayName],i.__read(e.originatorChain),false);var r=this.emit("characteristic-warning",e);if(!r){var n="[".concat(e.originatorChain.join("@"),"] ").concat(e.message);if(e.type==="error-message"||e.type==="timeout-read"||e.type==="timeout-write"){console.error(n)}else{console.warn(n)}_("[%s] Above characteristic warning was thrown at: %s",this.displayName,(t=e.stack)!==null&&t!==void 0?t:"unknown")}};Accessory.prototype.setupServiceEventHandlers=function(e){e.on("service-configurationChange",this.handleServiceConfigurationChangeEvent.bind(this,e));e.on("characteristic-change",this.handleCharacteristicChangeEvent.bind(this,this,e));e.on("characteristic-warning",this.handleCharacteristicWarning.bind(this))};Accessory.prototype._sideloadServices=function(e){var t,r;var n=this;try{for(var a=i.__values(e),o=a.next();!o.done;o=a.next()){var s=o.value;this.setupServiceEventHandlers(s)}}catch(e){t={error:e}}finally{try{if(o&&!o.done&&(r=a.return))r.call(a)}finally{if(t)throw t.error}}this.services=e.slice();this.getService(y.Service.AccessoryInformation).getCharacteristic(d.Characteristic.Identify).on("set",(function(e,t){if(e){var r=true;n.identificationRequest(r,t)}}))};Accessory._generateSetupID=function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";var t=e.length;var r="";for(var i=0;i<4;i++){var n=Math.floor(Math.random()*t);r+=e.charAt(n)}return r};Accessory.serialize=function(e){var t={displayName:e.displayName,UUID:e.UUID,lastKnownUsername:e._accessoryInfo?e._accessoryInfo.username:undefined,category:e.category,services:[]};var r={};var n=false;e.services.forEach((function(e){t.services.push(y.Service.serialize(e));var i=[];e.linkedServices.forEach((function(e){i.push(e.getServiceId())}));if(i.length>0){r[e.getServiceId()]=i;n=true}}));if(n){t.linkedServices=r}var a=[];Object.values(e.controllers).forEach((function(e){a.push({type:e.controller.controllerId(),services:Accessory.serializeServiceMap(e.serviceMap)})}));e.serializedControllers&&Object.entries(e.serializedControllers).forEach((function(e){var t=i.__read(e,2),r=t[0],n=t[1];a.push({type:r,services:Accessory.serializeServiceMap(n)})}));if(a.length>0){t.controllers=a}return t};Accessory.deserialize=function(e){var t,r;var n=new Accessory(e.displayName,e.UUID);n.lastKnownUsername=e.lastKnownUsername;n.category=e.category;var a=[];var o={};e.services.forEach((function(e){var t=y.Service.deserialize(e);a.push(t);o[t.getServiceId()]=t}));if(e.linkedServices){var _loop_3=function(e,t){var r=o[e];if(!r){return"continue"}t.forEach((function(e){var t=o[e];if(t){r.addLinkedService(t)}}))};try{for(var s=i.__values(Object.entries(e.linkedServices)),c=s.next();!c.done;c=s.next()){var u=i.__read(c.value,2),l=u[0],d=u[1];_loop_3(l,d)}}catch(e){t={error:e}}finally{try{if(c&&!c.done&&(r=s.return))r.call(s)}finally{if(t)throw t.error}}}if(e.controllers){n.serializedControllers={};e.controllers.forEach((function(e){n.serializedControllers[e.type]=Accessory.deserializeServiceMap(e.services,o)}))}n._sideloadServices(a);return n};Accessory.cleanupAccessoryData=function(e){g.IdentifierCache.remove(e);v.AccessoryInfo.remove(e);m.ControllerStorage.remove(e)};Accessory.serializeServiceMap=function(e){var t={};Object.entries(e).forEach((function(e){var r=i.__read(e,2),n=r[0],a=r[1];if(!a){return}t[n]=a.getServiceId()}));return t};Accessory.deserializeServiceMap=function(e,t){var r={};Object.entries(e).forEach((function(e){var n=i.__read(e,2),a=n[0],o=n[1];var s=t[o];if(s){r[a]=s}}));return r};Accessory.parseBindOption=function(e){var t,r;var n=undefined;var a=undefined;var o=undefined;if(e.bind){var s=new Set(Array.isArray(e.bind)?e.bind:[e.bind]);if(s.has("::")){o="::";s.delete("::");if(s.size){n=Array.from(s)}}else if(s.has("0.0.0.0")){a=true;o="0.0.0.0";s.delete("0.0.0.0");if(s.size){n=Array.from(s)}}else if(s.size===1){n=Array.from(s);var u=s.values().next().value;var l=c.default.isIP(u);if(l){o=l===4?"0.0.0.0":"::"}else{o="::"}}else if(s.size>1){n=Array.from(s);var d=false;try{for(var h=i.__values(s),p=h.next();!p.done;p=h.next()){var u=p.value;var l=c.default.isIP(u);if(l===0||l===6){d=true;break}}}catch(e){t={error:e}}finally{try{if(p&&!p.done&&(r=h.return))r.call(h)}finally{if(t)throw t.error}}if(d){o="::"}else{o="0.0.0.0"}}}return{advertiserAddress:n,serviceRestrictedAddress:n,serviceDisableIpv6:a,serverAddress:o}};Accessory.Categories=w;Accessory.TIMEOUT_WARNING=3e3;Accessory.TIMEOUT_AFTER_WARNING=6e3;return Accessory}(s.EventEmitter);t.Accessory=O},7097:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.loadDirectory=t.parseAccessoryJSON=t.parseServiceJSON=t.parseCharacteristicJSON=void 0;var i=r(6867);var n=i.__importDefault(r(7031));var a=i.__importDefault(r(7147));var o=i.__importDefault(r(1017));var s=r(8719);var c=r(8117);var u=r(877);var l=i.__importStar(r(5752));var d=(0,n.default)("HAP-NodeJS:AccessoryLoader");function parseCharacteristicJSON(e){var t=e.cType;var r=new c.Characteristic(e.manfDescription||t,t,{format:e.format,minValue:e.designedMinValue,maxValue:e.designedMaxValue,minStep:e.designedMinStep,unit:e.unit,perms:e.perms});r.value=e.initialValue;r.locals=e.locals;var i=e.onUpdate;var n=e.onRead;var a=e.onRegister;if(i){r.on("set",(function(e,t){i(e);t&&t()}))}if(n){r.on("get",(function(e){n((function(t){e(null,t)}))}))}if(a){a(r)}return r}t.parseCharacteristicJSON=parseCharacteristicJSON;function parseServiceJSON(e){var t=e.sType;var r=[];e.characteristics.forEach((function(e){var t=parseCharacteristicJSON(e);r.push(t)}));var i=null;r.forEach((function(e){if(e.UUID==="00000023-0000-1000-8000-0026BB765291"){i=e.value}}));var n=new u.Service(i||t,t,"".concat(i));r.forEach((function(e){if(e.UUID!=="00000023-0000-1000-8000-0026BB765291"){n.addCharacteristic(e)}}));return n}t.parseServiceJSON=parseServiceJSON;function parseAccessoryJSON(e){var t=[];e.services.forEach((function(e){var r=parseServiceJSON(e);t.push(r)}));var r=e.displayName;t.forEach((function(e){if(e.UUID==="0000003E-0000-1000-8000-0026BB765291"){e.characteristics.forEach((function(e){if(e.UUID==="00000023-0000-1000-8000-0026BB765291"){r=e.value}}))}}));var i=new s.Accessory(r,l.generate(r));i.username=e.username;i.pincode=e.pincode;i.services.length=0;t.forEach((function(e){i.addService(e)}));return i}t.parseAccessoryJSON=parseAccessoryJSON;function loadDirectory(e){var t=[];a.default.readdirSync(e).forEach((function(r){var i=r.split("_").pop();if(i==="accessory.js"||i==="accessory.ts"){d("Parsing accessory: %s",r);var n=require(o.default.join(e,r)).accessory;t.push(n)}else if(i==="accfactory.js"||i==="accfactory.ts"){d("Parsing accessory factory: %s",r);var a=require(o.default.join(e,r));t=t.concat(a)}}));return t.map((function(e){if(e===null||e===undefined){console.log("Invalid accessory!");return false}else{return e instanceof s.Accessory?e:parseAccessoryJSON(e)}})).filter((function(e){return!!e}))}t.loadDirectory=loadDirectory},3524:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ResolvedAdvertiser=t.AvahiAdvertiser=t.DBusInvokeError=t.BonjourHAPAdvertiser=t.CiaoAdvertiser=t.AdvertiserEvent=t.PairingFeatureFlag=t.StatusFlag=void 0;var i=r(6867);var n=i.__importDefault(r(3285));var a=i.__importDefault(r(7933));var o=i.__importDefault(r(9491));var s=i.__importDefault(r(6196));var c=i.__importDefault(r(6113));var u=i.__importDefault(r(7031));var l=r(2361);var d=r(4719);var h=(0,u.default)("HAP-NodeJS:Advertiser");var p;(function(e){e[e["NOT_PAIRED"]=1]="NOT_PAIRED";e[e["NOT_JOINED_WIFI"]=2]="NOT_JOINED_WIFI";e[e["PROBLEM_DETECTED"]=4]="PROBLEM_DETECTED"})(p=t.StatusFlag||(t.StatusFlag={}));var v;(function(e){e[e["SUPPORTS_HARDWARE_AUTHENTICATION"]=1]="SUPPORTS_HARDWARE_AUTHENTICATION";e[e["SUPPORTS_SOFTWARE_AUTHENTICATION"]=2]="SUPPORTS_SOFTWARE_AUTHENTICATION"})(v=t.PairingFeatureFlag||(t.PairingFeatureFlag={}));var m;(function(e){e["UPDATED_NAME"]="updated-name"})(m=t.AdvertiserEvent||(t.AdvertiserEvent={}));var g=function(e){i.__extends(CiaoAdvertiser,e);function CiaoAdvertiser(t,r,a){var o=e.call(this)||this;o.accessoryInfo=t;o.setupHash=CiaoAdvertiser.computeSetupHash(t);o.responder=n.default.getResponder(i.__assign({},r));o.advertisedService=o.responder.createService(i.__assign({name:o.accessoryInfo.displayName,type:"hap",txt:CiaoAdvertiser.createTxt(t,o.setupHash)},a));o.advertisedService.on("name-change",o.emit.bind(o,"updated-name"));h("Preparing Advertiser for '".concat(o.accessoryInfo.displayName,"' using ciao backend!"));return o}CiaoAdvertiser.prototype.initPort=function(e){this.advertisedService.updatePort(e)};CiaoAdvertiser.prototype.startAdvertising=function(){h("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using ciao backend!"));return this.advertisedService.advertise()};CiaoAdvertiser.prototype.updateAdvertisement=function(e){var t=CiaoAdvertiser.createTxt(this.accessoryInfo,this.setupHash);h("Updating txt record (txt: %o, silent: %d)",t,e);this.advertisedService.updateTxt(t,e)};CiaoAdvertiser.prototype.destroy=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return[4,this.responder.shutdown()];case 1:e.sent();this.removeAllListeners();return[2]}}))}))};CiaoAdvertiser.createTxt=function(e,t){var r=[];if(!e.paired()){r.push(1)}return{"c#":e.getConfigVersion(),ff:CiaoAdvertiser.ff(),id:e.username,md:e.model,pv:CiaoAdvertiser.protocolVersion,"s#":1,sf:CiaoAdvertiser.sf.apply(CiaoAdvertiser,i.__spreadArray([],i.__read(r),false)),ci:e.category,sh:t}};CiaoAdvertiser.computeSetupHash=function(e){var t=c.default.createHash("sha512");t.update(e.setupID+e.username.toUpperCase());return t.digest().slice(0,4).toString("base64")};CiaoAdvertiser.ff=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var r=0;e.forEach((function(e){return r|=e}));return r};CiaoAdvertiser.sf=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var r=0;e.forEach((function(e){return r|=e}));return r};CiaoAdvertiser.protocolVersion="1.1";CiaoAdvertiser.protocolVersionService="1.1.0";return CiaoAdvertiser}(l.EventEmitter);t.CiaoAdvertiser=g;var y=function(e){i.__extends(BonjourHAPAdvertiser,e);function BonjourHAPAdvertiser(t,r,i){var n=e.call(this)||this;n.destroyed=false;n.accessoryInfo=t;n.setupHash=g.computeSetupHash(t);n.serviceOptions=i;n.bonjour=(0,s.default)(r);h("Preparing Advertiser for '".concat(n.accessoryInfo.displayName,"' using bonjour-hap backend!"));return n}BonjourHAPAdvertiser.prototype.initPort=function(e){this.port=e};BonjourHAPAdvertiser.prototype.startAdvertising=function(){(0,o.default)(!this.destroyed,"Can't advertise on a destroyed bonjour instance!");if(this.port==null){throw new Error("Tried starting bonjour-hap advertisement without initializing port!")}h("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using bonjour-hap backend!"));if(this.advertisement){this.destroy()}var e=this.accessoryInfo.username.replace(/:/gi,"_")+".local";this.advertisement=this.bonjour.publish(i.__assign({name:this.accessoryInfo.displayName,type:"hap",port:this.port,txt:g.createTxt(this.accessoryInfo,this.setupHash),host:e,addUnsafeServiceEnumerationRecord:true},this.serviceOptions));return(0,d.PromiseTimeout)(1)};BonjourHAPAdvertiser.prototype.updateAdvertisement=function(e){var t=g.createTxt(this.accessoryInfo,this.setupHash);h("Updating txt record (txt: %o, silent: %d)",t,e);if(this.advertisement){this.advertisement.updateTxt(t,e)}};BonjourHAPAdvertiser.prototype.destroy=function(){var e=this;if(this.advertisement){this.advertisement.stop((function(){e.advertisement.destroy();e.advertisement=undefined;e.bonjour.destroy()}))}else{this.bonjour.destroy()}};return BonjourHAPAdvertiser}(l.EventEmitter);t.BonjourHAPAdvertiser=y;function messageBusConnectionResult(e){return new Promise((function(t,r){var errorHandler=function(t){e.connection.removeListener("connect",connectHandler);r(t)};var connectHandler=function(){e.connection.removeListener("error",errorHandler);t()};e.connection.once("connect",connectHandler);e.connection.once("error",errorHandler)}))}var C=function(e){i.__extends(DBusInvokeError,e);function DBusInvokeError(t){var r=e.call(this)||this;Object.setPrototypeOf(r,DBusInvokeError.prototype);r.name="DBusInvokeError";r.errorName=t.name;if(Array.isArray(t.message)&&t.message.length===1){r.message=t.message[0]}else{r.message=t.message.toString()}return r}return DBusInvokeError}(Error);t.DBusInvokeError=C;function dbusInvoke(e,t,r,n,a,o){return new Promise((function(s,c){var u=i.__assign({destination:t,path:r,interface:n,member:a},o||{});e.invoke(u,(function(e,t){if(e){c(new C(e))}else{s(t)}}))}))}var T;(function(e){e[e["INVALID"]=0]="INVALID";e[e["REGISTERING"]=1]="REGISTERING";e[e["RUNNING"]=2]="RUNNING";e[e["COLLISION"]=3]="COLLISION";e[e["FAILURE"]=4]="FAILURE"})(T||(T={}));var E=function(e){i.__extends(AvahiAdvertiser,e);function AvahiAdvertiser(t){var r=e.call(this)||this;r.accessoryInfo=t;r.setupHash=g.computeSetupHash(t);h("Preparing Advertiser for '".concat(r.accessoryInfo.displayName,"' using Avahi backend!"));r.bus=a.default.systemBus();r.stateChangeHandler=r.handleStateChangedEvent.bind(r);return r}AvahiAdvertiser.prototype.createTxt=function(){return Object.entries(g.createTxt(this.accessoryInfo,this.setupHash)).map((function(e){return Buffer.from(e[0]+"="+e[1])}))};AvahiAdvertiser.prototype.initPort=function(e){this.port=e};AvahiAdvertiser.prototype.startAdvertising=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,t;return i.__generator(this,(function(r){switch(r.label){case 0:if(this.port==null){throw new Error("Tried starting Avahi advertisement without initializing port!")}if(!this.bus){throw new Error("Tried to start Avahi advertisement on a destroyed advertiser!")}h("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using Avahi backend!"));if(!!this.avahiServerInterface)return[3,2];e=this;return[4,AvahiAdvertiser.avahiInterface(this.bus,"Server")];case 1:e.avahiServerInterface=r.sent();this.avahiServerInterface.on("StateChanged",this.stateChangeHandler);r.label=2;case 2:t=this;return[4,AvahiAdvertiser.avahiInvoke(this.bus,"/","Server","EntryGroupNew")];case 3:t.path=r.sent();return[4,AvahiAdvertiser.avahiInvoke(this.bus,this.path,"EntryGroup","AddService",{body:[-1,-1,0,this.accessoryInfo.displayName,"_hap._tcp","","",this.port,this.createTxt()],signature:"iiussssqaay"})];case 4:r.sent();return[4,AvahiAdvertiser.avahiInvoke(this.bus,this.path,"EntryGroup","Commit")];case 5:r.sent();return[2]}}))}))};AvahiAdvertiser.prototype.handleStateChangedEvent=function(e){if(e===2&&this.path){h("Found Avahi daemon to have restarted!");this.startAdvertising().catch((function(e){return console.error("Could not (re-)create mDNS advertisement. The HAP-Server won't be discoverable: "+e)}))}};AvahiAdvertiser.prototype.updateAdvertisement=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(r){switch(r.label){case 0:if(!this.bus){throw new Error("Tried to update Avahi advertisement on a destroyed advertiser!")}if(!this.path){h("Tried to update advertisement without a valid `path`!");return[2]}h("Updating txt record (txt: %o, silent: %d)",g.createTxt(this.accessoryInfo,this.setupHash),e);r.label=1;case 1:r.trys.push([1,3,,4]);return[4,AvahiAdvertiser.avahiInvoke(this.bus,this.path,"EntryGroup","UpdateServiceTxt",{body:[-1,-1,0,this.accessoryInfo.displayName,"_hap._tcp","",this.createTxt()],signature:"iiusssaay"})];case 2:r.sent();return[3,4];case 3:t=r.sent();console.error("Failed to update avahi advertisement: "+t);return[3,4];case 4:return[2]}}))}))};AvahiAdvertiser.prototype.destroy=function(){return i.__awaiter(this,void 0,void 0,(function(){var e;return i.__generator(this,(function(t){switch(t.label){case 0:if(!this.bus){throw new Error("Tried to destroy Avahi advertisement on a destroyed advertiser!")}if(!this.path)return[3,5];t.label=1;case 1:t.trys.push([1,3,,4]);return[4,AvahiAdvertiser.avahiInvoke(this.bus,this.path,"EntryGroup","Free")];case 2:t.sent();return[3,4];case 3:e=t.sent();h("Destroying Avahi advertisement failed: "+e);return[3,4];case 4:this.path=undefined;t.label=5;case 5:if(this.avahiServerInterface){this.avahiServerInterface.removeListener("StateChanged",this.stateChangeHandler);this.avahiServerInterface=undefined}this.bus.connection.stream.destroy();this.bus=undefined;return[2]}}))}))};AvahiAdvertiser.isAvailable=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,t,r,n;return i.__generator(this,(function(i){switch(i.label){case 0:e=a.default.systemBus();i.label=1;case 1:i.trys.push([1,,9,10]);i.label=2;case 2:i.trys.push([2,4,,5]);return[4,messageBusConnectionResult(e)];case 3:i.sent();return[3,5];case 4:t=i.sent();h("Avahi/DBus classified unavailable due to missing dbus interface!");return[2,false];case 5:i.trys.push([5,7,,8]);return[4,this.avahiInvoke(e,"/","Server","GetVersionString")];case 6:r=i.sent();h("Detected Avahi over DBus interface running version '%s'.",r);return[3,8];case 7:n=i.sent();h("Avahi/DBus classified unavailable due to missing avahi interface!");return[2,false];case 8:return[2,true];case 9:e.connection.stream.destroy();return[7];case 10:return[2]}}))}))};AvahiAdvertiser.avahiInvoke=function(e,t,r,i,n){return dbusInvoke(e,"org.freedesktop.Avahi",t,"org.freedesktop.Avahi.".concat(r),i,n)};AvahiAdvertiser.avahiInterface=function(e,t){return new Promise((function(r,i){e.getService("org.freedesktop.Avahi").getInterface("/","org.freedesktop.Avahi."+t,(function(e,t){if(e||!t){i(e!==null&&e!==void 0?e:new Error("Interface not present!"))}else{r(t)}}))}))};return AvahiAdvertiser}(l.EventEmitter);t.AvahiAdvertiser=E;var D=["org.freedesktop.DBus.Error.AccessDenied","org.freedesktop.DBus.Error.AuthFailed","org.freedesktop.DBus.Error.InteractiveAuthorizationRequired"];var _=function(e){i.__extends(ResolvedAdvertiser,e);function ResolvedAdvertiser(t){var r=e.call(this)||this;r.accessoryInfo=t;r.setupHash=g.computeSetupHash(t);r.bus=a.default.systemBus();h("Preparing Advertiser for '".concat(r.accessoryInfo.displayName,"' using systemd-resolved backend!"));return r}ResolvedAdvertiser.prototype.createTxt=function(){return Object.entries(g.createTxt(this.accessoryInfo,this.setupHash)).map((function(e){return[e[0].toString(),Buffer.from(e[1].toString())]}))};ResolvedAdvertiser.prototype.initPort=function(e){this.port=e};ResolvedAdvertiser.prototype.startAdvertising=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,t;return i.__generator(this,(function(r){switch(r.label){case 0:if(this.port==null){throw new Error("Tried starting systemd-resolved advertisement without initializing port!")}if(!this.bus){throw new Error("Tried to start systemd-resolved advertisement on a destroyed advertiser!")}h("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using systemd-resolved backend!"));r.label=1;case 1:r.trys.push([1,3,,4]);e=this;return[4,ResolvedAdvertiser.managerInvoke(this.bus,"RegisterService",{body:[this.accessoryInfo.displayName,this.accessoryInfo.displayName,"_hap._tcp",this.port,0,0,[this.createTxt()]],signature:"sssqqqaa{say}"})];case 2:e.path=r.sent();return[3,4];case 3:t=r.sent();if(t instanceof C){if(D.includes(t.errorName)){t.message="Permissions issue. See https://homebridge.io/w/mDNS-Options for more info. ".concat(t.message)}}throw t;case 4:return[2]}}))}))};ResolvedAdvertiser.prototype.updateAdvertisement=function(e){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:if(!this.bus){throw new Error("Tried to update systemd-resolved advertisement on a destroyed advertiser!")}h("Updating txt record (txt: %o, silent: %d)",g.createTxt(this.accessoryInfo,this.setupHash),e);return[4,this.stopAdvertising()];case 1:t.sent();return[4,this.startAdvertising()];case 2:t.sent();return[2]}}))}))};ResolvedAdvertiser.prototype.stopAdvertising=function(){return i.__awaiter(this,void 0,void 0,(function(){var e;return i.__generator(this,(function(t){switch(t.label){case 0:if(!this.bus){throw new Error("Tried to destroy systemd-resolved advertisement on a destroyed advertiser!")}if(!this.path)return[3,5];t.label=1;case 1:t.trys.push([1,3,,4]);return[4,ResolvedAdvertiser.managerInvoke(this.bus,"UnregisterService",{body:[this.path],signature:"o"})];case 2:t.sent();return[3,4];case 3:e=t.sent();h("Destroying systemd-resolved advertisement failed: "+e);return[3,4];case 4:this.path=undefined;t.label=5;case 5:return[2]}}))}))};ResolvedAdvertiser.prototype.destroy=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:if(!this.bus){throw new Error("Tried to destroy systemd-resolved advertisement on a destroyed advertiser!")}return[4,this.stopAdvertising()];case 1:e.sent();this.bus.connection.stream.destroy();this.bus=undefined;return[2]}}))}))};ResolvedAdvertiser.isAvailable=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,t,r,n,o;return i.__generator(this,(function(i){switch(i.label){case 0:e=a.default.systemBus();i.label=1;case 1:i.trys.push([1,,12,13]);i.label=2;case 2:i.trys.push([2,4,,5]);return[4,messageBusConnectionResult(e)];case 3:i.sent();return[3,5];case 4:t=i.sent();h("systemd-resolved/DBus classified unavailable due to missing dbus interface!");return[2,false];case 5:i.trys.push([5,7,,8]);return[4,this.managerInvoke(e,"ResolveHostname",{body:[0,"127.0.0.1",0,0],signature:"isit"})];case 6:i.sent();h("Detected systemd-resolved over DBus interface running version.");return[3,8];case 7:r=i.sent();h("systemd-resolved/DBus classified unavailable due to missing systemd-resolved interface!");return[2,false];case 8:i.trys.push([8,10,,11]);return[4,this.resolvedInvoke(e,"org.freedesktop.DBus.Properties","Get",{body:["org.freedesktop.resolve1.Manager","MulticastDNS"],signature:"ss"})];case 9:n=i.sent();if(n[0][0].type!=="s"){throw new Error("Invalid type for MulticastDNS")}if(n[1][0]!=="yes"){h("systemd-resolved/DBus classified unavailable because MulticastDNS is not enabled!");return[2,false]}return[3,11];case 10:o=i.sent();h("systemd-resolved/DBus classified unavailable due to failure checking system status: "+o);return[2,false];case 11:return[2,true];case 12:e.connection.stream.destroy();return[7];case 13:return[2]}}))}))};ResolvedAdvertiser.resolvedInvoke=function(e,t,r,i){return dbusInvoke(e,"org.freedesktop.resolve1","/org/freedesktop/resolve1",t,r,i)};ResolvedAdvertiser.managerInvoke=function(e,t,r){return this.resolvedInvoke(e,"org.freedesktop.resolve1.Manager",t,r)};return ResolvedAdvertiser}(l.EventEmitter);t.ResolvedAdvertiser=_},3554:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Bridge=void 0;var i=r(6867);var n=r(8719);var a=function(e){i.__extends(Bridge,e);function Bridge(t,r){var i=e.call(this,t,r)||this;i._isBridge=true;return i}return Bridge}(n.Accessory);t.Bridge=a},8117:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Characteristic=t.CharacteristicEventTypes=t.ChangeReason=t.Access=t.Perms=t.Units=t.Formats=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=i.__importDefault(r(7031));var o=r(2361);var s=r(4080);var c=r(5164);var u=r(2716);var l=r(7417);var d=r(1996);var h=r(5752);var p=(0,a.default)("HAP-NodeJS:Characteristic");var v;(function(e){e["BOOL"]="bool";e["INT"]="int";e["FLOAT"]="float";e["STRING"]="string";e["UINT8"]="uint8";e["UINT16"]="uint16";e["UINT32"]="uint32";e["UINT64"]="uint64";e["DATA"]="data";e["TLV8"]="tlv8";e["ARRAY"]="array";e["DICTIONARY"]="dict"})(v=t.Formats||(t.Formats={}));var m;(function(e){e["CELSIUS"]="celsius";e["PERCENTAGE"]="percentage";e["ARC_DEGREE"]="arcdegrees";e["LUX"]="lux";e["SECONDS"]="seconds"})(m=t.Units||(t.Units={}));var g;(function(e){e["READ"]="pr";e["WRITE"]="pw";e["PAIRED_READ"]="pr";e["PAIRED_WRITE"]="pw";e["NOTIFY"]="ev";e["EVENTS"]="ev";e["ADDITIONAL_AUTHORIZATION"]="aa";e["TIMED_WRITE"]="tw";e["HIDDEN"]="hd";e["WRITE_RESPONSE"]="wr"})(g=t.Perms||(t.Perms={}));var y;(function(e){e[e["READ"]=0]="READ";e[e["WRITE"]=1]="WRITE";e[e["NOTIFY"]=2]="NOTIFY"})(y=t.Access||(t.Access={}));var C;(function(e){e["WRITE"]="write";e["UPDATE"]="update";e["READ"]="read";e["EVENT"]="event"})(C=t.ChangeReason||(t.ChangeReason={}));var T;(function(e){e["GET"]="get";e["SET"]="set";e["CHANGE"]="change";e["SUBSCRIBE"]="subscribe";e["UNSUBSCRIBE"]="unsubscribe";e["CHARACTERISTIC_WARNING"]="characteristic-warning"})(T=t.CharacteristicEventTypes||(t.CharacteristicEventTypes={}));var E=function(){function ValidValuesIterable(e){(0,n.default)((0,d.isNumericFormat)(e.format),"Cannot instantiate valid values iterable when format is not numeric. Found "+e.format);this.props=e}ValidValuesIterable.prototype[Symbol.iterator]=function(){var e,t,r,n,a,o,s,c;var u,l;return i.__generator(this,(function(h){switch(h.label){case 0:if(!this.props.validValues)return[3,9];h.label=1;case 1:h.trys.push([1,6,7,8]);e=i.__values(this.props.validValues),t=e.next();h.label=2;case 2:if(!!t.done)return[3,5];r=t.value;return[4,r];case 3:h.sent();h.label=4;case 4:t=e.next();return[3,2];case 5:return[3,8];case 6:n=h.sent();u={error:n};return[3,8];case 7:try{if(t&&!t.done&&(l=e.return))l.call(e)}finally{if(u)throw u.error}return[7];case 8:return[3,13];case 9:a=0;o=void 0;s=1;if(this.props.validValueRanges){a=this.props.validValueRanges[0];o=this.props.validValueRanges[1]}else if(this.props.minValue!=null&&this.props.maxValue!=null){a=this.props.minValue;o=this.props.maxValue;if(this.props.minStep!=null){s=this.props.minStep}}else if((0,d.isUnsignedNumericFormat)(this.props.format)){o=(0,d.numericUpperBound)(this.props.format)}else{throw new Error("Could not find valid iterator strategy for props: "+JSON.stringify(this.props))}c=a;h.label=10;case 10:if(!(c<=o))return[3,13];return[4,c];case 11:h.sent();h.label=12;case 12:c+=s;return[3,10];case 13:return[2]}}))};return ValidValuesIterable}();var D=/^-?\d+$/;function extractHAPStatusFromError(e){var t=-70402;if(D.test(e.message)){var r=parseInt(e.message,10);if((0,s.IsKnownHAPStatusError)(r)){t=r}}return t}function maxWithUndefined(e,t){if(e==null){return t}else if(t==null){return e}else{return Math.max(e,t)}}function minWithUndefined(e,t){if(e==null){return t}else if(t==null){return e}else{return Math.min(e,t)}}var _=function(e){i.__extends(Characteristic,e);function Characteristic(t,r,i){var n=e.call(this)||this;n.iid=null;n.value=null;n.status=null;n.statusCode=0;n.subscriptions=0;n.displayName=t;n.UUID=r;n.props={format:"int",perms:["ev"]};n.setProps(i||{});return n}Characteristic.prototype.onGet=function(e){if(typeof e!=="function"){this.characteristicWarning(".onGet handler must be a function");return this}this.getHandler=e;return this};Characteristic.prototype.removeOnGet=function(){this.getHandler=undefined;return this};Characteristic.prototype.onSet=function(e){if(typeof e!=="function"){this.characteristicWarning(".onSet handler must be a function");return this}this.setHandler=e;return this};Characteristic.prototype.removeOnSet=function(){this.setHandler=undefined;return this};Characteristic.prototype.setProps=function(e){(0,n.default)(e,"props cannot be undefined when setting props");var t=false;if(e.format){t=this.props.format!==e.format;this.props.format=e.format}if(e.perms){(0,n.default)(e.perms.length>0,"characteristic prop perms cannot be empty array");this.props.perms=e.perms}if(e.unit!==undefined){this.props.unit=e.unit!=null?e.unit:undefined}if(e.description!==undefined){this.props.description=e.description!=null?e.description:undefined}if(e.minValue!==undefined){if(e.minValue===null){e.minValue=undefined}else if(!(0,d.isNumericFormat)(this.props.format)){this.characteristicWarning("Characteristic Property 'minValue' can only be set for characteristics with numeric format, but not for "+this.props.format,"error-message");e.minValue=undefined}else if(typeof e.minValue!=="number"||!Number.isFinite(e.minValue)){this.characteristicWarning("Characteristic Property 'minValue' must be a finite number, received \"".concat(e.minValue,'" (').concat(typeof e.minValue,")"),"error-message");e.minValue=undefined}else{if(e.minValue<(0,d.numericLowerBound)(this.props.format)){this.characteristicWarning("Characteristic Property 'minValue' was set to "+e.minValue+", but for numeric format "+this.props.format+" minimum possible is "+(0,d.numericLowerBound)(this.props.format),"error-message");e.minValue=(0,d.numericLowerBound)(this.props.format)}else if(e.minValue>(0,d.numericUpperBound)(this.props.format)){this.characteristicWarning("Characteristic Property 'minValue' was set to "+e.minValue+", but for numeric format "+this.props.format+" maximum possible is "+(0,d.numericUpperBound)(this.props.format),"error-message");e.minValue=(0,d.numericLowerBound)(this.props.format)}}this.props.minValue=e.minValue}if(e.maxValue!==undefined){if(e.maxValue===null){e.maxValue=undefined}else if(!(0,d.isNumericFormat)(this.props.format)){this.characteristicWarning("Characteristic Property 'maxValue' can only be set for characteristics with numeric format, but not for "+this.props.format,"error-message");e.maxValue=undefined}else if(typeof e.maxValue!=="number"||!Number.isFinite(e.maxValue)){this.characteristicWarning("Characteristic Property 'maxValue' must be a finite number, received \"".concat(e.maxValue,'" (').concat(typeof e.maxValue,")"),"error-message");e.maxValue=undefined}else{if(e.maxValue>(0,d.numericUpperBound)(this.props.format)){this.characteristicWarning("Characteristic Property 'maxValue' was set to "+e.maxValue+", but for numeric format "+this.props.format+" maximum possible is "+(0,d.numericUpperBound)(this.props.format),"error-message");e.maxValue=(0,d.numericUpperBound)(this.props.format)}else if(e.maxValue<(0,d.numericLowerBound)(this.props.format)){this.characteristicWarning("Characteristic Property 'maxValue' was set to "+e.maxValue+", but for numeric format "+this.props.format+" minimum possible is "+(0,d.numericLowerBound)(this.props.format),"error-message");e.maxValue=(0,d.numericUpperBound)(this.props.format)}}this.props.maxValue=e.maxValue}if(e.minStep!==undefined){if(e.minStep===null){this.props.minStep=undefined}else if(!(0,d.isNumericFormat)(this.props.format)){this.characteristicWarning("Characteristic Property `minStep` can only be set for characteristics with numeric format, but not for "+this.props.format,"error-message")}else{if(e.minStep<1&&(0,d.isIntegerNumericFormat)(this.props.format)){this.characteristicWarning("Characteristic Property `minStep` was set to a value lower than 1, "+"this will have no effect on format `"+this.props.format)}this.props.minStep=e.minStep}}if(e.maxLen!==undefined){if(e.maxLen===null){this.props.maxLen=undefined}else if(this.props.format!=="string"){this.characteristicWarning("Characteristic Property `maxLen` can only be set for characteristics with format `STRING`, but not for "+this.props.format,"error-message")}else{if(e.maxLen>256){this.characteristicWarning("Characteristic Property string `maxLen` cannot be bigger than 256");e.maxLen=256}this.props.maxLen=e.maxLen}}if(e.maxDataLen!==undefined){if(e.maxDataLen===null){this.props.maxDataLen=undefined}else if(this.props.format!=="data"){this.characteristicWarning("Characteristic Property `maxDataLen` can only be set for characteristics with format `DATA`, but not for "+this.props.format,"error-message")}else{this.props.maxDataLen=e.maxDataLen}}if(e.validValues!==undefined){if(e.validValues===null){this.props.validValues=undefined}else if(!(0,d.isNumericFormat)(this.props.format)){this.characteristicWarning("Characteristic Property `validValues` was supplied for non numeric format "+this.props.format)}else{(0,n.default)(e.validValues.length,"characteristic prop validValues cannot be empty array");this.props.validValues=e.validValues}}if(e.validValueRanges!==undefined){if(e.validValueRanges===null){this.props.validValueRanges=undefined}else if(!(0,d.isNumericFormat)(this.props.format)){this.characteristicWarning("Characteristic Property `validValueRanges` was supplied for non numeric format "+this.props.format)}else{(0,n.default)(e.validValueRanges.length===2,"characteristic prop validValueRanges must have a length of 2");this.props.validValueRanges=e.validValueRanges}}if(e.adminOnlyAccess!==undefined){this.props.adminOnlyAccess=e.adminOnlyAccess!=null?e.adminOnlyAccess:undefined}if(this.props.minValue!=null&&this.props.maxValue!=null){if(this.props.minValue>this.props.maxValue){this.props.minValue=undefined;this.props.maxValue=undefined;throw new Error("Error setting CharacteristicsProps for '"+this.displayName+"': 'minValue' cannot be greater or equal the 'maxValue'!")}}if(((0,d.isNumericFormat)(this.props.format)||this.props.format==="string")&&this.value!=null&&!t&&this.statusCode===0&&this.UUID!==Characteristic.ProgrammableSwitchEvent.UUID){var r=this.validateUserInput(this.value,"debug-message");if(r!==this.value){this.updateValue(r)}}return this};Characteristic.prototype.validValuesIterator=function(){return new E(this.props)};Characteristic.prototype.setupAdditionalAuthorization=function(e){if(!this.props.perms.includes("aa")){this.props.perms.push("aa")}this.additionalAuthorizationHandler=e};Characteristic.prototype.getValue=function(e,t){this.handleGetRequest(undefined,t).then((function(t){if(e){e(null,t)}}),(function(t){if(e){e(t)}}))};Characteristic.prototype.setValue=function(e,t,r){if(e instanceof Error){this.statusCode=e instanceof u.HapStatusError?e.hapStatus:extractHAPStatusFromError(e);this.status=e;if(t){t()}return this}if(t&&!r&&typeof t!=="function"){r=t;t=undefined}try{e=this.validateUserInput(e)}catch(e){this.characteristicWarning((e===null||e===void 0?void 0:e.message)+"","error-message",e===null||e===void 0?void 0:e.stack);if(t){t(e)}return this}this.handleSetRequest(e,undefined,r).then((function(e){if(t){if(e){t(null,e)}else{t(null)}}}),(function(e){if(t){t(e)}}));return this};Characteristic.prototype.updateValue=function(e,t,r){if(e instanceof Error){this.statusCode=e instanceof u.HapStatusError?e.hapStatus:extractHAPStatusFromError(e);this.status=e;if(t){t()}return this}if(t&&!r&&typeof t!=="function"){r=t;t=undefined}try{e=this.validateUserInput(e)}catch(e){this.characteristicWarning((e===null||e===void 0?void 0:e.message)+"","error-message",e===null||e===void 0?void 0:e.stack);if(t){t()}return this}this.statusCode=0;this.status=null;var i=this.value;this.value=e;if(t){t()}this.emit("change",{originator:undefined,oldValue:i,newValue:e,reason:"update",context:r});return this};Characteristic.prototype.sendEventNotification=function(e,t){this.statusCode=0;this.status=null;e=this.validateUserInput(e);var r=this.value;this.value=e;this.emit("change",{originator:undefined,oldValue:r,newValue:e,reason:"event",context:t});return this};Characteristic.prototype.handleGetRequest=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r,n,a,o;var s=this;return i.__generator(this,(function(i){switch(i.label){case 0:if(!this.props.perms.includes("pr")){throw-70405}if(this.UUID===Characteristic.ProgrammableSwitchEvent.UUID){return[2,null]}if(!this.getHandler)return[3,4];if(this.listeners("get").length>0){this.characteristicWarning("Ignoring on('get') handler as onGet handler was defined instead")}i.label=1;case 1:i.trys.push([1,3,,4]);return[4,this.getHandler(t,e)];case 2:r=i.sent();this.statusCode=0;this.status=null;try{r=this.validateUserInput(r)}catch(e){this.characteristicWarning("An illegal value was supplied by the read handler for characteristic: ".concat(e===null||e===void 0?void 0:e.message),"warn-message",e===null||e===void 0?void 0:e.stack);this.statusCode=-70402;this.status=e;return[2,Promise.reject(-70402)]}n=this.value;this.value=r;if(n!==r){this.emit("change",{originator:e,oldValue:n,newValue:r,reason:"read",context:t})}return[2,r];case 3:a=i.sent();if(typeof a==="number"){o=new u.HapStatusError(a);this.statusCode=o.hapStatus;this.status=o}else if(a instanceof u.HapStatusError){this.statusCode=a.hapStatus;this.status=a}else{this.characteristicWarning("Unhandled error thrown inside read handler for characteristic: ".concat(a===null||a===void 0?void 0:a.message),"error-message",a===null||a===void 0?void 0:a.stack);this.statusCode=-70402;this.status=a}throw this.statusCode;case 4:if(this.listeners("get").length===0){if(this.statusCode){throw this.statusCode}try{return[2,this.validateUserInput(this.value)]}catch(e){this.characteristicWarning("An illegal value was supplied by setting `value` for characteristic: ".concat(e===null||e===void 0?void 0:e.message),"warn-message",e===null||e===void 0?void 0:e.stack);return[2,Promise.reject(-70402)]}}return[2,new Promise((function(r,i){try{s.emit("get",(0,l.once)((function(n,a){if(n){if(typeof n==="number"){var o=new u.HapStatusError(n);s.statusCode=o.hapStatus;s.status=o}else if(n instanceof u.HapStatusError){s.statusCode=n.hapStatus;s.status=n}else{p("[%s] Received error from get handler %s",s.displayName,n.stack);s.statusCode=extractHAPStatusFromError(n);s.status=n}i(s.statusCode);return}s.statusCode=0;s.status=null;a=s.validateUserInput(a);var c=s.value;s.value=a;r(a);if(c!==a){s.emit("change",{originator:e,oldValue:c,newValue:a,reason:"read",context:t})}})),t,e)}catch(e){s.characteristicWarning("Unhandled error thrown inside read handler for characteristic: ".concat(e===null||e===void 0?void 0:e.message),"error-message",e===null||e===void 0?void 0:e.stack);s.statusCode=-70402;s.status=e;i(-70402)}}))]}}))}))};Characteristic.prototype.handleSetRequest=function(e,t,r){return i.__awaiter(this,void 0,void 0,(function(){var n,a,o,s;var c=this;return i.__generator(this,(function(i){switch(i.label){case 0:this.statusCode=0;this.status=null;if(t!==undefined){try{e=this.validateClientSuppliedValue(e)}catch(e){p("[".concat(this.displayName,"]"),e.message);return[2,Promise.reject(-70410)]}}n=this.value;if(!this.setHandler)return[3,4];if(this.listeners("set").length>0){this.characteristicWarning("Ignoring on('set') handler as onSet handler was defined instead")}i.label=1;case 1:i.trys.push([1,3,,4]);return[4,this.setHandler(e,r,t)];case 2:a=i.sent();this.statusCode=0;this.status=null;if(a!=null&&this.props.perms.includes("wr")){this.value=this.validateUserInput(a);return[2,this.value]}else{if(a!=null){this.characteristicWarning("SET handler returned write response value, though the characteristic doesn't support write response","debug-message")}this.value=e;this.emit("change",{originator:t,oldValue:n,newValue:e,reason:"write",context:r});return[2]}return[3,4];case 3:o=i.sent();if(typeof o==="number"){s=new u.HapStatusError(o);this.statusCode=s.hapStatus;this.status=s}else if(o instanceof u.HapStatusError){this.statusCode=o.hapStatus;this.status=o}else{this.characteristicWarning("Unhandled error thrown inside write handler for characteristic: ".concat(o===null||o===void 0?void 0:o.message),"error-message",o===null||o===void 0?void 0:o.stack);this.statusCode=-70402;this.status=o}throw this.statusCode;case 4:if(this.listeners("set").length===0){this.value=e;this.emit("change",{originator:t,oldValue:n,newValue:e,reason:"write",context:r});return[2,Promise.resolve()]}else{return[2,new Promise((function(i,a){try{c.emit("set",e,(0,l.once)((function(o,s){if(o){if(typeof o==="number"){var l=new u.HapStatusError(o);c.statusCode=l.hapStatus;c.status=l}else if(o instanceof u.HapStatusError){c.statusCode=o.hapStatus;c.status=o}else{p("[%s] Received error from set handler %s",c.displayName,o.stack);c.statusCode=extractHAPStatusFromError(o);c.status=o}a(c.statusCode);return}c.statusCode=0;c.status=null;if(s!=null&&c.props.perms.includes("wr")){c.value=c.validateUserInput(s);i(c.value)}else{if(s!=null){c.characteristicWarning("SET handler returned write response value, though the characteristic doesn't support write response","debug-message")}c.value=e;i();c.emit("change",{originator:t,oldValue:n,newValue:e,reason:"write",context:r})}})),r,t)}catch(e){c.characteristicWarning("Unhandled error thrown inside write handler for characteristic: ".concat(e===null||e===void 0?void 0:e.message),"error-message",e===null||e===void 0?void 0:e.stack);c.statusCode=-70402;c.status=e;a(-70402)}}))]}return[2]}}))}))};Characteristic.prototype.subscribe=function(){if(this.subscriptions===0){this.emit("subscribe")}this.subscriptions++};Characteristic.prototype.unsubscribe=function(){var e=this.subscriptions===1;this.subscriptions--;this.subscriptions=Math.max(this.subscriptions,0);if(e){this.emit("unsubscribe")}};Characteristic.prototype.getDefaultValue=function(){var e;switch(this.props.format){case"bool":return false;case"string":switch(this.UUID){case Characteristic.Manufacturer.UUID:return"Default-Manufacturer";case Characteristic.Model.UUID:return"Default-Model";case Characteristic.SerialNumber.UUID:return"Default-SerialNumber";case Characteristic.FirmwareRevision.UUID:return"0.0.0";default:return""}case"data":return"";case"tlv8":return"";case"dict":return{};case"array":return[];case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":switch(this.UUID){case Characteristic.CurrentTemperature.UUID:return 0;default:{if(((e=this.props.validValues)===null||e===void 0?void 0:e.length)&&typeof this.props.validValues[0]==="number"){return this.props.validValues[0]}if(typeof this.props.minValue==="number"&&Number.isFinite(this.props.minValue)){return this.props.minValue}return 0}}default:return 0}};Characteristic.prototype.validateClientSuppliedValue=function(e){if(e==null){throw new Error("Client supplied invalid value for ".concat(this.props.format,": ").concat(e))}switch(this.props.format){case"bool":{if(typeof e==="boolean"){return e}if(typeof e==="number"&&(e===1||e===0)){return Boolean(e)}throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"))}case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":{if(typeof e==="boolean"){e=e?1:0}if(typeof e!=="number"||!Number.isFinite(e)){throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"))}var t=maxWithUndefined(this.props.minValue,(0,d.numericLowerBound)(this.props.format));var r=minWithUndefined(this.props.maxValue,(0,d.numericUpperBound)(this.props.format));if(typeof t==="number"&&e<t){throw new Error("Client supplied value of ".concat(e," is less than the minimum allowed value of ").concat(t))}if(typeof r==="number"&&e>r){throw new Error("Client supplied value of ".concat(e," is greater than the maximum allowed value of ").concat(r))}if(this.props.validValues&&!this.props.validValues.includes(e)){throw new Error("Client supplied value of ".concat(e," is not in ").concat(this.props.validValues.toString()))}if(this.props.validValueRanges&&this.props.validValueRanges.length===2){if(e<this.props.validValueRanges[0]){throw new Error("Client supplied value of ".concat(e," is less than the minimum allowed value of ").concat(this.props.validValueRanges[0]))}if(e>this.props.validValueRanges[1]){throw new Error("Client supplied value of ".concat(e," is greater than the maximum allowed value of ").concat(this.props.validValueRanges[1]))}}return e}case"string":{if(typeof e!=="string"){throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"))}var i=this.props.maxLen!=null?this.props.maxLen:64;if(e.length>i){throw new Error("Client supplied value length of ".concat(e.length," exceeds maximum length allowed of ").concat(i))}return e}case"data":{if(typeof e!=="string"){throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"))}var i=this.props.maxDataLen!=null?this.props.maxDataLen:2097152;if(e.length>i){throw new Error("Client supplied value length of ".concat(e.length," exceeds maximum length allowed of ").concat(i))}return e}case"tlv8":if(typeof e!=="string"){throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"))}return e}return e};Characteristic.prototype.validateUserInput=function(e,t){var r;if(t===void 0){t="warn-message"}if(e===null){if(this.UUID===Characteristic.Model.UUID||this.UUID===Characteristic.SerialNumber.UUID){this.characteristicWarning("characteristic must have a non null value otherwise HomeKit will reject this accessory, ignoring new value","error-message");return this.value}if(this.props.format==="data"||this.props.format==="tlv8"){return e}if(this.UUID.endsWith(h.BASE_UUID)){if(this.UUID===Characteristic.ProgrammableSwitchEvent.UUID){return e}this.characteristicWarning("characteristic was supplied illegal value: null! Home App will reject null for Apple defined characteristics",t);if(this.value!==null){return this.value}}else{return e}}switch(this.props.format){case"bool":{if(typeof e==="boolean"){return e}if(typeof e==="number"){return e===1}if(typeof e==="string"){return e==="1"||e==="true"}this.characteristicWarning("characteristic value expected boolean and received "+typeof e,t);return false}case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":{if(typeof e==="boolean"){e=e?1:0}if(typeof e==="string"){e=this.props.format==="float"?parseFloat(e):parseInt(e,10)}if(typeof e!=="number"||!Number.isFinite(e)){this.characteristicWarning('characteristic value expected valid finite number and received "'.concat(e,'" (').concat(typeof e,")"),t);e=typeof this.value==="number"?this.value:this.props.minValue||0}var i=maxWithUndefined(this.props.minValue,(0,d.numericLowerBound)(this.props.format));var n=minWithUndefined(this.props.maxValue,(0,d.numericUpperBound)(this.props.format));var a=undefined;if(this.props.format==="float"){a=this.props.minStep}else{a=maxWithUndefined(this.props.minStep,1)}if(a!=null&&a>0){var o=this.props.minValue!=null?this.props.minValue:0;e=a*Math.round((e-o)/a)+o}if(i!=null&&e<i){this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," exceeded minimum of ").concat(i),t);e=i}if(n!=null&&e>n){this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," exceeded maximum of ").concat(n),t);e=n}if(this.props.validValues&&!this.props.validValues.includes(e)){this.characteristicWarning("characteristic value ".concat(e," is not contained in valid values array"),t);return this.props.validValues.includes(this.value)?this.value:this.props.validValues[0]||0}if(this.props.validValueRanges&&this.props.validValueRanges.length===2){if(e<this.props.validValueRanges[0]){this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," not contained in valid value range of           ").concat(this.props.validValueRanges,", supplying illegal values will throw errors in the future"),t);e=this.props.validValueRanges[0]}else if(e>this.props.validValueRanges[1]){this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," not contained in valid value range of           ").concat(this.props.validValueRanges,", supplying illegal values will throw errors in the future"),t);e=this.props.validValueRanges[1]}}return e}case"string":{if(typeof e==="number"){this.characteristicWarning("characteristic was supplied illegal value: number instead of string, "+"supplying illegal values will throw errors in the future",t);e=String(e)}if(typeof e!=="string"){this.characteristicWarning("characteristic value expected string and received "+typeof e,t);e=typeof this.value==="string"?this.value:e+""}if(e.length<=1&&(this.UUID===Characteristic.Model.UUID||this.UUID===Characteristic.SerialNumber.UUID)){this.characteristicWarning("[".concat(this.displayName,"] characteristic must have a length of more than 1 character otherwise         HomeKit will reject this accessory, ignoring new value"),t);return this.value}var s=(r=this.props.maxLen)!==null&&r!==void 0?r:64;if(e.length>s){this.characteristicWarning("characteristic was supplied illegal value: string '".concat(e,"' exceeded max length of ").concat(s),t);e=e.substring(0,s)}return e}case"data":if(typeof e!=="string"){throw new Error("characteristic with DATA format must have string value")}if(this.props.maxDataLen!=null&&e.length>this.props.maxDataLen){throw new Error("characteristic with DATA format exceeds specified maxDataLen")}return e;case"tlv8":if(e===undefined){this.characteristicWarning("characteristic was supplied illegal value: undefined",t);return this.value}return e}if(e===undefined){this.characteristicWarning("characteristic was supplied illegal value: undefined","error-message");return this.value}return e};Characteristic.prototype._assignID=function(e,t,r,i){this.iid=e.getIID(t,r,i,this.UUID)};Characteristic.prototype.characteristicWarning=function(e,t,r){if(t===void 0){t="warn-message"}if(r===void 0){r=(new Error).stack}this.emit("characteristic-warning",t,e,r)};Characteristic.prototype.removeAllListeners=function(t){if(!t){this.removeOnGet();this.removeOnSet()}return e.prototype.removeAllListeners.call(this,t)};Characteristic.prototype.replaceBy=function(e){var t=this;this.props=e.props;this.updateValue(e.value);var r=e.listeners("get");if(r.length){this.removeAllListeners("get");r.forEach((function(e){return t.addListener("get",e)}))}this.removeOnGet();if(e.getHandler){this.onGet(e.getHandler)}var i=e.listeners("set");if(i.length){this.removeAllListeners("set");i.forEach((function(e){return t.addListener("set",e)}))}this.removeOnSet();if(e.setHandler){this.onSet(e.setHandler)}};Characteristic.prototype.toHAP=function(e,t){if(t===void 0){t=true}return i.__awaiter(this,void 0,void 0,(function(){var r,n,a;var o=this;return i.__generator(this,(function(i){switch(i.label){case 0:r=this.internalHAPRepresentation();if(!!this.props.perms.includes("pr"))return[3,1];r.value=undefined;return[3,6];case 1:if(!(this.UUID===Characteristic.ProgrammableSwitchEvent.UUID))return[3,2];r.value=null;return[3,6];case 2:if(!t)return[3,4];return[4,this.handleGetRequest(e).catch((function(){var e=o.getDefaultValue();p("[%s] Error getting value for characteristic on /accessories request. Returning default value instead: %s",o.displayName,"".concat(e));return e}))];case 3:a=i.sent();return[3,5];case 4:a=this.value;i.label=5;case 5:n=a;r.value=(0,d.formatOutgoingCharacteristicValue)(n,this.props);i.label=6;case 6:return[2,r]}}))}))};Characteristic.prototype.internalHAPRepresentation=function(){(0,n.default)(this.iid,"iid cannot be undefined for characteristic '"+this.displayName+"'");return{type:(0,h.toShortForm)(this.UUID),iid:this.iid,value:null,perms:this.props.perms,description:this.props.description||this.displayName,format:this.props.format,unit:this.props.unit,minValue:this.props.minValue,maxValue:this.props.maxValue,minStep:this.props.minStep,maxLen:this.props.maxLen,maxDataLen:this.props.maxDataLen,"valid-values":this.props.validValues,"valid-values-range":this.props.validValueRanges}};Characteristic.serialize=function(e){var t;if(e.constructor.name!=="Characteristic"){t=e.constructor.name}return{displayName:e.displayName,UUID:e.UUID,eventOnlyCharacteristic:e.UUID===Characteristic.ProgrammableSwitchEvent.UUID,constructorName:t,value:e.value,props:(0,c.clone)({},e.props)}};Characteristic.deserialize=function(e){var t;if(e.constructorName&&e.constructorName.charAt(0).toUpperCase()===e.constructorName.charAt(0)&&Characteristic[e.constructorName]){var r=Characteristic[e.constructorName];t=new r;t.displayName=e.displayName;t.setProps(e.props)}else{t=new Characteristic(e.displayName,e.UUID,e.props)}t.value=e.value;return t};Characteristic.Formats=v;Characteristic.Units=m;Characteristic.Perms=g;return Characteristic}(o.EventEmitter);t.Characteristic=_;r(5893)},4080:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HAPServer=t.HAPServerEventTypes=t.HAPPairingHTTPCode=t.HAPHTTPCode=t.Status=t.Codes=t.IsKnownHAPStatusError=t.HAPStatus=t.TLVErrorCode=void 0;var i=r(6867);var n=i.__importDefault(r(6113));var a=i.__importDefault(r(7031));var o=r(2361);var s=r(3823);var c=i.__importDefault(r(326));var u=r(7310);var l=r(6711);var d=r(3939);var h=i.__importStar(r(6831));var p=r(7417);var v=i.__importStar(r(2571));var m=(0,a.default)("HAP-NodeJS:HAPServer");var g;(function(e){e[e["UNKNOWN"]=1]="UNKNOWN";e[e["INVALID_REQUEST"]=2]="INVALID_REQUEST";e[e["AUTHENTICATION"]=2]="AUTHENTICATION";e[e["BACKOFF"]=3]="BACKOFF";e[e["MAX_PEERS"]=4]="MAX_PEERS";e[e["MAX_TRIES"]=5]="MAX_TRIES";e[e["UNAVAILABLE"]=6]="UNAVAILABLE";e[e["BUSY"]=7]="BUSY"})(g=t.TLVErrorCode||(t.TLVErrorCode={}));var y;(function(e){e[e["SUCCESS"]=0]="SUCCESS";e[e["INSUFFICIENT_PRIVILEGES"]=-70401]="INSUFFICIENT_PRIVILEGES";e[e["SERVICE_COMMUNICATION_FAILURE"]=-70402]="SERVICE_COMMUNICATION_FAILURE";e[e["RESOURCE_BUSY"]=-70403]="RESOURCE_BUSY";e[e["READ_ONLY_CHARACTERISTIC"]=-70404]="READ_ONLY_CHARACTERISTIC";e[e["WRITE_ONLY_CHARACTERISTIC"]=-70405]="WRITE_ONLY_CHARACTERISTIC";e[e["NOTIFICATION_NOT_SUPPORTED"]=-70406]="NOTIFICATION_NOT_SUPPORTED";e[e["OUT_OF_RESOURCE"]=-70407]="OUT_OF_RESOURCE";e[e["OPERATION_TIMED_OUT"]=-70408]="OPERATION_TIMED_OUT";e[e["RESOURCE_DOES_NOT_EXIST"]=-70409]="RESOURCE_DOES_NOT_EXIST";e[e["INVALID_VALUE_IN_REQUEST"]=-70410]="INVALID_VALUE_IN_REQUEST";e[e["INSUFFICIENT_AUTHORIZATION"]=-70411]="INSUFFICIENT_AUTHORIZATION";e[e["NOT_ALLOWED_IN_CURRENT_STATE"]=-70412]="NOT_ALLOWED_IN_CURRENT_STATE"})(y=t.HAPStatus||(t.HAPStatus={}));function IsKnownHAPStatusError(e){return e>=-70412&&e<=-70401}t.IsKnownHAPStatusError=IsKnownHAPStatusError;t.Codes=g;t.Status=y;var C;(function(e){e[e["OK"]=200]="OK";e[e["NO_CONTENT"]=204]="NO_CONTENT";e[e["MULTI_STATUS"]=207]="MULTI_STATUS";e[e["BAD_REQUEST"]=400]="BAD_REQUEST";e[e["NOT_FOUND"]=404]="NOT_FOUND";e[e["UNPROCESSABLE_ENTITY"]=422]="UNPROCESSABLE_ENTITY";e[e["INTERNAL_SERVER_ERROR"]=500]="INTERNAL_SERVER_ERROR";e[e["SERVICE_UNAVAILABLE"]=503]="SERVICE_UNAVAILABLE"})(C=t.HAPHTTPCode||(t.HAPHTTPCode={}));var T;(function(e){e[e["OK"]=200]="OK";e[e["BAD_REQUEST"]=400]="BAD_REQUEST";e[e["METHOD_NOT_ALLOWED"]=405]="METHOD_NOT_ALLOWED";e[e["TOO_MANY_REQUESTS"]=429]="TOO_MANY_REQUESTS";e[e["CONNECTION_AUTHORIZATION_REQUIRED"]=470]="CONNECTION_AUTHORIZATION_REQUIRED";e[e["INTERNAL_SERVER_ERROR"]=500]="INTERNAL_SERVER_ERROR"})(T=t.HAPPairingHTTPCode||(t.HAPPairingHTTPCode={}));var E;(function(e){e["LISTENING"]="listening";e["IDENTIFY"]="identify";e["ADD_PAIRING"]="add-pairing";e["REMOVE_PAIRING"]="remove-pairing";e["LIST_PAIRINGS"]="list-pairings";e["PAIR"]="pair";e["ACCESSORIES"]="accessories";e["GET_CHARACTERISTICS"]="get-characteristics";e["SET_CHARACTERISTICS"]="set-characteristics";e["REQUEST_RESOURCE"]="request-resource";e["CONNECTION_CLOSED"]="connection-closed"})(E=t.HAPServerEventTypes||(t.HAPServerEventTypes={}));var D=function(e){i.__extends(HAPServer,e);function HAPServer(t){var r=e.call(this)||this;r.unsuccessfulPairAttempts=0;r.accessoryInfo=t;r.allowInsecureRequest=false;r.httpServer=new d.EventedHTTPServer;r.httpServer.on("listening",r.onListening.bind(r));r.httpServer.on("request",r.handleRequestOnHAPConnection.bind(r));r.httpServer.on("connection-closed",r.handleConnectionClosed.bind(r));return r}HAPServer.prototype.listen=function(e,t){if(e===void 0){e=0}if(t==="::"){t=undefined}this.httpServer.listen(e,t)};HAPServer.prototype.stop=function(){this.httpServer.stop()};HAPServer.prototype.destroy=function(){this.stop();this.removeAllListeners()};HAPServer.prototype.sendEventNotifications=function(e,t,r,i,n){try{this.httpServer.broadcastEvent(e,t,r,i,n)}catch(e){console.warn("["+this.accessoryInfo.username+"] Error when sending event notifications: "+e.message)}};HAPServer.prototype.onListening=function(e,t){this.emit("listening",e,t)};HAPServer.prototype.handleRequestOnHAPConnection=function(e,t,r){var i=this;m("[%s] HAP Request: %s %s",this.accessoryInfo.username,t.method,t.url);var n=[];t.on("data",(function(e){return n.push(e)}));t.on("end",(function(){var a=new u.URL(t.url,"http://hap-nodejs.local");var o=i.getHandler(a);if(!o){m("[%s] WARNING: Handler for %s not implemented",i.accessoryInfo.username,t.url);r.writeHead(404,{"Content-Type":"application/hap+json"});r.end(JSON.stringify({status:-70409}))}else{var s=Buffer.concat(n);try{o(e,a,t,s,r)}catch(e){m("[%s] Error executing route handler: %s",i.accessoryInfo.username,e.stack);r.writeHead(500,{"Content-Type":"application/hap+json"});r.end(JSON.stringify({status:-70403}))}}}))};HAPServer.prototype.handleConnectionClosed=function(e){this.emit("connection-closed",e)};HAPServer.prototype.getHandler=function(e){switch(e.pathname.toLowerCase()){case"/identify":return this.handleIdentifyRequest.bind(this);case"/pair-setup":return this.handlePairSetup.bind(this);case"/pair-verify":return this.handlePairVerify.bind(this);case"/pairings":return this.handlePairings.bind(this);case"/accessories":return this.handleAccessories.bind(this);case"/characteristics":return this.handleCharacteristics.bind(this);case"/prepare":return this.handlePrepareWrite.bind(this);case"/resource":return this.handleResource.bind(this);default:return undefined}};HAPServer.prototype.handleIdentifyRequest=function(e,t,r,i,n){var a=this;if(this.accessoryInfo.paired()&&!this.allowInsecureRequest){n.writeHead(400,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:-70401}));return}this.emit("identify",(0,p.once)((function(e){if(!e){m("[%s] Identification success",a.accessoryInfo.username);n.writeHead(204);n.end()}else{m("[%s] Identification error: %s",a.accessoryInfo.username,e.message);n.writeHead(500,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:-70403}))}})))};HAPServer.prototype.handlePairSetup=function(e,t,r,i,n){if(!this.allowInsecureRequest&&this.accessoryInfo.paired()){n.writeHead(200,{"Content-Type":"application/pairing+tlv8"});n.end(v.encode(6,2,7,6));return}if(this.unsuccessfulPairAttempts>100){m("[%s] Reached maximum amount of unsuccessful pair attempts!",this.accessoryInfo.username);n.writeHead(200,{"Content-Type":"application/pairing+tlv8"});n.end(v.encode(6,2,7,5));return}var a=v.decode(i);var o=a[6][0];if(o===1){this.handlePairSetupM1(e,r,n)}else if(o===3&&e._pairSetupState===2){this.handlePairSetupM3(e,r,n,a)}else if(o===5&&e._pairSetupState===4){this.handlePairSetupM5(e,r,n,a)}else{n.writeHead(400,{"Content-Type":"application/pairing+tlv8"});n.end(v.encode(6,o+1,7,1));return}};HAPServer.prototype.handlePairSetupM1=function(e,t,r){var i=this;m("[%s] Pair step 1/5",this.accessoryInfo.username);var a=n.default.randomBytes(16);var o=s.SRP.params.hap;s.SRP.genKey(32).then((function(t){var n=new s.SrpServer(o,a,Buffer.from("Pair-Setup"),Buffer.from(i.accessoryInfo.pincode),t);var c=n.computeB();e.srpServer=n;r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,2,2,a,3,c));e._pairSetupState=2})).catch((function(e){m("[%s] Error occurred when generating srp key: %s",i.accessoryInfo.username,e.message);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,2,7,1));return}))};HAPServer.prototype.handlePairSetupM3=function(e,t,r,i){m("[%s] Pair step 2/5",this.accessoryInfo.username);var n=i[3];var a=i[4];var o=e.srpServer;o.setA(n);try{o.checkM1(a)}catch(t){this.unsuccessfulPairAttempts++;m("[%s] Error while checking pincode: %s",this.accessoryInfo.username,t.message);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,4,7,2));e._pairSetupState=undefined;return}var s=o.computeM2();r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,4,4,s));e._pairSetupState=4};HAPServer.prototype.handlePairSetupM5=function(e,t,r,i){m("[%s] Pair step 3/5",this.accessoryInfo.username);var n=e.srpServer;var a=i[5];var o=Buffer.alloc(a.length-16);var s=Buffer.alloc(16);a.copy(o,0,0,a.length-16);a.copy(s,0,a.length-16,a.length);var c=n.computeK();var u=Buffer.from("Pair-Setup-Encrypt-Salt");var l=Buffer.from("Pair-Setup-Encrypt-Info");var d=h.HKDF("sha512",u,c,l,32);var p;try{p=h.chacha20_poly1305_decryptAndVerify(d,Buffer.from("PS-Msg05"),null,o,s)}catch(t){m("[%s] Error while decrypting and verifying M5 subTlv: %s",this.accessoryInfo.username);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,4,7,2));e._pairSetupState=undefined;return}var g=v.decode(p);var y=g[1];var C=g[3];var T=g[10];this.handlePairSetupM5_2(e,t,r,y,C,T,d)};HAPServer.prototype.handlePairSetupM5_2=function(e,t,r,i,n,a,o){m("[%s] Pair step 4/5",this.accessoryInfo.username);var s=e.srpServer.computeK();var u=Buffer.from("Pair-Setup-Controller-Sign-Salt");var l=Buffer.from("Pair-Setup-Controller-Sign-Info");var d=h.HKDF("sha512",u,s,l,32);var p=Buffer.concat([d,i,n]);if(!c.default.sign.detached.verify(p,a,n)){m("[%s] Invalid signature",this.accessoryInfo.username);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,6,7,2));e._pairSetupState=undefined;return}this.handlePairSetupM5_3(e,t,r,i,n,o)};HAPServer.prototype.handlePairSetupM5_3=function(e,t,r,i,n,a){var o=this;m("[%s] Pair step 5/5",this.accessoryInfo.username);var s=e.srpServer.computeK();var u=Buffer.from("Pair-Setup-Accessory-Sign-Salt");var l=Buffer.from("Pair-Setup-Accessory-Sign-Info");var d=h.HKDF("sha512",u,s,l,32);var g=this.accessoryInfo.signPk;var y=Buffer.from(this.accessoryInfo.username);var C=Buffer.concat([d,y,g]);var T=Buffer.from(this.accessoryInfo.signSk);var E=c.default.sign.detached(C,T);var D=v.encode(1,y,3,g,10,E);var _=h.chacha20_poly1305_encryptAndSeal(a,Buffer.from("PS-Msg06"),null,D);this.emit("pair",i.toString(),n,(0,p.once)((function(t){if(t){m("[%s] Error adding pairing info: %s",o.accessoryInfo.username,t.message);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,6,7,1));e._pairSetupState=undefined;return}r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,6,5,Buffer.concat([_.ciphertext,_.authTag])));e._pairSetupState=undefined})))};HAPServer.prototype.handlePairVerify=function(e,t,r,i,n){var a=v.decode(i);var o=a[6][0];if(o===1){this.handlePairVerifyM1(e,r,n,a)}else if(o===3&&e._pairVerifyState===2){this.handlePairVerifyM3(e,r,n,a)}else{n.writeHead(400,{"Content-Type":"application/pairing+tlv8"});n.end(v.encode(6,o+1,7,1));return}};HAPServer.prototype.handlePairVerifyM1=function(e,t,r,i){m("[%s] Pair verify step 1/2",this.accessoryInfo.username);var n=i[3];var a=h.generateCurve25519KeyPair();var o=Buffer.from(a.secretKey);var s=Buffer.from(a.publicKey);var u=Buffer.from(h.generateCurve25519SharedSecKey(o,n));var l=Buffer.from(this.accessoryInfo.username);var p=Buffer.concat([s,l,n]);var g=Buffer.from(this.accessoryInfo.signSk);var y=c.default.sign.detached(p,g);var C=Buffer.from("Pair-Verify-Encrypt-Salt");var T=Buffer.from("Pair-Verify-Encrypt-Info");var E=h.HKDF("sha512",C,u,T,32).slice(0,32);e.encryption=new d.HAPEncryption(n,o,s,u,E);var D=v.encode(1,l,10,y);var _=h.chacha20_poly1305_encryptAndSeal(E,Buffer.from("PV-Msg02"),null,D);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,2,5,Buffer.concat([_.ciphertext,_.authTag]),3,s));e._pairVerifyState=2};HAPServer.prototype.handlePairVerifyM3=function(e,t,r,i){m("[%s] Pair verify step 2/2",this.accessoryInfo.username);var n=i[5];var a=Buffer.alloc(n.length-16);var o=Buffer.alloc(16);n.copy(a,0,0,n.length-16);n.copy(o,0,n.length-16,n.length);var s=e.encryption;var u;try{u=h.chacha20_poly1305_decryptAndVerify(s.hkdfPairEncryptionKey,Buffer.from("PV-Msg03"),null,a,o)}catch(t){m("[%s] M3: Failed to decrypt and/or verify",this.accessoryInfo.username);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,4,7,2));e._pairVerifyState=undefined;return}var l=v.decode(u);var d=l[1];var p=l[10];var g=Buffer.concat([s.clientPublicKey,d,s.publicKey]);var y=this.accessoryInfo.getClientPublicKey(d.toString());if(!y){m("[%s] Client %s attempting to verify, but we are not paired; rejecting client",this.accessoryInfo.username,d);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,4,7,2));e._pairVerifyState=undefined;return}if(!c.default.sign.detached.verify(g,p,y)){m("[%s] Client %s provided an invalid signature",this.accessoryInfo.username,d);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,4,7,2));e._pairVerifyState=undefined;return}m("[%s] Client %s verification complete",this.accessoryInfo.username,d);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"});r.end(v.encode(6,4));var C=Buffer.from("Control-Salt");var T=Buffer.from("Control-Read-Encryption-Key");var E=Buffer.from("Control-Write-Encryption-Key");s.accessoryToControllerKey=h.HKDF("sha512",C,s.sharedSecret,T,32);s.controllerToAccessoryKey=h.HKDF("sha512",C,s.sharedSecret,E,32);e.connectionAuthenticated(d.toString());e._pairVerifyState=undefined};HAPServer.prototype.handlePairings=function(e,t,r,n,a){var o=this;if(!this.allowInsecureRequest&&!e.isAuthenticated()){a.writeHead(470,{"Content-Type":"application/hap+json"});a.end(JSON.stringify({status:-70401}));return}var s=v.decode(n);var c=s[0][0];var u=s[6][0];if(u!==1){return}if(c===3){var l=s[1].toString();var d=s[3];var h=s[11][0];this.emit("add-pairing",e,l,d,h,(0,p.once)((function(e){if(e>0){m("[%s] Pairings: failed ADD_PAIRING with code %d",o.accessoryInfo.username,e);a.writeHead(200,{"Content-Type":"application/pairing+tlv8"});a.end(v.encode(6,2,7,e));return}a.writeHead(200,{"Content-Type":"application/pairing+tlv8"});a.end(v.encode(6,2));m("[%s] Pairings: successfully executed ADD_PAIRING",o.accessoryInfo.username)})))}else if(c===4){var l=s[1].toString();this.emit("remove-pairing",e,l,(0,p.once)((function(e){if(e>0){m("[%s] Pairings: failed REMOVE_PAIRING with code %d",o.accessoryInfo.username,e);a.writeHead(200,{"Content-Type":"application/pairing+tlv8"});a.end(v.encode(6,2,7,e));return}a.writeHead(200,{"Content-Type":"application/pairing+tlv8"});a.end(v.encode(6,2));m("[%s] Pairings: successfully executed REMOVE_PAIRING",o.accessoryInfo.username)})))}else if(c===5){this.emit("list-pairings",e,(0,p.once)((function(e,t){if(e>0){m("[%s] Pairings: failed LIST_PAIRINGS with code %d",o.accessoryInfo.username,e);a.writeHead(200,{"Content-Type":"application/pairing+tlv8"});a.end(v.encode(6,2,7,e));return}var r=[];t.forEach((function(e,t){if(t>0){r.push(255,Buffer.alloc(0))}r.push(1,e.username,3,e.publicKey,11,e.permission)}));var n=v.encode.apply(v,i.__spreadArray([6,2],i.__read(r),false));a.writeHead(200,{"Content-Type":"application/pairing+tlv8"});a.end(n);m("[%s] Pairings: successfully executed LIST_PAIRINGS",o.accessoryInfo.username)})))}};HAPServer.prototype.handleAccessories=function(e,t,r,i,n){if(!this.allowInsecureRequest&&!e.isAuthenticated()){n.writeHead(470,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:-70401}));return}this.emit("accessories",e,(0,p.once)((function(e,t){if(e){n.writeHead(e.httpCode,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:e.status}))}else{n.writeHead(200,{"Content-Type":"application/hap+json"});n.end(JSON.stringify(t))}})))};HAPServer.prototype.handleCharacteristics=function(e,t,r,n,a){var o,s;if(!this.allowInsecureRequest&&!e.isAuthenticated()){a.writeHead(470,{"Content-Type":"application/hap+json"});a.end(JSON.stringify({status:-70401}));return}if(r.method==="GET"){var c=t.searchParams;var u=c.get("id");if(!u){a.writeHead(400,{"Content-Type":"application/hap+json"});a.end(JSON.stringify({status:-70410}));return}var d=[];try{for(var h=i.__values(u.split(",")),v=h.next();!v.done;v=h.next()){var m=v.value;var g=m.split(".");d.push({aid:parseInt(g[0],10),iid:parseInt(g[1],10)})}}catch(e){o={error:e}}finally{try{if(v&&!v.done&&(s=h.return))s.call(h)}finally{if(o)throw o.error}}var y={ids:d,includeMeta:(0,l.consideredTrue)(c.get("meta")),includePerms:(0,l.consideredTrue)(c.get("perms")),includeType:(0,l.consideredTrue)(c.get("type")),includeEvent:(0,l.consideredTrue)(c.get("ev"))};this.emit("get-characteristics",e,y,(0,p.once)((function(e,t){var r,n,o,s;if(e){a.writeHead(e.httpCode,{"Content-Type":"application/hap+json"});a.end(JSON.stringify({status:e.status}));return}var c=t.characteristics;var u=false;try{for(var l=i.__values(c),d=l.next();!d.done;d=l.next()){var h=d.value;if(h.status){u=true;break}}}catch(e){r={error:e}}finally{try{if(d&&!d.done&&(n=l.return))n.call(l)}finally{if(r)throw r.error}}if(u){try{for(var p=i.__values(c),v=p.next();!v.done;v=p.next()){var m=v.value;if(!m.status){m.status=0}}}catch(e){o={error:e}}finally{try{if(v&&!v.done&&(s=p.return))s.call(p)}finally{if(o)throw o.error}}}a.writeHead(u?207:200,{"Content-Type":"application/hap+json"});a.end(JSON.stringify({characteristics:c}))})))}else if(r.method==="PUT"){if(!e.isAuthenticated()){if(!r.headers||r.headers&&r.headers.authorization!==this.accessoryInfo.pincode){a.writeHead(470,{"Content-Type":"application/hap+json"});a.end(JSON.stringify({status:-70401}));return}}if(n.length===0){a.writeHead(400,{"Content-Type":"application/hap+json"});a.end(JSON.stringify({status:-70410}));return}var C=JSON.parse(n.toString("utf8"));this.emit("set-characteristics",e,C,(0,p.once)((function(e,t){var r,n;if(e){a.writeHead(e.httpCode,{"Content-Type":"application/hap+json"});a.end(JSON.stringify({status:e.status}));return}var o=t.characteristics;var s=false;try{for(var c=i.__values(o),u=c.next();!u.done;u=c.next()){var l=u.value;if(l.status||l.value!==undefined){s=true;break}}}catch(e){r={error:e}}finally{try{if(u&&!u.done&&(n=c.return))n.call(c)}finally{if(r)throw r.error}}if(s){a.writeHead(207,{"Content-Type":"application/hap+json"});a.end(JSON.stringify({characteristics:o}))}else{a.writeHead(204);a.end()}})))}else{a.writeHead(400,{"Content-Type":"application/hap+json"});a.end(JSON.stringify({status:-70410}))}};HAPServer.prototype.handlePrepareWrite=function(e,t,r,i,n){var a=this;if(!this.allowInsecureRequest&&!e.isAuthenticated()){n.writeHead(470,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:-70401}));return}if(r.method==="PUT"){if(i.length===0){n.writeHead(400,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:-70410}));return}var o=JSON.parse(i.toString());if(o.pid&&o.ttl){m("[%s] Received prepare write request with pid %d and ttl %d",this.accessoryInfo.username,o.pid,o.ttl);if(e.timedWriteTimeout){clearTimeout(e.timedWriteTimeout)}e.timedWritePid=o.pid;e.timedWriteTimeout=setTimeout((function(){m("[%s] Timed write request timed out for pid %d",a.accessoryInfo.username,o.pid);e.timedWritePid=undefined;e.timedWriteTimeout=undefined}),o.ttl);n.writeHead(200,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:0}));return}else{n.writeHead(400,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:-70410}))}}else{n.writeHead(400,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:-70410}))}};HAPServer.prototype.handleResource=function(e,t,r,i,n){if(!e.isAuthenticated()){if(!(this.allowInsecureRequest&&r.headers&&r.headers.authorization===this.accessoryInfo.pincode)){n.writeHead(470,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:-70401}));return}}if(r.method==="POST"){if(i.length===0){n.writeHead(400,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:-70410}));return}var a=JSON.parse(i.toString());this.emit("request-resource",a,(0,p.once)((function(e,t){if(e){n.writeHead(e.httpCode,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:e.status}))}else{n.writeHead(200,{"Content-Type":"image/jpeg"});n.end(t)}})))}else{n.writeHead(400,{"Content-Type":"application/hap+json"});n.end(JSON.stringify({status:-70410}))}};return HAPServer}(o.EventEmitter);t.HAPServer=D},877:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Service=t.ServiceEventTypes=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=i.__importDefault(r(7031));var o=r(2361);var s=r(8117);var c=r(5752);var u=(0,a.default)("HAP-NodeJS:Service");var l=100;var d;(function(e){e["CHARACTERISTIC_CHANGE"]="characteristic-change";e["SERVICE_CONFIGURATION_CHANGE"]="service-configurationChange";e["CHARACTERISTIC_WARNING"]="characteristic-warning"})(d=t.ServiceEventTypes||(t.ServiceEventTypes={}));var h=function(e){i.__extends(Service,e);function Service(t,r,i){if(t===void 0){t=""}var a=e.call(this)||this;a.iid=null;a.name=null;a.characteristics=[];a.optionalCharacteristics=[];a.isHiddenService=false;a.isPrimaryService=false;a.linkedServices=[];(0,n.default)(r,"Services must be created with a valid UUID.");a.displayName=t;a.UUID=r;a.subtype=i;if(t){var o=a.getCharacteristic(s.Characteristic.Name)||a.addCharacteristic(s.Characteristic.Name);o.updateValue(t)}return a}Service.prototype.getServiceId=function(){return this.UUID+(this.subtype||"")};Service.prototype.addCharacteristic=function(e){var t,r;var n=[];for(var a=1;a<arguments.length;a++){n[a-1]=arguments[a]}var o=typeof e==="function"?new(e.bind.apply(e,i.__spreadArray([void 0],i.__read(n),false))):e;try{for(var s=i.__values(this.characteristics),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.UUID===o.UUID){if(o.UUID==="00000052-0000-1000-8000-0026BB765291"){return u}throw new Error("Cannot add a Characteristic with the same UUID as another Characteristic in this Service: "+u.UUID)}}}catch(e){t={error:e}}finally{try{if(c&&!c.done&&(r=s.return))r.call(s)}finally{if(t)throw t.error}}if(this.characteristics.length>=l){throw new Error("Cannot add more than "+l+" characteristics to a single service!")}this.setupCharacteristicEventHandlers(o);this.characteristics.push(o);this.emit("service-configurationChange");return o};Service.prototype.setPrimaryService=function(e){if(e===void 0){e=true}this.isPrimaryService=e;this.emit("service-configurationChange")};Service.prototype.setHiddenService=function(e){if(e===void 0){e=true}this.isHiddenService=e;this.emit("service-configurationChange")};Service.prototype.addLinkedService=function(e){if(!this.linkedServices.includes(e)){this.linkedServices.push(e)}this.emit("service-configurationChange")};Service.prototype.removeLinkedService=function(e){var t=this.linkedServices.indexOf(e);if(t!==-1){this.linkedServices.splice(t,1)}this.emit("service-configurationChange")};Service.prototype.removeCharacteristic=function(e){var t=this.characteristics.indexOf(e);if(t!==-1){this.characteristics.splice(t,1);e.removeAllListeners();this.emit("service-configurationChange")}};Service.prototype.getCharacteristic=function(e){var t,r,n,a;try{for(var o=i.__values(this.characteristics),c=o.next();!c.done;c=o.next()){var u=c.value;if(typeof e==="string"&&u.displayName===e){return u}else if(typeof e==="function"&&(u instanceof e||e.UUID===u.UUID)){return u}}}catch(e){t={error:e}}finally{try{if(c&&!c.done&&(r=o.return))r.call(o)}finally{if(t)throw t.error}}if(typeof e==="function"){try{for(var l=i.__values(this.optionalCharacteristics),d=l.next();!d.done;d=l.next()){var u=d.value;if(u instanceof e||e.UUID===u.UUID){return this.addCharacteristic(e)}}}catch(e){n={error:e}}finally{try{if(d&&!d.done&&(a=l.return))a.call(l)}finally{if(n)throw n.error}}var h=this.addCharacteristic(e);if(e.UUID!==s.Characteristic.Name.UUID){this.emitCharacteristicWarningEvent(h,"warn-message","Characteristic not in required or optional characteristic section for service "+this.constructor.name+". Adding anyway.")}return h}};Service.prototype.testCharacteristic=function(e){var t,r;try{for(var n=i.__values(this.characteristics),a=n.next();!a.done;a=n.next()){var o=a.value;if(typeof e==="string"&&o.displayName===e){return true}else if(typeof e==="function"&&(o instanceof e||e.UUID===o.UUID)){return true}}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}return false};Service.prototype.setCharacteristic=function(e,t){this.getCharacteristic(e).setValue(t);return this};Service.prototype.updateCharacteristic=function(e,t){this.getCharacteristic(e).updateValue(t);return this};Service.prototype.addOptionalCharacteristic=function(e){if(typeof e==="function"){e=new e}this.optionalCharacteristics.push(e)};Service.prototype.replaceCharacteristicsFromService=function(e){var t=this;if(this.UUID!==e.UUID){throw new Error("Incompatible services. Tried replacing characteristics of ".concat(this.UUID," with characteristics from ").concat(e.UUID))}var r={};e.characteristics.forEach((function(e){return r[e.UUID]=e}));this.characteristics.forEach((function(e){var t=r[e.UUID];if(t){delete r[e.UUID];if(!t.value&&t.value!==0&&t.value!==false){return}e.replaceBy(t)}}));Object.values(r).forEach((function(e){return t.addCharacteristic(e)}))};Service.prototype.getCharacteristicByIID=function(e){var t,r;try{for(var n=i.__values(this.characteristics),a=n.next();!a.done;a=n.next()){var o=a.value;if(o.iid===e){return o}}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}};Service.prototype._assignIDs=function(e,t,r){var n,a;if(r===void 0){r=0}if(this.UUID==="0000003E-0000-1000-8000-0026BB765291"){this.iid=1}else{this.iid=r+e.getIID(t,this.UUID,this.subtype)}try{for(var o=i.__values(this.characteristics),s=o.next();!s.done;s=o.next()){var c=s.value;c._assignID(e,t,this.UUID,this.subtype)}}catch(e){n={error:e}}finally{try{if(s&&!s.done&&(a=o.return))a.call(o)}finally{if(n)throw n.error}}};Service.prototype.toHAP=function(e,t){var r=this;if(t===void 0){t=true}return new Promise((function(a){var o,s,l,d;(0,n.default)(r.iid,"iid cannot be undefined for service '"+r.displayName+"'");(0,n.default)(r.characteristics.length,"service '"+r.displayName+"' does not have any characteristics!");var h={type:(0,c.toShortForm)(r.UUID),iid:r.iid,characteristics:[],hidden:r.isHiddenService?true:undefined,primary:r.isPrimaryService?true:undefined};if(r.linkedServices.length){h.linked=[];try{for(var p=i.__values(r.linkedServices),v=p.next();!v.done;v=p.next()){var m=v.value;if(!m.iid){u("iid of linked service '".concat(m.displayName,"' ").concat(m.UUID," is undefined on service '").concat(r.displayName,"'"));continue}h.linked.push(m.iid)}}catch(e){o={error:e}}finally{try{if(v&&!v.done&&(s=p.return))s.call(p)}finally{if(o)throw o.error}}}var g=new Set;var y=setTimeout((function(){var e,t;try{for(var n=i.__values(g),o=n.next();!o.done;o=n.next()){var s=o.value;r.emitCharacteristicWarningEvent(s,"slow-read","The read handler for the characteristic '".concat(s.displayName,"' was slow to respond!"))}}catch(t){e={error:t}}finally{try{if(o&&!o.done&&(t=n.return))t.call(n)}finally{if(e)throw e.error}}y=setTimeout((function(){var e,t;y=undefined;try{for(var n=i.__values(g),o=n.next();!o.done;o=n.next()){var s=o.value;r.emitCharacteristicWarningEvent(s,"timeout-read","The read handler for the characteristic '"+(s===null||s===void 0?void 0:s.displayName)+"' didn't respond at all!. Please check that you properly call the callback!");h.characteristics.push(s.internalHAPRepresentation())}}catch(t){e={error:t}}finally{try{if(o&&!o.done&&(t=n.return))t.call(n)}finally{if(e)throw e.error}}g.clear();a(h)}),6e3)}),3e3);var _loop_1=function(r){g.add(r);r.toHAP(e,t).then((function(e){if(!y){return}g.delete(r);h.characteristics.push(e);if(g.size===0){if(y){clearTimeout(y);y=undefined}a(h)}}))};try{for(var C=i.__values(r.characteristics),T=C.next();!T.done;T=C.next()){var E=T.value;_loop_1(E)}}catch(e){l={error:e}}finally{try{if(T&&!T.done&&(d=C.return))d.call(C)}finally{if(l)throw l.error}}}))};Service.prototype.internalHAPRepresentation=function(){var e,t;(0,n.default)(this.iid,"iid cannot be undefined for service '"+this.displayName+"'");(0,n.default)(this.characteristics.length,"service '"+this.displayName+"' does not have any characteristics!");var r={type:(0,c.toShortForm)(this.UUID),iid:this.iid,characteristics:this.characteristics.map((function(e){return e.internalHAPRepresentation()})),hidden:this.isHiddenService?true:undefined,primary:this.isPrimaryService?true:undefined};if(this.linkedServices.length){r.linked=[];try{for(var a=i.__values(this.linkedServices),o=a.next();!o.done;o=a.next()){var s=o.value;if(!s.iid){u("iid of linked service '".concat(s.displayName,"' ").concat(s.UUID," is undefined on service '").concat(this.displayName,"'"));continue}r.linked.push(s.iid)}}catch(t){e={error:t}}finally{try{if(o&&!o.done&&(t=a.return))t.call(a)}finally{if(e)throw e.error}}}return r};Service.prototype.setupCharacteristicEventHandlers=function(e){var t=this;e.on("change",(function(r){t.emit("characteristic-change",i.__assign(i.__assign({},r),{characteristic:e}))}));e.on("characteristic-warning",this.emitCharacteristicWarningEvent.bind(this,e))};Service.prototype.emitCharacteristicWarningEvent=function(e,t,r,i){this.emit("characteristic-warning",{characteristic:e,type:t,message:r,originatorChain:[this.displayName,e.displayName],stack:i})};Service.prototype._sideloadCharacteristics=function(e){var t,r;try{for(var n=i.__values(e),a=n.next();!a.done;a=n.next()){var o=a.value;this.setupCharacteristicEventHandlers(o)}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}this.characteristics=e.slice()};Service.serialize=function(e){var t;if(e.constructor.name!=="Service"){t=e.constructor.name}return{displayName:e.displayName,UUID:e.UUID,subtype:e.subtype,constructorName:t,hiddenService:e.isHiddenService,primaryService:e.isPrimaryService,characteristics:e.characteristics.map((function(e){return s.Characteristic.serialize(e)})),optionalCharacteristics:e.optionalCharacteristics.map((function(e){return s.Characteristic.serialize(e)}))}};Service.deserialize=function(e){var t;if(e.constructorName&&e.constructorName.charAt(0).toUpperCase()===e.constructorName.charAt(0)&&Service[e.constructorName]){var r=Service[e.constructorName];t=new r(e.displayName,e.subtype)}else{t=new Service(e.displayName,e.UUID,e.subtype)}t.isHiddenService=!!e.hiddenService;t.isPrimaryService=!!e.primaryService;var i=e.characteristics.map((function(e){return s.Characteristic.deserialize(e)}));t._sideloadCharacteristics(i);if(e.optionalCharacteristics){t.optionalCharacteristics=e.optionalCharacteristics.map((function(e){return s.Characteristic.deserialize(e)}))}return t};return Service}(o.EventEmitter);t.Service=h;r(6017)},6815:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LegacyCameraSourceAdapter=void 0;var r=function(){function LegacyCameraSourceAdapter(e){this.cameraSource=e}LegacyCameraSourceAdapter.prototype.handleSnapshotRequest=function(e,t){this.cameraSource.handleSnapshotRequest(e,(function(e,r){t(e?e:undefined,r)}))};LegacyCameraSourceAdapter.prototype.prepareStream=function(e,t){this.cameraSource.prepareStream(e,(function(e){t(undefined,e)}))};LegacyCameraSourceAdapter.prototype.handleStreamRequest=function(e,t){this.cameraSource.handleStreamRequest(e);t()};LegacyCameraSourceAdapter.prototype.forwardCloseConnection=function(e){this.cameraSource.handleCloseConnection(e)};return LegacyCameraSourceAdapter}();t.LegacyCameraSourceAdapter=r},553:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(6867);var n=i.__importDefault(r(1891));var a=function(){function RTPProxy(e){this.options=e;this.startingPort=1e4;this.type=e.isIPV6?"udp6":"udp4";this.startingPort=1e4;this.outgoingAddress=e.outgoingAddress;this.outgoingPort=e.outgoingPort;this.incomingPayloadType=0;this.outgoingSSRC=e.outgoingSSRC;this.disabled=e.disabled;this.incomingSSRC=null;this.outgoingPayloadType=null}RTPProxy.prototype.setup=function(){var e=this;return this.createSocketPair(this.type).then((function(t){e.incomingRTPSocket=t[0];e.incomingRTCPSocket=t[1];return e.createSocket(e.type)})).then((function(t){e.outgoingSocket=t;e.onBound()}))};RTPProxy.prototype.destroy=function(){if(this.incomingRTPSocket){this.incomingRTPSocket.close()}if(this.incomingRTCPSocket){this.incomingRTCPSocket.close()}if(this.outgoingSocket){this.outgoingSocket.close()}};RTPProxy.prototype.incomingRTPPort=function(){var e=this.incomingRTPSocket.address();if(typeof e!=="string"){return e.port}throw new Error("Unsupported socket!")};RTPProxy.prototype.incomingRTCPPort=function(){var e=this.incomingRTCPSocket.address();if(typeof e!=="string"){return e.port}throw new Error("Unsupported socket!")};RTPProxy.prototype.outgoingLocalPort=function(){var e=this.outgoingSocket.address();if(typeof e!=="string"){return e.port}throw new Error("Unsupported socket!")};RTPProxy.prototype.setServerAddress=function(e){this.serverAddress=e};RTPProxy.prototype.setServerRTPPort=function(e){this.serverRTPPort=e};RTPProxy.prototype.setServerRTCPPort=function(e){this.serverRTCPPort=e};RTPProxy.prototype.setIncomingPayloadType=function(e){this.incomingPayloadType=e};RTPProxy.prototype.setOutgoingPayloadType=function(e){this.outgoingPayloadType=e};RTPProxy.prototype.sendOut=function(e){if(!this.outgoingAddress||!this.outgoingPort){return}this.outgoingSocket.send(e,this.outgoingPort,this.outgoingAddress)};RTPProxy.prototype.sendBack=function(e){if(!this.serverAddress||!this.serverRTCPPort){return}this.outgoingSocket.send(e,this.serverRTCPPort,this.serverAddress)};RTPProxy.prototype.onBound=function(){var e=this;if(this.disabled){return}this.incomingRTPSocket.on("message",(function(t){e.rtpMessage(t)}));this.incomingRTCPSocket.on("message",(function(t){e.rtcpMessage(t)}));this.outgoingSocket.on("message",(function(t){e.rtcpReply(t)}))};RTPProxy.prototype.rtpMessage=function(e){if(e.length<12){this.sendOut(e);return}var t=e.readUInt8(1);var r=t&127;if(r===this.incomingPayloadType){t=t&128|this.outgoingPayloadType;e.writeUInt8(t,1)}if(this.incomingSSRC===null){this.incomingSSRC=e.readUInt32BE(4)}e.writeUInt32BE(this.outgoingSSRC,8);this.sendOut(e)};RTPProxy.prototype.processRTCPMessage=function(e,t){var r=[];var i=0;while(i+4<=e.length){var n=e.readUInt8(i+1);var a=e.readUInt16BE(i+2)*4;if(i+4+a>e.length){break}var o=e.slice(i,i+4+a);o=t(n,o);if(o){r.push(o)}i+=4+a}if(r.length>0){return Buffer.concat(r)}return null};RTPProxy.prototype.rtcpMessage=function(e){var t=this;var r=this.processRTCPMessage(e,(function(e,r){if(e!==200||r.length<8){return r}if(t.incomingSSRC===null){t.incomingSSRC=r.readUInt32BE(4)}r.writeUInt32BE(t.outgoingSSRC,4);return r}));if(r){this.sendOut(r)}};RTPProxy.prototype.rtcpReply=function(e){var t=this;var r=this.processRTCPMessage(e,(function(e,r){if(e!==201||r.length<12){return r}r.writeUInt32BE(t.incomingSSRC,8);return r}));if(r){this.sendOut(r)}};RTPProxy.prototype.createSocket=function(e){var t=this;return new Promise((function(r){var retry=function(){var i=n.default.createSocket(e);var bindErrorHandler=function(){if(t.startingPort===65535){t.startingPort=1e4}else{++t.startingPort}i.close();retry()};i.once("error",bindErrorHandler);i.on("listening",(function(){r(i)}));i.bind(t.startingPort)};retry()}))};RTPProxy.prototype.createSocketPair=function(e){var t=this;return new Promise((function(r){var retry=function(){var i=n.default.createSocket(e);var a=n.default.createSocket(e);var o={socket1:0,socket2:0};var recheck=function(){if(o.socket1===0||o.socket2===0){return}if(o.socket1===2&&o.socket2===2){r([i,a]);return}if(t.startingPort===65534){t.startingPort=1e4}else{++t.startingPort}i.close();a.close();retry()};i.once("error",(function(){o.socket1=1;recheck()}));a.once("error",(function(){o.socket2=1;recheck()}));i.once("listening",(function(){o.socket1=2;recheck()}));a.once("listening",(function(){o.socket2=2;recheck()}));i.bind(t.startingPort);a.bind(t.startingPort+1)};retry()}))};return RTPProxy}();t["default"]=a},1015:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.StreamController=t.RTPStreamManagement=t.StreamRequestTypes=t.AudioStreamingSamplerate=t.AudioStreamingCodecType=t.SRTPCryptoSuites=t.AudioSamplerate=t.AudioBitrate=t.VideoCodecPacketizationMode=t.H264Level=t.H264Profile=t.VideoCodecType=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=i.__importDefault(r(6113));var o=i.__importDefault(r(7031));var s=i.__importDefault(r(1808));var c=r(8117);var u=r(5691);var l=r(877);var d=r(2716);var h=r(7417);var p=i.__importStar(r(2571));var v=i.__importStar(r(5752));var m=r(6815);var g=i.__importDefault(r(553));var y=(0,o.default)("HAP-NodeJS:Camera:RTPStreamManagement");var C;(function(e){e[e["STATUS"]=1]="STATUS"})(C||(C={}));var T;(function(e){e[e["AVAILABLE"]=0]="AVAILABLE";e[e["IN_USE"]=1]="IN_USE";e[e["UNAVAILABLE"]=2]="UNAVAILABLE"})(T||(T={}));var E;(function(e){e[e["VIDEO_CODEC_CONFIGURATION"]=1]="VIDEO_CODEC_CONFIGURATION"})(E||(E={}));var D;(function(e){e[e["CODEC_TYPE"]=1]="CODEC_TYPE";e[e["CODEC_PARAMETERS"]=2]="CODEC_PARAMETERS";e[e["ATTRIBUTES"]=3]="ATTRIBUTES"})(D||(D={}));var _;(function(e){e[e["PROFILE_ID"]=1]="PROFILE_ID";e[e["LEVEL"]=2]="LEVEL";e[e["PACKETIZATION_MODE"]=3]="PACKETIZATION_MODE";e[e["CVO_ENABLED"]=4]="CVO_ENABLED";e[e["CVO_ID"]=5]="CVO_ID"})(_||(_={}));var I;(function(e){e[e["IMAGE_WIDTH"]=1]="IMAGE_WIDTH";e[e["IMAGE_HEIGHT"]=2]="IMAGE_HEIGHT";e[e["FRAME_RATE"]=3]="FRAME_RATE"})(I||(I={}));var b;(function(e){e[e["H264"]=0]="H264"})(b=t.VideoCodecType||(t.VideoCodecType={}));var w;(function(e){e[e["BASELINE"]=0]="BASELINE";e[e["MAIN"]=1]="MAIN";e[e["HIGH"]=2]="HIGH"})(w=t.H264Profile||(t.H264Profile={}));var R;(function(e){e[e["LEVEL3_1"]=0]="LEVEL3_1";e[e["LEVEL3_2"]=1]="LEVEL3_2";e[e["LEVEL4_0"]=2]="LEVEL4_0"})(R=t.H264Level||(t.H264Level={}));var N;(function(e){e[e["NON_INTERLEAVED"]=0]="NON_INTERLEAVED"})(N=t.VideoCodecPacketizationMode||(t.VideoCodecPacketizationMode={}));var U;(function(e){e[e["UNSUPPORTED"]=0]="UNSUPPORTED";e[e["SUPPORTED"]=1]="SUPPORTED"})(U||(U={}));var P;(function(e){e[e["AUDIO_CODEC_CONFIGURATION"]=1]="AUDIO_CODEC_CONFIGURATION";e[e["COMFORT_NOISE_SUPPORT"]=2]="COMFORT_NOISE_SUPPORT"})(P||(P={}));var O;(function(e){e[e["CODEC_TYPE"]=1]="CODEC_TYPE";e[e["CODEC_PARAMETERS"]=2]="CODEC_PARAMETERS"})(O||(O={}));var L;(function(e){e[e["PCMU"]=0]="PCMU";e[e["PCMA"]=1]="PCMA";e[e["AAC_ELD"]=2]="AAC_ELD";e[e["OPUS"]=3]="OPUS";e[e["MSBC"]=4]="MSBC";e[e["AMR"]=5]="AMR";e[e["AMR_WB"]=6]="AMR_WB"})(L||(L={}));var B;(function(e){e[e["CHANNEL"]=1]="CHANNEL";e[e["BIT_RATE"]=2]="BIT_RATE";e[e["SAMPLE_RATE"]=3]="SAMPLE_RATE";e[e["PACKET_TIME"]=4]="PACKET_TIME"})(B||(B={}));var x;(function(e){e[e["VARIABLE"]=0]="VARIABLE";e[e["CONSTANT"]=1]="CONSTANT"})(x=t.AudioBitrate||(t.AudioBitrate={}));var k;(function(e){e[e["KHZ_8"]=0]="KHZ_8";e[e["KHZ_16"]=1]="KHZ_16";e[e["KHZ_24"]=2]="KHZ_24"})(k=t.AudioSamplerate||(t.AudioSamplerate={}));var V;(function(e){e[e["SRTP_CRYPTO_SUITE"]=2]="SRTP_CRYPTO_SUITE"})(V||(V={}));var H;(function(e){e[e["AES_CM_128_HMAC_SHA1_80"]=0]="AES_CM_128_HMAC_SHA1_80";e[e["AES_CM_256_HMAC_SHA1_80"]=1]="AES_CM_256_HMAC_SHA1_80";e[e["NONE"]=2]="NONE"})(H=t.SRTPCryptoSuites||(t.SRTPCryptoSuites={}));var j;(function(e){e[e["SESSION_ID"]=1]="SESSION_ID";e[e["CONTROLLER_ADDRESS"]=3]="CONTROLLER_ADDRESS";e[e["VIDEO_SRTP_PARAMETERS"]=4]="VIDEO_SRTP_PARAMETERS";e[e["AUDIO_SRTP_PARAMETERS"]=5]="AUDIO_SRTP_PARAMETERS"})(j||(j={}));var W;(function(e){e[e["ADDRESS_VERSION"]=1]="ADDRESS_VERSION";e[e["ADDRESS"]=2]="ADDRESS";e[e["VIDEO_RTP_PORT"]=3]="VIDEO_RTP_PORT";e[e["AUDIO_RTP_PORT"]=4]="AUDIO_RTP_PORT"})(W||(W={}));var G;(function(e){e[e["IPV4"]=0]="IPV4";e[e["IPV6"]=1]="IPV6"})(G||(G={}));var X;(function(e){e[e["SRTP_CRYPTO_SUITE"]=1]="SRTP_CRYPTO_SUITE";e[e["MASTER_KEY"]=2]="MASTER_KEY";e[e["MASTER_SALT"]=3]="MASTER_SALT"})(X||(X={}));var q;(function(e){e[e["SESSION_ID"]=1]="SESSION_ID";e[e["STATUS"]=2]="STATUS";e[e["ACCESSORY_ADDRESS"]=3]="ACCESSORY_ADDRESS";e[e["VIDEO_SRTP_PARAMETERS"]=4]="VIDEO_SRTP_PARAMETERS";e[e["AUDIO_SRTP_PARAMETERS"]=5]="AUDIO_SRTP_PARAMETERS";e[e["VIDEO_SSRC"]=6]="VIDEO_SSRC";e[e["AUDIO_SSRC"]=7]="AUDIO_SSRC"})(q||(q={}));var Y;(function(e){e[e["SUCCESS"]=0]="SUCCESS";e[e["BUSY"]=1]="BUSY";e[e["ERROR"]=2]="ERROR"})(Y||(Y={}));var K;(function(e){e[e["SESSION_CONTROL"]=1]="SESSION_CONTROL";e[e["SELECTED_VIDEO_PARAMETERS"]=2]="SELECTED_VIDEO_PARAMETERS";e[e["SELECTED_AUDIO_PARAMETERS"]=3]="SELECTED_AUDIO_PARAMETERS"})(K||(K={}));var $;(function(e){e[e["SESSION_IDENTIFIER"]=1]="SESSION_IDENTIFIER";e[e["COMMAND"]=2]="COMMAND"})($||($={}));var z;(function(e){e[e["END_SESSION"]=0]="END_SESSION";e[e["START_SESSION"]=1]="START_SESSION";e[e["SUSPEND_SESSION"]=2]="SUSPEND_SESSION";e[e["RESUME_SESSION"]=3]="RESUME_SESSION";e[e["RECONFIGURE_SESSION"]=4]="RECONFIGURE_SESSION"})(z||(z={}));var J;(function(e){e[e["CODEC_TYPE"]=1]="CODEC_TYPE";e[e["CODEC_PARAMETERS"]=2]="CODEC_PARAMETERS";e[e["ATTRIBUTES"]=3]="ATTRIBUTES";e[e["RTP_PARAMETERS"]=4]="RTP_PARAMETERS"})(J||(J={}));var ee;(function(e){e[e["PAYLOAD_TYPE"]=1]="PAYLOAD_TYPE";e[e["SYNCHRONIZATION_SOURCE"]=2]="SYNCHRONIZATION_SOURCE";e[e["MAX_BIT_RATE"]=3]="MAX_BIT_RATE";e[e["MIN_RTCP_INTERVAL"]=4]="MIN_RTCP_INTERVAL";e[e["MAX_MTU"]=5]="MAX_MTU"})(ee||(ee={}));var te;(function(e){e[e["CODEC_TYPE"]=1]="CODEC_TYPE";e[e["CODEC_PARAMETERS"]=2]="CODEC_PARAMETERS";e[e["RTP_PARAMETERS"]=3]="RTP_PARAMETERS";e[e["COMFORT_NOISE"]=4]="COMFORT_NOISE"})(te||(te={}));var re;(function(e){e[e["PAYLOAD_TYPE"]=1]="PAYLOAD_TYPE";e[e["SYNCHRONIZATION_SOURCE"]=2]="SYNCHRONIZATION_SOURCE";e[e["MAX_BIT_RATE"]=3]="MAX_BIT_RATE";e[e["MIN_RTCP_INTERVAL"]=4]="MIN_RTCP_INTERVAL";e[e["COMFORT_NOISE_PAYLOAD_TYPE"]=6]="COMFORT_NOISE_PAYLOAD_TYPE"})(re||(re={}));function isLegacySRTPOptions(e){return"srtp"in e}var ie;(function(e){e["PCMU"]="PCMU";e["PCMA"]="PCMA";e["AAC_ELD"]="AAC-eld";e["OPUS"]="OPUS";e["MSBC"]="mSBC";e["AMR"]="AMR";e["AMR_WB"]="AMR-WB"})(ie=t.AudioStreamingCodecType||(t.AudioStreamingCodecType={}));var ne;(function(e){e[e["KHZ_8"]=8]="KHZ_8";e[e["KHZ_16"]=16]="KHZ_16";e[e["KHZ_24"]=24]="KHZ_24"})(ne=t.AudioStreamingSamplerate||(t.AudioStreamingSamplerate={}));var ae;(function(e){e["RECONFIGURE"]="reconfigure";e["START"]="start";e["STOP"]="stop"})(ae=t.StreamRequestTypes||(t.StreamRequestTypes={}));var oe=function(){function RTPStreamManagement(e,t,r,i,n){this.videoOnly=false;this.sessionIdentifier=undefined;this.streamStatus=0;this.selectedConfiguration="";this.setupEndpointsResponse="";this.id=e;this.delegate=r;this.requireProxy=t.proxy||false;this.disableAudioProxy=t.disable_audio_proxy||false;if(isLegacySRTPOptions(t)){this.supportedCryptoSuites=[t.srtp?0:2]}else{this.supportedCryptoSuites=t.supportedCryptoSuites}if(this.supportedCryptoSuites.length===0){this.supportedCryptoSuites.push(2)}if(!t.video){throw new Error("Video parameters cannot be undefined in options")}this.supportedRTPConfiguration=RTPStreamManagement._supportedRTPConfiguration(this.supportedCryptoSuites);this.supportedVideoStreamConfiguration=RTPStreamManagement._supportedVideoStreamConfiguration(t.video);this.supportedAudioStreamConfiguration=this._supportedAudioStreamConfiguration(t.audio);this.activeConnectionClosedListener=this._handleStopStream.bind(this);this.service=i||this.constructService(e);this.setupServiceHandlers();this.resetSetupEndpointsResponse();this.resetSelectedStreamConfiguration();this.disabledThroughOperatingMode=n}RTPStreamManagement.prototype.forceStop=function(){this.handleSessionClosed()};RTPStreamManagement.prototype.getService=function(){return this.service};RTPStreamManagement.prototype.handleCloseConnection=function(e){};RTPStreamManagement.prototype.handleFactoryReset=function(){this.resetSelectedStreamConfiguration();this.resetSetupEndpointsResponse();this.service.updateCharacteristic(c.Characteristic.Active,true)};RTPStreamManagement.prototype.destroy=function(){if(this.activeConnection){this._handleStopStream()}};RTPStreamManagement.prototype.constructService=function(e){var t=new l.Service.CameraRTPStreamManagement("",e.toString());t.setCharacteristic(c.Characteristic.Active,true);return t};RTPStreamManagement.prototype.setupServiceHandlers=function(){var e=this;if(!this.service.testCharacteristic(c.Characteristic.Active)){this.service.setCharacteristic(c.Characteristic.Active,true)}this.service.getCharacteristic(c.Characteristic.Active).on("change",(function(){var t;return(t=e.stateChangeDelegate)===null||t===void 0?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]});this.service.setCharacteristic(c.Characteristic.SupportedRTPConfiguration,this.supportedRTPConfiguration);this.service.setCharacteristic(c.Characteristic.SupportedVideoStreamConfiguration,this.supportedVideoStreamConfiguration);this.service.setCharacteristic(c.Characteristic.SupportedAudioStreamConfiguration,this.supportedAudioStreamConfiguration);this._updateStreamStatus(0);this.service.setCharacteristic(c.Characteristic.SetupEndpoints,this.setupEndpointsResponse);this.service.getCharacteristic(c.Characteristic.SelectedRTPStreamConfiguration).on("get",(function(t){if(e.streamingIsDisabled()){t(null,p.encode(1,p.encode(2,z.SUSPEND_SESSION)).toString("base64"));return}t(null,e.selectedConfiguration)})).on("set",this._handleSelectedStreamConfigurationWrite.bind(this));this.service.getCharacteristic(c.Characteristic.SetupEndpoints).on("get",(function(t){if(e.streamingIsDisabled()){t(null,p.encode(2,2).toString("base64"));return}t(null,e.setupEndpointsResponse)})).on("set",(function(t,r,i,n){if(!n){y("Set event handler for SetupEndpoints cannot be called from plugin. Connection undefined!");r(-70410);return}e.handleSetupEndpoints(t,r,n)}))};RTPStreamManagement.prototype.handleSessionClosed=function(){this.resetSelectedStreamConfiguration();this.resetSetupEndpointsResponse();if(this.activeConnection){this.activeConnection.removeListener("closed",this.activeConnectionClosedListener);this.activeConnection=undefined}this._updateStreamStatus(0);this.sessionIdentifier=undefined;this.connectionID=undefined;this.ipVersion=undefined;if(this.videoProxy){this.videoProxy.destroy();this.videoProxy=undefined}if(this.audioProxy){this.audioProxy.destroy();this.audioProxy=undefined}};RTPStreamManagement.prototype.streamingIsDisabled=function(e){var t;if(!this.service.getCharacteristic(c.Characteristic.Active).value){e&&e(new d.HapStatusError(-70412));return true}if((t=this.disabledThroughOperatingMode)===null||t===void 0?void 0:t.call(this)){e&&e(new d.HapStatusError(-70412));return true}return false};RTPStreamManagement.prototype._handleSelectedStreamConfigurationWrite=function(e,t){var r=this;if(this.streamingIsDisabled(t)){return}var i=Buffer.from(e,"base64");var n=p.decode(i);var a=p.decode(n[1]);var o=v.unparse(a[1]);var s=a[2][0];if(o!==this.sessionIdentifier){y("Received unknown session Identifier with request to ".concat(z[s]));t(-70410);return}this.selectedConfiguration=e;var streamCallback=function(e,i){t(e,i);if(e){r.handleSessionClosed()}};switch(s){case z.START_SESSION:{var c=p.decode(n[2]);var u=p.decode(n[3]);this._handleStartStream(c,u,streamCallback);break}case z.RECONFIGURE_SESSION:{var l=p.decode(n[2]);this.handleReconfigureStream(l,streamCallback);break}case z.END_SESSION:this._handleStopStream(streamCallback);break;case z.RESUME_SESSION:case z.SUSPEND_SESSION:default:y("Unhandled request type ".concat(z[s]));t(-70410);return}};RTPStreamManagement.prototype._handleStartStream=function(e,t,r){var i=e[1];var n=e[2];var a=e[3];var o=e[4];var s=p.decode(n);var c=s[1][0];var u=s[2][0];var l=s[3][0];var d=s[4];var h=undefined;if(d&&d[0]===1){h=s[5].readUInt8(0)}var v=p.decode(a);var m=v[1].readUInt16LE(0);var g=v[2].readUInt16LE(0);var y=v[3].readUInt8(0);var C=p.decode(o);var T=C[1].readUInt8(0);var E=C[2].readUInt32LE(0);var D=C[3].readUInt16LE(0);var _=C[4].readFloatLE(0);var I=this.ipVersion==="ipv6"?1228:1378;if(C[5]){I=C[5].readUInt16LE(0)}var b=t[1][0];var w=t[2];var R=t[3];var N=!!t[4].readUInt8(0);var U=p.decode(w);var P=U[1][0];var O=U[2][0];var L=U[3][0];var B=U[4].readUInt8(0);var x=p.decode(R);var k=x[1].readUInt8(0);var V=x[2].readUInt32LE(0);var H=x[3].readUInt16LE(0);var j=x[4].readFloatLE(0);var W=x[6].readUInt8(0);if(this.requireProxy){this.videoProxy.setOutgoingPayloadType(T);if(!this.disableAudioProxy){this.audioProxy.setOutgoingPayloadType(k)}}var G={codec:i.readUInt8(0),profile:c,level:u,packetizationMode:l,cvoId:h,width:m,height:g,fps:y,pt:T,ssrc:E,max_bit_rate:D,rtcp_interval:_,mtu:I};var X;var q;switch(b){case 0:X="PCMU";break;case 1:X="PCMA";break;case 2:X="AAC-eld";break;case 3:X="OPUS";break;case 4:X="mSBC";break;case 5:X="AMR";break;case 6:X="AMR-WB";break;default:throw new Error("Encountered unknown selected audio codec ".concat(b))}switch(L){case 0:q=8;break;case 1:q=16;break;case 2:q=24;break;default:throw new Error("Encountered unknown selected audio samplerate ".concat(L))}var Y={codec:X,channel:P,bit_rate:O,sample_rate:q,packet_time:B,pt:k,ssrc:V,max_bit_rate:H,rtcp_interval:j,comfort_pt:W,comfortNoiseEnabled:N};var K={sessionID:this.sessionIdentifier,type:"start",video:G,audio:Y};this.delegate.handleStreamRequest(K,(function(e){return r(e)}))};RTPStreamManagement.prototype.handleReconfigureStream=function(e,t){var r=e[3];var i=e[4];var n=p.decode(r);var a=n[1].readUInt16LE(0);var o=n[2].readUInt16LE(0);var s=n[3].readUInt8(0);var c=p.decode(i);var u=c[3].readUInt16LE(0);var l=c[4].readFloatLE(0)||.5;var d={width:a,height:o,fps:s,max_bit_rate:u,rtcp_interval:l};var h={sessionID:this.sessionIdentifier,type:"reconfigure",video:d};this.delegate.handleStreamRequest(h,(function(e){return t(e)}))};RTPStreamManagement.prototype._handleStopStream=function(e){var t={sessionID:this.sessionIdentifier,type:"stop"};this.handleSessionClosed();this.delegate.handleStreamRequest(t,(function(t){return e?e(t):undefined}))};RTPStreamManagement.prototype.handleSetupEndpoints=function(e,t,r){var i=this;if(this.streamingIsDisabled(t)){return}var o=Buffer.from(e,"base64");var s=p.decode(o);var c=v.unparse(s[1]);if(this.streamStatus!==0){this.setupEndpointsResponse=p.encode(1,v.write(c),2,1).toString("base64");t();return}(0,n.default)(this.activeConnection==null,"Found non-nil `activeConnection` when trying to setup streaming endpoints, even though streamStatus is reported to be AVAILABLE!");this.activeConnection=r;this.activeConnection.on("closed",this.activeConnectionClosedListener);this.connectionID=r.sessionID;this.sessionIdentifier=c;this._updateStreamStatus(1);var u=s[3];var l=p.decode(u);var d=l[1][0];var m=l[2].toString("utf8");var C=l[3].readUInt16LE(0);var T=l[4].readUInt16LE(0);var E=s[4];var D=p.decode(E);var _=D[1][0];var I=D[2];var b=D[3];var w=s[5];var R=p.decode(w);var N=R[1][0];var U=R[2];var P=R[3];y("Session: ",c,"\nControllerAddress: ",m,"\nVideoPort: ",C,"\nAudioPort: ",T,"\nVideo Crypto: ",_,"\nVideo Master Key: ",I,"\nVideo Master Salt: ",b,"\nAudio Crypto: ",N,"\nAudio Master Key: ",U,"\nAudio Master Salt: ",P);var O={sessionID:c,targetAddress:m,addressVersion:d===1?"ipv6":"ipv4",video:{port:C,srtpCryptoSuite:_,srtp_key:I,srtp_salt:b},audio:{port:T,srtpCryptoSuite:N,srtp_key:U,srtp_salt:P}};var L=[];if(this.requireProxy){O.targetAddress=r.getLocalAddress(d===1?"ipv6":"ipv4");this.videoProxy=new g.default({outgoingAddress:m,outgoingPort:C,outgoingSSRC:a.default.randomBytes(4).readUInt32LE(0),disabled:false});L.push(this.videoProxy.setup().then((function(){O.video.proxy_rtp=i.videoProxy.incomingRTPPort();O.video.proxy_rtcp=i.videoProxy.incomingRTCPPort()})));if(!this.disableAudioProxy){this.audioProxy=new g.default({outgoingAddress:m,outgoingPort:T,outgoingSSRC:a.default.randomBytes(4).readUInt32LE(0),disabled:this.videoOnly});L.push(this.audioProxy.setup().then((function(){O.audio.proxy_rtp=i.audioProxy.incomingRTPPort();O.audio.proxy_rtcp=i.audioProxy.incomingRTCPPort()})))}}Promise.all(L).then((function(){i.delegate.prepareStream(O,(0,h.once)((function(e,n){if(e||!n){y("PrepareStream request encountered an error: ".concat(e?e.message:undefined));i.setupEndpointsResponse=p.encode(1,v.write(c),2,2).toString("base64");i.handleSessionClosed();t(e)}else{i.generateSetupEndpointResponse(r,c,O,n,t)}})))}))};RTPStreamManagement.prototype.generateSetupEndpointResponse=function(e,t,r,i,n){var a;var o=r.addressVersion;var c;var l;var d;var h;var m;var g;var y;var C;var T;var E;if(!this.videoOnly&&!i.audio){throw new Error("Audio was enabled but not supplied in PrepareStreamResponse!")}var D=i.audio||{port:r.audio.port,ssrc:u.CameraController.generateSynchronisationSource(),srtp_key:r.audio.srtp_key,srtp_salt:r.audio.srtp_salt};if(!this.requireProxy){var _=i.video;var I=D;if(i.addressOverride){o=s.default.isIPv4(i.addressOverride)?"ipv4":"ipv6";a=i.addressOverride}else{a=e.getLocalAddress(o)}if(r.addressVersion!==o){throw new Error("Incoming and outgoing ip address versions must match! Expected ".concat(r.addressVersion," but got ").concat(o))}c=_.port;l=I.port;if(r.video.srtpCryptoSuite!==2&&(_.srtp_key===undefined||_.srtp_salt===undefined)){throw new Error("SRTP was selected for the prepared video stream, but no 'srtp_key' or 'srtp_salt' was specified!")}if(r.audio.srtpCryptoSuite!==2&&(I.srtp_key===undefined||I.srtp_salt===undefined)){throw new Error("SRTP was selected for the prepared audio stream, but no 'srtp_key' or 'srtp_salt' was specified!")}d=r.video.srtpCryptoSuite;h=_.srtp_key||Buffer.alloc(0);m=_.srtp_salt||Buffer.alloc(0);g=r.audio.srtpCryptoSuite;y=I.srtp_key||Buffer.alloc(0);C=I.srtp_salt||Buffer.alloc(0);T=_.ssrc;E=I.ssrc}else{var _=i.video;a=e.getLocalAddress(r.addressVersion);d=2;h=Buffer.alloc(0);m=Buffer.alloc(0);g=2;y=Buffer.alloc(0);C=Buffer.alloc(0);this.videoProxy.setIncomingPayloadType(_.proxy_pt);this.videoProxy.setServerAddress(_.proxy_server_address);this.videoProxy.setServerRTPPort(_.proxy_server_rtp);this.videoProxy.setServerRTCPPort(_.proxy_server_rtcp);c=this.videoProxy.outgoingLocalPort();T=this.videoProxy.outgoingSSRC;if(!this.disableAudioProxy){var I=i.audio;this.audioProxy.setIncomingPayloadType(I.proxy_pt);this.audioProxy.setServerAddress(I.proxy_server_address);this.audioProxy.setServerRTPPort(I.proxy_server_rtp);this.audioProxy.setServerRTCPPort(I.proxy_server_rtcp);l=this.audioProxy.outgoingLocalPort();E=this.audioProxy.outgoingSSRC}else{var I=i.audio;l=I.port;E=I.ssrc}}this.ipVersion=o;var b=p.encode(1,o==="ipv4"?0:1,2,a,3,p.writeUInt16(c),4,p.writeUInt16(l));var w=p.encode(1,d,2,h,3,m);var R=p.encode(1,g,2,y,3,C);this.setupEndpointsResponse=p.encode(1,v.write(t),2,0,3,b,4,w,5,R,6,p.writeUInt32(T),7,p.writeUInt32(E)).toString("base64");n()};RTPStreamManagement.prototype._updateStreamStatus=function(e){this.streamStatus=e;this.service.updateCharacteristic(c.Characteristic.StreamingStatus,p.encode(1,this.streamStatus).toString("base64"))};RTPStreamManagement._supportedRTPConfiguration=function(e){if(e.length===1&&e[0]===2){y("Client claims it doesn't support SRTP. The stream may stops working with future iOS releases.")}return p.encode(2,e).toString("base64")};RTPStreamManagement._supportedVideoStreamConfiguration=function(e){if(!e.codec){throw new Error("Video codec cannot be undefined")}if(!e.resolutions){throw new Error("Video resolutions cannot be undefined")}var t=p.encode(1,e.codec.profiles,2,e.codec.levels,3,0);if(e.cvoId!=null){t=Buffer.concat([t,p.encode(4,1,5,e.cvoId)])}var r=p.encode(1,0,2,t,3,e.resolutions.map((function(e){if(e.length!==3){throw new Error("Unexpected video resolution")}var t=Buffer.alloc(2);var r=Buffer.alloc(2);var i=Buffer.alloc(1);t.writeUInt16LE(e[0],0);r.writeUInt16LE(e[1],0);i.writeUInt8(e[2],0);return p.encode(1,t,2,r,3,i)})));return p.encode(1,r).toString("base64")};RTPStreamManagement.prototype.checkForLegacyAudioCodecRepresentation=function(e){var t={};e.slice().forEach((function(r){var i=t[r.type];if(i){if(typeof i.samplerate==="number"){i.samplerate=[i.samplerate]}i.samplerate=i.samplerate.concat(r.samplerate);var n=e.indexOf(r);if(n>=0){e.splice(n,1)}}else{t[r.type]=r}}))};RTPStreamManagement.prototype._supportedAudioStreamConfiguration=function(e){var t=e&&!!e.comfort_noise;var r=e&&e.codecs||[];this.checkForLegacyAudioCodecRepresentation(r);if(r.length===0){y("Client doesn't support any audio codec that HomeKit supports.");this.videoOnly=true;r.push({type:"OPUS",samplerate:[16,24]})}var i=r.map((function(e){var t;switch(e.type){case"OPUS":t=3;break;case"AAC-eld":t=2;break;case"PCMA":t=1;break;case"PCMU":t=0;break;case"mSBC":t=4;break;case"AMR":t=5;break;case"AMR-WB":t=6;break;default:throw new Error("Unsupported codec: "+e.type)}var r=(typeof e.samplerate==="number"?[e.samplerate]:e.samplerate).map((function(t){var r;switch(t){case 8:r=0;break;case 16:r=1;break;case 24:r=2;break;default:console.log("Unsupported sample rate: ",e.samplerate);r=-1}return r})).filter((function(e){return e!==-1}));if(r.length===0){throw new Error("Audio samplerate cannot be empty!")}var i=p.encode(1,Math.max(1,e.audioChannels||1),2,e.bitrate||0,3,r);return p.encode(1,t,2,i)}));return p.encode(1,i,2,t?1:0).toString("base64")};RTPStreamManagement.prototype.resetSetupEndpointsResponse=function(){this.setupEndpointsResponse=p.encode(2,2).toString("base64");this.service.updateCharacteristic(c.Characteristic.SetupEndpoints,this.setupEndpointsResponse)};RTPStreamManagement.prototype.resetSelectedStreamConfiguration=function(){this.selectedConfiguration=p.encode(1,p.encode(2,z.SUSPEND_SESSION)).toString("base64");this.service.updateCharacteristic(c.Characteristic.SelectedRTPStreamConfiguration,this.selectedConfiguration)};RTPStreamManagement.prototype.serialize=function(){var e=this.service.getCharacteristic(c.Characteristic.Active).value;if(e===true){return undefined}return{id:this.id,active:!!e}};RTPStreamManagement.prototype.deserialize=function(e){(0,n.default)(e.id===this.id,"Tried to initialize RTPStreamManagement ".concat(this.id," with data from management with id ").concat(e.id,"!"));this.service.updateCharacteristic(c.Characteristic.Active,e.active)};RTPStreamManagement.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e};RTPStreamManagement.SRTPCryptoSuites=H;RTPStreamManagement.VideoCodecParamProfileIDTypes=w;RTPStreamManagement.VideoCodecParamLevelTypes=Object.freeze({TYPE3_1:0,TYPE3_2:1,TYPE4_0:2});return RTPStreamManagement}();t.RTPStreamManagement=oe;var se=function(e){i.__extends(StreamController,e);function StreamController(t,r,i,n){var a=e.call(this,t,r,new m.LegacyCameraSourceAdapter(i),n)||this;a.options=r;return a}return StreamController}(oe);t.StreamController=se},8319:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RecordingManagement=t.PacketDataType=t.AudioRecordingSamplerate=t.AudioRecordingCodecType=t.MediaContainerType=t.EventTriggerOption=void 0;var i=r(6867);var n=i.__importDefault(r(6113));var a=i.__importDefault(r(7031));var o=r(2361);var s=r(8117);var c=r(4658);var u=r(877);var l=r(2716);var d=i.__importStar(r(2571));var h=(0,a.default)("HAP-NodeJS:Camera:RecordingManagement");var p;(function(e){e[e["MOTION"]=1]="MOTION";e[e["DOORBELL"]=2]="DOORBELL"})(p=t.EventTriggerOption||(t.EventTriggerOption={}));var v;(function(e){e[e["FRAGMENTED_MP4"]=0]="FRAGMENTED_MP4"})(v=t.MediaContainerType||(t.MediaContainerType={}));var m;(function(e){e[e["CODEC_TYPE"]=1]="CODEC_TYPE";e[e["CODEC_PARAMETERS"]=2]="CODEC_PARAMETERS";e[e["ATTRIBUTES"]=3]="ATTRIBUTES"})(m||(m={}));var g;(function(e){e[e["PROFILE_ID"]=1]="PROFILE_ID";e[e["LEVEL"]=2]="LEVEL";e[e["BITRATE"]=3]="BITRATE";e[e["IFRAME_INTERVAL"]=4]="IFRAME_INTERVAL"})(g||(g={}));var y;(function(e){e[e["IMAGE_WIDTH"]=1]="IMAGE_WIDTH";e[e["IMAGE_HEIGHT"]=2]="IMAGE_HEIGHT";e[e["FRAME_RATE"]=3]="FRAME_RATE"})(y||(y={}));var C;(function(e){e[e["SELECTED_RECORDING_CONFIGURATION"]=1]="SELECTED_RECORDING_CONFIGURATION";e[e["SELECTED_VIDEO_CONFIGURATION"]=2]="SELECTED_VIDEO_CONFIGURATION";e[e["SELECTED_AUDIO_CONFIGURATION"]=3]="SELECTED_AUDIO_CONFIGURATION"})(C||(C={}));var T;(function(e){e[e["AAC_LC"]=0]="AAC_LC";e[e["AAC_ELD"]=1]="AAC_ELD"})(T=t.AudioRecordingCodecType||(t.AudioRecordingCodecType={}));var E;(function(e){e[e["KHZ_8"]=0]="KHZ_8";e[e["KHZ_16"]=1]="KHZ_16";e[e["KHZ_24"]=2]="KHZ_24";e[e["KHZ_32"]=3]="KHZ_32";e[e["KHZ_44_1"]=4]="KHZ_44_1";e[e["KHZ_48"]=5]="KHZ_48"})(E=t.AudioRecordingSamplerate||(t.AudioRecordingSamplerate={}));var D;(function(e){e[e["VIDEO_CODEC_CONFIGURATION"]=1]="VIDEO_CODEC_CONFIGURATION"})(D||(D={}));var _;(function(e){e[e["PREBUFFER_LENGTH"]=1]="PREBUFFER_LENGTH";e[e["EVENT_TRIGGER_OPTIONS"]=2]="EVENT_TRIGGER_OPTIONS";e[e["MEDIA_CONTAINER_CONFIGURATIONS"]=3]="MEDIA_CONTAINER_CONFIGURATIONS"})(_||(_={}));var I;(function(e){e[e["MEDIA_CONTAINER_TYPE"]=1]="MEDIA_CONTAINER_TYPE";e[e["MEDIA_CONTAINER_PARAMETERS"]=2]="MEDIA_CONTAINER_PARAMETERS"})(I||(I={}));var b;(function(e){e[e["FRAGMENT_LENGTH"]=1]="FRAGMENT_LENGTH"})(b||(b={}));var w;(function(e){e[e["CHANNEL"]=1]="CHANNEL";e[e["BIT_RATE"]=2]="BIT_RATE";e[e["SAMPLE_RATE"]=3]="SAMPLE_RATE";e[e["MAX_AUDIO_BITRATE"]=4]="MAX_AUDIO_BITRATE"})(w||(w={}));var R;(function(e){e[e["CODEC_TYPE"]=1]="CODEC_TYPE";e[e["CODEC_PARAMETERS"]=2]="CODEC_PARAMETERS"})(R||(R={}));var N;(function(e){e[e["AUDIO_CODEC_CONFIGURATION"]=1]="AUDIO_CODEC_CONFIGURATION"})(N||(N={}));var U;(function(e){e["MEDIA_INITIALIZATION"]="mediaInitialization";e["MEDIA_FRAGMENT"]="mediaFragment"})(U=t.PacketDataType||(t.PacketDataType={}));var P=function(){function RecordingManagement(e,t,r,n){var a,o;this.sensorServices=[];this.recordingActive=false;this.options=e;this.delegate=t;var s=n||this.constructService();this.recordingManagementService=s.recordingManagement;this.operatingModeService=s.operatingMode;this.dataStreamManagement=s.dataStreamManagement;this.eventTriggerOptions=0;try{for(var c=i.__values(r),u=c.next();!u.done;u=c.next()){var l=u.value;this.eventTriggerOptions|=l}}catch(e){a={error:e}}finally{try{if(u&&!u.done&&(o=c.return))o.call(c)}finally{if(a)throw a.error}}this.supportedCameraRecordingConfiguration=this._supportedCameraRecordingConfiguration(e);this.supportedVideoRecordingConfiguration=this._supportedVideoRecordingConfiguration(e.video);this.supportedAudioRecordingConfiguration=this._supportedAudioStreamConfiguration(e.audio);this.setupServiceHandlers()}RecordingManagement.prototype.constructService=function(){var e=new u.Service.CameraRecordingManagement("","");e.setCharacteristic(s.Characteristic.Active,false);e.setCharacteristic(s.Characteristic.RecordingAudioActive,false);var t=new u.Service.CameraOperatingMode("","");t.setCharacteristic(s.Characteristic.EventSnapshotsActive,true);t.setCharacteristic(s.Characteristic.HomeKitCameraActive,true);t.setCharacteristic(s.Characteristic.PeriodicSnapshotsActive,true);var r=new c.DataStreamManagement;e.addLinkedService(r.getService());return{recordingManagement:e,operatingMode:t,dataStreamManagement:r}};RecordingManagement.prototype.setupServiceHandlers=function(){var e=this;this.recordingManagementService.setCharacteristic(s.Characteristic.SupportedCameraRecordingConfiguration,this.supportedCameraRecordingConfiguration);this.recordingManagementService.setCharacteristic(s.Characteristic.SupportedVideoRecordingConfiguration,this.supportedVideoRecordingConfiguration);this.recordingManagementService.setCharacteristic(s.Characteristic.SupportedAudioRecordingConfiguration,this.supportedAudioRecordingConfiguration);this.recordingManagementService.getCharacteristic(s.Characteristic.SelectedCameraRecordingConfiguration).onGet(this.handleSelectedCameraRecordingConfigurationRead.bind(this)).onSet(this.handleSelectedCameraRecordingConfigurationWrite.bind(this)).setProps({adminOnlyAccess:[1]});this.recordingManagementService.getCharacteristic(s.Characteristic.Active).onSet((function(t){if(!!t===e.recordingActive){return}e.recordingActive=!!t;e.delegate.updateRecordingActive(e.recordingActive)})).on("change",(function(){var t;return(t=e.stateChangeDelegate)===null||t===void 0?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]});this.recordingManagementService.getCharacteristic(s.Characteristic.RecordingAudioActive).on("change",(function(){var t;return(t=e.stateChangeDelegate)===null||t===void 0?void 0:t.call(e)}));this.operatingModeService.getCharacteristic(s.Characteristic.HomeKitCameraActive).on("change",(function(t){var r,n;var a;try{for(var o=i.__values(e.sensorServices),c=o.next();!c.done;c=o.next()){var u=c.value;u.setCharacteristic(s.Characteristic.StatusActive,!!t.newValue)}}catch(e){r={error:e}}finally{try{if(c&&!c.done&&(n=o.return))n.call(o)}finally{if(r)throw r.error}}if(!t.newValue&&e.recordingStream){e.recordingStream.close(1)}(a=e.stateChangeDelegate)===null||a===void 0?void 0:a.call(e)})).setProps({adminOnlyAccess:[1]});this.operatingModeService.getCharacteristic(s.Characteristic.EventSnapshotsActive).on("change",(function(){var t;return(t=e.stateChangeDelegate)===null||t===void 0?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]});this.operatingModeService.getCharacteristic(s.Characteristic.PeriodicSnapshotsActive).on("change",(function(){var t;return(t=e.stateChangeDelegate)===null||t===void 0?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]});this.dataStreamManagement.onRequestMessage("dataSend","open",this.handleDataSendOpen.bind(this))};RecordingManagement.prototype.handleDataSendOpen=function(e,t,r){var i=this;var n=r.streamId;var a=r.type;var o=r.target;var u=r.reason;if(o!=="controller"||a!=="ipcamera.recording"){h("[HDS %s] Received data send with unexpected target: %s or type: %d. Rejecting...",e.remoteAddress,o,a);e.sendResponse("dataSend","open",t,c.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:5});return}if(!this.recordingActive){e.sendResponse("dataSend","open",t,c.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:1});return}if(!this.operatingModeService.getCharacteristic(s.Characteristic.HomeKitCameraActive).value){e.sendResponse("dataSend","open",t,c.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:1});return}if(this.recordingStream){h("[HDS %s] Rejecting DATA_SEND OPEN as another stream (%s) is already recording with streamId %d!",e.remoteAddress,this.recordingStream.connection.remoteAddress,this.recordingStream.streamId);e.sendResponse("dataSend","open",t,c.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:2});return}if(!this.selectedConfiguration){e.sendResponse("dataSend","open",t,c.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:9});return}h("[HDS %s] HDS DATA_SEND Open with reason '%s'.",e.remoteAddress,u);this.recordingStream=new L(e,this.delegate,t,n);this.recordingStream.on("closed",(function(){h("[HDS %s] Removing active recoding session from recording management!");i.recordingStream=undefined}));this.recordingStream.startStreaming()};RecordingManagement.prototype.handleSelectedCameraRecordingConfigurationRead=function(){if(!this.selectedConfiguration){throw new l.HapStatusError(-70402)}return this.selectedConfiguration.base64};RecordingManagement.prototype.handleSelectedCameraRecordingConfigurationWrite=function(e){var t,r;var i=this.parseSelectedConfiguration(e);var n=((t=this.selectedConfiguration)===null||t===void 0?void 0:t.base64)!==e;this.selectedConfiguration={parsed:i,base64:e};if(n){this.delegate.updateRecordingConfiguration(this.selectedConfiguration.parsed);(r=this.stateChangeDelegate)===null||r===void 0?void 0:r.call(this)}};RecordingManagement.prototype.parseSelectedConfiguration=function(e){var t=d.decode(Buffer.from(e,"base64"));var r=d.decode(t[1]);var i=d.decode(t[2]);var n=d.decode(t[3]);var a=r[1].readInt32LE(0);var o=r[2].readInt32LE(0);var s=d.decode(r[3]);var c=s[1][0];var u=d.decode(s[2]);var l=u[1].readInt32LE(0);var h=i[1][0];var p=d.decode(i[2]);var v=d.decode(i[3]);var m=p[1][0];var g=p[2][0];var y=p[3].readInt32LE(0);var C=p[4].readInt32LE(0);var T=v[1].readInt16LE(0);var E=v[2].readInt16LE(0);var D=v[3][0];var _=n[1][0];var I=d.decode(n[2]);var b=I[1][0];var w=I[3][0];var R=I[2][0];var N=I[4].readUInt32LE(0);var U=[];var P=0;while(o>0){if(o&1){U.push(1<<P)}o=o>>1;P+=1}return{prebufferLength:a,eventTriggerTypes:U,mediaContainerConfiguration:{type:c,fragmentLength:l},videoCodec:{type:h,parameters:{profile:m,level:g,bitRate:y,iFrameInterval:C},resolution:[T,E,D]},audioCodec:{audioChannels:b,type:_,samplerate:w,bitrateMode:R,bitrate:N}}};RecordingManagement.prototype._supportedCameraRecordingConfiguration=function(e){var t=Array.isArray(e.mediaContainerConfiguration)?e.mediaContainerConfiguration:[e.mediaContainerConfiguration];var r=Buffer.alloc(4);var i=Buffer.alloc(8);r.writeInt32LE(e.prebufferLength,0);i.writeInt32LE(this.eventTriggerOptions,0);return d.encode(1,r,2,i,3,t.map((function(e){var t=Buffer.alloc(4);t.writeInt32LE(e.fragmentLength,0);return d.encode(1,e.type,2,d.encode(1,t))}))).toString("base64")};RecordingManagement.prototype._supportedVideoRecordingConfiguration=function(e){if(!e.parameters){throw new Error("Video parameters cannot be undefined")}if(!e.resolutions){throw new Error("Video resolutions cannot be undefined")}var t=d.encode(1,e.parameters.profiles,2,e.parameters.levels);var r=d.encode(1,e.type,2,t,3,e.resolutions.map((function(e){if(e.length!==3){throw new Error("Unexpected video resolution")}var t=Buffer.alloc(2);var r=Buffer.alloc(2);var i=Buffer.alloc(1);t.writeUInt16LE(e[0],0);r.writeUInt16LE(e[1],0);i.writeUInt8(e[2],0);return d.encode(1,t,2,r,3,i)})));return d.encode(1,r).toString("base64")};RecordingManagement.prototype._supportedAudioStreamConfiguration=function(e){var t=Array.isArray(e.codecs)?e.codecs:[e.codecs];if(t.length===0){throw Error("CameraRecordingOptions.audio: At least one audio codec configuration must be specified!")}var r=t.map((function(e){var t=Array.isArray(e.samplerate)?e.samplerate:[e.samplerate];if(t.length===0){throw new Error("CameraRecordingOptions.audio.codecs: Audio samplerate cannot be empty!")}var r=d.encode(1,Math.max(1,e.audioChannels||1),2,e.bitrateMode||0,3,t);return d.encode(1,e.type,2,r)}));return d.encode(1,r).toString("base64")};RecordingManagement.prototype.computeConfigurationHash=function(e){if(e===void 0){e="sha256"}var t=n.default.createHash(e);t.update(this.supportedCameraRecordingConfiguration);t.update(this.supportedVideoRecordingConfiguration);t.update(this.supportedAudioRecordingConfiguration);return t.digest().toString("hex")};RecordingManagement.prototype.serialize=function(){var e;return{configurationHash:{algorithm:"sha256",hash:this.computeConfigurationHash("sha256")},selectedConfiguration:(e=this.selectedConfiguration)===null||e===void 0?void 0:e.base64,recordingActive:this.recordingActive,recordingAudioActive:!!this.recordingManagementService.getCharacteristic(s.Characteristic.RecordingAudioActive).value,eventSnapshotsActive:!!this.operatingModeService.getCharacteristic(s.Characteristic.EventSnapshotsActive).value,homeKitCameraActive:!!this.operatingModeService.getCharacteristic(s.Characteristic.HomeKitCameraActive).value,periodicSnapshotsActive:!!this.operatingModeService.getCharacteristic(s.Characteristic.PeriodicSnapshotsActive).value}};RecordingManagement.prototype.deserialize=function(e){var t,r;var n;var a=false;var o=this.computeConfigurationHash(e.configurationHash.algorithm);if(e.selectedConfiguration){if(o===e.configurationHash.hash){this.selectedConfiguration={base64:e.selectedConfiguration,parsed:this.parseSelectedConfiguration(e.selectedConfiguration)}}else{a=true}}this.recordingActive=e.recordingActive;this.recordingManagementService.updateCharacteristic(s.Characteristic.Active,e.recordingActive);this.recordingManagementService.updateCharacteristic(s.Characteristic.RecordingAudioActive,e.recordingAudioActive);this.operatingModeService.updateCharacteristic(s.Characteristic.EventSnapshotsActive,e.eventSnapshotsActive);this.operatingModeService.updateCharacteristic(s.Characteristic.PeriodicSnapshotsActive,e.periodicSnapshotsActive);this.operatingModeService.updateCharacteristic(s.Characteristic.HomeKitCameraActive,e.homeKitCameraActive);try{for(var c=i.__values(this.sensorServices),u=c.next();!u.done;u=c.next()){var l=u.value;l.setCharacteristic(s.Characteristic.StatusActive,e.homeKitCameraActive)}}catch(e){t={error:e}}finally{try{if(u&&!u.done&&(r=c.return))r.call(c)}finally{if(t)throw t.error}}try{if(this.selectedConfiguration){this.delegate.updateRecordingConfiguration(this.selectedConfiguration.parsed)}if(e.recordingActive){this.delegate.updateRecordingActive(e.recordingActive)}}catch(e){console.error("Failed to properly initialize CameraRecordingDelegate from persistent storage: "+e.stack)}if(a){(n=this.stateChangeDelegate)===null||n===void 0?void 0:n.call(this)}};RecordingManagement.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e};RecordingManagement.prototype.destroy=function(){this.dataStreamManagement.destroy()};RecordingManagement.prototype.handleFactoryReset=function(){var e,t;this.selectedConfiguration=undefined;this.recordingManagementService.updateCharacteristic(s.Characteristic.Active,false);this.recordingManagementService.updateCharacteristic(s.Characteristic.RecordingAudioActive,false);this.operatingModeService.updateCharacteristic(s.Characteristic.EventSnapshotsActive,true);this.operatingModeService.updateCharacteristic(s.Characteristic.PeriodicSnapshotsActive,true);this.operatingModeService.updateCharacteristic(s.Characteristic.HomeKitCameraActive,true);try{for(var r=i.__values(this.sensorServices),n=r.next();!n.done;n=r.next()){var a=n.value;a.setCharacteristic(s.Characteristic.StatusActive,true)}}catch(t){e={error:t}}finally{try{if(n&&!n.done&&(t=r.return))t.call(r)}finally{if(e)throw e.error}}try{this.delegate.updateRecordingActive(false);this.delegate.updateRecordingConfiguration(undefined)}catch(e){console.error("CameraRecordingDelegate failed to update state after handleFactoryReset: "+e.stack)}};return RecordingManagement}();t.RecordingManagement=P;var O;(function(e){e["CLOSED"]="closed"})(O||(O={}));var L=function(e){i.__extends(CameraRecordingStream,e);function CameraRecordingStream(t,r,i,n){var a;var o=e.call(this)||this;o.closed=false;o.eventHandler=(a={},a["close"]=o.handleDataSendClose.bind(o),a["ack"]=o.handleDataSendAck.bind(o),a);o.requestHandler=undefined;o.connection=t;o.delegate=r;o.hdsRequestId=i;o.streamId=n;o.connection.on("closed",o.closeListener=o.handleDataStreamConnectionClosed.bind(o));o.connection.addProtocolHandler("dataSend",o);return o}CameraRecordingStream.prototype.startStreaming=function(){this._startStreaming()};CameraRecordingStream.prototype._startStreaming=function(){var e,t,r,n;return i.__awaiter(this,void 0,void 0,(function(){var a,o,s,u,l,d,p,v,m,g,y,C,T,E,D,_;return i.__generator(this,(function(I){switch(I.label){case 0:h("[HDS %s] Sending DATA_SEND OPEN response for streamId %d",this.connection.remoteAddress,this.streamId);this.connection.sendResponse("dataSend","open",this.hdsRequestId,c.HDSStatus.SUCCESS,{status:c.HDSStatus.SUCCESS});a=262144;o=true;s=1;u=false;I.label=1;case 1:I.trys.push([1,14,15,16]);this.generator=this.delegate.handleRecordingStreamRequest(this.streamId);I.label=2;case 2:I.trys.push([2,7,8,13]);l=true,d=i.__asyncValues(this.generator);I.label=3;case 3:return[4,d.next()];case 4:if(!(p=I.sent(),e=p.done,!e))return[3,6];n=p.value;l=false;try{v=n;if(this.closed){console.error("[HDS ".concat(this.connection.remoteAddress,"] Delegate yielded fragment after stream ").concat(this.streamId," was already closed!"));return[3,6]}if(u){console.error("[HDS ".concat(this.connection.remoteAddress,"] Delegate yielded fragment for stream ").concat(this.streamId," after already signaling end of stream!"));return[3,6]}m=v.data;g=0;y=1;while(g<m.length){C=m.slice(g,g+a);g+=C.length;T={streamId:this.streamId,packets:[{data:C,metadata:{dataType:o?"mediaInitialization":"mediaFragment",dataSequenceNumber:s,dataChunkSequenceNumber:y,isLastDataChunk:g>=m.length,dataTotalSize:y===1?m.length:undefined}}],endOfStream:g>=m.length?Boolean(v.isLast).valueOf():undefined};h("[HDS %s] Sending DATA_SEND DATA for stream %d with metadata: %o and length %d; EoS: %s",this.connection.remoteAddress,this.streamId,T.packets[0].metadata,C.length,T.endOfStream);this.connection.sendEvent("dataSend","data",T);y++;o=false}u=v.isLast;if(v.isLast){return[3,6]}s++}finally{l=true}I.label=5;case 5:return[3,3];case 6:return[3,13];case 7:E=I.sent();t={error:E};return[3,13];case 8:I.trys.push([8,,11,12]);if(!(!l&&!e&&(r=d.return)))return[3,10];return[4,r.call(d)];case 9:I.sent();I.label=10;case 10:return[3,12];case 11:if(t)throw t.error;return[7];case 12:return[7];case 13:if(!u&&!this.closed){console.warn("[HDS ".concat(this.connection.remoteAddress,"] Delegate finished streaming for ").concat(this.streamId," without setting RecordingPacket.isLast.         Can't notify Controller about endOfStream!"))}return[3,16];case 14:D=I.sent();if(this.closed){console.warn("[HDS ".concat(this.connection.remoteAddress,"] Encountered unexpected error on already closed recording stream ").concat(this.streamId,": ").concat(D.stack))}else{_=5;if(D instanceof c.HDSProtocolError){_=D.reason;h("[HDS %s] Delegate signaled to close the recording stream %d.",this.connection.remoteAddress,this.streamId)}else if(D instanceof c.HDSConnectionError&&D.type===2){h("[HDS %s] Exited recording stream due to closed HDS socket: stream id %d.",this.connection.remoteAddress,this.streamId);return[2]}else{console.error("[HDS ".concat(this.connection.remoteAddress,"] Encountered unexpected error for recording stream ").concat(this.streamId,": ").concat(D.stack))}this.close(_)}return[2];case 15:this.generator=undefined;if(this.generatorTimeout){clearTimeout(this.generatorTimeout)}if(!this.closed){this.kickOffCloseTimeout()}return[7];case 16:if(o){console.warn("[HDS ".concat(this.connection.remoteAddress,"] Delegate finished recording stream ").concat(this.streamId," without sending anything out.       Controller will CANCEL."))}h("[HDS %s] Finished DATA_SEND transmission for stream %d!",this.connection.remoteAddress,this.streamId);return[2]}}))}))};CameraRecordingStream.prototype.handleDataSendAck=function(e){var t=this;var r=e.streamId;var i=e.endOfStream;h("[HDS %s] Received DATA_SEND ACK packet for streamId %s. Acknowledged %s.",this.connection.remoteAddress,r,i);this.handleClosed((function(){var e,r;return(r=(e=t.delegate).acknowledgeStream)===null||r===void 0?void 0:r.call(e,t.streamId)}))};CameraRecordingStream.prototype.handleDataSendClose=function(e){var t=this;var r=e.streamId;var i=e.reason;if(r!==this.streamId){return}h("[HDS %s] Received DATA_SEND CLOSE for streamId %d with reason %s",this.connection.remoteAddress,r,c.HDSProtocolSpecificErrorReason[i]);this.handleClosed((function(){return t.delegate.closeRecordingStream(r,i)}))};CameraRecordingStream.prototype.handleDataStreamConnectionClosed=function(){var e=this;h("[HDS %s] The HDS connection of the stream %d closed.",this.connection.remoteAddress,this.streamId);this.handleClosed((function(){return e.delegate.closeRecordingStream(e.streamId,undefined)}))};CameraRecordingStream.prototype.handleClosed=function(e){var t=this;this.closed=true;if(this.closingTimeout){clearTimeout(this.closingTimeout);this.closingTimeout=undefined}this.connection.removeProtocolHandler("dataSend",this);this.connection.removeListener("closed",this.closeListener);if(this.generator){this.generatorTimeout=setTimeout((function(){console.error("[HDS %s] Recording download stream %d is still awaiting generator although stream was closed 10s ago! "+"This is a programming mistake by the camera implementation which prevents freeing up resources.",t.connection.remoteAddress,t.streamId)}),1e4)}try{e()}catch(e){console.error("[HDS ".concat(this.connection.remoteAddress,"] CameraRecordingDelegated failed to handle closing the stream ").concat(this.streamId,": ").concat(e.stack))}this.emit("closed")};CameraRecordingStream.prototype.close=function(e){var t=this;if(this.closed){return}h("[HDS %s] Recording stream %d was closed manually with reason %s.",this.connection.remoteAddress,this.streamId,e?c.HDSProtocolSpecificErrorReason[e]:"CLOSED");if(!this.connection.isConsideredClosed()){this.connection.sendEvent("dataSend","close",{streamId:this.streamId,reason:e})}this.handleClosed((function(){return t.delegate.closeRecordingStream(t.streamId,e)}))};CameraRecordingStream.prototype.kickOffCloseTimeout=function(){var e=this;if(this.closingTimeout){clearTimeout(this.closingTimeout)}this.closingTimeout=setTimeout((function(){if(e.closed){return}h("[HDS %s] Recording stream %d took longer than expected to fully close. Force closing now!",e.connection.remoteAddress,e.streamId);e.close(3)}),12e3)};return CameraRecordingStream}(o.EventEmitter)},7270:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(6867);i.__exportStar(r(6815),t);i.__exportStar(r(553),t);i.__exportStar(r(1015),t);i.__exportStar(r(8319),t)},3141:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AdaptiveLightingController=t.AdaptiveLightingControllerEvents=t.AdaptiveLightingControllerMode=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=r(3223);var o=r(2716);var s=r(9727);var c=i.__importStar(r(5752));var u=i.__importDefault(r(7031));var l=r(2361);var d=r(8117);var h=i.__importStar(r(2571));var p=(0,u.default)("HAP-NodeJS:Controller:TransitionControl");var v;(function(e){e[e["SUPPORTED_TRANSITION_CONFIGURATION"]=1]="SUPPORTED_TRANSITION_CONFIGURATION"})(v||(v={}));var m;(function(e){e[e["CHARACTERISTIC_IID"]=1]="CHARACTERISTIC_IID";e[e["TRANSITION_TYPE"]=2]="TRANSITION_TYPE"})(m||(m={}));var g;(function(e){e[e["BRIGHTNESS"]=1]="BRIGHTNESS";e[e["COLOR_TEMPERATURE"]=2]="COLOR_TEMPERATURE"})(g||(g={}));var y;(function(e){e[e["READ_CURRENT_VALUE_TRANSITION_CONFIGURATION"]=1]="READ_CURRENT_VALUE_TRANSITION_CONFIGURATION";e[e["UPDATE_VALUE_TRANSITION_CONFIGURATION"]=2]="UPDATE_VALUE_TRANSITION_CONFIGURATION"})(y||(y={}));var C;(function(e){e[e["CHARACTERISTIC_IID"]=1]="CHARACTERISTIC_IID"})(C||(C={}));var T;(function(e){e[e["VALUE_TRANSITION_CONFIGURATION"]=1]="VALUE_TRANSITION_CONFIGURATION"})(T||(T={}));var E;(function(e){e[e["CHARACTERISTIC_IID"]=1]="CHARACTERISTIC_IID";e[e["TRANSITION_PARAMETERS"]=2]="TRANSITION_PARAMETERS";e[e["UNKNOWN_3"]=3]="UNKNOWN_3";e[e["UNKNOWN_4"]=4]="UNKNOWN_4";e[e["TRANSITION_CURVE_CONFIGURATION"]=5]="TRANSITION_CURVE_CONFIGURATION";e[e["UPDATE_INTERVAL"]=6]="UPDATE_INTERVAL";e[e["UNKNOWN_7"]=7]="UNKNOWN_7";e[e["NOTIFY_INTERVAL_THRESHOLD"]=8]="NOTIFY_INTERVAL_THRESHOLD"})(E||(E={}));var D;(function(e){e[e["TRANSITION_ID"]=1]="TRANSITION_ID";e[e["START_TIME"]=2]="START_TIME";e[e["UNKNOWN_3"]=3]="UNKNOWN_3"})(D||(D={}));var _;(function(e){e[e["TRANSITION_ENTRY"]=1]="TRANSITION_ENTRY";e[e["ADJUSTMENT_CHARACTERISTIC_IID"]=2]="ADJUSTMENT_CHARACTERISTIC_IID";e[e["ADJUSTMENT_MULTIPLIER_RANGE"]=3]="ADJUSTMENT_MULTIPLIER_RANGE"})(_||(_={}));var I;(function(e){e[e["ADJUSTMENT_FACTOR"]=1]="ADJUSTMENT_FACTOR";e[e["VALUE"]=2]="VALUE";e[e["TRANSITION_OFFSET"]=3]="TRANSITION_OFFSET";e[e["DURATION"]=4]="DURATION"})(I||(I={}));var b;(function(e){e[e["MINIMUM_ADJUSTMENT_MULTIPLIER"]=1]="MINIMUM_ADJUSTMENT_MULTIPLIER";e[e["MAXIMUM_ADJUSTMENT_MULTIPLIER"]=2]="MAXIMUM_ADJUSTMENT_MULTIPLIER"})(b||(b={}));var w;(function(e){e[e["VALUE_CONFIGURATION_STATUS"]=1]="VALUE_CONFIGURATION_STATUS"})(w||(w={}));var R;(function(e){e[e["CHARACTERISTIC_IID"]=1]="CHARACTERISTIC_IID";e[e["TRANSITION_PARAMETERS"]=2]="TRANSITION_PARAMETERS";e[e["TIME_SINCE_START"]=3]="TIME_SINCE_START"})(R||(R={}));function isAdaptiveLightingContext(e){return e&&"controller"in e}var N;(function(e){e[e["AUTOMATIC"]=1]="AUTOMATIC";e[e["MANUAL"]=2]="MANUAL"})(N=t.AdaptiveLightingControllerMode||(t.AdaptiveLightingControllerMode={}));var U;(function(e){e["UPDATE"]="update";e["DISABLED"]="disable"})(U=t.AdaptiveLightingControllerEvents||(t.AdaptiveLightingControllerEvents={}));var P=function(e){i.__extends(AdaptiveLightingController,e);function AdaptiveLightingController(t,r){var i=this;var a,o;i=e.call(this)||this;i.didRunFirstInitializationStep=false;i.lastEventNotificationSent=0;i.lastNotifiedTemperatureValue=0;i.lastNotifiedSaturationValue=0;i.lastNotifiedHueValue=0;i.lightbulb=t;i.mode=(a=r===null||r===void 0?void 0:r.controllerMode)!==null&&a!==void 0?a:1;i.customTemperatureAdjustment=(o=r===null||r===void 0?void 0:r.customTemperatureAdjustment)!==null&&o!==void 0?o:0;(0,n.default)(i.lightbulb.testCharacteristic(d.Characteristic.ColorTemperature),"Lightbulb must have the ColorTemperature characteristic added!");(0,n.default)(i.lightbulb.testCharacteristic(d.Characteristic.Brightness),"Lightbulb must have the Brightness characteristic added!");i.adjustmentFactorChangedListener=i.handleAdjustmentFactorChanged.bind(i);i.characteristicManualWrittenChangeListener=i.handleCharacteristicManualWritten.bind(i);return i}AdaptiveLightingController.prototype.controllerId=function(){return"characteristic-transition"+"-"+this.lightbulb.getServiceId()};AdaptiveLightingController.prototype.isAdaptiveLightingActive=function(){return!!this.activeTransition};AdaptiveLightingController.prototype.disableAdaptiveLighting=function(){var e;if(this.updateTimeout){clearTimeout(this.updateTimeout);this.updateTimeout=undefined}if(this.activeTransition){this.colorTemperatureCharacteristic.removeListener("change",this.characteristicManualWrittenChangeListener);this.brightnessCharacteristic.removeListener("change",this.adjustmentFactorChangedListener);if(this.hueCharacteristic){this.hueCharacteristic.removeListener("change",this.characteristicManualWrittenChangeListener)}if(this.saturationCharacteristic){this.saturationCharacteristic.removeListener("change",this.characteristicManualWrittenChangeListener)}this.activeTransition=undefined;(e=this.stateChangeDelegate)===null||e===void 0?void 0:e.call(this)}this.colorTemperatureCharacteristic=undefined;this.brightnessCharacteristic=undefined;this.hueCharacteristic=undefined;this.saturationCharacteristic=undefined;this.lastTransitionPointInfo=undefined;this.lastEventNotificationSent=0;this.lastNotifiedTemperatureValue=0;this.lastNotifiedSaturationValue=0;this.lastNotifiedHueValue=0;this.didRunFirstInitializationStep=false;this.activeTransitionCount.sendEventNotification(0);p("[%s] Disabling adaptive lighting",this.lightbulb.displayName)};AdaptiveLightingController.prototype.getAdaptiveLightingStartTimeOfTransition=function(){if(!this.activeTransition){throw new Error("There is no active transition!")}return this.activeTransition.transitionStartMillis};AdaptiveLightingController.prototype.getAdaptiveLightingTimeOffset=function(){if(!this.activeTransition){throw new Error("There is no active transition!")}return this.activeTransition.timeMillisOffset};AdaptiveLightingController.prototype.getAdaptiveLightingTransitionCurve=function(){if(!this.activeTransition){throw new Error("There is no active transition!")}return this.activeTransition.transitionCurve};AdaptiveLightingController.prototype.getAdaptiveLightingBrightnessMultiplierRange=function(){if(!this.activeTransition){throw new Error("There is no active transition!")}return this.activeTransition.brightnessAdjustmentRange};AdaptiveLightingController.prototype.getAdaptiveLightingUpdateInterval=function(){if(!this.activeTransition){throw new Error("There is no active transition!")}return this.activeTransition.updateInterval};AdaptiveLightingController.prototype.getAdaptiveLightingNotifyIntervalThreshold=function(){if(!this.activeTransition){throw new Error("There is no active transition!")}return this.activeTransition.notifyIntervalThreshold};AdaptiveLightingController.prototype.handleActiveTransitionUpdated=function(e){var t;if(e===void 0){e=false}if(!e){this.activeTransitionCount.sendEventNotification(1)}else{this.activeTransitionCount.value=1}if(this.mode===1){this.scheduleNextUpdate()}else if(this.mode===2){this.emit("update")}else{throw new Error("Unsupported adaptive lighting controller mode: "+this.mode)}if(!e){(t=this.stateChangeDelegate)===null||t===void 0?void 0:t.call(this)}};AdaptiveLightingController.prototype.handleAdaptiveLightingEnabled=function(){if(!this.activeTransition){throw new Error("There is no active transition!")}this.colorTemperatureCharacteristic=this.lightbulb.getCharacteristic(d.Characteristic.ColorTemperature);this.brightnessCharacteristic=this.lightbulb.getCharacteristic(d.Characteristic.Brightness);this.colorTemperatureCharacteristic.on("change",this.characteristicManualWrittenChangeListener);this.brightnessCharacteristic.on("change",this.adjustmentFactorChangedListener);if(this.lightbulb.testCharacteristic(d.Characteristic.Hue)){this.hueCharacteristic=this.lightbulb.getCharacteristic(d.Characteristic.Hue).on("change",this.characteristicManualWrittenChangeListener)}if(this.lightbulb.testCharacteristic(d.Characteristic.Saturation)){this.saturationCharacteristic=this.lightbulb.getCharacteristic(d.Characteristic.Saturation).on("change",this.characteristicManualWrittenChangeListener)}};AdaptiveLightingController.prototype.handleAdaptiveLightingDisabled=function(){if(this.mode===2&&this.activeTransition){this.emit("disable")}this.disableAdaptiveLighting()};AdaptiveLightingController.prototype.handleAdjustmentFactorChanged=function(e){var t=this;if(e.newValue===e.oldValue){return}if(e.reason==="read"){setTimeout((function(){if(!t.activeTransition){return}t.scheduleNextUpdate(true)}),1e3).unref()}else{this.scheduleNextUpdate(true)}};AdaptiveLightingController.prototype.handleCharacteristicManualWritten=function(e){if(e.reason==="write"&&!(isAdaptiveLightingContext(e.context)&&e.context.controller===this)){p("[%s] Received a manual write to an characteristic (newValue: %d, oldValue: %d, reason: %s). Thus disabling adaptive lighting!",this.lightbulb.displayName,e.newValue,e.oldValue,e.reason);this.disableAdaptiveLighting()}};AdaptiveLightingController.prototype.getCurrentAdaptiveLightingTransitionPoint=function(){var e,t,r,i,n;if(!this.activeTransition){throw new Error("Cannot calculate current transition point if no transition is active!")}var a=Date.now()-this.activeTransition.timeMillisOffset;var o=a-this.activeTransition.transitionStartMillis;var s=(t=(e=this.lastTransitionPointInfo)===null||e===void 0?void 0:e.curveIndex)!==null&&t!==void 0?t:0;var c=(i=(r=this.lastTransitionPointInfo)===null||r===void 0?void 0:r.lowerBoundTimeOffset)!==null&&i!==void 0?i:0;var u=undefined;var l=undefined;for(;s+1<this.activeTransition.transitionCurve.length;s++){var d=this.activeTransition.transitionCurve[s];var h=this.activeTransition.transitionCurve[s+1];var p=(n=d.duration)!==null&&n!==void 0?n:0;c+=d.transitionTime;if(o>=c){if(o<=c+p+h.transitionTime){u=d;l=h;break}}else if(this.lastTransitionPointInfo){this.lastTransitionPointInfo=undefined;return this.getCurrentAdaptiveLightingTransitionPoint()}c+=p}if(!u||!l){this.lastTransitionPointInfo=undefined;return undefined}this.lastTransitionPointInfo={curveIndex:s,lowerBoundTimeOffset:c-u.transitionTime};return{lowerBoundTimeOffset:c,transitionOffset:o-c,lowerBound:u,upperBound:l}};AdaptiveLightingController.prototype.scheduleNextUpdate=function(e){var t=this;var r,i,n,o,s;if(e===void 0){e=false}if(!this.activeTransition){throw new Error("tried scheduling transition when no transition was active!")}if(!e){this.updateTimeout=undefined}if(!this.didRunFirstInitializationStep){this.didRunFirstInitializationStep=true;this.handleAdaptiveLightingEnabled()}var c=this.getCurrentAdaptiveLightingTransitionPoint();if(!c){p("[%s] Reached end of transition curve!",this.lightbulb.displayName);if(!e){this.disableAdaptiveLighting()}return}var u=c.lowerBound;var l=c.upperBound;var d;var h;if(u.duration&&c.transitionOffset<=u.duration){d=u.temperature;h=u.brightnessAdjustmentFactor}else{var v=(c.transitionOffset-((r=u.duration)!==null&&r!==void 0?r:0))/l.transitionTime;d=u.temperature+(l.temperature-u.temperature)*v;h=u.brightnessAdjustmentFactor+(l.brightnessAdjustmentFactor-u.brightnessAdjustmentFactor)*v}var m=Math.max(this.activeTransition.brightnessAdjustmentRange.minBrightnessValue,Math.min(this.activeTransition.brightnessAdjustmentRange.maxBrightnessValue,this.brightnessCharacteristic.value));var g=Math.round(d+h*m);g+=this.customTemperatureAdjustment;var y=(n=(i=this.colorTemperatureCharacteristic)===null||i===void 0?void 0:i.props.minValue)!==null&&n!==void 0?n:140;var C=(s=(o=this.colorTemperatureCharacteristic)===null||o===void 0?void 0:o.props.maxValue)!==null&&s!==void 0?s:500;g=Math.max(y,Math.min(C,g));var T=a.ColorUtils.colorTemperatureToHueAndSaturation(g);p("[%s] Next temperature value is %d (for brightness %d adj: %s)",this.lightbulb.displayName,g,m,this.customTemperatureAdjustment);var E={controller:this,omitEventUpdate:true};if(this.saturationCharacteristic){this.saturationCharacteristic.value=T.saturation}if(this.hueCharacteristic){this.hueCharacteristic.value=T.hue}this.colorTemperatureCharacteristic.handleSetRequest(g,undefined,E).catch((function(e){p("[%s] Failed to next adaptive lighting transition point: %d",t.lightbulb.displayName,e)}));if(!this.activeTransition){console.warn("["+this.lightbulb.displayName+"] Adaptive Lighting was probably disable my mistake by some call in "+"the SET handler of the ColorTemperature characteristic! "+"Please check that you don't call setValue/setCharacteristic on the Hue, Saturation or ColorTemperature characteristic!");return}var D=Date.now();if(!e&&D-this.lastEventNotificationSent>=this.activeTransition.notifyIntervalThreshold){p("[%s] Sending event notifications for current transition!",this.lightbulb.displayName);this.lastEventNotificationSent=D;var _={controller:this};if(this.lastNotifiedTemperatureValue!==g){this.colorTemperatureCharacteristic.sendEventNotification(g,_);this.lastNotifiedTemperatureValue=g}if(this.saturationCharacteristic&&this.lastNotifiedSaturationValue!==T.saturation){this.saturationCharacteristic.sendEventNotification(T.saturation,_);this.lastNotifiedSaturationValue=T.saturation}if(this.hueCharacteristic&&this.lastNotifiedHueValue!==T.hue){this.hueCharacteristic.sendEventNotification(T.hue,_);this.lastNotifiedHueValue=T.hue}}if(!e){this.updateTimeout=setTimeout(this.scheduleNextUpdate.bind(this),this.activeTransition.updateInterval)}};AdaptiveLightingController.prototype.constructServices=function(){return{}};AdaptiveLightingController.prototype.initWithServices=function(e){};AdaptiveLightingController.prototype.configureServices=function(){var e=this;this.supportedTransitionConfiguration=this.lightbulb.getCharacteristic(d.Characteristic.SupportedCharacteristicValueTransitionConfiguration);this.transitionControl=this.lightbulb.getCharacteristic(d.Characteristic.CharacteristicValueTransitionControl).updateValue("");this.activeTransitionCount=this.lightbulb.getCharacteristic(d.Characteristic.CharacteristicValueActiveTransitionCount).updateValue(0);this.supportedTransitionConfiguration.onGet(this.handleSupportedTransitionConfigurationRead.bind(this));this.transitionControl.onGet((function(){return e.buildTransitionControlResponseBuffer().toString("base64")})).onSet((function(t){try{return e.handleTransitionControlWrite(t)}catch(r){console.warn("[%s] DEBUG: '".concat(t,"'"));console.warn("[%s] Encountered error on CharacteristicValueTransitionControl characteristic: "+r.stack);e.disableAdaptiveLighting();throw new o.HapStatusError(-70402)}}))};AdaptiveLightingController.prototype.handleControllerRemoved=function(){this.lightbulb.removeCharacteristic(this.supportedTransitionConfiguration);this.lightbulb.removeCharacteristic(this.transitionControl);this.lightbulb.removeCharacteristic(this.activeTransitionCount);this.supportedTransitionConfiguration=undefined;this.transitionControl=undefined;this.activeTransitionCount=undefined;this.removeAllListeners()};AdaptiveLightingController.prototype.handleFactoryReset=function(){this.handleAdaptiveLightingDisabled()};AdaptiveLightingController.prototype.serialize=function(){if(!this.activeTransition){return undefined}return{activeTransition:this.activeTransition}};AdaptiveLightingController.prototype.deserialize=function(e){this.activeTransition=e.activeTransition;if(!this.activeTransition.transitionId){this.activeTransition.transitionId=this.activeTransition.id1;delete this.activeTransition.id1}if(!this.activeTransition.timeMillisOffset){this.activeTransition.timeMillisOffset=0}this.handleActiveTransitionUpdated(true)};AdaptiveLightingController.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e};AdaptiveLightingController.prototype.handleSupportedTransitionConfigurationRead=function(){var e=this.lightbulb.getCharacteristic(d.Characteristic.Brightness).iid;var t=this.lightbulb.getCharacteristic(d.Characteristic.ColorTemperature).iid;(0,n.default)(e,"iid for brightness characteristic is undefined");(0,n.default)(t,"iid for temperature characteristic is undefined");return h.encode(1,[h.encode(1,h.writeVariableUIntLE(e),2,1),h.encode(1,h.writeVariableUIntLE(t),2,2)]).toString("base64")};AdaptiveLightingController.prototype.buildTransitionControlResponseBuffer=function(e){if(!this.activeTransition){return Buffer.alloc(0)}var t=this.activeTransition;var r=e!==null&&e!==void 0?e:Date.now()-t.timeMillisOffset-t.transitionStartMillis;var i=h.writeVariableUIntLE(r);var n=h.encode(1,c.write(t.transitionId),2,Buffer.from(t.transitionStartBuffer,"hex"));if(t.id3){n=Buffer.concat([n,h.encode(3,Buffer.from(t.id3,"hex"))])}var a=h.encode(1,h.writeVariableUIntLE(t.iid),2,n,3,i);return h.encode(1,a)};AdaptiveLightingController.prototype.handleTransitionControlWrite=function(e){if(typeof e!=="string"){throw new o.HapStatusError(-70410)}var t=h.decode(Buffer.from(e,"base64"));var r=[];var i=t[1];if(i){var n=this.handleTransitionControlReadTransition(i);if(n){r.push(n)}}var a=t[2];if(a){var s=this.handleTransitionControlUpdateTransition(a);if(s){r.push(s)}}return Buffer.concat(r).toString("base64")};AdaptiveLightingController.prototype.handleTransitionControlReadTransition=function(e){var t=h.decode(e);var r=h.readVariableUIntLE(t[1]);if(this.activeTransition){if(this.activeTransition.iid!==r){console.warn("["+this.lightbulb.displayName+"] iid of current adaptive lighting transition ("+this.activeTransition.iid+") doesn't match the requested one "+r);throw new o.HapStatusError(-70410)}var i=h.encode(1,c.write(this.activeTransition.transitionId),2,Buffer.from(this.activeTransition.transitionStartBuffer,"hex"));if(this.activeTransition.id3){i=Buffer.concat([i,h.encode(3,Buffer.from(this.activeTransition.id3,"hex"))])}return h.encode(1,h.encode(1,h.writeVariableUIntLE(this.activeTransition.iid),2,i,3,1,5,h.encode(1,this.activeTransition.transitionCurve.map((function(e,t,r){var i,n;var a=(n=(i=r[t-1])===null||i===void 0?void 0:i.duration)!==null&&n!==void 0?n:0;return h.encode(1,h.writeFloat32LE(e.brightnessAdjustmentFactor),2,h.writeFloat32LE(e.temperature),3,h.writeVariableUIntLE(e.transitionTime),4,h.writeVariableUIntLE(a))})),2,h.writeVariableUIntLE(this.activeTransition.brightnessCharacteristicIID),3,h.encode(1,h.writeUInt32(this.activeTransition.brightnessAdjustmentRange.minBrightnessValue),2,h.writeUInt32(this.activeTransition.brightnessAdjustmentRange.maxBrightnessValue))),6,h.writeVariableUIntLE(this.activeTransition.updateInterval),8,h.writeVariableUIntLE(this.activeTransition.notifyIntervalThreshold)))}else{return undefined}};AdaptiveLightingController.prototype.handleTransitionControlUpdateTransition=function(e){var t,r;var n,a;var u=h.decode(e);var l=h.decode(u[1]);var d=h.readVariableUIntLE(l[1]);if(!this.lightbulb.getCharacteristicByIID(d)){throw new o.HapStatusError(-70410)}var v=(n=l[3])===null||n===void 0?void 0:n.readUInt8(0);if(!v){this.handleAdaptiveLightingDisabled();return h.encode(2,Buffer.alloc(0))}var m=h.decode(l[2]);var g=h.decodeWithLists(l[5]);var y=(a=l[6])===null||a===void 0?void 0:a.readUInt16LE(0);var C=l[8].readUInt32LE(0);var T=m[1];var E=m[2];var D=m[3];var _=(0,s.epochMillisFromMillisSince2001_01_01Buffer)(E);var I=Date.now()-_;var b=[];var w=undefined;var R=g[1];try{for(var N=i.__values(R),U=N.next();!U.done;U=N.next()){var P=U.value;var O=h.decode(P);var L=O[1].readFloatLE(0);var B=O[2].readFloatLE(0);var x=h.readVariableUIntLE(O[3]);var k=O[4]?h.readVariableUIntLE(O[4]):undefined;if(w){w.duration=k}w={temperature:B,brightnessAdjustmentFactor:L,transitionTime:x};b.push(w)}}catch(e){t={error:e}}finally{try{if(U&&!U.done&&(r=N.return))r.call(N)}finally{if(t)throw t.error}}var V=h.readVariableUIntLE(g[2]);var H=h.decode(g[3]);var j=H[1].readUInt32LE(0);var W=H[2].readUInt32LE(0);this.activeTransition={iid:d,transitionStartMillis:_,timeMillisOffset:I,transitionId:c.unparse(T),transitionStartBuffer:E.toString("hex"),id3:D===null||D===void 0?void 0:D.toString("hex"),brightnessCharacteristicIID:V,brightnessAdjustmentRange:{minBrightnessValue:j,maxBrightnessValue:W},transitionCurve:b,updateInterval:y!==null&&y!==void 0?y:6e4,notifyIntervalThreshold:C};if(this.updateTimeout){clearTimeout(this.updateTimeout);this.updateTimeout=undefined;p("[%s] Adaptive lighting was renewed.",this.lightbulb.displayName)}else{p("[%s] Adaptive lighting was enabled.",this.lightbulb.displayName)}this.handleActiveTransitionUpdated();return h.encode(2,this.buildTransitionControlResponseBuffer(0))};return AdaptiveLightingController}(l.EventEmitter);t.AdaptiveLightingController=P},1706:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CameraController=t.CameraControllerEvents=t.ResourceRequestReason=void 0;var i=r(6867);var n=i.__importDefault(r(6113));var a=i.__importDefault(r(7031));var o=r(2361);var s=r(7270);var c=r(8117);var u=r(4658);var l=r(877);var d=r(2716);var h=(0,a.default)("HAP-NodeJS:Camera:Controller");var p;(function(e){e[e["PERIODIC"]=0]="PERIODIC";e[e["EVENT"]=1]="EVENT"})(p=t.ResourceRequestReason||(t.ResourceRequestReason={}));var v;(function(e){e["MICROPHONE_PROPERTIES_CHANGED"]="microphone-change";e["SPEAKER_PROPERTIES_CHANGED"]="speaker-change"})(v=t.CameraControllerEvents||(t.CameraControllerEvents={}));var m=function(e){i.__extends(CameraController,e);function CameraController(t,r){if(r===void 0){r=false}var i=e.call(this)||this;i.legacyMode=false;i.streamManagements=[];i.microphoneMuted=false;i.microphoneVolume=100;i.speakerMuted=false;i.speakerVolume=100;i.motionServiceExternallySupplied=false;i.occupancyServiceExternallySupplied=false;i.streamCount=Math.max(1,t.cameraStreamCount||1);i.delegate=t.delegate;i.streamingOptions=t.streamingOptions;i.recording=t.recording;i.sensorOptions=t.sensors;i.legacyMode=r;return i}CameraController.prototype.controllerId=function(){return"camera"};CameraController.prototype.forceStopStreamingSession=function(e){this.streamManagements.forEach((function(t){if(t.sessionIdentifier===e){t.forceStop()}}))};CameraController.generateSynchronisationSource=function(){var e=n.default.randomBytes(4);e[0]=0;return e.readInt32BE(0)};CameraController.prototype.setMicrophoneMuted=function(e){if(e===void 0){e=true}if(!this.microphoneService){return}this.microphoneMuted=e;this.microphoneService.updateCharacteristic(c.Characteristic.Mute,e)};CameraController.prototype.setMicrophoneVolume=function(e){if(!this.microphoneService){return}this.microphoneVolume=e;this.microphoneService.updateCharacteristic(c.Characteristic.Volume,e)};CameraController.prototype.setSpeakerMuted=function(e){if(e===void 0){e=true}if(!this.speakerService){return}this.speakerMuted=e;this.speakerService.updateCharacteristic(c.Characteristic.Mute,e)};CameraController.prototype.setSpeakerVolume=function(e){if(!this.speakerService){return}this.speakerVolume=e;this.speakerService.updateCharacteristic(c.Characteristic.Volume,e)};CameraController.prototype.emitMicrophoneChange=function(){this.emit("microphone-change",this.microphoneMuted,this.microphoneVolume)};CameraController.prototype.emitSpeakerChange=function(){this.emit("speaker-change",this.speakerMuted,this.speakerVolume)};CameraController.prototype.constructServices=function(){var e,t,r,i;for(var n=0;n<this.streamCount;n++){var a=new s.RTPStreamManagement(n,this.streamingOptions,this.delegate,undefined,this.rtpStreamManagementDisabledThroughOperatingMode.bind(this));this.streamManagements.push(a)}if(!this.legacyMode&&this.streamingOptions.audio){this.microphoneService=new l.Service.Microphone("","");this.microphoneService.setCharacteristic(c.Characteristic.Volume,this.microphoneVolume);if(this.streamingOptions.audio.twoWayAudio){this.speakerService=new l.Service.Speaker("","");this.speakerService.setCharacteristic(c.Characteristic.Volume,this.speakerVolume)}}if(this.recording){this.recordingManagement=new s.RecordingManagement(this.recording.options,this.recording.delegate,this.retrieveEventTriggerOptions())}if((e=this.sensorOptions)===null||e===void 0?void 0:e.motion){if(typeof this.sensorOptions.motion==="boolean"){this.motionService=new l.Service.MotionSensor("","")}else{this.motionService=this.sensorOptions.motion;this.motionServiceExternallySupplied=true}this.motionService.setCharacteristic(c.Characteristic.StatusActive,true);(t=this.recordingManagement)===null||t===void 0?void 0:t.recordingManagementService.addLinkedService(this.motionService)}if((r=this.sensorOptions)===null||r===void 0?void 0:r.occupancy){if(typeof this.sensorOptions.occupancy==="boolean"){this.occupancyService=new l.Service.OccupancySensor("","")}else{this.occupancyService=this.sensorOptions.occupancy;this.occupancyServiceExternallySupplied=true}this.occupancyService.setCharacteristic(c.Characteristic.StatusActive,true);(i=this.recordingManagement)===null||i===void 0?void 0:i.recordingManagementService.addLinkedService(this.occupancyService)}var o={microphone:this.microphoneService,speaker:this.speakerService,motionService:!this.motionServiceExternallySupplied?this.motionService:undefined,occupancyService:!this.occupancyServiceExternallySupplied?this.occupancyService:undefined};if(this.recordingManagement){o.cameraEventRecordingManagement=this.recordingManagement.recordingManagementService;o.cameraOperatingMode=this.recordingManagement.operatingModeService;o.dataStreamTransportManagement=this.recordingManagement.dataStreamManagement.getService()}this.streamManagements.forEach((function(e,t){o[CameraController.STREAM_MANAGEMENT+t]=e.getService()}));this.recording=undefined;this.sensorOptions=undefined;return o};CameraController.prototype.initWithServices=function(e){var t=this._initWithServices(e);if(t.updated){return t.serviceMap}};CameraController.prototype._initWithServices=function(e){var t,r,i,n,a,o,d,h,p;var v=false;for(var m=0;true;m++){var g=e[CameraController.STREAM_MANAGEMENT+m];if(m<this.streamCount){var y=this.rtpStreamManagementDisabledThroughOperatingMode.bind(this);if(g){this.streamManagements.push(new s.RTPStreamManagement(m,this.streamingOptions,this.delegate,g,y))}else{var C=new s.RTPStreamManagement(m,this.streamingOptions,this.delegate,undefined,y);this.streamManagements.push(C);e[CameraController.STREAM_MANAGEMENT+m]=C.getService();v=true}}else{if(g){delete e[CameraController.STREAM_MANAGEMENT+m];v=true}else{break}}}if(!this.legacyMode&&this.streamingOptions.audio){if(e.microphone){this.microphoneService=e.microphone}else{this.microphoneService=new l.Service.Microphone("","");this.microphoneService.setCharacteristic(c.Characteristic.Volume,this.microphoneVolume);e.microphone=this.microphoneService;v=true}}else if(e.microphone){delete e.microphone;v=true}if(!this.legacyMode&&((t=this.streamingOptions.audio)===null||t===void 0?void 0:t.twoWayAudio)){if(e.speaker){this.speakerService=e.speaker}else{this.speakerService=new l.Service.Speaker("","");this.speakerService.setCharacteristic(c.Characteristic.Volume,this.speakerVolume);e.speaker=this.speakerService;v=true}}else if(e.speaker){delete e.speaker;v=true}if(this.recording){var T=this.retrieveEventTriggerOptions();if(e.cameraEventRecordingManagement&&e.cameraOperatingMode&&e.dataStreamTransportManagement){this.recordingManagement=new s.RecordingManagement(this.recording.options,this.recording.delegate,T,{recordingManagement:e.cameraEventRecordingManagement,operatingMode:e.cameraOperatingMode,dataStreamManagement:new u.DataStreamManagement(e.dataStreamTransportManagement)})}else{this.recordingManagement=new s.RecordingManagement(this.recording.options,this.recording.delegate,T);e.cameraEventRecordingManagement=this.recordingManagement.recordingManagementService;e.cameraOperatingMode=this.recordingManagement.operatingModeService;e.dataStreamTransportManagement=this.recordingManagement.dataStreamManagement.getService();v=true}}else{if(e.cameraEventRecordingManagement){delete e.cameraEventRecordingManagement;v=true}if(e.cameraOperatingMode){delete e.cameraOperatingMode;v=true}if(e.dataStreamTransportManagement){delete e.dataStreamTransportManagement;v=true}}if((r=this.sensorOptions)===null||r===void 0?void 0:r.motion){if(typeof this.sensorOptions.motion==="boolean"){if(e.motionService){this.motionService=e.motionService}else{this.motionService=new l.Service.MotionSensor("","")}}else{this.motionService=this.sensorOptions.motion;this.motionServiceExternallySupplied=true;if(e.motionService){(i=this.recordingManagement)===null||i===void 0?void 0:i.recordingManagementService.removeLinkedService(e.motionService);delete e.motionService;v=true}}this.motionService.setCharacteristic(c.Characteristic.StatusActive,true);(n=this.recordingManagement)===null||n===void 0?void 0:n.recordingManagementService.addLinkedService(this.motionService)}else{if(e.motionService){(a=this.recordingManagement)===null||a===void 0?void 0:a.recordingManagementService.removeLinkedService(e.motionService);delete e.motionService;v=true}}if((o=this.sensorOptions)===null||o===void 0?void 0:o.occupancy){if(typeof this.sensorOptions.occupancy==="boolean"){if(e.occupancyService){this.occupancyService=e.occupancyService}else{this.occupancyService=new l.Service.OccupancySensor("","")}}else{this.occupancyService=this.sensorOptions.occupancy;this.occupancyServiceExternallySupplied=true;if(e.occupancyService){(d=this.recordingManagement)===null||d===void 0?void 0:d.recordingManagementService.removeLinkedService(e.occupancyService);delete e.occupancyService;v=true}}this.occupancyService.setCharacteristic(c.Characteristic.StatusActive,true);(h=this.recordingManagement)===null||h===void 0?void 0:h.recordingManagementService.addLinkedService(this.occupancyService)}else{if(e.occupancyService){(p=this.recordingManagement)===null||p===void 0?void 0:p.recordingManagementService.removeLinkedService(e.occupancyService);delete e.occupancyService;v=true}}if(this.migrateFromDoorbell(e)){v=true}this.recording=undefined;this.sensorOptions=undefined;return{serviceMap:e,updated:v}};CameraController.prototype.migrateFromDoorbell=function(e){if(e.doorbell){delete e.doorbell;return true}return false};CameraController.prototype.retrieveEventTriggerOptions=function(){var e,t;var r;if(!this.recording){return new Set}var n=new Set;if(this.recording.options.overrideEventTriggerOptions){try{for(var a=i.__values(this.recording.options.overrideEventTriggerOptions),o=a.next();!o.done;o=a.next()){var s=o.value;n.add(s)}}catch(t){e={error:t}}finally{try{if(o&&!o.done&&(t=a.return))t.call(a)}finally{if(e)throw e.error}}}if((r=this.sensorOptions)===null||r===void 0?void 0:r.motion){n.add(1)}return n};CameraController.prototype.configureServices=function(){var e=this;var t,r;if(this.microphoneService){this.microphoneService.getCharacteristic(c.Characteristic.Mute).on("get",(function(t){t(undefined,e.microphoneMuted)})).on("set",(function(t,r){e.microphoneMuted=t;r();e.emitMicrophoneChange()}));this.microphoneService.getCharacteristic(c.Characteristic.Volume).on("get",(function(t){t(undefined,e.microphoneVolume)})).on("set",(function(t,r){e.microphoneVolume=t;r();e.emitMicrophoneChange()}))}if(this.speakerService){this.speakerService.getCharacteristic(c.Characteristic.Mute).on("get",(function(t){t(undefined,e.speakerMuted)})).on("set",(function(t,r){e.speakerMuted=t;r();e.emitSpeakerChange()}));this.speakerService.getCharacteristic(c.Characteristic.Volume).on("get",(function(t){t(undefined,e.speakerVolume)})).on("set",(function(t,r){e.speakerVolume=t;r();e.emitSpeakerChange()}))}if(this.motionService){(t=this.recordingManagement)===null||t===void 0?void 0:t.sensorServices.push(this.motionService)}if(this.occupancyService){(r=this.recordingManagement)===null||r===void 0?void 0:r.sensorServices.push(this.occupancyService)}};CameraController.prototype.rtpStreamManagementDisabledThroughOperatingMode=function(){return this.recordingManagement?!this.recordingManagement.operatingModeService.getCharacteristic(c.Characteristic.HomeKitCameraActive).value:false};CameraController.prototype.handleControllerRemoved=function(){var e,t;var r;this.handleFactoryReset();try{for(var n=i.__values(this.streamManagements),a=n.next();!a.done;a=n.next()){var o=a.value;o.destroy()}}catch(t){e={error:t}}finally{try{if(a&&!a.done&&(t=n.return))t.call(n)}finally{if(e)throw e.error}}this.streamManagements.splice(0,this.streamManagements.length);this.microphoneService=undefined;this.speakerService=undefined;(r=this.recordingManagement)===null||r===void 0?void 0:r.destroy();this.recordingManagement=undefined;this.removeAllListeners()};CameraController.prototype.handleFactoryReset=function(){var e;this.streamManagements.forEach((function(e){return e.handleFactoryReset()}));(e=this.recordingManagement)===null||e===void 0?void 0:e.handleFactoryReset();this.microphoneMuted=false;this.microphoneVolume=100;this.speakerMuted=false;this.speakerVolume=100};CameraController.prototype.serialize=function(){var e,t;var r;var n=[];try{for(var a=i.__values(this.streamManagements),o=a.next();!o.done;o=a.next()){var s=o.value;var c=s.serialize();if(c){n.push(c)}}}catch(t){e={error:t}}finally{try{if(o&&!o.done&&(t=a.return))t.call(a)}finally{if(e)throw e.error}}return{streamManagements:n,recordingManagement:(r=this.recordingManagement)===null||r===void 0?void 0:r.serialize()}};CameraController.prototype.deserialize=function(e){var t,r,n,a;var o;try{for(var s=i.__values(e.streamManagements),u=s.next();!u.done;u=s.next()){var l=u.value;var d=this.streamManagements[l.id];if(d){d.deserialize(l)}}}catch(e){t={error:e}}finally{try{if(u&&!u.done&&(r=s.return))r.call(s)}finally{if(t)throw t.error}}if(e.recordingManagement){if(this.recordingManagement){this.recordingManagement.deserialize(e.recordingManagement)}else{try{for(var h=i.__values(this.streamManagements),p=h.next();!p.done;p=h.next()){var d=p.value;d.service.updateCharacteristic(c.Characteristic.Active,true)}}catch(e){n={error:e}}finally{try{if(p&&!p.done&&(a=h.return))a.call(h)}finally{if(n)throw n.error}}(o=this.stateChangeDelegate)===null||o===void 0?void 0:o.call(this)}}};CameraController.prototype.setupStateChangeDelegate=function(e){var t,r;var n;this.stateChangeDelegate=e;try{for(var a=i.__values(this.streamManagements),o=a.next();!o.done;o=a.next()){var s=o.value;s.setupStateChangeDelegate(e)}}catch(e){t={error:e}}finally{try{if(o&&!o.done&&(r=a.return))r.call(a)}finally{if(t)throw t.error}}(n=this.recordingManagement)===null||n===void 0?void 0:n.setupStateChangeDelegate(e)};CameraController.prototype.handleSnapshotRequest=function(e,t,r,i){var n=this;var a=this.streamManagements.map((function(e){return!e.getService().getCharacteristic(c.Characteristic.Active).value})).reduce((function(e,t){return e&&t}));if(a){h("[%s] Rejecting snapshot as streaming is disabled.",r);return Promise.reject(-70412)}if(this.recordingManagement){var o=this.recordingManagement.operatingModeService;if(!o.getCharacteristic(c.Characteristic.HomeKitCameraActive).value){h("[%s] Rejecting snapshot as HomeKit camera is disabled.",r);return Promise.reject(-70412)}var s=o.getCharacteristic(c.Characteristic.EventSnapshotsActive).value;if(!s){if(i==null){h("[%s] Rejecting snapshot as reason is required due to disabled event snapshots.",r);return Promise.reject(-70401)}else if(i===1){h("[%s] Rejecting snapshot as even snapshots are disabled.",r);return Promise.reject(-70412)}}var u=o.getCharacteristic(c.Characteristic.PeriodicSnapshotsActive).value;if(!u){if(i==null){h("[%s] Rejecting snapshot as reason is required due to disabled periodic snapshots.",r);return Promise.reject(-70401)}else if(i===0){h("[%s] Rejecting snapshot as periodic snapshots are disabled.",r);return Promise.reject(-70412)}}}return new Promise((function(a,o){var s=setTimeout((function(){console.warn("[".concat(r,"] The image snapshot handler for the given accessory is slow to respond! See https://homebridge.io/w/JtMGR for more info."));s=setTimeout((function(){s=undefined;console.warn("[".concat(r,"] The image snapshot handler for the given accessory didn't respond at all! See https://homebridge.io/w/JtMGR for more info."));o(-70408)}),17e3);s.unref()}),5e3);s.unref();try{n.delegate.handleSnapshotRequest({height:e,width:t,reason:i},(function(e,t){if(!s){return}else{clearTimeout(s);s=undefined}if(e){if(typeof e==="number"){o(e)}else{h("[%s] Error getting snapshot: %s",r,e.stack);o(-70402)}return}if(!t||t.length===0){console.warn("[".concat(r,"] Snapshot request handler provided empty image buffer!"));o(-70402)}else{a(t)}}))}catch(e){if(!s){return}else{clearTimeout(s);s=undefined}console.warn("[".concat(r,"] Unhandled error thrown inside snapshot request handler: ").concat(e.stack));o(e instanceof d.HapStatusError?e.hapStatus:-70402)}}))};CameraController.prototype.handleCloseConnection=function(e){if(this.delegate instanceof s.LegacyCameraSourceAdapter){this.delegate.forwardCloseConnection(e)}};CameraController.STREAM_MANAGEMENT="streamManagement";return CameraController}(o.EventEmitter);t.CameraController=m},9955:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.isSerializableController=t.DefaultControllerType=void 0;var r;(function(e){e["CAMERA"]="camera";e["REMOTE"]="remote";e["TV"]="tv";e["ROUTER"]="router";e["LOCK"]="lock";e["CHARACTERISTIC_TRANSITION"]="characteristic-transition"})(r=t.DefaultControllerType||(t.DefaultControllerType={}));function isSerializableController(e){return"serialize"in e&&"deserialize"in e&&"setupStateChangeDelegate"in e}t.isSerializableController=isSerializableController},5468:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DoorbellController=void 0;var i=r(6867);var n=r(8117);var a=r(877);var o=r(1706);var s=function(e){i.__extends(DoorbellController,e);function DoorbellController(t){var r=e.call(this,t)||this;r.doorbellServiceExternallySupplied=false;r.doorbellOptions={name:t.name,externalDoorbellService:t.externalDoorbellService};return r}DoorbellController.prototype.ringDoorbell=function(){this.doorbellService.updateCharacteristic(n.Characteristic.ProgrammableSwitchEvent,n.Characteristic.ProgrammableSwitchEvent.SINGLE_PRESS)};DoorbellController.prototype.constructServices=function(){var t,r,i;if((t=this.doorbellOptions)===null||t===void 0?void 0:t.externalDoorbellService){this.doorbellService=this.doorbellOptions.externalDoorbellService;this.doorbellServiceExternallySupplied=true}else{this.doorbellService=new a.Service.Doorbell((i=(r=this.doorbellOptions)===null||r===void 0?void 0:r.name)!==null&&i!==void 0?i:"","")}this.doorbellService.setPrimaryService();var n=e.prototype.constructServices.call(this);if(!this.doorbellServiceExternallySupplied){n.doorbell=this.doorbellService}return n};DoorbellController.prototype.initWithServices=function(t){var r,i,n;var o=e.prototype._initWithServices.call(this,t);if((r=this.doorbellOptions)===null||r===void 0?void 0:r.externalDoorbellService){this.doorbellService=this.doorbellOptions.externalDoorbellService;this.doorbellServiceExternallySupplied=true;if(o.serviceMap.doorbell){delete o.serviceMap.doorbell;o.updated=true}}else{this.doorbellService=o.serviceMap.doorbell;if(!this.doorbellService){this.doorbellService=new a.Service.Doorbell((n=(i=this.doorbellOptions)===null||i===void 0?void 0:i.name)!==null&&n!==void 0?n:"","");o.serviceMap.doorbell=this.doorbellService;o.updated=true}}this.doorbellService.setPrimaryService();if(o.updated){return o.serviceMap}};DoorbellController.prototype.migrateFromDoorbell=function(e){return false};DoorbellController.prototype.retrieveEventTriggerOptions=function(){var t=e.prototype.retrieveEventTriggerOptions.call(this);t.add(2);return t};DoorbellController.prototype.handleControllerRemoved=function(){e.prototype.handleControllerRemoved.call(this);this.doorbellService=undefined};DoorbellController.prototype.configureServices=function(){e.prototype.configureServices.call(this);this.doorbellService.getCharacteristic(n.Characteristic.ProgrammableSwitchEvent).onGet((function(){return null}));this.doorbellOptions=undefined};return DoorbellController}(o.CameraController);t.DoorbellController=s},118:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SiriAudioSession=t.SiriAudioSessionEvents=t.HomeKitRemoteController=t.RemoteController=t.RemoteControllerEvents=t.TargetUpdates=t.AudioCodecTypes=t.ButtonState=t.TargetCategory=t.ButtonType=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=i.__importDefault(r(7031));var o=r(2361);var s=r(8117);var c=r(4658);var u=r(877);var l=i.__importStar(r(2571));var d=(0,a.default)("HAP-NodeJS:Remote:Controller");var h;(function(e){e[e["MAXIMUM_TARGETS"]=1]="MAXIMUM_TARGETS";e[e["TICKS_PER_SECOND"]=2]="TICKS_PER_SECOND";e[e["SUPPORTED_BUTTON_CONFIGURATION"]=3]="SUPPORTED_BUTTON_CONFIGURATION";e[e["TYPE"]=4]="TYPE"})(h||(h={}));var p;(function(e){e[e["BUTTON_ID"]=1]="BUTTON_ID";e[e["BUTTON_TYPE"]=2]="BUTTON_TYPE"})(p||(p={}));var v;(function(e){e[e["UNDEFINED"]=0]="UNDEFINED";e[e["MENU"]=1]="MENU";e[e["PLAY_PAUSE"]=2]="PLAY_PAUSE";e[e["TV_HOME"]=3]="TV_HOME";e[e["SELECT"]=4]="SELECT";e[e["ARROW_UP"]=5]="ARROW_UP";e[e["ARROW_RIGHT"]=6]="ARROW_RIGHT";e[e["ARROW_DOWN"]=7]="ARROW_DOWN";e[e["ARROW_LEFT"]=8]="ARROW_LEFT";e[e["VOLUME_UP"]=9]="VOLUME_UP";e[e["VOLUME_DOWN"]=10]="VOLUME_DOWN";e[e["SIRI"]=11]="SIRI";e[e["POWER"]=12]="POWER";e[e["GENERIC"]=13]="GENERIC"})(v=t.ButtonType||(t.ButtonType={}));var m;(function(e){e[e["OPERATION"]=1]="OPERATION";e[e["TARGET_CONFIGURATION"]=2]="TARGET_CONFIGURATION"})(m||(m={}));var g;(function(e){e[e["UNDEFINED"]=0]="UNDEFINED";e[e["LIST"]=1]="LIST";e[e["ADD"]=2]="ADD";e[e["REMOVE"]=3]="REMOVE";e[e["RESET"]=4]="RESET";e[e["UPDATE"]=5]="UPDATE"})(g||(g={}));var y;(function(e){e[e["TARGET_IDENTIFIER"]=1]="TARGET_IDENTIFIER";e[e["TARGET_NAME"]=2]="TARGET_NAME";e[e["TARGET_CATEGORY"]=3]="TARGET_CATEGORY";e[e["BUTTON_CONFIGURATION"]=4]="BUTTON_CONFIGURATION"})(y||(y={}));var C;(function(e){e[e["UNDEFINED"]=0]="UNDEFINED";e[e["APPLE_TV"]=24]="APPLE_TV"})(C=t.TargetCategory||(t.TargetCategory={}));var T;(function(e){e[e["BUTTON_ID"]=1]="BUTTON_ID";e[e["BUTTON_TYPE"]=2]="BUTTON_TYPE";e[e["BUTTON_NAME"]=3]="BUTTON_NAME"})(T||(T={}));var E;(function(e){e[e["BUTTON_ID"]=1]="BUTTON_ID";e[e["BUTTON_STATE"]=2]="BUTTON_STATE";e[e["TIMESTAMP"]=3]="TIMESTAMP";e[e["ACTIVE_IDENTIFIER"]=4]="ACTIVE_IDENTIFIER"})(E||(E={}));var D;(function(e){e[e["UP"]=0]="UP";e[e["DOWN"]=1]="DOWN"})(D=t.ButtonState||(t.ButtonState={}));var _;(function(e){e[e["SELECTED_AUDIO_INPUT_STREAM_CONFIGURATION"]=1]="SELECTED_AUDIO_INPUT_STREAM_CONFIGURATION"})(_||(_={}));var I;(function(e){e[e["AUDIO_CODEC_CONFIGURATION"]=1]="AUDIO_CODEC_CONFIGURATION";e[e["COMFORT_NOISE_SUPPORT"]=2]="COMFORT_NOISE_SUPPORT"})(I||(I={}));var b;(function(e){e[e["CODEC_TYPE"]=1]="CODEC_TYPE";e[e["CODEC_PARAMETERS"]=2]="CODEC_PARAMETERS"})(b||(b={}));var w;(function(e){e[e["PCMU"]=0]="PCMU";e[e["PCMA"]=1]="PCMA";e[e["AAC_ELD"]=2]="AAC_ELD";e[e["OPUS"]=3]="OPUS";e[e["MSBC"]=4]="MSBC";e[e["AMR"]=5]="AMR";e[e["AMR_WB"]=6]="AMR_WB"})(w=t.AudioCodecTypes||(t.AudioCodecTypes={}));var R;(function(e){e[e["CHANNEL"]=1]="CHANNEL";e[e["BIT_RATE"]=2]="BIT_RATE";e[e["SAMPLE_RATE"]=3]="SAMPLE_RATE";e[e["PACKET_TIME"]=4]="PACKET_TIME"})(R||(R={}));var N;(function(e){e[e["STARTING"]=0]="STARTING";e[e["SENDING"]=1]="SENDING";e[e["CLOSING"]=2]="CLOSING";e[e["CLOSED"]=3]="CLOSED"})(N||(N={}));var U;(function(e){e[e["NAME"]=0]="NAME";e[e["CATEGORY"]=1]="CATEGORY";e[e["UPDATED_BUTTONS"]=2]="UPDATED_BUTTONS";e[e["REMOVED_BUTTONS"]=3]="REMOVED_BUTTONS"})(U=t.TargetUpdates||(t.TargetUpdates={}));var P;(function(e){e["ACTIVE_CHANGE"]="active-change";e["ACTIVE_IDENTIFIER_CHANGE"]="active-identifier-change";e["TARGET_ADDED"]="target-add";e["TARGET_UPDATED"]="target-update";e["TARGET_REMOVED"]="target-remove";e["TARGETS_RESET"]="targets-reset"})(P=t.RemoteControllerEvents||(t.RemoteControllerEvents={}));var O=function(e){i.__extends(RemoteController,e);function RemoteController(t,r){var i=e.call(this)||this;i.buttons={};i.targetConfigurations=new Map;i.targetConfigurationsString="";i.lastButtonEvent="";i.activeIdentifier=0;i.dataStreamConnections=new Map;i.audioSupported=t!==undefined;i.audioProducerConstructor=t;i.audioProducerOptions=r;var n=i.constructSupportedConfiguration();i.supportedConfiguration=i.buildTargetControlSupportedConfigurationTLV(n);var a=i.constructSupportedAudioConfiguration();i.supportedAudioConfiguration=RemoteController.buildSupportedAudioConfigurationTLV(a);i.selectedAudioConfiguration={codecType:3,parameters:{channels:1,bitrate:0,samplerate:1,rtpTime:20}};i.selectedAudioConfigurationString=RemoteController.buildSelectedAudioConfigurationTLV({audioCodecConfiguration:i.selectedAudioConfiguration});return i}RemoteController.prototype.controllerId=function(){return"remote"};RemoteController.prototype.setActiveIdentifier=function(e){var t=this;if(e===this.activeIdentifier){return}if(e!==0&&!this.targetConfigurations.has(e)){throw Error("Tried setting unconfigured targetIdentifier to active")}d("%d is now the active target",e);this.activeIdentifier=e;this.targetControlService.getCharacteristic(s.Characteristic.ActiveIdentifier).updateValue(e);if(this.activeAudioSession){this.handleSiriAudioStop()}setTimeout((function(){return t.emit("active-identifier-change",e)}),0);this.setInactive()};RemoteController.prototype.isActive=function(){return!!this.activeConnection};RemoteController.prototype.isConfigured=function(e){return this.targetConfigurations.has(e)};RemoteController.prototype.getTargetIdentifierByName=function(e){var t,r;try{for(var n=i.__values(Object.entries(this.targetConfigurations)),a=n.next();!a.done;a=n.next()){var o=i.__read(a.value,2),s=o[0],c=o[1];if(c.targetName===e){return parseInt(s,10)}}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}return undefined};RemoteController.prototype.pushButton=function(e){this.sendButtonEvent(e,1)};RemoteController.prototype.releaseButton=function(e){this.sendButtonEvent(e,0)};RemoteController.prototype.pushAndReleaseButton=function(e,t){var r=this;if(t===void 0){t=200}this.pushButton(e);setTimeout((function(){return r.releaseButton(e)}),t)};RemoteController.prototype.addServicesToAccessory=function(e){e.configureController(this)};RemoteController.prototype.constructSupportedConfiguration=function(){var e=this;var t={maximumTargets:10,ticksPerSecond:1e3,supportedButtonConfiguration:[],hardwareImplemented:this.audioSupported};var r=[1,2,3,4,5,6,7,8,9,10,12,13];if(this.audioSupported){r.push(11)}r.forEach((function(r){var i={buttonID:100+r,buttonType:r};t.supportedButtonConfiguration.push(i);e.buttons[r]=i.buttonID}));return t};RemoteController.prototype.constructSupportedAudioConfiguration=function(){return{audioCodecConfiguration:{codecType:3,parameters:{channels:1,bitrate:0,samplerate:1}}}};RemoteController.prototype.handleTargetControlWrite=function(e,t){var r=Buffer.from(e,"base64");var i=l.decode(r);var n=i[1][0];var a=undefined;if(i[2]){a=this.parseTargetConfigurationTLV(i[2])}d("Received TargetControl write operation %s",g[n]);var o;switch(n){case g.ADD:o=this.handleAddTarget.bind(this);break;case g.UPDATE:o=this.handleUpdateTarget.bind(this);break;case g.REMOVE:o=this.handleRemoveTarget.bind(this);break;case g.RESET:o=this.handleResetTargets.bind(this);break;case g.LIST:o=this.handleListTargets.bind(this);break;default:t(-70410,undefined);return}var s=o(a);if(s===0){t(undefined,this.targetConfigurationsString);if(n===g.ADD&&this.activeIdentifier===0){this.setActiveIdentifier(a.targetIdentifier)}}else{t(new Error(s+""))}};RemoteController.prototype.handleAddTarget=function(e){var t=this;if(!e){return-70410}this.targetConfigurations.set(e.targetIdentifier,e);d("Configured new target '"+e.targetName+"' with targetIdentifier '"+e.targetIdentifier+"'");setTimeout((function(){return t.emit("target-add",e)}),0);this.updatedTargetConfiguration();return 0};RemoteController.prototype.handleUpdateTarget=function(e){var t,r;var n=this;if(!e){return-70410}var a=[];var o=this.targetConfigurations.get(e.targetIdentifier);if(!o){return-70410}if(e.targetName){d("Target name was updated '%s' => '%s' (%d)",o.targetName,e.targetName,o.targetIdentifier);o.targetName=e.targetName;a.push(0)}if(e.targetCategory){d("Target category was updated '%d' => '%d' for target '%s' (%d)",o.targetCategory,e.targetCategory,o.targetName,o.targetIdentifier);o.targetCategory=e.targetCategory;a.push(1)}if(e.buttonConfiguration){d("%d button configurations were updated for target '%s' (%d)",Object.keys(e.buttonConfiguration).length,o.targetName,o.targetIdentifier);try{for(var s=i.__values(Object.values(e.buttonConfiguration)),c=s.next();!c.done;c=s.next()){var u=c.value;var l=o.buttonConfiguration[u.buttonID];l.buttonType=u.buttonType;l.buttonName=u.buttonName}}catch(e){t={error:e}}finally{try{if(c&&!c.done&&(r=s.return))r.call(s)}finally{if(t)throw t.error}}a.push(2)}setTimeout((function(){return n.emit("target-update",e,a)}),0);this.updatedTargetConfiguration();return 0};RemoteController.prototype.handleRemoveTarget=function(e){var t=this;if(!e){return-70410}var r=this.targetConfigurations.get(e.targetIdentifier);if(!r){return-70410}if(e.buttonConfiguration){for(var i in e.buttonConfiguration){if(Object.prototype.hasOwnProperty.call(e.buttonConfiguration,i)){delete r.buttonConfiguration[i]}}d("Removed %d button configurations of target '%s' (%d)",Object.keys(e.buttonConfiguration).length,r.targetName,r.targetIdentifier);setTimeout((function(){return t.emit("target-update",r,[3])}),0)}else{this.targetConfigurations.delete(e.targetIdentifier);d("Target '%s' (%d) was removed",r.targetName,r.targetIdentifier);setTimeout((function(){return t.emit("target-remove",e.targetIdentifier)}),0);var n=Object.keys(this.targetConfigurations);this.setActiveIdentifier(n.length===0?0:parseInt(n[0],10))}this.updatedTargetConfiguration();return 0};RemoteController.prototype.handleResetTargets=function(e){var t=this;if(e){return-70410}d("Resetting all target configurations");this.targetConfigurations=new Map;this.updatedTargetConfiguration();setTimeout((function(){return t.emit("targets-reset")}),0);this.setActiveIdentifier(0);return 0};RemoteController.prototype.handleListTargets=function(e){if(e){return-70410}d("Returning "+Object.keys(this.targetConfigurations).length+" target configurations");return 0};RemoteController.prototype.handleActiveWrite=function(e,t,r){if(this.activeIdentifier===0){d("Tried to change active state. There is no active target set though");t(-70410);return}if(this.activeConnection){this.activeConnection.removeListener("closed",this.activeConnectionDisconnectListener);this.activeConnection=undefined;this.activeConnectionDisconnectListener=undefined}this.activeConnection=e?r:undefined;if(this.activeConnection){this.activeConnectionDisconnectListener=this.handleActiveSessionDisconnected.bind(this,this.activeConnection);this.activeConnection.on("closed",this.activeConnectionDisconnectListener)}var i=this.targetConfigurations.get(this.activeIdentifier);if(!i){t(-70410);return}d("Remote with activeTarget '%s' (%d) was set to %s",i.targetName,this.activeIdentifier,e?"ACTIVE":"INACTIVE");t();this.emit("active-change",e)};RemoteController.prototype.setInactive=function(){var e=this;if(this.activeConnection===undefined){return}this.activeConnection.removeListener("closed",this.activeConnectionDisconnectListener);this.activeConnection=undefined;this.activeConnectionDisconnectListener=undefined;this.targetControlService.getCharacteristic(s.Characteristic.Active).updateValue(false);d("Remote was set to INACTIVE");setTimeout((function(){return e.emit("active-change",false)}),0)};RemoteController.prototype.handleActiveSessionDisconnected=function(e){if(e!==this.activeConnection){return}d("Active hap session disconnected!");this.setInactive()};RemoteController.prototype.sendButtonEvent=function(e,t){var r=this.buttons[e];if(r===undefined||r===0){throw new Error("Tried sending button event for unsupported button ("+e+")")}if(this.activeIdentifier===0){throw new Error("Tried sending button event although no target was selected")}if(!this.isActive()){throw new Error("Tried sending button event although target was not marked as active")}if(e===11&&this.audioSupported){if(t===1){this.handleSiriAudioStart()}else if(t===0){this.handleSiriAudioStop()}return}var i=l.encode(1,r);var n=l.encode(2,t);var a=l.encode(3,l.writeVariableUIntLE((new Date).getTime()));var o=l.encode(4,l.writeUInt32(this.activeIdentifier));this.lastButtonEvent=Buffer.concat([i,n,a,o]).toString("base64");this.targetControlService.getCharacteristic(s.Characteristic.ButtonEvent).sendEventNotification(this.lastButtonEvent)};RemoteController.prototype.parseTargetConfigurationTLV=function(e){var t=l.decode(e);var r=l.readUInt32(t[1]);var i=undefined;if(t[2]){i=t[2].toString()}var n=undefined;if(t[3]){n=l.readUInt16(t[3])}var a={};if(t[4]){var o=l.decodeList(t[4],1);o.forEach((function(e){var t=e[1][0];var r=l.readUInt16(e[2]);var i;if(e[3]){i=e[3].toString()}else{i=v[r]}a[t]={buttonID:t,buttonType:r,buttonName:i}}))}return{targetIdentifier:r,targetName:i,targetCategory:n,buttonConfiguration:a}};RemoteController.prototype.updatedTargetConfiguration=function(){var e,t,r,n;var a;var o=[];try{for(var s=i.__values(Object.values(this.targetConfigurations)),c=s.next();!c.done;c=s.next()){var u=c.value;var d=l.encode(1,l.writeUInt32(u.targetIdentifier));var h=l.encode(2,u.targetName);var p=l.encode(3,l.writeUInt16(u.targetCategory));var v=[];try{for(var m=(r=void 0,i.__values(u.buttonConfiguration.values())),g=m.next();!g.done;g=m.next()){var y=g.value;var C=l.encode(1,y.buttonID,2,l.writeUInt16(y.buttonType));if(y.buttonName){C=Buffer.concat([C,l.encode(3,y.buttonName)])}v.push(C)}}catch(e){r={error:e}}finally{try{if(g&&!g.done&&(n=m.return))n.call(m)}finally{if(r)throw r.error}}var T=l.encode(4,Buffer.concat(v));var E=Buffer.concat([d,h,p,T]);o.push(l.encode(2,E))}}catch(t){e={error:t}}finally{try{if(c&&!c.done&&(t=s.return))t.call(s)}finally{if(e)throw e.error}}this.targetConfigurationsString=Buffer.concat(o).toString("base64");(a=this.stateChangeDelegate)===null||a===void 0?void 0:a.call(this)};RemoteController.prototype.buildTargetControlSupportedConfigurationTLV=function(e){var t=l.encode(1,e.maximumTargets);var r=l.encode(2,l.writeVariableUIntLE(e.ticksPerSecond));var i=[];e.supportedButtonConfiguration.forEach((function(e){var t=l.encode(1,e.buttonID,2,l.writeUInt16(e.buttonType));i.push(t)}));var n=l.encode(3,Buffer.concat(i));var a=l.encode(4,e.hardwareImplemented?1:0);return Buffer.concat([t,r,n,a]).toString("base64")};RemoteController.prototype.handleTargetControlWhoAmI=function(e,t){var r=t.identifier;this.dataStreamConnections.set(r,e);d("Discovered HDS connection for targetIdentifier %s",r);e.addProtocolHandler("dataSend",this)};RemoteController.prototype.handleSiriAudioStart=function(){if(!this.audioSupported){throw new Error("Cannot start siri stream on remote where siri is not supported")}if(!this.isActive()){d("Tried opening Siri audio stream, however no controller is connected!");return}if(this.activeAudioSession&&(!this.activeAudioSession.isClosing()||this.nextAudioSession)){d("Tried opening Siri audio stream, however there is already one in progress");return}var e=this.dataStreamConnections.get(this.activeIdentifier);if(e===undefined){d("Tried opening Siri audio stream however target is not connected via HDS");return}var t=new x(e,this.selectedAudioConfiguration,this.audioProducerConstructor,this.audioProducerOptions);if(!this.activeAudioSession){this.activeAudioSession=t}else{this.nextAudioSession=t}t.on("close",this.handleSiriAudioSessionClosed.bind(this,t));t.start()};RemoteController.prototype.handleSiriAudioStop=function(){if(this.activeAudioSession){if(!this.activeAudioSession.isClosing()){this.activeAudioSession.stop();return}else if(this.nextAudioSession&&!this.nextAudioSession.isClosing()){this.nextAudioSession.stop();return}}d("handleSiriAudioStop called although no audio session was started")};RemoteController.prototype.handleDataSendAckEvent=function(e){var t=e.streamId;var r=e.endOfStream;if(this.activeAudioSession&&this.activeAudioSession.streamId===t){this.activeAudioSession.handleDataSendAckEvent(r)}else if(this.nextAudioSession&&this.nextAudioSession.streamId===t){this.nextAudioSession.handleDataSendAckEvent(r)}else{d("Received dataSend acknowledgment event for unknown streamId '%s'",t)}};RemoteController.prototype.handleDataSendCloseEvent=function(e){var t=e.streamId;var r=e.reason;if(this.activeAudioSession&&this.activeAudioSession.streamId===t){this.activeAudioSession.handleDataSendCloseEvent(r)}else if(this.nextAudioSession&&this.nextAudioSession.streamId===t){this.nextAudioSession.handleDataSendCloseEvent(r)}else{d("Received dataSend close event for unknown streamId '%s'",t)}};RemoteController.prototype.handleSiriAudioSessionClosed=function(e){if(e===this.activeAudioSession){this.activeAudioSession=this.nextAudioSession;this.nextAudioSession=undefined}else if(e===this.nextAudioSession){this.nextAudioSession=undefined}};RemoteController.prototype.handleDataStreamConnectionClosed=function(e){var t,r;try{for(var n=i.__values(this.dataStreamConnections),a=n.next();!a.done;a=n.next()){var o=i.__read(a.value,2),s=o[0],c=o[1];if(e===c){d("HDS connection disconnected for targetIdentifier %s",s);this.dataStreamConnections.delete(s);break}}}catch(e){t={error:e}}finally{try{if(a&&!a.done&&(r=n.return))r.call(n)}finally{if(t)throw t.error}}};RemoteController.prototype.handleSelectedAudioConfigurationWrite=function(e,t){var r=Buffer.from(e,"base64");var i=l.decode(r);var n=l.decode(i[1]);var a=n[1][0];var o=l.decode(n[2]);var s=o[1][0];var c=o[2][0];var u=o[3][0];this.selectedAudioConfiguration={codecType:a,parameters:{channels:s,bitrate:c,samplerate:u,rtpTime:20}};this.selectedAudioConfigurationString=RemoteController.buildSelectedAudioConfigurationTLV({audioCodecConfiguration:this.selectedAudioConfiguration});t()};RemoteController.buildSupportedAudioConfigurationTLV=function(e){var t=RemoteController.buildCodecConfigurationTLV(e.audioCodecConfiguration);var r=l.encode(1,t);return r.toString("base64")};RemoteController.buildSelectedAudioConfigurationTLV=function(e){var t=RemoteController.buildCodecConfigurationTLV(e.audioCodecConfiguration);var r=l.encode(1,t);return r.toString("base64")};RemoteController.buildCodecConfigurationTLV=function(e){var t=e.parameters;var r=l.encode(1,t.channels,2,t.bitrate,3,t.samplerate);if(t.rtpTime){r=Buffer.concat([r,l.encode(4,t.rtpTime)])}return l.encode(1,e.codecType,2,r)};RemoteController.prototype.constructServices=function(){var e;this.targetControlManagementService=new u.Service.TargetControlManagement("","");this.targetControlManagementService.setCharacteristic(s.Characteristic.TargetControlSupportedConfiguration,this.supportedConfiguration);this.targetControlManagementService.setCharacteristic(s.Characteristic.TargetControlList,this.targetConfigurationsString);this.targetControlManagementService.setPrimaryService();this.targetControlService=new u.Service.TargetControl("","");this.targetControlService.setCharacteristic(s.Characteristic.ActiveIdentifier,0);this.targetControlService.setCharacteristic(s.Characteristic.Active,false);this.targetControlService.setCharacteristic(s.Characteristic.ButtonEvent,this.lastButtonEvent);if(this.audioSupported){this.siriService=new u.Service.Siri("","");this.siriService.setCharacteristic(s.Characteristic.SiriInputType,s.Characteristic.SiriInputType.PUSH_BUTTON_TRIGGERED_APPLE_TV);this.audioStreamManagementService=new u.Service.AudioStreamManagement("","");this.audioStreamManagementService.setCharacteristic(s.Characteristic.SupportedAudioStreamConfiguration,this.supportedAudioConfiguration);this.audioStreamManagementService.setCharacteristic(s.Characteristic.SelectedAudioStreamConfiguration,this.selectedAudioConfigurationString);this.dataStreamManagement=new c.DataStreamManagement;this.siriService.addLinkedService(this.dataStreamManagement.getService());this.siriService.addLinkedService(this.audioStreamManagementService)}return{targetControlManagement:this.targetControlManagementService,targetControl:this.targetControlService,siri:this.siriService,audioStreamManagement:this.audioStreamManagementService,dataStreamTransportManagement:(e=this.dataStreamManagement)===null||e===void 0?void 0:e.getService()}};RemoteController.prototype.initWithServices=function(e){this.targetControlManagementService=e.targetControlManagement;this.targetControlService=e.targetControl;this.siriService=e.siri;this.audioStreamManagementService=e.audioStreamManagement;this.dataStreamManagement=new c.DataStreamManagement(e.dataStreamTransportManagement)};RemoteController.prototype.configureServices=function(){var e;var t=this;if(!this.targetControlManagementService||!this.targetControlService){throw new Error("Unexpected state: Services not configured!")}this.targetControlManagementService.getCharacteristic(s.Characteristic.TargetControlList).on("get",(function(e){e(null,t.targetConfigurationsString)})).on("set",this.handleTargetControlWrite.bind(this));this.targetControlService.getCharacteristic(s.Characteristic.ActiveIdentifier).on("get",(function(e){e(undefined,t.activeIdentifier)}));this.targetControlService.getCharacteristic(s.Characteristic.Active).on("get",(function(e){e(undefined,t.isActive())})).on("set",(function(e,r,i,n){if(!n){d("Set event handler for Remote.Active cannot be called from plugin. Connection undefined!");r(-70410);return}t.handleActiveWrite(e,r,n)}));this.targetControlService.getCharacteristic(s.Characteristic.ButtonEvent).on("get",(function(e){e(undefined,t.lastButtonEvent)}));if(this.audioSupported){this.audioStreamManagementService.getCharacteristic(s.Characteristic.SelectedAudioStreamConfiguration).on("get",(function(e){e(null,t.selectedAudioConfigurationString)})).on("set",this.handleSelectedAudioConfigurationWrite.bind(this)).updateValue(this.selectedAudioConfigurationString);this.dataStreamManagement.onEventMessage("targetControl","whoami",this.handleTargetControlWhoAmI.bind(this)).onServerEvent("connection-closed",this.handleDataStreamConnectionClosed.bind(this));this.eventHandler=(e={},e["ack"]=this.handleDataSendAckEvent.bind(this),e["close"]=this.handleDataSendCloseEvent.bind(this),e)}};RemoteController.prototype.handleControllerRemoved=function(){var e;this.targetControlManagementService=undefined;this.targetControlService=undefined;this.siriService=undefined;this.audioStreamManagementService=undefined;this.eventHandler=undefined;this.requestHandler=undefined;(e=this.dataStreamManagement)===null||e===void 0?void 0:e.destroy();this.dataStreamManagement=undefined};RemoteController.prototype.handleFactoryReset=function(){d("Running factory reset. Resetting targets...");this.handleResetTargets(undefined);this.lastButtonEvent=""};RemoteController.prototype.serialize=function(){if(!this.activeIdentifier&&Object.keys(this.targetConfigurations).length===0){return undefined}return{activeIdentifier:this.activeIdentifier,targetConfigurations:i.__spreadArray([],i.__read(this.targetConfigurations),false).reduce((function(e,t){var r=i.__read(t,2),n=r[0],a=r[1];e[n]=a;return e}),{})}};RemoteController.prototype.deserialize=function(e){this.activeIdentifier=e.activeIdentifier;this.targetConfigurations=Object.entries(e.targetConfigurations).reduce((function(e,t){var r=i.__read(t,2),n=r[0],a=r[1];var o=parseInt(n,10);e.set(o,a);return e}),new Map);this.updatedTargetConfiguration()};RemoteController.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e};return RemoteController}(o.EventEmitter);t.RemoteController=O;var L=function(e){i.__extends(HomeKitRemoteController,e);function HomeKitRemoteController(){return e!==null&&e.apply(this,arguments)||this}return HomeKitRemoteController}(O);t.HomeKitRemoteController=L;var B;(function(e){e["CLOSE"]="close"})(B=t.SiriAudioSessionEvents||(t.SiriAudioSessionEvents={}));var x=function(e){i.__extends(SiriAudioSession,e);function SiriAudioSession(t,r,i,n){var a=e.call(this)||this;a.producerRunning=false;a.state=0;a.endOfStream=false;a.audioFrameQueue=[];a.maxQueueSize=1024;a.sequenceNumber=0;a.connection=t;a.selectedAudioConfiguration=r;a.producer=new i(a.handleSiriAudioFrame.bind(a),a.handleProducerError.bind(a),n);a.connection.on("closed",a.closeListener=a.handleDataStreamConnectionClosed.bind(a));return a}SiriAudioSession.prototype.start=function(){var e=this;d("Sending request to start siri audio stream");this.connection.sendRequest("dataSend","open",{target:"controller",type:"audio.siri"},(function(t,r,i){if(e.state===3){d("Ignoring dataSend open response as the session is already closed");return}n.default.strictEqual(e.state,0);e.state=1;if(t||r){if(t){d("Error occurred trying to start siri audio stream: %s",t.message)}else if(r){d("Controller responded with non-zero status code: %s",c.HDSStatus[r])}e.closed()}else{e.streamId=i.streamId;if(!e.producerRunning){e.sendDataSendCloseEvent(3)}else{d("Successfully setup siri audio stream with streamId %d",e.streamId)}}}));this.startAudioProducer()};SiriAudioSession.prototype.isClosing=function(){return this.state>=2};SiriAudioSession.prototype.stop=function(){(0,n.default)(this.state<=1,"state was higher than SENDING");d("Stopping siri audio stream with streamId %d",this.streamId);this.endOfStream=true;this.stopAudioProducer();if(this.state===1){this.handleSiriAudioFrame(undefined);this.state=2}else{this.closed()}};SiriAudioSession.prototype.startAudioProducer=function(){var e=this;this.producer.startAudioProduction(this.selectedAudioConfiguration);this.producerRunning=true;this.producerTimer=setTimeout((function(){d("Didn't receive any frames from audio producer for stream with streamId %s. Canceling the stream now.",e.streamId);e.producerTimer=undefined;e.handleProducerError(3)}),3e3);this.producerTimer.unref()};SiriAudioSession.prototype.stopAudioProducer=function(){this.producer.stopAudioProduction();this.producerRunning=false;if(this.producerTimer){clearTimeout(this.producerTimer);this.producerTimer=undefined}};SiriAudioSession.prototype.handleSiriAudioFrame=function(e){var t=this;if(this.state>=2){return}if(this.producerTimer){clearTimeout(this.producerTimer);this.producerTimer=undefined}if(e&&this.audioFrameQueue.length<this.maxQueueSize){this.audioFrameQueue.push(e)}if(this.state!==1){return}var r;var _loop_1=function(){var e=[];r.forEach((function(r){var i={data:r.data,metadata:{rms:new c.Float32(r.rms),sequenceNumber:new c.Int64(t.sequenceNumber++)}};e.push(i)}));var n={packets:e,streamId:new c.Int64(i.streamId),endOfStream:i.endOfStream};try{i.connection.sendEvent("dataSend","data",n)}catch(e){d("Error occurred when trying to send audio frame of hds connection: %s",e.message);i.stopAudioProducer();i.closed()}if(i.endOfStream){return"break"}};var i=this;while((r=this.popSome())!==null){var n=_loop_1();if(n==="break")break}};SiriAudioSession.prototype.handleProducerError=function(e){if(this.state>=2){return}this.stopAudioProducer();if(this.state===1){this.sendDataSendCloseEvent(e)}};SiriAudioSession.prototype.handleDataSendAckEvent=function(e){n.default.strictEqual(e,true);d("Received acknowledgment for siri audio stream with streamId %s, closing it now",this.streamId);this.sendDataSendCloseEvent(0)};SiriAudioSession.prototype.handleDataSendCloseEvent=function(e){d("Received close event from controller with reason %s for stream with streamId %s",c.HDSProtocolSpecificErrorReason[e],this.streamId);if(this.state<=1){this.stopAudioProducer()}this.closed()};SiriAudioSession.prototype.sendDataSendCloseEvent=function(e){(0,n.default)(this.state>=1,"state was less than SENDING");(0,n.default)(this.state<=2,"state was higher than CLOSING");this.connection.sendEvent("dataSend","close",{streamId:new c.Int64(this.streamId),reason:new c.Int64(e)});this.closed()};SiriAudioSession.prototype.handleDataStreamConnectionClosed=function(){d("Closing audio session with streamId %d",this.streamId);if(this.state<=1){this.stopAudioProducer()}this.closed()};SiriAudioSession.prototype.closed=function(){var e=this.state;this.state=3;if(e!==3){this.emit("close");this.connection.removeListener("closed",this.closeListener)}this.removeAllListeners()};SiriAudioSession.prototype.popSome=function(){if(this.audioFrameQueue.length<5&&!this.endOfStream){return null}var e=Math.min(this.audioFrameQueue.length,5);var t=[];for(var r=0;r<e;r++){var i=this.audioFrameQueue.shift();t.push(i)}return t};return SiriAudioSession}(o.EventEmitter);t.SiriAudioSession=x},5691:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(6867);i.__exportStar(r(9955),t);i.__exportStar(r(3141),t);i.__exportStar(r(118),t);i.__exportStar(r(1706),t);i.__exportStar(r(5468),t)},427:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DataStreamManagement=t.DataStreamStatus=void 0;var i=r(6867);var n=i.__importDefault(r(7031));var a=r(8117);var o=r(877);var s=i.__importStar(r(2571));var c=r(4745);var u=(0,n.default)("HAP-NodeJS:DataStream:Management");var l;(function(e){e[e["TRANSFER_TRANSPORT_CONFIGURATION"]=1]="TRANSFER_TRANSPORT_CONFIGURATION"})(l||(l={}));var d;(function(e){e[e["TRANSPORT_TYPE"]=1]="TRANSPORT_TYPE"})(d||(d={}));var h;(function(e){e[e["SESSION_COMMAND_TYPE"]=1]="SESSION_COMMAND_TYPE";e[e["TRANSPORT_TYPE"]=2]="TRANSPORT_TYPE";e[e["CONTROLLER_KEY_SALT"]=3]="CONTROLLER_KEY_SALT"})(h||(h={}));var p;(function(e){e[e["STATUS"]=1]="STATUS";e[e["TRANSPORT_TYPE_SESSION_PARAMETERS"]=2]="TRANSPORT_TYPE_SESSION_PARAMETERS";e[e["ACCESSORY_KEY_SALT"]=3]="ACCESSORY_KEY_SALT"})(p||(p={}));var v;(function(e){e[e["TCP_LISTENING_PORT"]=1]="TCP_LISTENING_PORT"})(v||(v={}));var m;(function(e){e[e["HOMEKIT_DATA_STREAM"]=0]="HOMEKIT_DATA_STREAM"})(m||(m={}));var g;(function(e){e[e["START_SESSION"]=0]="START_SESSION"})(g||(g={}));var y;(function(e){e[e["SUCCESS"]=0]="SUCCESS";e[e["GENERIC_ERROR"]=1]="GENERIC_ERROR";e[e["BUSY"]=2]="BUSY"})(y=t.DataStreamStatus||(t.DataStreamStatus={}));var C=function(){function DataStreamManagement(e){this.dataStreamServer=new c.DataStreamServer;this.lastSetupDataStreamTransportResponse="";var t=[m.HOMEKIT_DATA_STREAM];this.supportedDataStreamTransportConfiguration=this.buildSupportedDataStreamTransportConfigurationTLV(t);this.dataStreamTransportManagementService=e||this.constructService();this.setupServiceHandlers()}DataStreamManagement.prototype.destroy=function(){this.dataStreamServer.destroy();this.dataStreamTransportManagementService.getCharacteristic(a.Characteristic.SetupDataStreamTransport).removeOnGet().removeAllListeners("set");this.lastSetupDataStreamTransportResponse=""};DataStreamManagement.prototype.getService=function(){return this.dataStreamTransportManagementService};DataStreamManagement.prototype.onEventMessage=function(e,t,r){this.dataStreamServer.onEventMessage(e,t,r);return this};DataStreamManagement.prototype.removeEventHandler=function(e,t,r){this.dataStreamServer.removeEventHandler(e,t,r);return this};DataStreamManagement.prototype.onRequestMessage=function(e,t,r){this.dataStreamServer.onRequestMessage(e,t,r);return this};DataStreamManagement.prototype.removeRequestHandler=function(e,t,r){this.dataStreamServer.removeRequestHandler(e,t,r);return this};DataStreamManagement.prototype.onServerEvent=function(e,t){this.dataStreamServer.on(e,t);return this};DataStreamManagement.prototype.handleSetupDataStreamTransportWrite=function(e,t,r){var i=this;var n=Buffer.from(e,"base64");var a=s.decode(n);var o=a[1][0];var c=a[2][0];var l=a[3];u("Received setup write with command %s and transport type %s",g[o],m[c]);if(o===g.START_SESSION){if(c!==m.HOMEKIT_DATA_STREAM||l.length!==32){t(-70410);return}this.dataStreamServer.prepareSession(r,l,(function(e,r){if(e||!r){t(e!==null&&e!==void 0?e:new Error("PreparedSession was undefined!"));return}var n=s.encode(1,s.writeUInt16(r.port));var a=Buffer.concat([s.encode(1,0),s.encode(2,n)]);i.lastSetupDataStreamTransportResponse=a.toString("base64");a=Buffer.concat([a,s.encode(3,r.accessoryKeySalt)]);t(null,a.toString("base64"))}))}else{t(-70410);return}};DataStreamManagement.prototype.buildSupportedDataStreamTransportConfigurationTLV=function(e){var t=[];e.forEach((function(e){var r=s.encode(1,e);var i=s.encode(1,r);t.push(i)}));return Buffer.concat(t).toString("base64")};DataStreamManagement.prototype.constructService=function(){var e=new o.Service.DataStreamTransportManagement("","");e.setCharacteristic(a.Characteristic.SupportedDataStreamTransportConfiguration,this.supportedDataStreamTransportConfiguration);e.setCharacteristic(a.Characteristic.Version,c.DataStreamServer.version);return e};DataStreamManagement.prototype.setupServiceHandlers=function(){var e=this;this.dataStreamTransportManagementService.getCharacteristic(a.Characteristic.SetupDataStreamTransport).onGet((function(){return e.lastSetupDataStreamTransportResponse})).on("set",(function(t,r,i,n){if(!n){u("Set event handler for SetupDataStreamTransport cannot be called from plugin! Connection undefined!");r(-70410);return}e.handleSetupDataStreamTransportWrite(t,r,n)})).updateValue(this.lastSetupDataStreamTransportResponse)};return DataStreamManagement}();t.DataStreamManagement=C},4601:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DataStreamWriter=t.DataStreamReader=t.DataStreamParser=t.DataFormatTags=t.UUID=t.SecondsSince2001=t.Float64=t.Float32=t.Int64=t.Int32=t.Int16=t.Int8=t.ValueWrapper=void 0;var i=r(6867);var n=i.__importStar(r(5752));var a=i.__importStar(r(6831));var o=i.__importDefault(r(9491));var s=i.__importDefault(r(7031));var c=(0,s.default)("HAP-NodeJS:DataStream:Parser");var u=function(){function Magics(){}Magics.TERMINATOR={type:"terminator"};return Magics}();var l=function(){function ValueWrapper(e){this.value=e}ValueWrapper.prototype.equals=function(e){return this.constructor.name===e.constructor.name&&e.value===this.value};return ValueWrapper}();t.ValueWrapper=l;var d=function(e){i.__extends(Int8,e);function Int8(){return e!==null&&e.apply(this,arguments)||this}return Int8}(l);t.Int8=d;var h=function(e){i.__extends(Int16,e);function Int16(){return e!==null&&e.apply(this,arguments)||this}return Int16}(l);t.Int16=h;var p=function(e){i.__extends(Int32,e);function Int32(){return e!==null&&e.apply(this,arguments)||this}return Int32}(l);t.Int32=p;var v=function(e){i.__extends(Int64,e);function Int64(){return e!==null&&e.apply(this,arguments)||this}return Int64}(l);t.Int64=v;var m=function(e){i.__extends(Float32,e);function Float32(){return e!==null&&e.apply(this,arguments)||this}return Float32}(l);t.Float32=m;var g=function(e){i.__extends(Float64,e);function Float64(){return e!==null&&e.apply(this,arguments)||this}return Float64}(l);t.Float64=g;var y=function(e){i.__extends(SecondsSince2001,e);function SecondsSince2001(){return e!==null&&e.apply(this,arguments)||this}return SecondsSince2001}(l);t.SecondsSince2001=y;var C=function(e){i.__extends(UUID,e);function UUID(t){(0,o.default)(n.isValid(t),"invalid uuid format");return e.call(this,t)||this}return UUID}(l);t.UUID=C;var T;(function(e){e[e["INVALID"]=0]="INVALID";e[e["TRUE"]=1]="TRUE";e[e["FALSE"]=2]="FALSE";e[e["TERMINATOR"]=3]="TERMINATOR";e[e["NULL"]=4]="NULL";e[e["UUID"]=5]="UUID";e[e["DATE"]=6]="DATE";e[e["INTEGER_MINUS_ONE"]=7]="INTEGER_MINUS_ONE";e[e["INTEGER_RANGE_START_0"]=8]="INTEGER_RANGE_START_0";e[e["INTEGER_RANGE_STOP_39"]=46]="INTEGER_RANGE_STOP_39";e[e["INT8"]=48]="INT8";e[e["INT16LE"]=49]="INT16LE";e[e["INT32LE"]=50]="INT32LE";e[e["INT64LE"]=51]="INT64LE";e[e["FLOAT32LE"]=53]="FLOAT32LE";e[e["FLOAT64LE"]=54]="FLOAT64LE";e[e["UTF8_LENGTH_START"]=64]="UTF8_LENGTH_START";e[e["UTF8_LENGTH_STOP"]=96]="UTF8_LENGTH_STOP";e[e["UTF8_LENGTH8"]=97]="UTF8_LENGTH8";e[e["UTF8_LENGTH16LE"]=98]="UTF8_LENGTH16LE";e[e["UTF8_LENGTH32LE"]=99]="UTF8_LENGTH32LE";e[e["UTF8_LENGTH64LE"]=100]="UTF8_LENGTH64LE";e[e["UTF8_NULL_TERMINATED"]=111]="UTF8_NULL_TERMINATED";e[e["DATA_LENGTH_START"]=112]="DATA_LENGTH_START";e[e["DATA_LENGTH_STOP"]=144]="DATA_LENGTH_STOP";e[e["DATA_LENGTH8"]=145]="DATA_LENGTH8";e[e["DATA_LENGTH16LE"]=146]="DATA_LENGTH16LE";e[e["DATA_LENGTH32LE"]=147]="DATA_LENGTH32LE";e[e["DATA_LENGTH64LE"]=148]="DATA_LENGTH64LE";e[e["DATA_TERMINATED"]=159]="DATA_TERMINATED";e[e["COMPRESSION_START"]=160]="COMPRESSION_START";e[e["COMPRESSION_STOP"]=207]="COMPRESSION_STOP";e[e["ARRAY_LENGTH_START"]=208]="ARRAY_LENGTH_START";e[e["ARRAY_LENGTH_STOP"]=222]="ARRAY_LENGTH_STOP";e[e["ARRAY_TERMINATED"]=223]="ARRAY_TERMINATED";e[e["DICTIONARY_LENGTH_START"]=224]="DICTIONARY_LENGTH_START";e[e["DICTIONARY_LENGTH_STOP"]=238]="DICTIONARY_LENGTH_STOP";e[e["DICTIONARY_TERMINATED"]=239]="DICTIONARY_TERMINATED"})(T=t.DataFormatTags||(t.DataFormatTags={}));var E=function(){function DataStreamParser(){}DataStreamParser.decode=function(e){var t=e.readTag();if(t===0){throw new Error("HDSDecoder: zero tag detected on index "+e.readerIndex)}else if(t===1){return e.readTrue()}else if(t===2){return e.readFalse()}else if(t===3){return u.TERMINATOR}else if(t===4){return null}else if(t===5){return e.readUUID()}else if(t===6){return e.readSecondsSince2001_01_01()}else if(t===7){return e.readNegOne()}else if(t>=8&&t<=46){return e.readIntRange(t)}else if(t===48){return e.readInt8()}else if(t===49){return e.readInt16LE()}else if(t===50){return e.readInt32LE()}else if(t===51){return e.readInt64LE()}else if(t===53){return e.readFloat32LE()}else if(t===54){return e.readFloat64LE()}else if(t>=64&&t<=96){var r=t-64;return e.readUTF8(r)}else if(t===97){return e.readUTF8_Length8()}else if(t===98){return e.readUTF8_Length16LE()}else if(t===99){return e.readUTF8_Length32LE()}else if(t===100){return e.readUTF8_Length64LE()}else if(t===111){return e.readUTF8_NULL_terminated()}else if(t>=112&&t<=144){var r=t-112;e.readData(r)}else if(t===145){return e.readData_Length8()}else if(t===146){return e.readData_Length16LE()}else if(t===147){return e.readData_Length32LE()}else if(t===148){return e.readData_Length64LE()}else if(t===159){return e.readData_terminated()}else if(t>=160&&t<=207){var i=t-160;return e.decompressData(i)}else if(t>=208&&t<=222){var r=t-208;var n=[];for(var a=0;a<r;a++){n.push(this.decode(e))}return n}else if(t===223){var n=[];var o=void 0;while((o=this.decode(e))!==u.TERMINATOR){n.push(o)}return n}else if(t>=224&&t<=238){var r=t-224;var s={};for(var a=0;a<r;a++){var c=this.decode(e);s[c]=this.decode(e)}return s}else if(t===239){var s={};var c=void 0;while((c=this.decode(e))!==u.TERMINATOR){s[c]=this.decode(e)}return s}else{throw new Error("HDSDecoder: encountered unknown tag on index "+e.readerIndex+": "+t.toString(16))}};DataStreamParser.encode=function(e,t){var r=this;if(e===undefined){throw new Error("HDSEncoder: cannot encode undefined")}if(e===null){t.writeTag(4);return}switch(typeof e){case"boolean":if(e){t.writeTrue()}else{t.writeFalse()}break;case"number":if(Number.isInteger(e)){t.writeNumber(e)}else{t.writeFloat64LE(new g(e))}break;case"string":t.writeUTF8(e);break;case"object":if(Array.isArray(e)){var i=e.length;if(i<=12){t.writeTag(208+i)}else{t.writeTag(223)}e.forEach((function(e){r.encode(e,t)}));if(i>12){t.writeTag(3)}}else if(e instanceof l){if(e instanceof d){t.writeInt8(e)}else if(e instanceof h){t.writeInt16LE(e)}else if(e instanceof p){t.writeInt32LE(e)}else if(e instanceof v){t.writeInt64LE(e)}else if(e instanceof m){t.writeFloat32LE(e)}else if(e instanceof g){t.writeFloat64LE(e)}else if(e instanceof y){t.writeSecondsSince2001_01_01(e)}else if(e instanceof C){t.writeUUID(e.value)}else{throw new Error("Unknown wrapped object 'ValueWrapper' of class "+e.constructor.name)}}else if(e instanceof Buffer){t.writeData(e)}else{var n=Object.entries(e).filter((function(e){return e[1]!==undefined}));if(n.length<=14){t.writeTag(224+n.length)}else{t.writeTag(239)}n.forEach((function(e){r.encode(e[0],t);r.encode(e[1],t)}));if(n.length>14){t.writeTag(3)}}break;default:throw new Error("HDSEncoder: no idea how to encode value of type '"+typeof e+"': "+e)}};return DataStreamParser}();t.DataStreamParser=E;var D=function(){function DataStreamReader(e){this.trackedCompressedData=[];this.data=e;this.readerIndex=0}DataStreamReader.prototype.finished=function(){if(this.readerIndex<this.data.length){var e=this.data.slice(this.readerIndex,this.data.length).toString("hex");c("WARNING Finished reading HDS stream, but there are still %d bytes remaining () %s",this.data.length-this.readerIndex,e)}};DataStreamReader.prototype.decompressData=function(e){if(e>=this.trackedCompressedData.length){throw new Error("HDSDecoder: Tried decompression of data for an index out of range (index "+e+" and got "+this.trackedCompressedData.length+" elements)")}return this.trackedCompressedData[e]};DataStreamReader.prototype.trackData=function(e){this.trackedCompressedData.push(e);return e};DataStreamReader.prototype.ensureLength=function(e){if(this.readerIndex+e>this.data.length){var t=this.data.length-this.readerIndex;throw new Error("HDSDecoder: End of data stream. Tried reading "+e+" bytes however got only "+t+" remaining!")}};DataStreamReader.prototype.readTag=function(){this.ensureLength(1);return this.data.readUInt8(this.readerIndex++)};DataStreamReader.prototype.readTrue=function(){return this.trackData(true)};DataStreamReader.prototype.readFalse=function(){return this.trackData(false)};DataStreamReader.prototype.readNegOne=function(){return this.trackData(-1)};DataStreamReader.prototype.readIntRange=function(e){return this.trackData(e-8)};DataStreamReader.prototype.readInt8=function(){this.ensureLength(1);return this.trackData(this.data.readInt8(this.readerIndex++))};DataStreamReader.prototype.readInt16LE=function(){this.ensureLength(2);var e=this.data.readInt16LE(this.readerIndex);this.readerIndex+=2;return this.trackData(e)};DataStreamReader.prototype.readInt32LE=function(){this.ensureLength(4);var e=this.data.readInt32LE(this.readerIndex);this.readerIndex+=4;return this.trackData(e)};DataStreamReader.prototype.readInt64LE=function(){this.ensureLength(8);var e=this.data.readInt32LE(this.readerIndex);var t=this.data.readInt32LE(this.readerIndex+4)*4294967296+e;if(e<0){t+=4294967296}this.readerIndex+=8;return this.trackData(t)};DataStreamReader.prototype.readFloat32LE=function(){this.ensureLength(4);var e=this.data.readFloatLE(this.readerIndex);this.readerIndex+=4;return this.trackData(e)};DataStreamReader.prototype.readFloat64LE=function(){this.ensureLength(8);var e=this.data.readDoubleLE(this.readerIndex);return this.trackData(e)};DataStreamReader.prototype.readLength8=function(){this.ensureLength(1);return this.data.readUInt8(this.readerIndex++)};DataStreamReader.prototype.readLength16LE=function(){this.ensureLength(2);var e=this.data.readUInt16LE(this.readerIndex);this.readerIndex+=2;return e};DataStreamReader.prototype.readLength32LE=function(){this.ensureLength(4);var e=this.data.readUInt32LE(this.readerIndex);this.readerIndex+=4;return e};DataStreamReader.prototype.readLength64LE=function(){this.ensureLength(8);var e=this.data.readUInt32LE(this.readerIndex);var t=this.data.readUInt32LE(this.readerIndex+4)*4294967296+e;this.readerIndex+=8;return t};DataStreamReader.prototype.readUTF8=function(e){this.ensureLength(e);var t=this.data.toString("utf8",this.readerIndex,this.readerIndex+e);this.readerIndex+=e;return this.trackData(t)};DataStreamReader.prototype.readUTF8_Length8=function(){var e=this.readLength8();return this.readUTF8(e)};DataStreamReader.prototype.readUTF8_Length16LE=function(){var e=this.readLength16LE();return this.readUTF8(e)};DataStreamReader.prototype.readUTF8_Length32LE=function(){var e=this.readLength32LE();return this.readUTF8(e)};DataStreamReader.prototype.readUTF8_Length64LE=function(){var e=this.readLength64LE();return this.readUTF8(e)};DataStreamReader.prototype.readUTF8_NULL_terminated=function(){var e=this.readerIndex;var t;for(;;){t=this.data[e];if(t===undefined){throw new Error("HDSDecoder: Reached end of data stream while reading NUL terminated string!")}else if(t===0){break}else{e++}}var r=this.data.toString("utf8",this.readerIndex,e);this.readerIndex=e+1;return this.trackData(r)};DataStreamReader.prototype.readData=function(e){this.ensureLength(e);var t=this.data.slice(this.readerIndex,this.readerIndex+e);this.readerIndex+=e;return this.trackData(t)};DataStreamReader.prototype.readData_Length8=function(){var e=this.readLength8();return this.readData(e)};DataStreamReader.prototype.readData_Length16LE=function(){var e=this.readLength16LE();return this.readData(e)};DataStreamReader.prototype.readData_Length32LE=function(){var e=this.readLength32LE();return this.readData(e)};DataStreamReader.prototype.readData_Length64LE=function(){var e=this.readLength64LE();return this.readData(e)};DataStreamReader.prototype.readData_terminated=function(){var e=this.readerIndex;var t;for(;;){t=this.data[e];if(t===undefined){throw new Error("HDSDecoder: Reached end of data stream while reading terminated data!")}else if(t===3){break}else{e++}}var r=this.data.slice(this.readerIndex,e);this.readerIndex=e+1;return this.trackData(r)};DataStreamReader.prototype.readSecondsSince2001_01_01=function(){return this.readFloat64LE()};DataStreamReader.prototype.readUUID=function(){this.ensureLength(16);var e=n.unparse(this.data,this.readerIndex);this.readerIndex+=16;return this.trackData(e)};return DataStreamReader}();t.DataStreamReader=D;var _=function(){function WrittenDataList(){this.writtenData=[]}WrittenDataList.prototype.push=function(e){this.writtenData.push(e)};WrittenDataList.prototype.indexOf=function(e){for(var t=0;t<this.writtenData.length;t++){var r=this.writtenData[t];if(e===r){return t}if(e instanceof l&&r instanceof l){if(e.equals(r)){return t}}}return-1};return WrittenDataList}();var I=function(){function DataStreamWriter(){this.writtenData=new _;this.data=Buffer.alloc(DataStreamWriter.chunkSize);this.writerIndex=0}DataStreamWriter.prototype.length=function(){return this.writerIndex};DataStreamWriter.prototype.getData=function(){return this.data.slice(0,this.writerIndex)};DataStreamWriter.prototype.ensureLength=function(e){var t=this.writerIndex+e-this.data.length;if(t>0){var r=Math.ceil(t/DataStreamWriter.chunkSize);this.data=Buffer.concat([this.data,Buffer.alloc(r*DataStreamWriter.chunkSize)])}};DataStreamWriter.prototype.compressDataIfPossible=function(e){var t=this.writtenData.indexOf(e);if(t<0){this.writtenData.push(e);return false}else if(t<=207-160){this.writeTag(160+t);return true}return false};DataStreamWriter.prototype.writeTag=function(e){this.ensureLength(1);this.data.writeUInt8(e,this.writerIndex++)};DataStreamWriter.prototype.writeTrue=function(){this.writeTag(1)};DataStreamWriter.prototype.writeFalse=function(){this.writeTag(2)};DataStreamWriter.prototype.writeNumber=function(e){if(e===-1){this.writeTag(7)}else if(e>=0&&e<=39){this.writeTag(8+e)}else if(e>=-128&&e<=127){this.writeInt8(new d(e))}else if(e>=-32768&&e<=32767){this.writeInt16LE(new h(e))}else if(e>=-2147483648&&e<=-2147483648){this.writeInt32LE(new p(e))}else if(e>=Number.MIN_SAFE_INTEGER&&e<=Number.MAX_SAFE_INTEGER){this.writeInt64LE(new v(e))}else{throw new Error("Tried writing unrepresentable number ("+e+")")}};DataStreamWriter.prototype.writeInt8=function(e){if(this.compressDataIfPossible(e)){return}this.ensureLength(2);this.writeTag(48);this.data.writeInt8(e.value,this.writerIndex++)};DataStreamWriter.prototype.writeInt16LE=function(e){if(this.compressDataIfPossible(e)){return}this.ensureLength(3);this.writeTag(49);this.data.writeInt16LE(e.value,this.writerIndex);this.writerIndex+=2};DataStreamWriter.prototype.writeInt32LE=function(e){if(this.compressDataIfPossible(e)){return}this.ensureLength(5);this.writeTag(50);this.data.writeInt32LE(e.value,this.writerIndex);this.writerIndex+=4};DataStreamWriter.prototype.writeInt64LE=function(e){if(this.compressDataIfPossible(e)){return}this.ensureLength(9);this.writeTag(51);this.data.writeUInt32LE(e.value,this.writerIndex);this.data.writeUInt32LE(0,this.writerIndex+4);this.writerIndex+=8};DataStreamWriter.prototype.writeFloat32LE=function(e){if(this.compressDataIfPossible(e)){return}this.ensureLength(5);this.writeTag(53);this.data.writeFloatLE(e.value,this.writerIndex);this.writerIndex+=4};DataStreamWriter.prototype.writeFloat64LE=function(e){if(this.compressDataIfPossible(e)){return}this.ensureLength(9);this.writeTag(54);this.data.writeDoubleLE(e.value,this.writerIndex);this.writerIndex+=8};DataStreamWriter.prototype.writeLength8=function(e){this.ensureLength(1);this.data.writeUInt8(e,this.writerIndex++)};DataStreamWriter.prototype.writeLength16LE=function(e){this.ensureLength(2);this.data.writeUInt16LE(e,this.writerIndex);this.writerIndex+=2};DataStreamWriter.prototype.writeLength32LE=function(e){this.ensureLength(4);this.data.writeUInt32LE(e,this.writerIndex);this.writerIndex+=4};DataStreamWriter.prototype.writeLength64LE=function(e){this.ensureLength(8);a.writeUInt64LE(e,this.data,this.writerIndex);this.writerIndex+=8};DataStreamWriter.prototype.writeUTF8=function(e){if(this.compressDataIfPossible(e)){return}var t=Buffer.byteLength(e);if(t<=32){this.ensureLength(1+t);this.writeTag(64+e.length);this._writeUTF8(e)}else if(t<=255){this.writeUTF8_Length8(e)}else if(t<=65535){this.writeUTF8_Length16LE(e)}else if(t<=4294967295){this.writeUTF8_Length32LE(e)}else if(t<=Number.MAX_SAFE_INTEGER){this.writeUTF8_Length64LE(e)}else{this.writeUTF8_NULL_terminated(e)}};DataStreamWriter.prototype._writeUTF8=function(e){var t=Buffer.byteLength(e);this.ensureLength(t);this.data.write(e,this.writerIndex,undefined,"utf8");this.writerIndex+=t};DataStreamWriter.prototype.writeUTF8_Length8=function(e){var t=Buffer.byteLength(e);this.ensureLength(2+t);this.writeTag(97);this.writeLength8(t);this._writeUTF8(e)};DataStreamWriter.prototype.writeUTF8_Length16LE=function(e){var t=Buffer.byteLength(e);this.ensureLength(3+t);this.writeTag(98);this.writeLength16LE(t);this._writeUTF8(e)};DataStreamWriter.prototype.writeUTF8_Length32LE=function(e){var t=Buffer.byteLength(e);this.ensureLength(5+t);this.writeTag(99);this.writeLength32LE(t);this._writeUTF8(e)};DataStreamWriter.prototype.writeUTF8_Length64LE=function(e){var t=Buffer.byteLength(e);this.ensureLength(9+t);this.writeTag(100);this.writeLength64LE(t);this._writeUTF8(e)};DataStreamWriter.prototype.writeUTF8_NULL_terminated=function(e){this.ensureLength(1+Buffer.byteLength(e)+1);this.writeTag(111);this._writeUTF8(e);this.data.writeUInt8(0,this.writerIndex++)};DataStreamWriter.prototype.writeData=function(e){if(this.compressDataIfPossible(e)){return}if(e.length<=32){this.writeTag(112+e.length);this._writeData(e)}else if(e.length<=255){this.writeData_Length8(e)}else if(e.length<=65535){this.writeData_Length16LE(e)}else if(e.length<=4294967295){this.writeData_Length32LE(e)}else if(e.length<=Number.MAX_SAFE_INTEGER){this.writeData_Length64LE(e)}else{this.writeData_terminated(e)}};DataStreamWriter.prototype._writeData=function(e){this.ensureLength(e.length);for(var t=0;t<e.length;t++){this.data[this.writerIndex++]=e[t]}};DataStreamWriter.prototype.writeData_Length8=function(e){this.ensureLength(2+e.length);this.writeTag(145);this.writeLength8(e.length);this._writeData(e)};DataStreamWriter.prototype.writeData_Length16LE=function(e){this.ensureLength(3+e.length);this.writeTag(146);this.writeLength16LE(e.length);this._writeData(e)};DataStreamWriter.prototype.writeData_Length32LE=function(e){this.ensureLength(5+e.length);this.writeTag(147);this.writeLength32LE(e.length);this._writeData(e)};DataStreamWriter.prototype.writeData_Length64LE=function(e){this.ensureLength(9+e.length);this.writeTag(148);this.writeLength64LE(e.length);this._writeData(e)};DataStreamWriter.prototype.writeData_terminated=function(e){this.ensureLength(1+e.length+1);this.writeTag(159);this._writeData(e);this.writeTag(3)};DataStreamWriter.prototype.writeSecondsSince2001_01_01=function(e){if(this.compressDataIfPossible(e)){return}this.ensureLength(9);this.writeTag(6);this.data.writeDoubleLE(e.value,this.writerIndex);this.writerIndex+=8};DataStreamWriter.prototype.writeUUID=function(e){(0,o.default)(n.isValid(e),"supplied uuid is invalid");if(this.compressDataIfPossible(new C(e))){return}this.ensureLength(17);this.writeTag(5);n.write(e,this.data,this.writerIndex);this.writerIndex+=16};DataStreamWriter.chunkSize=128;return DataStreamWriter}();t.DataStreamWriter=I},4745:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DataStreamConnection=t.HDSConnectionError=t.HDSConnectionErrorType=t.DataStreamConnectionEvent=t.DataStreamServer=t.DataStreamServerEvent=t.MessageType=t.HDSProtocolError=t.HDSProtocolSpecificErrorReason=t.HDSStatus=t.Topics=t.Protocols=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=i.__importDefault(r(6113));var o=i.__importDefault(r(7031));var s=r(2361);var c=i.__importDefault(r(1808));var u=i.__importStar(r(6831));var l=r(4601);var d=(0,o.default)("HAP-NodeJS:DataStream:Server");var h;(function(e){e["CONTROL"]="control";e["TARGET_CONTROL"]="targetControl";e["DATA_SEND"]="dataSend"})(h=t.Protocols||(t.Protocols={}));var p;(function(e){e["HELLO"]="hello";e["WHOAMI"]="whoami";e["OPEN"]="open";e["DATA"]="data";e["ACK"]="ack";e["CLOSE"]="close"})(p=t.Topics||(t.Topics={}));var v;(function(e){e[e["SUCCESS"]=0]="SUCCESS";e[e["OUT_OF_MEMORY"]=1]="OUT_OF_MEMORY";e[e["TIMEOUT"]=2]="TIMEOUT";e[e["HEADER_ERROR"]=3]="HEADER_ERROR";e[e["PAYLOAD_ERROR"]=4]="PAYLOAD_ERROR";e[e["MISSING_PROTOCOL"]=5]="MISSING_PROTOCOL";e[e["PROTOCOL_SPECIFIC_ERROR"]=6]="PROTOCOL_SPECIFIC_ERROR"})(v=t.HDSStatus||(t.HDSStatus={}));var m;(function(e){e[e["NORMAL"]=0]="NORMAL";e[e["NOT_ALLOWED"]=1]="NOT_ALLOWED";e[e["BUSY"]=2]="BUSY";e[e["CANCELLED"]=3]="CANCELLED";e[e["UNSUPPORTED"]=4]="UNSUPPORTED";e[e["UNEXPECTED_FAILURE"]=5]="UNEXPECTED_FAILURE";e[e["TIMEOUT"]=6]="TIMEOUT";e[e["BAD_DATA"]=7]="BAD_DATA";e[e["PROTOCOL_ERROR"]=8]="PROTOCOL_ERROR";e[e["INVALID_CONFIGURATION"]=9]="INVALID_CONFIGURATION"})(m=t.HDSProtocolSpecificErrorReason||(t.HDSProtocolSpecificErrorReason={}));var g=function(e){i.__extends(HDSProtocolError,e);function HDSProtocolError(t){var r=e.call(this,"HDSProtocolError: "+t)||this;(0,n.default)(t!==0,"Cannot initialize a HDSProtocolError with NORMAL!");r.reason=t;return r}return HDSProtocolError}(Error);t.HDSProtocolError=g;var y;(function(e){e[e["UNINITIALIZED"]=0]="UNINITIALIZED";e[e["BINDING"]=1]="BINDING";e[e["LISTENING"]=2]="LISTENING";e[e["CLOSING"]=3]="CLOSING"})(y||(y={}));var C;(function(e){e[e["UNIDENTIFIED"]=0]="UNIDENTIFIED";e[e["EXPECTING_HELLO"]=1]="EXPECTING_HELLO";e[e["READY"]=2]="READY";e[e["CLOSING"]=3]="CLOSING";e[e["CLOSED"]=4]="CLOSED"})(C||(C={}));var T;(function(e){e[e["EVENT"]=1]="EVENT";e[e["REQUEST"]=2]="REQUEST";e[e["RESPONSE"]=3]="RESPONSE"})(T=t.MessageType||(t.MessageType={}));var E;(function(e){e["CONNECTION_OPENED"]="connection-opened";e["CONNECTION_CLOSED"]="connection-closed"})(E=t.DataStreamServerEvent||(t.DataStreamServerEvent={}));var D=function(e){i.__extends(DataStreamServer,e);function DataStreamServer(){var t=e.call(this)||this;t.state=0;t.preparedSessions=[];t.connections=[];t.removeListenersOnceClosed=false;t.internalEventEmitter=new s.EventEmitter;return t}DataStreamServer.prototype.onEventMessage=function(e,t,r){this.internalEventEmitter.on(e+"-e-"+t,r);return this};DataStreamServer.prototype.removeEventHandler=function(e,t,r){this.internalEventEmitter.removeListener(e+"-e-"+t,r);return this};DataStreamServer.prototype.onRequestMessage=function(e,t,r){this.internalEventEmitter.on(e+"-r-"+t,r);return this};DataStreamServer.prototype.removeRequestHandler=function(e,t,r){this.internalEventEmitter.removeListener(e+"-r-"+t,r);return this};DataStreamServer.prototype.prepareSession=function(e,t,r){var i=this;d("Preparing for incoming HDS connection from %s",e.sessionID);var n=a.default.randomBytes(32);var o=Buffer.concat([t,n]);var s=u.HKDF("sha512",o,e.encryption.sharedSecret,DataStreamServer.accessoryToControllerInfo,32);var c=u.HKDF("sha512",o,e.encryption.sharedSecret,DataStreamServer.controllerToAccessoryInfo,32);var l={connection:e,accessoryToControllerEncryptionKey:s,controllerToAccessoryEncryptionKey:c,accessoryKeySalt:n,connectTimeout:setTimeout((function(){return i.timeoutPreparedSession(l)}),1e4)};l.connectTimeout.unref();this.preparedSessions.push(l);this.checkTCPServerEstablished(l,(function(e){if(e){r(e)}else{r(undefined,l)}}))};DataStreamServer.prototype.timeoutPreparedSession=function(e){d("Prepared HDS session timed out out since no connection was opened for 10 seconds (%s)",e.connection.sessionID);var t=this.preparedSessions.indexOf(e);if(t>=0){this.preparedSessions.splice(t,1)}this.checkCloseable()};DataStreamServer.prototype.checkTCPServerEstablished=function(e,t){var r=this;switch(this.state){case 0:d("Starting up TCP server.");this.tcpServer=c.default.createServer();this.tcpServer.once("listening",this.listening.bind(this,e,t));this.tcpServer.on("connection",this.onConnection.bind(this));this.tcpServer.on("close",this.closed.bind(this));this.tcpServer.listen();this.state=1;break;case 1:d("TCP server already running. Waiting for it to bind.");this.tcpServer.once("listening",this.listening.bind(this,e,t));break;case 2:d("Instructing client to connect to already running TCP server");e.port=this.tcpPort;t();break;case 3:d("TCP socket is currently closing. Trying again when server is fully closed and opening a new one then.");this.tcpServer.once("close",(function(){return setTimeout((function(){return r.checkTCPServerEstablished(e,t)}),10)}));break}};DataStreamServer.prototype.listening=function(e,t){this.state=2;var r=this.tcpServer.address();if(r&&typeof r!=="string"){this.tcpPort=r.port;e.port=r.port;d("TCP server is now listening for new data stream connections on port %s",r.port);t()}};DataStreamServer.prototype.onConnection=function(e){d("[%s] New DataStream connection was established",e.remoteAddress);var t=new w(e);t.on("identification",this.handleSessionIdentification.bind(this,t));t.on("handle-message-globally",this.handleMessageGlobally.bind(this,t));t.on("closed",this.connectionClosed.bind(this,t));this.connections.push(t);this.emit("connection-opened",t)};DataStreamServer.prototype.handleSessionIdentification=function(e,t,r){var i=undefined;for(var n=0;n<this.preparedSessions.length;n++){var a=this.preparedSessions[n];if(e.decryptHDSFrame(t,a.controllerToAccessoryEncryptionKey)){i=a;break}}r(i);if(i){d("[%s] Connection was successfully identified (linked with sessionId: %s)",e.remoteAddress,i.connection.sessionID);var o=this.preparedSessions.indexOf(i);if(o>=0){this.preparedSessions.splice(o,1)}clearTimeout(i.connectTimeout);i.connectTimeout=undefined}else{d("[%s] Could not identify connection. Terminating.",e.remoteAddress);e.close()}};DataStreamServer.prototype.handleMessageGlobally=function(e,t){var r;n.default.notStrictEqual(t.type,3);var a="";var o=[];if(t.type===1){a="-e-"}else if(t.type===2){a="-r-";o.push(t.id)}o.push(t.message);var s;try{s=(r=this.internalEventEmitter).emit.apply(r,i.__spreadArray([t.protocol+a+t.topic,e],i.__read(o),false))}catch(r){s=true;d("[%s] Error occurred while dispatching handler for HDS message: %o",e.remoteAddress,t);d(r.stack)}if(!s){d("[%s] WARNING no handler was found for message: %o",e.remoteAddress,t)}};DataStreamServer.prototype.connectionClosed=function(e){d("[%s] DataStream connection closed",e.remoteAddress);this.connections.splice(this.connections.indexOf(e),1);this.emit("connection-closed",e);this.checkCloseable();if(this.state===3&&this.removeListenersOnceClosed&&this.connections.length===0){this.removeAllListeners()}};DataStreamServer.prototype.checkCloseable=function(){if(this.connections.length===0&&this.preparedSessions.length===0&&this.state<3){d("Last connection disconnected. Closing the server now.");this.state=3;this.tcpServer.close()}};DataStreamServer.prototype.destroy=function(){var e,t;if(this.state>0&&this.state<3){this.tcpServer.close();try{for(var r=i.__values(this.connections),n=r.next();!n.done;n=r.next()){var a=n.value;a.close()}}catch(t){e={error:t}}finally{try{if(n&&!n.done&&(t=r.return))t.call(r)}finally{if(e)throw e.error}}}this.state=3;this.removeListenersOnceClosed=true;this.internalEventEmitter.removeAllListeners()};DataStreamServer.prototype.closed=function(){this.tcpServer=undefined;this.tcpPort=undefined;this.state=0};DataStreamServer.version="1.0";DataStreamServer.accessoryToControllerInfo=Buffer.from("HDS-Read-Encryption-Key");DataStreamServer.controllerToAccessoryInfo=Buffer.from("HDS-Write-Encryption-Key");return DataStreamServer}(s.EventEmitter);t.DataStreamServer=D;var _;(function(e){e["IDENTIFICATION"]="identification";e["HANDLE_MESSAGE_GLOBALLY"]="handle-message-globally";e["CLOSED"]="closed"})(_=t.DataStreamConnectionEvent||(t.DataStreamConnectionEvent={}));var I;(function(e){e[e["ILLEGAL_STATE"]=1]="ILLEGAL_STATE";e[e["CLOSED_SOCKET"]=2]="CLOSED_SOCKET";e[e["MAX_PAYLOAD_LENGTH"]=3]="MAX_PAYLOAD_LENGTH"})(I=t.HDSConnectionErrorType||(t.HDSConnectionErrorType={}));var b=function(e){i.__extends(HDSConnectionError,e);function HDSConnectionError(t,r){var i=e.call(this,t)||this;i.type=r;return i}return HDSConnectionError}(Error);t.HDSConnectionError=b;var w=function(e){i.__extends(DataStreamConnection,e);function DataStreamConnection(t){var r;var i=e.call(this)||this;i.state=0;i.protocolHandlers={};i.responseHandlers={};i.responseTimers={};i.socket=t;i.remoteAddress=t.remoteAddress;i.socket.setNoDelay(true);i.socket.setKeepAlive(true);i.accessoryToControllerNonce=0;i.accessoryToControllerNonceBuffer=Buffer.alloc(8);i.controllerToAccessoryNonce=0;i.controllerToAccessoryNonceBuffer=Buffer.alloc(8);i.hapConnectionClosedListener=i.onHAPSessionClosed.bind(i);i.addProtocolHandler("control",{requestHandler:(r={},r["hello"]=i.handleHello.bind(i),r)});i.helloTimer=setTimeout((function(){d("[%s] Hello message did not arrive in time. Killing the connection",i.remoteAddress);i.close()}),1e4);i.socket.on("data",i.onSocketData.bind(i));i.socket.on("error",i.onSocketError.bind(i));i.socket.on("close",i.onSocketClose.bind(i));i.setMaxListeners(100);return i}DataStreamConnection.prototype.handleHello=function(e,t){d("[%s] Received hello message from client: %o",this.remoteAddress,t);clearTimeout(this.helloTimer);this.helloTimer=undefined;this.state=2;this.sendResponse("control","hello",e)};DataStreamConnection.prototype.addProtocolHandler=function(e,t){if(this.protocolHandlers[e]!==undefined){return false}this.protocolHandlers[e]=t;return true};DataStreamConnection.prototype.removeProtocolHandler=function(e,t){var r=this.protocolHandlers[e];if(r===t){delete this.protocolHandlers[e]}};DataStreamConnection.prototype.sendEvent=function(e,t,r){if(r===void 0){r={}}var i={};i.protocol=e;i.event=t;this.sendHDSFrame(i,r)};DataStreamConnection.prototype.sendRequest=function(e,t,r,i){var n=this;if(r===void 0){r={}}var a;do{a=Math.floor(Math.random()*4294967295)}while(this.responseHandlers[a]!==undefined);this.responseHandlers[a]=i;this.responseTimers[a]=setTimeout((function(){n.close();var e=n.responseHandlers[a];delete n.responseHandlers[a];delete n.responseTimers[a];e(new Error("timeout"),undefined,{})}),1e4);var o={};o.protocol=e;o.request=t;o.id=new l.Int64(a);this.sendHDSFrame(o,r)};DataStreamConnection.prototype.sendResponse=function(e,t,r,i,n){if(i===void 0){i=v.SUCCESS}if(n===void 0){n={}}var a={};a.protocol=e;a.response=t;a.id=new l.Int64(r);a.status=new l.Int64(i);this.sendHDSFrame(a,n)};DataStreamConnection.prototype.onSocketData=function(e){var t=this;if(this.state>=3){return}var r=0;var i=this.decodeHDSFrames(e);if(i.length===0){return}if(this.state===0){var n=i[r++];this.emit("identification",n,(function(e){if(e){t.connection=e.connection;t.accessoryToControllerEncryptionKey=e.accessoryToControllerEncryptionKey;t.controllerToAccessoryEncryptionKey=e.controllerToAccessoryEncryptionKey;t.state=1;t.connection.on("closed",t.hapConnectionClosedListener);d("[%s] Registering CLOSED handler to HAP connection. Connection currently has %d close handlers!",t.remoteAddress,t.connection.listeners("closed").length)}}));if(this.state===0){return}}for(;r<i.length;r++){if(!this.decryptHDSFrame(i[r])){d("[%s] HDS frame decryption or authentication failed. Connection will be terminated!",this.remoteAddress);this.close();return}}var a=this.decodePayloads(i);if(this.state===1){var o=a[0];if(o.protocol!=="control"||o.type!==2||o.topic!=="hello"){d("[%s] First message received was not the expected hello message. Instead got: %o",this.remoteAddress,o);this.close();return}}a.forEach((function(e){if(e.type===3){var r=t.responseHandlers[e.id];var i=t.responseTimers[e.id];if(i){clearTimeout(i);delete t.responseTimers[e.id]}if(!r){d("WARNING we received a response to a request we have not sent: %o",e);return}try{r(undefined,e.status,e.message)}catch(r){d("[%s] Error occurred while dispatching response handler for HDS message: %o",t.remoteAddress,e);d(r.stack)}delete t.responseHandlers[e.id]}else{var n=t.protocolHandlers[e.protocol];if(n===undefined){t.emit("handle-message-globally",e);return}if(e.type===1){var a=void 0;if(!n.eventHandler||!(a=n.eventHandler[e.topic])){d("[%s] WARNING no event handler was found for message: %o",t.remoteAddress,e);return}try{a(e.message)}catch(r){d("[%s] Error occurred while dispatching event handler for HDS message: %o",t.remoteAddress,e);d(r.stack)}}else if(e.type===2){var o=void 0;if(!n.requestHandler||!(o=n.requestHandler[e.topic])){d("[%s] WARNING no request handler was found for message: %o",t.remoteAddress,e);return}try{o(e.id,e.message)}catch(r){d("[%s] Error occurred while dispatching request handler for HDS message: %o",t.remoteAddress,e);d(r.stack)}}else{d("[%s] Encountered unknown message type with id %d",t.remoteAddress,e.type)}}}))};DataStreamConnection.prototype.decodeHDSFrames=function(e){if(this.frameBuffer!==undefined){e=Buffer.concat([this.frameBuffer,e]);this.frameBuffer=undefined}var t=e.length;var r=[];for(var i=0;i<t;){if(i+4>t){this.frameBuffer=e.slice(i);break}var n=e.readUInt8(i);var a=e.readUIntBE(i+1,3);if(a>DataStreamConnection.MAX_PAYLOAD_LENGTH){d("[%s] Connection send payload with size bigger than the maximum allow for data stream",this.remoteAddress);this.close();return[]}var o=t-i-4;if(a+16>o){this.frameBuffer=e.slice(i);break}var s=i+4;var c=s+a;var u=e.slice(i,s);var l=e.slice(s,c);var h=Buffer.alloc(a);var p=e.slice(c,c+16);i=c+16;if(n===1){var v={header:u,cipheredPayload:l,authTag:p};r.push(v)}else{d("[%s] Encountered unknown payload type %d for payload: %s",this.remoteAddress,h.toString("hex"))}}return r};DataStreamConnection.prototype.decryptHDSFrame=function(e,t){u.writeUInt64LE(this.controllerToAccessoryNonce,this.controllerToAccessoryNonceBuffer,0);var r=t||this.controllerToAccessoryEncryptionKey;try{e.plaintextPayload=u.chacha20_poly1305_decryptAndVerify(r,this.controllerToAccessoryNonceBuffer,e.header,e.cipheredPayload,e.authTag);this.controllerToAccessoryNonce++;return true}catch(e){return false}};DataStreamConnection.prototype.decodePayloads=function(e){var t=this;var r=[];e.forEach((function(e){var i=e.plaintextPayload;if(!i){throw new b("Reached illegal state. Encountered HDSFrame with wasn't decrypted yet!",1)}var n=i.readUInt8(0);var a=i.length-n-1;var o=1;var s=o+n;var c=new l.DataStreamReader(i.slice(o,o+n));var u=new l.DataStreamReader(i.slice(s,s+a));var h;var p;try{h=l.DataStreamParser.decode(c);c.finished()}catch(e){d("[%s] Failed to decode header payload: %s",t.remoteAddress,e.message);return}try{p=l.DataStreamParser.decode(u);u.finished()}catch(e){d("[%s] Failed to decode message payload: %s (header: %o)",t.remoteAddress,e.message,h);return}var v;var m=h.protocol;var g;var y=undefined;var C=undefined;if(h.event!==undefined){v=1;g=h.event}else if(h.request!==undefined){v=2;g=h.request;y=h.id}else if(h.response!==undefined){v=3;g=h.response;y=h.id;C=h.status}else{d("[%s] Encountered unknown payload header format: %o (message: %o)",t.remoteAddress,h,p);return}var T={type:v,protocol:m,topic:g,id:y,status:C,message:p};r.push(T)}));return r};DataStreamConnection.prototype.sendHDSFrame=function(e,t){if(this.state>=3){throw new b("Cannot send message on closing/closed socket!",2)}var r=new l.DataStreamWriter;var i=new l.DataStreamWriter;l.DataStreamParser.encode(e,r);l.DataStreamParser.encode(t,i);var n=Buffer.alloc(1);n.writeUInt8(r.length(),0);var a=Buffer.concat([n,r.getData(),i.getData()]);if(a.length>DataStreamConnection.MAX_PAYLOAD_LENGTH){throw new b("Tried sending payload with length larger than the maximum allowed for data stream",3)}var o=Buffer.alloc(1);o.writeUInt8(1,0);var s=Buffer.alloc(4);s.writeUInt32BE(a.length,0);s=s.slice(1,4);var c=Buffer.concat([o,s]);u.writeUInt64LE(this.accessoryToControllerNonce++,this.accessoryToControllerNonceBuffer);var d=u.chacha20_poly1305_encryptAndSeal(this.accessoryToControllerEncryptionKey,this.accessoryToControllerNonceBuffer,c,a);this.socket.write(Buffer.concat([c,d.ciphertext,d.authTag]))};DataStreamConnection.prototype.close=function(){if(this.state>=3){return}this.state=3;this.socket.end()};DataStreamConnection.prototype.isConsideredClosed=function(){return this.state>=3};DataStreamConnection.prototype.onHAPSessionClosed=function(){d("[%s] HAP connection disconnected. Also closing DataStream connection now.",this.remoteAddress);this.close()};DataStreamConnection.prototype.onSocketError=function(e){d("[%s] Encountered socket error: %s",this.remoteAddress,e.message)};DataStreamConnection.prototype.onSocketClose=function(){var e;this.state=4;this.emit("closed");(e=this.connection)===null||e===void 0?void 0:e.removeListener("closed",this.hapConnectionClosedListener);this.removeAllListeners()};DataStreamConnection.MAX_PAYLOAD_LENGTH=1048575;return DataStreamConnection}(s.EventEmitter);t.DataStreamConnection=w},4658:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(6867);i.__exportStar(r(427),t);i.__exportStar(r(4745),t);i.__exportStar(r(4601),t)},5893:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CurrentMediaState=t.CurrentHumidifierDehumidifierState=t.CurrentHorizontalTiltAngle=t.CurrentHeatingCoolingState=t.CurrentHeaterCoolerState=t.CurrentFanState=t.CurrentDoorState=t.CurrentAmbientLightLevel=t.CurrentAirPurifierState=t.CryptoHash=t.CoolingThresholdTemperature=t.ContactSensorState=t.ConfiguredName=t.ConfigureBridgedAccessoryStatus=t.ConfigureBridgedAccessory=t.ConfigurationState=t.ColorTemperature=t.ClosedCaptions=t.ChargingState=t.CharacteristicValueTransitionControl=t.CharacteristicValueActiveTransitionCount=t.CCASignalDetectThreshold=t.CCAEnergyDetectThreshold=t.Category=t.CarbonMonoxidePeakLevel=t.CarbonMonoxideLevel=t.CarbonMonoxideDetected=t.CarbonDioxidePeakLevel=t.CarbonDioxideLevel=t.CarbonDioxideDetected=t.CameraOperatingModeIndicator=t.ButtonEvent=t.Brightness=t.BatteryLevel=t.AudioFeedback=t.AssetUpdateReadiness=t.AppMatchingIdentifier=t.AirQuality=t.AirPlayEnable=t.AirParticulateSize=t.AirParticulateDensity=t.AdministratorOnlyAccess=t.ActivityInterval=t.ActiveIdentifier=t.Active=t.AccessoryIdentifier=t.AccessoryFlags=t.AccessControlLevel=t.AccessCodeSupportedConfiguration=t.AccessCodeControlPoint=void 0;t.Logs=t.LockTargetState=t.LockPhysicalControls=t.LockManagementAutoSecurityTimeout=t.LockLastKnownAction=t.LockCurrentState=t.LockControlPoint=t.ListPairings=t.LinkQuality=t.LeakDetected=t.IsConfigured=t.InUse=t.InputSourceType=t.InputDeviceType=t.ImageRotation=t.ImageMirroring=t.Identify=t.Identifier=t.Hue=t.HomeKitCameraActive=t.HoldPosition=t.HeatingThresholdTemperature=t.HeartBeat=t.HardwareRevision=t.HardwareFinish=t.FirmwareUpdateStatus=t.FirmwareUpdateReadiness=t.FirmwareRevision=t.FilterLifeLevel=t.FilterChangeIndication=t.EventTransmissionCounters=t.EventSnapshotsActive=t.EventRetransmissionMaximum=t.DisplayOrder=t.DiscoveredBridgedAccessories=t.DiscoverBridgedAccessories=t.DigitalZoom=t.DiagonalFieldOfView=t.DayoftheWeek=t.DataStreamHAPTransportInterrupt=t.DataStreamHAPTransport=t.CurrentVisibilityState=t.CurrentVerticalTiltAngle=t.CurrentTransport=t.CurrentTime=t.CurrentTiltAngle=t.CurrentTemperature=t.CurrentSlatState=t.CurrentRelativeHumidity=t.CurrentPosition=void 0;t.RelayState=t.RelayEnabled=t.RelayControlPoint=t.RelativeHumidityHumidifierThreshold=t.RelativeHumidityDehumidifierThreshold=t.RecordingAudioActive=t.ReceiverSensitivity=t.ReceivedSignalStrengthIndication=t.Reachable=t.ProgramMode=t.ProgrammableSwitchOutputState=t.ProgrammableSwitchEvent=t.ProductData=t.PowerModeSelection=t.PositionState=t.PM2_5Density=t.PM10Density=t.Ping=t.PictureMode=t.PeriodicSnapshotsActive=t.PasswordSetting=t.PairVerify=t.PairSetup=t.PairingFeatures=t.OzoneDensity=t.OutletInUse=t.OpticalZoom=t.OperatingStateResponse=t.On=t.OccupancyDetected=t.ObstructionDetected=t.NitrogenDioxideDensity=t.NightVision=t.NFCAccessSupportedConfiguration=t.NFCAccessControlPoint=t.NetworkClientStatusControl=t.NetworkClientProfileControl=t.NetworkAccessViolationControl=t.Name=t.Mute=t.MultifunctionButton=t.MotionDetected=t.Model=t.MetricsBufferFullState=t.MaximumTransmitPower=t.Manufacturer=t.ManuallyDisabled=t.ManagedNetworkEnable=t.MACTransmissionCounters=t.MACRetransmissionMaximum=void 0;t.SupportedDiagnosticsModes=t.SupportedDataStreamTransportConfiguration=t.SupportedCharacteristicValueTransitionConfiguration=t.SupportedCameraRecordingConfiguration=t.SupportedAudioStreamConfiguration=t.SupportedAudioRecordingConfiguration=t.SupportedAssetTypes=t.SulphurDioxideDensity=t.StreamingStatus=t.StatusTampered=t.StatusLowBattery=t.StatusJammed=t.StatusFault=t.StatusActive=t.StagedFirmwareVersion=t.SoftwareRevision=t.SmokeDetected=t.SleepInterval=t.SleepDiscoveryMode=t.SlatType=t.SiriTouchToUse=t.SiriListening=t.SiriLightOnUse=t.SiriInputType=t.SiriEngineVersion=t.SiriEndpointSessionStatus=t.SiriEnable=t.SignalToNoiseRatio=t.SetupTransferTransport=t.SetupEndpoints=t.SetupDataStreamTransport=t.SetDuration=t.ServiceLabelNamespace=t.ServiceLabelIndex=t.SerialNumber=t.SelectedSleepConfiguration=t.SelectedRTPStreamConfiguration=t.SelectedDiagnosticsModes=t.SelectedCameraRecordingConfiguration=t.SelectedAudioStreamConfiguration=t.SecuritySystemTargetState=t.SecuritySystemCurrentState=t.SecuritySystemAlarmType=t.Saturation=t.RouterStatus=t.RotationSpeed=t.RotationDirection=t.ResetFilterIndication=t.RemoteKey=t.RemainingDuration=void 0;t.WakeConfiguration=t.VolumeSelector=t.VolumeControlType=t.Volume=t.VOCDensity=t.VideoAnalysisActive=t.Version=t.ValveType=t.TunneledAccessoryStateNumber=t.TunneledAccessoryConnected=t.TunneledAccessoryAdvertising=t.TunnelConnectionTimeout=t.TransmitPower=t.Token=t.TimeUpdate=t.ThreadStatus=t.ThreadOpenThreadVersion=t.ThreadNodeCapabilities=t.ThreadControlPoint=t.ThirdPartyCameraActive=t.TemperatureDisplayUnits=t.TargetVisibilityState=t.TargetVerticalTiltAngle=t.TargetTiltAngle=t.TargetTemperature=t.TargetSlatState=t.TargetRelativeHumidity=t.TargetPosition=t.TargetMediaState=t.TargetHumidifierDehumidifierState=t.TargetHorizontalTiltAngle=t.TargetHeatingCoolingState=t.TargetHeaterCoolerState=t.TargetFanState=t.TargetDoorState=t.TargetControlSupportedConfiguration=t.TargetControlList=t.TargetAirQuality=t.TargetAirPurifierState=t.TapType=t.SwingMode=t.SupportedVideoStreamConfiguration=t.SupportedVideoRecordingConfiguration=t.SupportedTransferTransportConfiguration=t.SupportedSleepConfiguration=t.SupportedRTPConfiguration=t.SupportedRouterConfiguration=t.SupportedMetrics=t.SupportedFirmwareUpdateConfiguration=t.SupportedDiagnosticsSnapshot=void 0;t.WiFiSatelliteStatus=t.WiFiConfigurationControl=t.WiFiCapabilities=t.WaterLevel=t.WANStatusList=t.WANConfigurationList=void 0;var i=r(6867);var n=r(8117);var a=function(e){i.__extends(AccessCodeControlPoint,e);function AccessCodeControlPoint(){var t=e.call(this,"Access Code Control Point",AccessCodeControlPoint.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;t.value=t.getDefaultValue();return t}AccessCodeControlPoint.UUID="00000262-0000-1000-8000-0026BB765291";return AccessCodeControlPoint}(n.Characteristic);t.AccessCodeControlPoint=a;n.Characteristic.AccessCodeControlPoint=a;var o=function(e){i.__extends(AccessCodeSupportedConfiguration,e);function AccessCodeSupportedConfiguration(){var t=e.call(this,"Access Code Supported Configuration",AccessCodeSupportedConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}AccessCodeSupportedConfiguration.UUID="00000261-0000-1000-8000-0026BB765291";return AccessCodeSupportedConfiguration}(n.Characteristic);t.AccessCodeSupportedConfiguration=o;n.Characteristic.AccessCodeSupportedConfiguration=o;var s=function(e){i.__extends(AccessControlLevel,e);function AccessControlLevel(){var t=e.call(this,"Access Control Level",AccessControlLevel.UUID,{format:"uint16",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1})||this;t.value=t.getDefaultValue();return t}AccessControlLevel.UUID="000000E5-0000-1000-8000-0026BB765291";return AccessControlLevel}(n.Characteristic);t.AccessControlLevel=s;n.Characteristic.AccessControlLevel=s;var c=function(e){i.__extends(AccessoryFlags,e);function AccessoryFlags(){var t=e.call(this,"Accessory Flags",AccessoryFlags.UUID,{format:"uint32",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}AccessoryFlags.UUID="000000A6-0000-1000-8000-0026BB765291";AccessoryFlags.REQUIRES_ADDITIONAL_SETUP_BIT_MASK=1;return AccessoryFlags}(n.Characteristic);t.AccessoryFlags=c;n.Characteristic.AccessoryFlags=c;var u=function(e){i.__extends(AccessoryIdentifier,e);function AccessoryIdentifier(){var t=e.call(this,"Accessory Identifier",AccessoryIdentifier.UUID,{format:"string",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}AccessoryIdentifier.UUID="00000057-0000-1000-8000-0026BB765291";return AccessoryIdentifier}(n.Characteristic);t.AccessoryIdentifier=u;n.Characteristic.AccessoryIdentifier=u;var l=function(e){i.__extends(Active,e);function Active(){var t=e.call(this,"Active",Active.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}Active.UUID="000000B0-0000-1000-8000-0026BB765291";Active.INACTIVE=0;Active.ACTIVE=1;return Active}(n.Characteristic);t.Active=l;n.Characteristic.Active=l;var d=function(e){i.__extends(ActiveIdentifier,e);function ActiveIdentifier(){var t=e.call(this,"Active Identifier",ActiveIdentifier.UUID,{format:"uint32",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}ActiveIdentifier.UUID="000000E7-0000-1000-8000-0026BB765291";return ActiveIdentifier}(n.Characteristic);t.ActiveIdentifier=d;n.Characteristic.ActiveIdentifier=d;var h=function(e){i.__extends(ActivityInterval,e);function ActivityInterval(){var t=e.call(this,"Activity Interval",ActivityInterval.UUID,{format:"uint32",perms:["ev","pr"],minValue:0,minStep:1})||this;t.value=t.getDefaultValue();return t}ActivityInterval.UUID="0000023B-0000-1000-8000-0026BB765291";return ActivityInterval}(n.Characteristic);t.ActivityInterval=h;n.Characteristic.ActivityInterval=h;var p=function(e){i.__extends(AdministratorOnlyAccess,e);function AdministratorOnlyAccess(){var t=e.call(this,"Administrator Only Access",AdministratorOnlyAccess.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}AdministratorOnlyAccess.UUID="00000001-0000-1000-8000-0026BB765291";return AdministratorOnlyAccess}(n.Characteristic);t.AdministratorOnlyAccess=p;n.Characteristic.AdministratorOnlyAccess=p;var v=function(e){i.__extends(AirParticulateDensity,e);function AirParticulateDensity(){var t=e.call(this,"Air Particulate Density",AirParticulateDensity.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3})||this;t.value=t.getDefaultValue();return t}AirParticulateDensity.UUID="00000064-0000-1000-8000-0026BB765291";return AirParticulateDensity}(n.Characteristic);t.AirParticulateDensity=v;n.Characteristic.AirParticulateDensity=v;var m=function(e){i.__extends(AirParticulateSize,e);function AirParticulateSize(){var t=e.call(this,"Air Particulate Size",AirParticulateSize.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}AirParticulateSize.UUID="00000065-0000-1000-8000-0026BB765291";AirParticulateSize._2_5_M=0;AirParticulateSize._10_M=1;return AirParticulateSize}(n.Characteristic);t.AirParticulateSize=m;n.Characteristic.AirParticulateSize=m;var g=function(e){i.__extends(AirPlayEnable,e);function AirPlayEnable(){var t=e.call(this,"AirPlay Enable",AirPlayEnable.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;t.value=t.getDefaultValue();return t}AirPlayEnable.UUID="0000025B-0000-1000-8000-0026BB765291";return AirPlayEnable}(n.Characteristic);t.AirPlayEnable=g;n.Characteristic.AirPlayEnable=g;var y=function(e){i.__extends(AirQuality,e);function AirQuality(){var t=e.call(this,"Air Quality",AirQuality.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:5,minStep:1,validValues:[0,1,2,3,4,5]})||this;t.value=t.getDefaultValue();return t}AirQuality.UUID="00000095-0000-1000-8000-0026BB765291";AirQuality.UNKNOWN=0;AirQuality.EXCELLENT=1;AirQuality.GOOD=2;AirQuality.FAIR=3;AirQuality.INFERIOR=4;AirQuality.POOR=5;return AirQuality}(n.Characteristic);t.AirQuality=y;n.Characteristic.AirQuality=y;var C=function(e){i.__extends(AppMatchingIdentifier,e);function AppMatchingIdentifier(){var t=e.call(this,"App Matching Identifier",AppMatchingIdentifier.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}AppMatchingIdentifier.UUID="000000A4-0000-1000-8000-0026BB765291";return AppMatchingIdentifier}(n.Characteristic);t.AppMatchingIdentifier=C;n.Characteristic.AppMatchingIdentifier=C;var T=function(e){i.__extends(AssetUpdateReadiness,e);function AssetUpdateReadiness(){var t=e.call(this,"Asset Update Readiness",AssetUpdateReadiness.UUID,{format:"uint32",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}AssetUpdateReadiness.UUID="00000269-0000-1000-8000-0026BB765291";return AssetUpdateReadiness}(n.Characteristic);t.AssetUpdateReadiness=T;n.Characteristic.AssetUpdateReadiness=T;var E=function(e){i.__extends(AudioFeedback,e);function AudioFeedback(){var t=e.call(this,"Audio Feedback",AudioFeedback.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}AudioFeedback.UUID="00000005-0000-1000-8000-0026BB765291";return AudioFeedback}(n.Characteristic);t.AudioFeedback=E;n.Characteristic.AudioFeedback=E;var D=function(e){i.__extends(BatteryLevel,e);function BatteryLevel(){var t=e.call(this,"Battery Level",BatteryLevel.UUID,{format:"uint8",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}BatteryLevel.UUID="00000068-0000-1000-8000-0026BB765291";return BatteryLevel}(n.Characteristic);t.BatteryLevel=D;n.Characteristic.BatteryLevel=D;var _=function(e){i.__extends(Brightness,e);function Brightness(){var t=e.call(this,"Brightness",Brightness.UUID,{format:"int",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}Brightness.UUID="00000008-0000-1000-8000-0026BB765291";return Brightness}(n.Characteristic);t.Brightness=_;n.Characteristic.Brightness=_;var I=function(e){i.__extends(ButtonEvent,e);function ButtonEvent(){var t=e.call(this,"Button Event",ButtonEvent.UUID,{format:"tlv8",perms:["ev","pr"],adminOnlyAccess:[2]})||this;t.value=t.getDefaultValue();return t}ButtonEvent.UUID="00000126-0000-1000-8000-0026BB765291";return ButtonEvent}(n.Characteristic);t.ButtonEvent=I;n.Characteristic.ButtonEvent=I;var b=function(e){i.__extends(CameraOperatingModeIndicator,e);function CameraOperatingModeIndicator(){var t=e.call(this,"Camera Operating Mode Indicator",CameraOperatingModeIndicator.UUID,{format:"bool",perms:["ev","pr","pw","tw"],validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}CameraOperatingModeIndicator.UUID="0000021D-0000-1000-8000-0026BB765291";CameraOperatingModeIndicator.DISABLE=0;CameraOperatingModeIndicator.ENABLE=1;return CameraOperatingModeIndicator}(n.Characteristic);t.CameraOperatingModeIndicator=b;n.Characteristic.CameraOperatingModeIndicator=b;var w=function(e){i.__extends(CarbonDioxideDetected,e);function CarbonDioxideDetected(){var t=e.call(this,"Carbon Dioxide Detected",CarbonDioxideDetected.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}CarbonDioxideDetected.UUID="00000092-0000-1000-8000-0026BB765291";CarbonDioxideDetected.CO2_LEVELS_NORMAL=0;CarbonDioxideDetected.CO2_LEVELS_ABNORMAL=1;return CarbonDioxideDetected}(n.Characteristic);t.CarbonDioxideDetected=w;n.Characteristic.CarbonDioxideDetected=w;var R=function(e){i.__extends(CarbonDioxideLevel,e);function CarbonDioxideLevel(){var t=e.call(this,"Carbon Dioxide Level",CarbonDioxideLevel.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e5,minStep:1})||this;t.value=t.getDefaultValue();return t}CarbonDioxideLevel.UUID="00000093-0000-1000-8000-0026BB765291";return CarbonDioxideLevel}(n.Characteristic);t.CarbonDioxideLevel=R;n.Characteristic.CarbonDioxideLevel=R;var N=function(e){i.__extends(CarbonDioxidePeakLevel,e);function CarbonDioxidePeakLevel(){var t=e.call(this,"Carbon Dioxide Peak Level",CarbonDioxidePeakLevel.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e5,minStep:1})||this;t.value=t.getDefaultValue();return t}CarbonDioxidePeakLevel.UUID="00000094-0000-1000-8000-0026BB765291";return CarbonDioxidePeakLevel}(n.Characteristic);t.CarbonDioxidePeakLevel=N;n.Characteristic.CarbonDioxidePeakLevel=N;var U=function(e){i.__extends(CarbonMonoxideDetected,e);function CarbonMonoxideDetected(){var t=e.call(this,"Carbon Monoxide Detected",CarbonMonoxideDetected.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}CarbonMonoxideDetected.UUID="00000069-0000-1000-8000-0026BB765291";CarbonMonoxideDetected.CO_LEVELS_NORMAL=0;CarbonMonoxideDetected.CO_LEVELS_ABNORMAL=1;return CarbonMonoxideDetected}(n.Characteristic);t.CarbonMonoxideDetected=U;n.Characteristic.CarbonMonoxideDetected=U;var P=function(e){i.__extends(CarbonMonoxideLevel,e);function CarbonMonoxideLevel(){var t=e.call(this,"Carbon Monoxide Level",CarbonMonoxideLevel.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}CarbonMonoxideLevel.UUID="00000090-0000-1000-8000-0026BB765291";return CarbonMonoxideLevel}(n.Characteristic);t.CarbonMonoxideLevel=P;n.Characteristic.CarbonMonoxideLevel=P;var O=function(e){i.__extends(CarbonMonoxidePeakLevel,e);function CarbonMonoxidePeakLevel(){var t=e.call(this,"Carbon Monoxide Peak Level",CarbonMonoxidePeakLevel.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}CarbonMonoxidePeakLevel.UUID="00000091-0000-1000-8000-0026BB765291";return CarbonMonoxidePeakLevel}(n.Characteristic);t.CarbonMonoxidePeakLevel=O;n.Characteristic.CarbonMonoxidePeakLevel=O;var L=function(e){i.__extends(Category,e);function Category(){var t=e.call(this,"Category",Category.UUID,{format:"uint16",perms:["ev","pr"],minValue:1,maxValue:16})||this;t.value=t.getDefaultValue();return t}Category.UUID="000000A3-0000-1000-8000-0026BB765291";return Category}(n.Characteristic);t.Category=L;n.Characteristic.Category=L;var B=function(e){i.__extends(CCAEnergyDetectThreshold,e);function CCAEnergyDetectThreshold(){var t=e.call(this,"CCA Energy Detect Threshold",CCAEnergyDetectThreshold.UUID,{format:"int",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}CCAEnergyDetectThreshold.UUID="00000246-0000-1000-8000-0026BB765291";return CCAEnergyDetectThreshold}(n.Characteristic);t.CCAEnergyDetectThreshold=B;n.Characteristic.CCAEnergyDetectThreshold=B;var x=function(e){i.__extends(CCASignalDetectThreshold,e);function CCASignalDetectThreshold(){var t=e.call(this,"CCA Signal Detect Threshold",CCASignalDetectThreshold.UUID,{format:"int",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}CCASignalDetectThreshold.UUID="00000245-0000-1000-8000-0026BB765291";return CCASignalDetectThreshold}(n.Characteristic);t.CCASignalDetectThreshold=x;n.Characteristic.CCASignalDetectThreshold=x;var k=function(e){i.__extends(CharacteristicValueActiveTransitionCount,e);function CharacteristicValueActiveTransitionCount(){var t=e.call(this,"Characteristic Value Active Transition Count",CharacteristicValueActiveTransitionCount.UUID,{format:"uint8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}CharacteristicValueActiveTransitionCount.UUID="0000024B-0000-1000-8000-0026BB765291";return CharacteristicValueActiveTransitionCount}(n.Characteristic);t.CharacteristicValueActiveTransitionCount=k;n.Characteristic.CharacteristicValueActiveTransitionCount=k;var V=function(e){i.__extends(CharacteristicValueTransitionControl,e);function CharacteristicValueTransitionControl(){var t=e.call(this,"Characteristic Value Transition Control",CharacteristicValueTransitionControl.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;t.value=t.getDefaultValue();return t}CharacteristicValueTransitionControl.UUID="00000143-0000-1000-8000-0026BB765291";return CharacteristicValueTransitionControl}(n.Characteristic);t.CharacteristicValueTransitionControl=V;n.Characteristic.CharacteristicValueTransitionControl=V;var H=function(e){i.__extends(ChargingState,e);function ChargingState(){var t=e.call(this,"Charging State",ChargingState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}ChargingState.UUID="0000008F-0000-1000-8000-0026BB765291";ChargingState.NOT_CHARGING=0;ChargingState.CHARGING=1;ChargingState.NOT_CHARGEABLE=2;return ChargingState}(n.Characteristic);t.ChargingState=H;n.Characteristic.ChargingState=H;var j=function(e){i.__extends(ClosedCaptions,e);function ClosedCaptions(){var t=e.call(this,"Closed Captions",ClosedCaptions.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}ClosedCaptions.UUID="000000DD-0000-1000-8000-0026BB765291";ClosedCaptions.DISABLED=0;ClosedCaptions.ENABLED=1;return ClosedCaptions}(n.Characteristic);t.ClosedCaptions=j;n.Characteristic.ClosedCaptions=j;var W=function(e){i.__extends(ColorTemperature,e);function ColorTemperature(){var t=e.call(this,"Color Temperature",ColorTemperature.UUID,{format:"int",perms:["ev","pr","pw"],minValue:140,maxValue:500,minStep:1})||this;t.value=t.getDefaultValue();return t}ColorTemperature.UUID="000000CE-0000-1000-8000-0026BB765291";return ColorTemperature}(n.Characteristic);t.ColorTemperature=W;n.Characteristic.ColorTemperature=W;var G=function(e){i.__extends(ConfigurationState,e);function ConfigurationState(){var t=e.call(this,"Configuration State",ConfigurationState.UUID,{format:"uint16",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}ConfigurationState.UUID="00000263-0000-1000-8000-0026BB765291";return ConfigurationState}(n.Characteristic);t.ConfigurationState=G;n.Characteristic.ConfigurationState=G;var X=function(e){i.__extends(ConfigureBridgedAccessory,e);function ConfigureBridgedAccessory(){var t=e.call(this,"Configure Bridged Accessory",ConfigureBridgedAccessory.UUID,{format:"tlv8",perms:["pw"]})||this;t.value=t.getDefaultValue();return t}ConfigureBridgedAccessory.UUID="000000A0-0000-1000-8000-0026BB765291";return ConfigureBridgedAccessory}(n.Characteristic);t.ConfigureBridgedAccessory=X;n.Characteristic.ConfigureBridgedAccessory=X;var q=function(e){i.__extends(ConfigureBridgedAccessoryStatus,e);function ConfigureBridgedAccessoryStatus(){var t=e.call(this,"Configure Bridged Accessory Status",ConfigureBridgedAccessoryStatus.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}ConfigureBridgedAccessoryStatus.UUID="0000009D-0000-1000-8000-0026BB765291";return ConfigureBridgedAccessoryStatus}(n.Characteristic);t.ConfigureBridgedAccessoryStatus=q;n.Characteristic.ConfigureBridgedAccessoryStatus=q;var Y=function(e){i.__extends(ConfiguredName,e);function ConfiguredName(){var t=e.call(this,"Configured Name",ConfiguredName.UUID,{format:"string",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}ConfiguredName.UUID="000000E3-0000-1000-8000-0026BB765291";return ConfiguredName}(n.Characteristic);t.ConfiguredName=Y;n.Characteristic.ConfiguredName=Y;var K=function(e){i.__extends(ContactSensorState,e);function ContactSensorState(){var t=e.call(this,"Contact Sensor State",ContactSensorState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}ContactSensorState.UUID="0000006A-0000-1000-8000-0026BB765291";ContactSensorState.CONTACT_DETECTED=0;ContactSensorState.CONTACT_NOT_DETECTED=1;return ContactSensorState}(n.Characteristic);t.ContactSensorState=K;n.Characteristic.ContactSensorState=K;var $=function(e){i.__extends(CoolingThresholdTemperature,e);function CoolingThresholdTemperature(){var t=e.call(this,"Cooling Threshold Temperature",CoolingThresholdTemperature.UUID,{format:"float",perms:["ev","pr","pw"],unit:"celsius",minValue:10,maxValue:35,minStep:.1})||this;t.value=t.getDefaultValue();return t}CoolingThresholdTemperature.UUID="0000000D-0000-1000-8000-0026BB765291";return CoolingThresholdTemperature}(n.Characteristic);t.CoolingThresholdTemperature=$;n.Characteristic.CoolingThresholdTemperature=$;var z=function(e){i.__extends(CryptoHash,e);function CryptoHash(){var t=e.call(this,"Crypto Hash",CryptoHash.UUID,{format:"tlv8",perms:["pw","wr"]})||this;t.value=t.getDefaultValue();return t}CryptoHash.UUID="00000250-0000-1000-8000-0026BB765291";return CryptoHash}(n.Characteristic);t.CryptoHash=z;n.Characteristic.CryptoHash=z;var J=function(e){i.__extends(CurrentAirPurifierState,e);function CurrentAirPurifierState(){var t=e.call(this,"Current Air Purifier State",CurrentAirPurifierState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}CurrentAirPurifierState.UUID="000000A9-0000-1000-8000-0026BB765291";CurrentAirPurifierState.INACTIVE=0;CurrentAirPurifierState.IDLE=1;CurrentAirPurifierState.PURIFYING_AIR=2;return CurrentAirPurifierState}(n.Characteristic);t.CurrentAirPurifierState=J;n.Characteristic.CurrentAirPurifierState=J;var ee=function(e){i.__extends(CurrentAmbientLightLevel,e);function CurrentAmbientLightLevel(){var t=e.call(this,"Current Ambient Light Level",CurrentAmbientLightLevel.UUID,{format:"float",perms:["ev","pr"],unit:"lux",minValue:1e-4,maxValue:1e5})||this;t.value=t.getDefaultValue();return t}CurrentAmbientLightLevel.UUID="0000006B-0000-1000-8000-0026BB765291";return CurrentAmbientLightLevel}(n.Characteristic);t.CurrentAmbientLightLevel=ee;n.Characteristic.CurrentAmbientLightLevel=ee;var te=function(e){i.__extends(CurrentDoorState,e);function CurrentDoorState(){var t=e.call(this,"Current Door State",CurrentDoorState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:4,minStep:1,validValues:[0,1,2,3,4]})||this;t.value=t.getDefaultValue();return t}CurrentDoorState.UUID="0000000E-0000-1000-8000-0026BB765291";CurrentDoorState.OPEN=0;CurrentDoorState.CLOSED=1;CurrentDoorState.OPENING=2;CurrentDoorState.CLOSING=3;CurrentDoorState.STOPPED=4;return CurrentDoorState}(n.Characteristic);t.CurrentDoorState=te;n.Characteristic.CurrentDoorState=te;var re=function(e){i.__extends(CurrentFanState,e);function CurrentFanState(){var t=e.call(this,"Current Fan State",CurrentFanState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}CurrentFanState.UUID="000000AF-0000-1000-8000-0026BB765291";CurrentFanState.INACTIVE=0;CurrentFanState.IDLE=1;CurrentFanState.BLOWING_AIR=2;return CurrentFanState}(n.Characteristic);t.CurrentFanState=re;n.Characteristic.CurrentFanState=re;var ie=function(e){i.__extends(CurrentHeaterCoolerState,e);function CurrentHeaterCoolerState(){var t=e.call(this,"Current Heater-Cooler State",CurrentHeaterCoolerState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;t.value=t.getDefaultValue();return t}CurrentHeaterCoolerState.UUID="000000B1-0000-1000-8000-0026BB765291";CurrentHeaterCoolerState.INACTIVE=0;CurrentHeaterCoolerState.IDLE=1;CurrentHeaterCoolerState.HEATING=2;CurrentHeaterCoolerState.COOLING=3;return CurrentHeaterCoolerState}(n.Characteristic);t.CurrentHeaterCoolerState=ie;n.Characteristic.CurrentHeaterCoolerState=ie;var ne=function(e){i.__extends(CurrentHeatingCoolingState,e);function CurrentHeatingCoolingState(){var t=e.call(this,"Current Heating Cooling State",CurrentHeatingCoolingState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}CurrentHeatingCoolingState.UUID="0000000F-0000-1000-8000-0026BB765291";CurrentHeatingCoolingState.OFF=0;CurrentHeatingCoolingState.HEAT=1;CurrentHeatingCoolingState.COOL=2;return CurrentHeatingCoolingState}(n.Characteristic);t.CurrentHeatingCoolingState=ne;n.Characteristic.CurrentHeatingCoolingState=ne;var ae=function(e){i.__extends(CurrentHorizontalTiltAngle,e);function CurrentHorizontalTiltAngle(){var t=e.call(this,"Current Horizontal Tilt Angle",CurrentHorizontalTiltAngle.UUID,{format:"int",perms:["ev","pr"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;t.value=t.getDefaultValue();return t}CurrentHorizontalTiltAngle.UUID="0000006C-0000-1000-8000-0026BB765291";return CurrentHorizontalTiltAngle}(n.Characteristic);t.CurrentHorizontalTiltAngle=ae;n.Characteristic.CurrentHorizontalTiltAngle=ae;var oe=function(e){i.__extends(CurrentHumidifierDehumidifierState,e);function CurrentHumidifierDehumidifierState(){var t=e.call(this,"Current Humidifier-Dehumidifier State",CurrentHumidifierDehumidifierState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;t.value=t.getDefaultValue();return t}CurrentHumidifierDehumidifierState.UUID="000000B3-0000-1000-8000-0026BB765291";CurrentHumidifierDehumidifierState.INACTIVE=0;CurrentHumidifierDehumidifierState.IDLE=1;CurrentHumidifierDehumidifierState.HUMIDIFYING=2;CurrentHumidifierDehumidifierState.DEHUMIDIFYING=3;return CurrentHumidifierDehumidifierState}(n.Characteristic);t.CurrentHumidifierDehumidifierState=oe;n.Characteristic.CurrentHumidifierDehumidifierState=oe;var se=function(e){i.__extends(CurrentMediaState,e);function CurrentMediaState(){var t=e.call(this,"Current Media State",CurrentMediaState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:5,minStep:1,validValues:[0,1,2,4,5]})||this;t.value=t.getDefaultValue();return t}CurrentMediaState.UUID="000000E0-0000-1000-8000-0026BB765291";CurrentMediaState.PLAY=0;CurrentMediaState.PAUSE=1;CurrentMediaState.STOP=2;CurrentMediaState.LOADING=4;CurrentMediaState.INTERRUPTED=5;return CurrentMediaState}(n.Characteristic);t.CurrentMediaState=se;n.Characteristic.CurrentMediaState=se;var ce=function(e){i.__extends(CurrentPosition,e);function CurrentPosition(){var t=e.call(this,"Current Position",CurrentPosition.UUID,{format:"uint8",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}CurrentPosition.UUID="0000006D-0000-1000-8000-0026BB765291";return CurrentPosition}(n.Characteristic);t.CurrentPosition=ce;n.Characteristic.CurrentPosition=ce;var ue=function(e){i.__extends(CurrentRelativeHumidity,e);function CurrentRelativeHumidity(){var t=e.call(this,"Current Relative Humidity",CurrentRelativeHumidity.UUID,{format:"float",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}CurrentRelativeHumidity.UUID="00000010-0000-1000-8000-0026BB765291";return CurrentRelativeHumidity}(n.Characteristic);t.CurrentRelativeHumidity=ue;n.Characteristic.CurrentRelativeHumidity=ue;var le=function(e){i.__extends(CurrentSlatState,e);function CurrentSlatState(){var t=e.call(this,"Current Slat State",CurrentSlatState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}CurrentSlatState.UUID="000000AA-0000-1000-8000-0026BB765291";CurrentSlatState.FIXED=0;CurrentSlatState.JAMMED=1;CurrentSlatState.SWINGING=2;return CurrentSlatState}(n.Characteristic);t.CurrentSlatState=le;n.Characteristic.CurrentSlatState=le;var de=function(e){i.__extends(CurrentTemperature,e);function CurrentTemperature(){var t=e.call(this,"Current Temperature",CurrentTemperature.UUID,{format:"float",perms:["ev","pr"],unit:"celsius",minValue:-270,maxValue:100,minStep:.1})||this;t.value=t.getDefaultValue();return t}CurrentTemperature.UUID="00000011-0000-1000-8000-0026BB765291";return CurrentTemperature}(n.Characteristic);t.CurrentTemperature=de;n.Characteristic.CurrentTemperature=de;var he=function(e){i.__extends(CurrentTiltAngle,e);function CurrentTiltAngle(){var t=e.call(this,"Current Tilt Angle",CurrentTiltAngle.UUID,{format:"int",perms:["ev","pr"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;t.value=t.getDefaultValue();return t}CurrentTiltAngle.UUID="000000C1-0000-1000-8000-0026BB765291";return CurrentTiltAngle}(n.Characteristic);t.CurrentTiltAngle=he;n.Characteristic.CurrentTiltAngle=he;var fe=function(e){i.__extends(CurrentTime,e);function CurrentTime(){var t=e.call(this,"Current Time",CurrentTime.UUID,{format:"string",perms:["pr","pw"]})||this;t.value=t.getDefaultValue();return t}CurrentTime.UUID="0000009B-0000-1000-8000-0026BB765291";return CurrentTime}(n.Characteristic);t.CurrentTime=fe;n.Characteristic.CurrentTime=fe;var pe=function(e){i.__extends(CurrentTransport,e);function CurrentTransport(){var t=e.call(this,"Current Transport",CurrentTransport.UUID,{format:"bool",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}CurrentTransport.UUID="0000022B-0000-1000-8000-0026BB765291";return CurrentTransport}(n.Characteristic);t.CurrentTransport=pe;n.Characteristic.CurrentTransport=pe;var ve=function(e){i.__extends(CurrentVerticalTiltAngle,e);function CurrentVerticalTiltAngle(){var t=e.call(this,"Current Vertical Tilt Angle",CurrentVerticalTiltAngle.UUID,{format:"int",perms:["ev","pr"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;t.value=t.getDefaultValue();return t}CurrentVerticalTiltAngle.UUID="0000006E-0000-1000-8000-0026BB765291";return CurrentVerticalTiltAngle}(n.Characteristic);t.CurrentVerticalTiltAngle=ve;n.Characteristic.CurrentVerticalTiltAngle=ve;var me=function(e){i.__extends(CurrentVisibilityState,e);function CurrentVisibilityState(){var t=e.call(this,"Current Visibility State",CurrentVisibilityState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}CurrentVisibilityState.UUID="00000135-0000-1000-8000-0026BB765291";CurrentVisibilityState.SHOWN=0;CurrentVisibilityState.HIDDEN=1;return CurrentVisibilityState}(n.Characteristic);t.CurrentVisibilityState=me;n.Characteristic.CurrentVisibilityState=me;var ge=function(e){i.__extends(DataStreamHAPTransport,e);function DataStreamHAPTransport(){var t=e.call(this,"Data Stream HAP Transport",DataStreamHAPTransport.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;t.value=t.getDefaultValue();return t}DataStreamHAPTransport.UUID="00000138-0000-1000-8000-0026BB765291";return DataStreamHAPTransport}(n.Characteristic);t.DataStreamHAPTransport=ge;n.Characteristic.DataStreamHAPTransport=ge;var ye=function(e){i.__extends(DataStreamHAPTransportInterrupt,e);function DataStreamHAPTransportInterrupt(){var t=e.call(this,"Data Stream HAP Transport Interrupt",DataStreamHAPTransportInterrupt.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}DataStreamHAPTransportInterrupt.UUID="00000139-0000-1000-8000-0026BB765291";return DataStreamHAPTransportInterrupt}(n.Characteristic);t.DataStreamHAPTransportInterrupt=ye;n.Characteristic.DataStreamHAPTransportInterrupt=ye;var Se=function(e){i.__extends(DayoftheWeek,e);function DayoftheWeek(){var t=e.call(this,"Day of the Week",DayoftheWeek.UUID,{format:"uint8",perms:["pr","pw"],minValue:1,maxValue:7})||this;t.value=t.getDefaultValue();return t}DayoftheWeek.UUID="00000098-0000-1000-8000-0026BB765291";return DayoftheWeek}(n.Characteristic);t.DayoftheWeek=Se;n.Characteristic.DayoftheWeek=Se;var Ce=function(e){i.__extends(DiagonalFieldOfView,e);function DiagonalFieldOfView(){var t=e.call(this,"Diagonal Field Of View",DiagonalFieldOfView.UUID,{format:"float",perms:["ev","pr"],unit:"arcdegrees",minValue:0,maxValue:360})||this;t.value=t.getDefaultValue();return t}DiagonalFieldOfView.UUID="00000224-0000-1000-8000-0026BB765291";return DiagonalFieldOfView}(n.Characteristic);t.DiagonalFieldOfView=Ce;n.Characteristic.DiagonalFieldOfView=Ce;var Te=function(e){i.__extends(DigitalZoom,e);function DigitalZoom(){var t=e.call(this,"Digital Zoom",DigitalZoom.UUID,{format:"float",perms:["ev","pr","pw"],minStep:.1})||this;t.value=t.getDefaultValue();return t}DigitalZoom.UUID="0000011D-0000-1000-8000-0026BB765291";return DigitalZoom}(n.Characteristic);t.DigitalZoom=Te;n.Characteristic.DigitalZoom=Te;var Ee=function(e){i.__extends(DiscoverBridgedAccessories,e);function DiscoverBridgedAccessories(){var t=e.call(this,"Discover Bridged Accessories",DiscoverBridgedAccessories.UUID,{format:"uint8",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}DiscoverBridgedAccessories.UUID="0000009E-0000-1000-8000-0026BB765291";return DiscoverBridgedAccessories}(n.Characteristic);t.DiscoverBridgedAccessories=Ee;n.Characteristic.DiscoverBridgedAccessories=Ee;var Ae=function(e){i.__extends(DiscoveredBridgedAccessories,e);function DiscoveredBridgedAccessories(){var t=e.call(this,"Discovered Bridged Accessories",DiscoveredBridgedAccessories.UUID,{format:"uint16",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}DiscoveredBridgedAccessories.UUID="0000009F-0000-1000-8000-0026BB765291";return DiscoveredBridgedAccessories}(n.Characteristic);t.DiscoveredBridgedAccessories=Ae;n.Characteristic.DiscoveredBridgedAccessories=Ae;var De=function(e){i.__extends(DisplayOrder,e);function DisplayOrder(){var t=e.call(this,"Display Order",DisplayOrder.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}DisplayOrder.UUID="00000136-0000-1000-8000-0026BB765291";return DisplayOrder}(n.Characteristic);t.DisplayOrder=De;n.Characteristic.DisplayOrder=De;var _e=function(e){i.__extends(EventRetransmissionMaximum,e);function EventRetransmissionMaximum(){var t=e.call(this,"Event Retransmission Maximum",EventRetransmissionMaximum.UUID,{format:"uint8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}EventRetransmissionMaximum.UUID="0000023D-0000-1000-8000-0026BB765291";return EventRetransmissionMaximum}(n.Characteristic);t.EventRetransmissionMaximum=_e;n.Characteristic.EventRetransmissionMaximum=_e;var Ie=function(e){i.__extends(EventSnapshotsActive,e);function EventSnapshotsActive(){var t=e.call(this,"Event Snapshots Active",EventSnapshotsActive.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}EventSnapshotsActive.UUID="00000223-0000-1000-8000-0026BB765291";EventSnapshotsActive.DISABLE=0;EventSnapshotsActive.ENABLE=1;return EventSnapshotsActive}(n.Characteristic);t.EventSnapshotsActive=Ie;n.Characteristic.EventSnapshotsActive=Ie;var be=function(e){i.__extends(EventTransmissionCounters,e);function EventTransmissionCounters(){var t=e.call(this,"Event Transmission Counters",EventTransmissionCounters.UUID,{format:"uint32",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}EventTransmissionCounters.UUID="0000023E-0000-1000-8000-0026BB765291";return EventTransmissionCounters}(n.Characteristic);t.EventTransmissionCounters=be;n.Characteristic.EventTransmissionCounters=be;var we=function(e){i.__extends(FilterChangeIndication,e);function FilterChangeIndication(){var t=e.call(this,"Filter Change Indication",FilterChangeIndication.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}FilterChangeIndication.UUID="000000AC-0000-1000-8000-0026BB765291";FilterChangeIndication.FILTER_OK=0;FilterChangeIndication.CHANGE_FILTER=1;return FilterChangeIndication}(n.Characteristic);t.FilterChangeIndication=we;n.Characteristic.FilterChangeIndication=we;var Re=function(e){i.__extends(FilterLifeLevel,e);function FilterLifeLevel(){var t=e.call(this,"Filter Life Level",FilterLifeLevel.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}FilterLifeLevel.UUID="000000AB-0000-1000-8000-0026BB765291";return FilterLifeLevel}(n.Characteristic);t.FilterLifeLevel=Re;n.Characteristic.FilterLifeLevel=Re;var Ne=function(e){i.__extends(FirmwareRevision,e);function FirmwareRevision(){var t=e.call(this,"Firmware Revision",FirmwareRevision.UUID,{format:"string",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}FirmwareRevision.UUID="00000052-0000-1000-8000-0026BB765291";return FirmwareRevision}(n.Characteristic);t.FirmwareRevision=Ne;n.Characteristic.FirmwareRevision=Ne;var Ue=function(e){i.__extends(FirmwareUpdateReadiness,e);function FirmwareUpdateReadiness(){var t=e.call(this,"Firmware Update Readiness",FirmwareUpdateReadiness.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}FirmwareUpdateReadiness.UUID="00000234-0000-1000-8000-0026BB765291";return FirmwareUpdateReadiness}(n.Characteristic);t.FirmwareUpdateReadiness=Ue;n.Characteristic.FirmwareUpdateReadiness=Ue;var Pe=function(e){i.__extends(FirmwareUpdateStatus,e);function FirmwareUpdateStatus(){var t=e.call(this,"Firmware Update Status",FirmwareUpdateStatus.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}FirmwareUpdateStatus.UUID="00000235-0000-1000-8000-0026BB765291";return FirmwareUpdateStatus}(n.Characteristic);t.FirmwareUpdateStatus=Pe;n.Characteristic.FirmwareUpdateStatus=Pe;var Oe=function(e){i.__extends(HardwareFinish,e);function HardwareFinish(){var t=e.call(this,"Hardware Finish",HardwareFinish.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}HardwareFinish.UUID="0000026C-0000-1000-8000-0026BB765291";return HardwareFinish}(n.Characteristic);t.HardwareFinish=Oe;n.Characteristic.HardwareFinish=Oe;var Le=function(e){i.__extends(HardwareRevision,e);function HardwareRevision(){var t=e.call(this,"Hardware Revision",HardwareRevision.UUID,{format:"string",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}HardwareRevision.UUID="00000053-0000-1000-8000-0026BB765291";return HardwareRevision}(n.Characteristic);t.HardwareRevision=Le;n.Characteristic.HardwareRevision=Le;var Me=function(e){i.__extends(HeartBeat,e);function HeartBeat(){var t=e.call(this,"Heart Beat",HeartBeat.UUID,{format:"uint32",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}HeartBeat.UUID="0000024A-0000-1000-8000-0026BB765291";return HeartBeat}(n.Characteristic);t.HeartBeat=Me;n.Characteristic.HeartBeat=Me;var Be=function(e){i.__extends(HeatingThresholdTemperature,e);function HeatingThresholdTemperature(){var t=e.call(this,"Heating Threshold Temperature",HeatingThresholdTemperature.UUID,{format:"float",perms:["ev","pr","pw"],unit:"celsius",minValue:0,maxValue:25,minStep:.1})||this;t.value=t.getDefaultValue();return t}HeatingThresholdTemperature.UUID="00000012-0000-1000-8000-0026BB765291";return HeatingThresholdTemperature}(n.Characteristic);t.HeatingThresholdTemperature=Be;n.Characteristic.HeatingThresholdTemperature=Be;var xe=function(e){i.__extends(HoldPosition,e);function HoldPosition(){var t=e.call(this,"Hold Position",HoldPosition.UUID,{format:"bool",perms:["pw"]})||this;t.value=t.getDefaultValue();return t}HoldPosition.UUID="0000006F-0000-1000-8000-0026BB765291";return HoldPosition}(n.Characteristic);t.HoldPosition=xe;n.Characteristic.HoldPosition=xe;var Fe=function(e){i.__extends(HomeKitCameraActive,e);function HomeKitCameraActive(){var t=e.call(this,"HomeKit Camera Active",HomeKitCameraActive.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}HomeKitCameraActive.UUID="0000021B-0000-1000-8000-0026BB765291";HomeKitCameraActive.OFF=0;HomeKitCameraActive.ON=1;return HomeKitCameraActive}(n.Characteristic);t.HomeKitCameraActive=Fe;n.Characteristic.HomeKitCameraActive=Fe;var ke=function(e){i.__extends(Hue,e);function Hue(){var t=e.call(this,"Hue",Hue.UUID,{format:"float",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:0,maxValue:360,minStep:1})||this;t.value=t.getDefaultValue();return t}Hue.UUID="00000013-0000-1000-8000-0026BB765291";return Hue}(n.Characteristic);t.Hue=ke;n.Characteristic.Hue=ke;var Ve=function(e){i.__extends(Identifier,e);function Identifier(){var t=e.call(this,"Identifier",Identifier.UUID,{format:"uint32",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}Identifier.UUID="000000E6-0000-1000-8000-0026BB765291";return Identifier}(n.Characteristic);t.Identifier=Ve;n.Characteristic.Identifier=Ve;var He=function(e){i.__extends(Identify,e);function Identify(){var t=e.call(this,"Identify",Identify.UUID,{format:"bool",perms:["pw"]})||this;t.value=t.getDefaultValue();return t}Identify.UUID="00000014-0000-1000-8000-0026BB765291";return Identify}(n.Characteristic);t.Identify=He;n.Characteristic.Identify=He;var je=function(e){i.__extends(ImageMirroring,e);function ImageMirroring(){var t=e.call(this,"Image Mirroring",ImageMirroring.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}ImageMirroring.UUID="0000011F-0000-1000-8000-0026BB765291";return ImageMirroring}(n.Characteristic);t.ImageMirroring=je;n.Characteristic.ImageMirroring=je;var We=function(e){i.__extends(ImageRotation,e);function ImageRotation(){var t=e.call(this,"Image Rotation",ImageRotation.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:0,maxValue:360,minStep:1})||this;t.value=t.getDefaultValue();return t}ImageRotation.UUID="0000011E-0000-1000-8000-0026BB765291";return ImageRotation}(n.Characteristic);t.ImageRotation=We;n.Characteristic.ImageRotation=We;var Ge=function(e){i.__extends(InputDeviceType,e);function InputDeviceType(){var t=e.call(this,"Input Device Type",InputDeviceType.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:6,minStep:1,validValues:[0,1,2,3,4,5,6]})||this;t.value=t.getDefaultValue();return t}InputDeviceType.UUID="000000DC-0000-1000-8000-0026BB765291";InputDeviceType.OTHER=0;InputDeviceType.TV=1;InputDeviceType.RECORDING=2;InputDeviceType.TUNER=3;InputDeviceType.PLAYBACK=4;InputDeviceType.AUDIO_SYSTEM=5;return InputDeviceType}(n.Characteristic);t.InputDeviceType=Ge;n.Characteristic.InputDeviceType=Ge;var Xe=function(e){i.__extends(InputSourceType,e);function InputSourceType(){var t=e.call(this,"Input Source Type",InputSourceType.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:10,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10]})||this;t.value=t.getDefaultValue();return t}InputSourceType.UUID="000000DB-0000-1000-8000-0026BB765291";InputSourceType.OTHER=0;InputSourceType.HOME_SCREEN=1;InputSourceType.TUNER=2;InputSourceType.HDMI=3;InputSourceType.COMPOSITE_VIDEO=4;InputSourceType.S_VIDEO=5;InputSourceType.COMPONENT_VIDEO=6;InputSourceType.DVI=7;InputSourceType.AIRPLAY=8;InputSourceType.USB=9;InputSourceType.APPLICATION=10;return InputSourceType}(n.Characteristic);t.InputSourceType=Xe;n.Characteristic.InputSourceType=Xe;var qe=function(e){i.__extends(InUse,e);function InUse(){var t=e.call(this,"In Use",InUse.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}InUse.UUID="000000D2-0000-1000-8000-0026BB765291";InUse.NOT_IN_USE=0;InUse.IN_USE=1;return InUse}(n.Characteristic);t.InUse=qe;n.Characteristic.InUse=qe;var Ye=function(e){i.__extends(IsConfigured,e);function IsConfigured(){var t=e.call(this,"Is Configured",IsConfigured.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}IsConfigured.UUID="000000D6-0000-1000-8000-0026BB765291";IsConfigured.NOT_CONFIGURED=0;IsConfigured.CONFIGURED=1;return IsConfigured}(n.Characteristic);t.IsConfigured=Ye;n.Characteristic.IsConfigured=Ye;var Ke=function(e){i.__extends(LeakDetected,e);function LeakDetected(){var t=e.call(this,"Leak Detected",LeakDetected.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}LeakDetected.UUID="00000070-0000-1000-8000-0026BB765291";LeakDetected.LEAK_NOT_DETECTED=0;LeakDetected.LEAK_DETECTED=1;return LeakDetected}(n.Characteristic);t.LeakDetected=Ke;n.Characteristic.LeakDetected=Ke;var Qe=function(e){i.__extends(LinkQuality,e);function LinkQuality(){var t=e.call(this,"Link Quality",LinkQuality.UUID,{format:"uint8",perms:["ev","pr"],minValue:1,maxValue:4})||this;t.value=t.getDefaultValue();return t}LinkQuality.UUID="0000009C-0000-1000-8000-0026BB765291";return LinkQuality}(n.Characteristic);t.LinkQuality=Qe;n.Characteristic.LinkQuality=Qe;var $e=function(e){i.__extends(ListPairings,e);function ListPairings(){var t=e.call(this,"List Pairings",ListPairings.UUID,{format:"tlv8",perms:["pr","pw"]})||this;t.value=t.getDefaultValue();return t}ListPairings.UUID="00000050-0000-1000-8000-0026BB765291";return ListPairings}(n.Characteristic);t.ListPairings=$e;n.Characteristic.ListPairings=$e;var ze=function(e){i.__extends(LockControlPoint,e);function LockControlPoint(){var t=e.call(this,"Lock Control Point",LockControlPoint.UUID,{format:"tlv8",perms:["pw"]})||this;t.value=t.getDefaultValue();return t}LockControlPoint.UUID="00000019-0000-1000-8000-0026BB765291";return LockControlPoint}(n.Characteristic);t.LockControlPoint=ze;n.Characteristic.LockControlPoint=ze;var Je=function(e){i.__extends(LockCurrentState,e);function LockCurrentState(){var t=e.call(this,"Lock Current State",LockCurrentState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;t.value=t.getDefaultValue();return t}LockCurrentState.UUID="0000001D-0000-1000-8000-0026BB765291";LockCurrentState.UNSECURED=0;LockCurrentState.SECURED=1;LockCurrentState.JAMMED=2;LockCurrentState.UNKNOWN=3;return LockCurrentState}(n.Characteristic);t.LockCurrentState=Je;n.Characteristic.LockCurrentState=Je;var Ze=function(e){i.__extends(LockLastKnownAction,e);function LockLastKnownAction(){var t=e.call(this,"Lock Last Known Action",LockLastKnownAction.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:10,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10]})||this;t.value=t.getDefaultValue();return t}LockLastKnownAction.UUID="0000001C-0000-1000-8000-0026BB765291";LockLastKnownAction.SECURED_PHYSICALLY_INTERIOR=0;LockLastKnownAction.UNSECURED_PHYSICALLY_INTERIOR=1;LockLastKnownAction.SECURED_PHYSICALLY_EXTERIOR=2;LockLastKnownAction.UNSECURED_PHYSICALLY_EXTERIOR=3;LockLastKnownAction.SECURED_BY_KEYPAD=4;LockLastKnownAction.UNSECURED_BY_KEYPAD=5;LockLastKnownAction.SECURED_REMOTELY=6;LockLastKnownAction.UNSECURED_REMOTELY=7;LockLastKnownAction.SECURED_BY_AUTO_SECURE_TIMEOUT=8;LockLastKnownAction.SECURED_PHYSICALLY=9;LockLastKnownAction.UNSECURED_PHYSICALLY=10;return LockLastKnownAction}(n.Characteristic);t.LockLastKnownAction=Ze;n.Characteristic.LockLastKnownAction=Ze;var et=function(e){i.__extends(LockManagementAutoSecurityTimeout,e);function LockManagementAutoSecurityTimeout(){var t=e.call(this,"Lock Management Auto Security Timeout",LockManagementAutoSecurityTimeout.UUID,{format:"uint32",perms:["ev","pr","pw"],unit:"seconds"})||this;t.value=t.getDefaultValue();return t}LockManagementAutoSecurityTimeout.UUID="0000001A-0000-1000-8000-0026BB765291";return LockManagementAutoSecurityTimeout}(n.Characteristic);t.LockManagementAutoSecurityTimeout=et;n.Characteristic.LockManagementAutoSecurityTimeout=et;var tt=function(e){i.__extends(LockPhysicalControls,e);function LockPhysicalControls(){var t=e.call(this,"Lock Physical Controls",LockPhysicalControls.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}LockPhysicalControls.UUID="000000A7-0000-1000-8000-0026BB765291";LockPhysicalControls.CONTROL_LOCK_DISABLED=0;LockPhysicalControls.CONTROL_LOCK_ENABLED=1;return LockPhysicalControls}(n.Characteristic);t.LockPhysicalControls=tt;n.Characteristic.LockPhysicalControls=tt;var rt=function(e){i.__extends(LockTargetState,e);function LockTargetState(){var t=e.call(this,"Lock Target State",LockTargetState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}LockTargetState.UUID="0000001E-0000-1000-8000-0026BB765291";LockTargetState.UNSECURED=0;LockTargetState.SECURED=1;return LockTargetState}(n.Characteristic);t.LockTargetState=rt;n.Characteristic.LockTargetState=rt;var it=function(e){i.__extends(Logs,e);function Logs(){var t=e.call(this,"Logs",Logs.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}Logs.UUID="0000001F-0000-1000-8000-0026BB765291";return Logs}(n.Characteristic);t.Logs=it;n.Characteristic.Logs=it;var nt=function(e){i.__extends(MACRetransmissionMaximum,e);function MACRetransmissionMaximum(){var t=e.call(this,"MAC Retransmission Maximum",MACRetransmissionMaximum.UUID,{format:"uint8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}MACRetransmissionMaximum.UUID="00000247-0000-1000-8000-0026BB765291";return MACRetransmissionMaximum}(n.Characteristic);t.MACRetransmissionMaximum=nt;n.Characteristic.MACRetransmissionMaximum=nt;var at=function(e){i.__extends(MACTransmissionCounters,e);function MACTransmissionCounters(){var t=e.call(this,"MAC Transmission Counters",MACTransmissionCounters.UUID,{format:"data",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}MACTransmissionCounters.UUID="00000248-0000-1000-8000-0026BB765291";return MACTransmissionCounters}(n.Characteristic);t.MACTransmissionCounters=at;n.Characteristic.MACTransmissionCounters=at;var ot=function(e){i.__extends(ManagedNetworkEnable,e);function ManagedNetworkEnable(){var t=e.call(this,"Managed Network Enable",ManagedNetworkEnable.UUID,{format:"uint8",perms:["ev","pr","pw","tw"],minValue:0,maxValue:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}ManagedNetworkEnable.UUID="00000215-0000-1000-8000-0026BB765291";ManagedNetworkEnable.DISABLED=0;ManagedNetworkEnable.ENABLED=1;return ManagedNetworkEnable}(n.Characteristic);t.ManagedNetworkEnable=ot;n.Characteristic.ManagedNetworkEnable=ot;var st=function(e){i.__extends(ManuallyDisabled,e);function ManuallyDisabled(){var t=e.call(this,"Manually Disabled",ManuallyDisabled.UUID,{format:"bool",perms:["ev","pr"],validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}ManuallyDisabled.UUID="00000227-0000-1000-8000-0026BB765291";ManuallyDisabled.ENABLED=0;ManuallyDisabled.DISABLED=1;return ManuallyDisabled}(n.Characteristic);t.ManuallyDisabled=st;n.Characteristic.ManuallyDisabled=st;var ct=function(e){i.__extends(Manufacturer,e);function Manufacturer(){var t=e.call(this,"Manufacturer",Manufacturer.UUID,{format:"string",perms:["pr"],maxLen:64})||this;t.value=t.getDefaultValue();return t}Manufacturer.UUID="00000020-0000-1000-8000-0026BB765291";return Manufacturer}(n.Characteristic);t.Manufacturer=ct;n.Characteristic.Manufacturer=ct;var ut=function(e){i.__extends(MaximumTransmitPower,e);function MaximumTransmitPower(){var t=e.call(this,"Maximum Transmit Power",MaximumTransmitPower.UUID,{format:"int",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}MaximumTransmitPower.UUID="00000243-0000-1000-8000-0026BB765291";return MaximumTransmitPower}(n.Characteristic);t.MaximumTransmitPower=ut;n.Characteristic.MaximumTransmitPower=ut;var lt=function(e){i.__extends(MetricsBufferFullState,e);function MetricsBufferFullState(){var t=e.call(this,"Metrics Buffer Full State",MetricsBufferFullState.UUID,{format:"bool",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}MetricsBufferFullState.UUID="00000272-0000-1000-8000-0026BB765291";return MetricsBufferFullState}(n.Characteristic);t.MetricsBufferFullState=lt;n.Characteristic.MetricsBufferFullState=lt;var dt=function(e){i.__extends(Model,e);function Model(){var t=e.call(this,"Model",Model.UUID,{format:"string",perms:["pr"],maxLen:64})||this;t.value=t.getDefaultValue();return t}Model.UUID="00000021-0000-1000-8000-0026BB765291";return Model}(n.Characteristic);t.Model=dt;n.Characteristic.Model=dt;var ht=function(e){i.__extends(MotionDetected,e);function MotionDetected(){var t=e.call(this,"Motion Detected",MotionDetected.UUID,{format:"bool",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}MotionDetected.UUID="00000022-0000-1000-8000-0026BB765291";return MotionDetected}(n.Characteristic);t.MotionDetected=ht;n.Characteristic.MotionDetected=ht;var ft=function(e){i.__extends(MultifunctionButton,e);function MultifunctionButton(){var t=e.call(this,"Multifunction Button",MultifunctionButton.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1})||this;t.value=t.getDefaultValue();return t}MultifunctionButton.UUID="0000026B-0000-1000-8000-0026BB765291";return MultifunctionButton}(n.Characteristic);t.MultifunctionButton=ft;n.Characteristic.MultifunctionButton=ft;var pt=function(e){i.__extends(Mute,e);function Mute(){var t=e.call(this,"Mute",Mute.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}Mute.UUID="0000011A-0000-1000-8000-0026BB765291";return Mute}(n.Characteristic);t.Mute=pt;n.Characteristic.Mute=pt;var vt=function(e){i.__extends(Name,e);function Name(){var t=e.call(this,"Name",Name.UUID,{format:"string",perms:["pr"],maxLen:64})||this;t.value=t.getDefaultValue();return t}Name.UUID="00000023-0000-1000-8000-0026BB765291";return Name}(n.Characteristic);t.Name=vt;n.Characteristic.Name=vt;var mt=function(e){i.__extends(NetworkAccessViolationControl,e);function NetworkAccessViolationControl(){var t=e.call(this,"Network Access Violation Control",NetworkAccessViolationControl.UUID,{format:"tlv8",perms:["ev","pr","pw","tw","wr"]})||this;t.value=t.getDefaultValue();return t}NetworkAccessViolationControl.UUID="0000021F-0000-1000-8000-0026BB765291";return NetworkAccessViolationControl}(n.Characteristic);t.NetworkAccessViolationControl=mt;n.Characteristic.NetworkAccessViolationControl=mt;var gt=function(e){i.__extends(NetworkClientProfileControl,e);function NetworkClientProfileControl(){var t=e.call(this,"Network Client Profile Control",NetworkClientProfileControl.UUID,{format:"tlv8",perms:["ev","pr","pw","tw","wr"]})||this;t.value=t.getDefaultValue();return t}NetworkClientProfileControl.UUID="0000020C-0000-1000-8000-0026BB765291";return NetworkClientProfileControl}(n.Characteristic);t.NetworkClientProfileControl=gt;n.Characteristic.NetworkClientProfileControl=gt;var yt=function(e){i.__extends(NetworkClientStatusControl,e);function NetworkClientStatusControl(){var t=e.call(this,"Network Client Status Control",NetworkClientStatusControl.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;t.value=t.getDefaultValue();return t}NetworkClientStatusControl.UUID="0000020D-0000-1000-8000-0026BB765291";return NetworkClientStatusControl}(n.Characteristic);t.NetworkClientStatusControl=yt;n.Characteristic.NetworkClientStatusControl=yt;var St=function(e){i.__extends(NFCAccessControlPoint,e);function NFCAccessControlPoint(){var t=e.call(this,"NFC Access Control Point",NFCAccessControlPoint.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;t.value=t.getDefaultValue();return t}NFCAccessControlPoint.UUID="00000264-0000-1000-8000-0026BB765291";return NFCAccessControlPoint}(n.Characteristic);t.NFCAccessControlPoint=St;n.Characteristic.NFCAccessControlPoint=St;var Ct=function(e){i.__extends(NFCAccessSupportedConfiguration,e);function NFCAccessSupportedConfiguration(){var t=e.call(this,"NFC Access Supported Configuration",NFCAccessSupportedConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}NFCAccessSupportedConfiguration.UUID="00000265-0000-1000-8000-0026BB765291";return NFCAccessSupportedConfiguration}(n.Characteristic);t.NFCAccessSupportedConfiguration=Ct;n.Characteristic.NFCAccessSupportedConfiguration=Ct;var Tt=function(e){i.__extends(NightVision,e);function NightVision(){var t=e.call(this,"Night Vision",NightVision.UUID,{format:"bool",perms:["ev","pr","pw","tw"]})||this;t.value=t.getDefaultValue();return t}NightVision.UUID="0000011B-0000-1000-8000-0026BB765291";return NightVision}(n.Characteristic);t.NightVision=Tt;n.Characteristic.NightVision=Tt;var Et=function(e){i.__extends(NitrogenDioxideDensity,e);function NitrogenDioxideDensity(){var t=e.call(this,"Nitrogen Dioxide Density",NitrogenDioxideDensity.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;t.value=t.getDefaultValue();return t}NitrogenDioxideDensity.UUID="000000C4-0000-1000-8000-0026BB765291";return NitrogenDioxideDensity}(n.Characteristic);t.NitrogenDioxideDensity=Et;n.Characteristic.NitrogenDioxideDensity=Et;var At=function(e){i.__extends(ObstructionDetected,e);function ObstructionDetected(){var t=e.call(this,"Obstruction Detected",ObstructionDetected.UUID,{format:"bool",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}ObstructionDetected.UUID="00000024-0000-1000-8000-0026BB765291";return ObstructionDetected}(n.Characteristic);t.ObstructionDetected=At;n.Characteristic.ObstructionDetected=At;var Dt=function(e){i.__extends(OccupancyDetected,e);function OccupancyDetected(){var t=e.call(this,"Occupancy Detected",OccupancyDetected.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}OccupancyDetected.UUID="00000071-0000-1000-8000-0026BB765291";OccupancyDetected.OCCUPANCY_NOT_DETECTED=0;OccupancyDetected.OCCUPANCY_DETECTED=1;return OccupancyDetected}(n.Characteristic);t.OccupancyDetected=Dt;n.Characteristic.OccupancyDetected=Dt;var _t=function(e){i.__extends(On,e);function On(){var t=e.call(this,"On",On.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}On.UUID="00000025-0000-1000-8000-0026BB765291";return On}(n.Characteristic);t.On=_t;n.Characteristic.On=_t;var It=function(e){i.__extends(OperatingStateResponse,e);function OperatingStateResponse(){var t=e.call(this,"Operating State Response",OperatingStateResponse.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}OperatingStateResponse.UUID="00000232-0000-1000-8000-0026BB765291";return OperatingStateResponse}(n.Characteristic);t.OperatingStateResponse=It;n.Characteristic.OperatingStateResponse=It;var bt=function(e){i.__extends(OpticalZoom,e);function OpticalZoom(){var t=e.call(this,"Optical Zoom",OpticalZoom.UUID,{format:"float",perms:["ev","pr","pw"],minStep:.1})||this;t.value=t.getDefaultValue();return t}OpticalZoom.UUID="0000011C-0000-1000-8000-0026BB765291";return OpticalZoom}(n.Characteristic);t.OpticalZoom=bt;n.Characteristic.OpticalZoom=bt;var wt=function(e){i.__extends(OutletInUse,e);function OutletInUse(){var t=e.call(this,"Outlet In Use",OutletInUse.UUID,{format:"bool",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}OutletInUse.UUID="00000026-0000-1000-8000-0026BB765291";return OutletInUse}(n.Characteristic);t.OutletInUse=wt;n.Characteristic.OutletInUse=wt;var Rt=function(e){i.__extends(OzoneDensity,e);function OzoneDensity(){var t=e.call(this,"Ozone Density",OzoneDensity.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;t.value=t.getDefaultValue();return t}OzoneDensity.UUID="000000C3-0000-1000-8000-0026BB765291";return OzoneDensity}(n.Characteristic);t.OzoneDensity=Rt;n.Characteristic.OzoneDensity=Rt;var Nt=function(e){i.__extends(PairingFeatures,e);function PairingFeatures(){var t=e.call(this,"Pairing Features",PairingFeatures.UUID,{format:"uint8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}PairingFeatures.UUID="0000004F-0000-1000-8000-0026BB765291";return PairingFeatures}(n.Characteristic);t.PairingFeatures=Nt;n.Characteristic.PairingFeatures=Nt;var Ut=function(e){i.__extends(PairSetup,e);function PairSetup(){var t=e.call(this,"Pair Setup",PairSetup.UUID,{format:"tlv8",perms:["pr","pw"]})||this;t.value=t.getDefaultValue();return t}PairSetup.UUID="0000004C-0000-1000-8000-0026BB765291";return PairSetup}(n.Characteristic);t.PairSetup=Ut;n.Characteristic.PairSetup=Ut;var Pt=function(e){i.__extends(PairVerify,e);function PairVerify(){var t=e.call(this,"Pair Verify",PairVerify.UUID,{format:"tlv8",perms:["pr","pw"]})||this;t.value=t.getDefaultValue();return t}PairVerify.UUID="0000004E-0000-1000-8000-0026BB765291";return PairVerify}(n.Characteristic);t.PairVerify=Pt;n.Characteristic.PairVerify=Pt;var Ot=function(e){i.__extends(PasswordSetting,e);function PasswordSetting(){var t=e.call(this,"Password Setting",PasswordSetting.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}PasswordSetting.UUID="000000E4-0000-1000-8000-0026BB765291";return PasswordSetting}(n.Characteristic);t.PasswordSetting=Ot;n.Characteristic.PasswordSetting=Ot;var Lt=function(e){i.__extends(PeriodicSnapshotsActive,e);function PeriodicSnapshotsActive(){var t=e.call(this,"Periodic Snapshots Active",PeriodicSnapshotsActive.UUID,{format:"uint8",perms:["ev","pr","pw"],validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}PeriodicSnapshotsActive.UUID="00000225-0000-1000-8000-0026BB765291";PeriodicSnapshotsActive.DISABLE=0;PeriodicSnapshotsActive.ENABLE=1;return PeriodicSnapshotsActive}(n.Characteristic);t.PeriodicSnapshotsActive=Lt;n.Characteristic.PeriodicSnapshotsActive=Lt;var Mt=function(e){i.__extends(PictureMode,e);function PictureMode(){var t=e.call(this,"Picture Mode",PictureMode.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:13,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10,11,12,13]})||this;t.value=t.getDefaultValue();return t}PictureMode.UUID="000000E2-0000-1000-8000-0026BB765291";PictureMode.OTHER=0;PictureMode.STANDARD=1;PictureMode.CALIBRATED=2;PictureMode.CALIBRATED_DARK=3;PictureMode.VIVID=4;PictureMode.GAME=5;PictureMode.COMPUTER=6;PictureMode.CUSTOM=7;return PictureMode}(n.Characteristic);t.PictureMode=Mt;n.Characteristic.PictureMode=Mt;var Bt=function(e){i.__extends(Ping,e);function Ping(){var t=e.call(this,"Ping",Ping.UUID,{format:"data",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}Ping.UUID="0000023C-0000-1000-8000-0026BB765291";return Ping}(n.Characteristic);t.Ping=Bt;n.Characteristic.Ping=Bt;var xt=function(e){i.__extends(PM10Density,e);function PM10Density(){var t=e.call(this,"PM10 Density",PM10Density.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;t.value=t.getDefaultValue();return t}PM10Density.UUID="000000C7-0000-1000-8000-0026BB765291";return PM10Density}(n.Characteristic);t.PM10Density=xt;n.Characteristic.PM10Density=xt;var Ft=function(e){i.__extends(PM2_5Density,e);function PM2_5Density(){var t=e.call(this,"PM2.5 Density",PM2_5Density.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;t.value=t.getDefaultValue();return t}PM2_5Density.UUID="000000C6-0000-1000-8000-0026BB765291";return PM2_5Density}(n.Characteristic);t.PM2_5Density=Ft;n.Characteristic.PM2_5Density=Ft;var kt=function(e){i.__extends(PositionState,e);function PositionState(){var t=e.call(this,"Position State",PositionState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}PositionState.UUID="00000072-0000-1000-8000-0026BB765291";PositionState.DECREASING=0;PositionState.INCREASING=1;PositionState.STOPPED=2;return PositionState}(n.Characteristic);t.PositionState=kt;n.Characteristic.PositionState=kt;var Vt=function(e){i.__extends(PowerModeSelection,e);function PowerModeSelection(){var t=e.call(this,"Power Mode Selection",PowerModeSelection.UUID,{format:"uint8",perms:["pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}PowerModeSelection.UUID="000000DF-0000-1000-8000-0026BB765291";PowerModeSelection.SHOW=0;PowerModeSelection.HIDE=1;return PowerModeSelection}(n.Characteristic);t.PowerModeSelection=Vt;n.Characteristic.PowerModeSelection=Vt;var Ht=function(e){i.__extends(ProductData,e);function ProductData(){var t=e.call(this,"Product Data",ProductData.UUID,{format:"data",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}ProductData.UUID="00000220-0000-1000-8000-0026BB765291";return ProductData}(n.Characteristic);t.ProductData=Ht;n.Characteristic.ProductData=Ht;var jt=function(e){i.__extends(ProgrammableSwitchEvent,e);function ProgrammableSwitchEvent(){var t=e.call(this,"Programmable Switch Event",ProgrammableSwitchEvent.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}ProgrammableSwitchEvent.UUID="00000073-0000-1000-8000-0026BB765291";ProgrammableSwitchEvent.SINGLE_PRESS=0;ProgrammableSwitchEvent.DOUBLE_PRESS=1;ProgrammableSwitchEvent.LONG_PRESS=2;return ProgrammableSwitchEvent}(n.Characteristic);t.ProgrammableSwitchEvent=jt;n.Characteristic.ProgrammableSwitchEvent=jt;var Wt=function(e){i.__extends(ProgrammableSwitchOutputState,e);function ProgrammableSwitchOutputState(){var t=e.call(this,"Programmable Switch Output State",ProgrammableSwitchOutputState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1})||this;t.value=t.getDefaultValue();return t}ProgrammableSwitchOutputState.UUID="00000074-0000-1000-8000-0026BB765291";return ProgrammableSwitchOutputState}(n.Characteristic);t.ProgrammableSwitchOutputState=Wt;n.Characteristic.ProgrammableSwitchOutputState=Wt;var Gt=function(e){i.__extends(ProgramMode,e);function ProgramMode(){var t=e.call(this,"Program Mode",ProgramMode.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}ProgramMode.UUID="000000D1-0000-1000-8000-0026BB765291";ProgramMode.NO_PROGRAM_SCHEDULED=0;ProgramMode.PROGRAM_SCHEDULED=1;ProgramMode.PROGRAM_SCHEDULED_MANUAL_MODE_=2;return ProgramMode}(n.Characteristic);t.ProgramMode=Gt;n.Characteristic.ProgramMode=Gt;var Xt=function(e){i.__extends(Reachable,e);function Reachable(){var t=e.call(this,"Reachable",Reachable.UUID,{format:"bool",perms:["pr","pw"]})||this;t.value=t.getDefaultValue();return t}Reachable.UUID="00000063-0000-1000-8000-0026BB765291";return Reachable}(n.Characteristic);t.Reachable=Xt;n.Characteristic.Reachable=Xt;var qt=function(e){i.__extends(ReceivedSignalStrengthIndication,e);function ReceivedSignalStrengthIndication(){var t=e.call(this,"Received Signal Strength Indication",ReceivedSignalStrengthIndication.UUID,{format:"int",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}ReceivedSignalStrengthIndication.UUID="0000023F-0000-1000-8000-0026BB765291";return ReceivedSignalStrengthIndication}(n.Characteristic);t.ReceivedSignalStrengthIndication=qt;n.Characteristic.ReceivedSignalStrengthIndication=qt;var Yt=function(e){i.__extends(ReceiverSensitivity,e);function ReceiverSensitivity(){var t=e.call(this,"Receiver Sensitivity",ReceiverSensitivity.UUID,{format:"int",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}ReceiverSensitivity.UUID="00000244-0000-1000-8000-0026BB765291";return ReceiverSensitivity}(n.Characteristic);t.ReceiverSensitivity=Yt;n.Characteristic.ReceiverSensitivity=Yt;var Kt=function(e){i.__extends(RecordingAudioActive,e);function RecordingAudioActive(){var t=e.call(this,"Recording Audio Active",RecordingAudioActive.UUID,{format:"uint8",perms:["ev","pr","pw","tw"],validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}RecordingAudioActive.UUID="00000226-0000-1000-8000-0026BB765291";RecordingAudioActive.DISABLE=0;RecordingAudioActive.ENABLE=1;return RecordingAudioActive}(n.Characteristic);t.RecordingAudioActive=Kt;n.Characteristic.RecordingAudioActive=Kt;var Qt=function(e){i.__extends(RelativeHumidityDehumidifierThreshold,e);function RelativeHumidityDehumidifierThreshold(){var t=e.call(this,"Relative Humidity Dehumidifier Threshold",RelativeHumidityDehumidifierThreshold.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}RelativeHumidityDehumidifierThreshold.UUID="000000C9-0000-1000-8000-0026BB765291";return RelativeHumidityDehumidifierThreshold}(n.Characteristic);t.RelativeHumidityDehumidifierThreshold=Qt;n.Characteristic.RelativeHumidityDehumidifierThreshold=Qt;var $t=function(e){i.__extends(RelativeHumidityHumidifierThreshold,e);function RelativeHumidityHumidifierThreshold(){var t=e.call(this,"Relative Humidity Humidifier Threshold",RelativeHumidityHumidifierThreshold.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}RelativeHumidityHumidifierThreshold.UUID="000000CA-0000-1000-8000-0026BB765291";return RelativeHumidityHumidifierThreshold}(n.Characteristic);t.RelativeHumidityHumidifierThreshold=$t;n.Characteristic.RelativeHumidityHumidifierThreshold=$t;var zt=function(e){i.__extends(RelayControlPoint,e);function RelayControlPoint(){var t=e.call(this,"Relay Control Point",RelayControlPoint.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}RelayControlPoint.UUID="0000005E-0000-1000-8000-0026BB765291";return RelayControlPoint}(n.Characteristic);t.RelayControlPoint=zt;n.Characteristic.RelayControlPoint=zt;var Jt=function(e){i.__extends(RelayEnabled,e);function RelayEnabled(){var t=e.call(this,"Relay Enabled",RelayEnabled.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}RelayEnabled.UUID="0000005B-0000-1000-8000-0026BB765291";return RelayEnabled}(n.Characteristic);t.RelayEnabled=Jt;n.Characteristic.RelayEnabled=Jt;var Zt=function(e){i.__extends(RelayState,e);function RelayState(){var t=e.call(this,"Relay State",RelayState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:5,minStep:1})||this;t.value=t.getDefaultValue();return t}RelayState.UUID="0000005C-0000-1000-8000-0026BB765291";return RelayState}(n.Characteristic);t.RelayState=Zt;n.Characteristic.RelayState=Zt;var er=function(e){i.__extends(RemainingDuration,e);function RemainingDuration(){var t=e.call(this,"Remaining Duration",RemainingDuration.UUID,{format:"uint32",perms:["ev","pr"],unit:"seconds",minValue:0,maxValue:3600,minStep:1})||this;t.value=t.getDefaultValue();return t}RemainingDuration.UUID="000000D4-0000-1000-8000-0026BB765291";return RemainingDuration}(n.Characteristic);t.RemainingDuration=er;n.Characteristic.RemainingDuration=er;var tr=function(e){i.__extends(RemoteKey,e);function RemoteKey(){var t=e.call(this,"Remote Key",RemoteKey.UUID,{format:"uint8",perms:["pw"],minValue:0,maxValue:16,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]})||this;t.value=t.getDefaultValue();return t}RemoteKey.UUID="000000E1-0000-1000-8000-0026BB765291";RemoteKey.REWIND=0;RemoteKey.FAST_FORWARD=1;RemoteKey.NEXT_TRACK=2;RemoteKey.PREVIOUS_TRACK=3;RemoteKey.ARROW_UP=4;RemoteKey.ARROW_DOWN=5;RemoteKey.ARROW_LEFT=6;RemoteKey.ARROW_RIGHT=7;RemoteKey.SELECT=8;RemoteKey.BACK=9;RemoteKey.EXIT=10;RemoteKey.PLAY_PAUSE=11;RemoteKey.INFORMATION=15;return RemoteKey}(n.Characteristic);t.RemoteKey=tr;n.Characteristic.RemoteKey=tr;var rr=function(e){i.__extends(ResetFilterIndication,e);function ResetFilterIndication(){var t=e.call(this,"Reset Filter Indication",ResetFilterIndication.UUID,{format:"uint8",perms:["pw"],minValue:1,maxValue:1,minStep:1})||this;t.value=t.getDefaultValue();return t}ResetFilterIndication.UUID="000000AD-0000-1000-8000-0026BB765291";return ResetFilterIndication}(n.Characteristic);t.ResetFilterIndication=rr;n.Characteristic.ResetFilterIndication=rr;var ir=function(e){i.__extends(RotationDirection,e);function RotationDirection(){var t=e.call(this,"Rotation Direction",RotationDirection.UUID,{format:"int",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}RotationDirection.UUID="00000028-0000-1000-8000-0026BB765291";RotationDirection.CLOCKWISE=0;RotationDirection.COUNTER_CLOCKWISE=1;return RotationDirection}(n.Characteristic);t.RotationDirection=ir;n.Characteristic.RotationDirection=ir;var nr=function(e){i.__extends(RotationSpeed,e);function RotationSpeed(){var t=e.call(this,"Rotation Speed",RotationSpeed.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}RotationSpeed.UUID="00000029-0000-1000-8000-0026BB765291";return RotationSpeed}(n.Characteristic);t.RotationSpeed=nr;n.Characteristic.RotationSpeed=nr;var ar=function(e){i.__extends(RouterStatus,e);function RouterStatus(){var t=e.call(this,"Router Status",RouterStatus.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}RouterStatus.UUID="0000020E-0000-1000-8000-0026BB765291";RouterStatus.READY=0;RouterStatus.NOT_READY=1;return RouterStatus}(n.Characteristic);t.RouterStatus=ar;n.Characteristic.RouterStatus=ar;var sr=function(e){i.__extends(Saturation,e);function Saturation(){var t=e.call(this,"Saturation",Saturation.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}Saturation.UUID="0000002F-0000-1000-8000-0026BB765291";return Saturation}(n.Characteristic);t.Saturation=sr;n.Characteristic.Saturation=sr;var cr=function(e){i.__extends(SecuritySystemAlarmType,e);function SecuritySystemAlarmType(){var t=e.call(this,"Security System Alarm Type",SecuritySystemAlarmType.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1})||this;t.value=t.getDefaultValue();return t}SecuritySystemAlarmType.UUID="0000008E-0000-1000-8000-0026BB765291";return SecuritySystemAlarmType}(n.Characteristic);t.SecuritySystemAlarmType=cr;n.Characteristic.SecuritySystemAlarmType=cr;var ur=function(e){i.__extends(SecuritySystemCurrentState,e);function SecuritySystemCurrentState(){var t=e.call(this,"Security System Current State",SecuritySystemCurrentState.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:4,minStep:1,validValues:[0,1,2,3,4]})||this;t.value=t.getDefaultValue();return t}SecuritySystemCurrentState.UUID="00000066-0000-1000-8000-0026BB765291";SecuritySystemCurrentState.STAY_ARM=0;SecuritySystemCurrentState.AWAY_ARM=1;SecuritySystemCurrentState.NIGHT_ARM=2;SecuritySystemCurrentState.DISARMED=3;SecuritySystemCurrentState.ALARM_TRIGGERED=4;return SecuritySystemCurrentState}(n.Characteristic);t.SecuritySystemCurrentState=ur;n.Characteristic.SecuritySystemCurrentState=ur;var lr=function(e){i.__extends(SecuritySystemTargetState,e);function SecuritySystemTargetState(){var t=e.call(this,"Security System Target State",SecuritySystemTargetState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;t.value=t.getDefaultValue();return t}SecuritySystemTargetState.UUID="00000067-0000-1000-8000-0026BB765291";SecuritySystemTargetState.STAY_ARM=0;SecuritySystemTargetState.AWAY_ARM=1;SecuritySystemTargetState.NIGHT_ARM=2;SecuritySystemTargetState.DISARM=3;return SecuritySystemTargetState}(n.Characteristic);t.SecuritySystemTargetState=lr;n.Characteristic.SecuritySystemTargetState=lr;var dr=function(e){i.__extends(SelectedAudioStreamConfiguration,e);function SelectedAudioStreamConfiguration(){var t=e.call(this,"Selected Audio Stream Configuration",SelectedAudioStreamConfiguration.UUID,{format:"tlv8",perms:["pr","pw"]})||this;t.value=t.getDefaultValue();return t}SelectedAudioStreamConfiguration.UUID="00000128-0000-1000-8000-0026BB765291";return SelectedAudioStreamConfiguration}(n.Characteristic);t.SelectedAudioStreamConfiguration=dr;n.Characteristic.SelectedAudioStreamConfiguration=dr;var hr=function(e){i.__extends(SelectedCameraRecordingConfiguration,e);function SelectedCameraRecordingConfiguration(){var t=e.call(this,"Selected Camera Recording Configuration",SelectedCameraRecordingConfiguration.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}SelectedCameraRecordingConfiguration.UUID="00000209-0000-1000-8000-0026BB765291";return SelectedCameraRecordingConfiguration}(n.Characteristic);t.SelectedCameraRecordingConfiguration=hr;n.Characteristic.SelectedCameraRecordingConfiguration=hr;var fr=function(e){i.__extends(SelectedDiagnosticsModes,e);function SelectedDiagnosticsModes(){var t=e.call(this,"Selected Diagnostics Modes",SelectedDiagnosticsModes.UUID,{format:"uint32",perms:["pr","pw"]})||this;t.value=t.getDefaultValue();return t}SelectedDiagnosticsModes.UUID="0000024D-0000-1000-8000-0026BB765291";return SelectedDiagnosticsModes}(n.Characteristic);t.SelectedDiagnosticsModes=fr;n.Characteristic.SelectedDiagnosticsModes=fr;var pr=function(e){i.__extends(SelectedRTPStreamConfiguration,e);function SelectedRTPStreamConfiguration(){var t=e.call(this,"Selected RTP Stream Configuration",SelectedRTPStreamConfiguration.UUID,{format:"tlv8",perms:["pr","pw"]})||this;t.value=t.getDefaultValue();return t}SelectedRTPStreamConfiguration.UUID="00000117-0000-1000-8000-0026BB765291";return SelectedRTPStreamConfiguration}(n.Characteristic);t.SelectedRTPStreamConfiguration=pr;n.Characteristic.SelectedRTPStreamConfiguration=pr;var vr=function(e){i.__extends(SelectedSleepConfiguration,e);function SelectedSleepConfiguration(){var t=e.call(this,"Selected Sleep Configuration",SelectedSleepConfiguration.UUID,{format:"tlv8",perms:["ev","pr","pw","wr"]})||this;t.value=t.getDefaultValue();return t}SelectedSleepConfiguration.UUID="00000252-0000-1000-8000-0026BB765291";return SelectedSleepConfiguration}(n.Characteristic);t.SelectedSleepConfiguration=vr;n.Characteristic.SelectedSleepConfiguration=vr;var mr=function(e){i.__extends(SerialNumber,e);function SerialNumber(){var t=e.call(this,"Serial Number",SerialNumber.UUID,{format:"string",perms:["pr"],maxLen:64})||this;t.value=t.getDefaultValue();return t}SerialNumber.UUID="00000030-0000-1000-8000-0026BB765291";return SerialNumber}(n.Characteristic);t.SerialNumber=mr;n.Characteristic.SerialNumber=mr;var gr=function(e){i.__extends(ServiceLabelIndex,e);function ServiceLabelIndex(){var t=e.call(this,"Service Label Index",ServiceLabelIndex.UUID,{format:"uint8",perms:["pr"],minValue:1,maxValue:255,minStep:1})||this;t.value=t.getDefaultValue();return t}ServiceLabelIndex.UUID="000000CB-0000-1000-8000-0026BB765291";return ServiceLabelIndex}(n.Characteristic);t.ServiceLabelIndex=gr;n.Characteristic.ServiceLabelIndex=gr;var yr=function(e){i.__extends(ServiceLabelNamespace,e);function ServiceLabelNamespace(){var t=e.call(this,"Service Label Namespace",ServiceLabelNamespace.UUID,{format:"uint8",perms:["pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}ServiceLabelNamespace.UUID="000000CD-0000-1000-8000-0026BB765291";ServiceLabelNamespace.DOTS=0;ServiceLabelNamespace.ARABIC_NUMERALS=1;return ServiceLabelNamespace}(n.Characteristic);t.ServiceLabelNamespace=yr;n.Characteristic.ServiceLabelNamespace=yr;var Sr=function(e){i.__extends(SetDuration,e);function SetDuration(){var t=e.call(this,"Set Duration",SetDuration.UUID,{format:"uint32",perms:["ev","pr","pw"],unit:"seconds",minValue:0,maxValue:3600,minStep:1})||this;t.value=t.getDefaultValue();return t}SetDuration.UUID="000000D3-0000-1000-8000-0026BB765291";return SetDuration}(n.Characteristic);t.SetDuration=Sr;n.Characteristic.SetDuration=Sr;var Cr=function(e){i.__extends(SetupDataStreamTransport,e);function SetupDataStreamTransport(){var t=e.call(this,"Setup Data Stream Transport",SetupDataStreamTransport.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;t.value=t.getDefaultValue();return t}SetupDataStreamTransport.UUID="00000131-0000-1000-8000-0026BB765291";return SetupDataStreamTransport}(n.Characteristic);t.SetupDataStreamTransport=Cr;n.Characteristic.SetupDataStreamTransport=Cr;var Tr=function(e){i.__extends(SetupEndpoints,e);function SetupEndpoints(){var t=e.call(this,"Setup Endpoints",SetupEndpoints.UUID,{format:"tlv8",perms:["pr","pw"]})||this;t.value=t.getDefaultValue();return t}SetupEndpoints.UUID="00000118-0000-1000-8000-0026BB765291";return SetupEndpoints}(n.Characteristic);t.SetupEndpoints=Tr;n.Characteristic.SetupEndpoints=Tr;var Er=function(e){i.__extends(SetupTransferTransport,e);function SetupTransferTransport(){var t=e.call(this,"Setup Transfer Transport",SetupTransferTransport.UUID,{format:"tlv8",perms:["pw","wr"]})||this;t.value=t.getDefaultValue();return t}SetupTransferTransport.UUID="00000201-0000-1000-8000-0026BB765291";return SetupTransferTransport}(n.Characteristic);t.SetupTransferTransport=Er;n.Characteristic.SetupTransferTransport=Er;var Ar=function(e){i.__extends(SignalToNoiseRatio,e);function SignalToNoiseRatio(){var t=e.call(this,"Signal To Noise Ratio",SignalToNoiseRatio.UUID,{format:"int",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SignalToNoiseRatio.UUID="00000241-0000-1000-8000-0026BB765291";return SignalToNoiseRatio}(n.Characteristic);t.SignalToNoiseRatio=Ar;n.Characteristic.SignalToNoiseRatio=Ar;var Dr=function(e){i.__extends(SiriEnable,e);function SiriEnable(){var t=e.call(this,"Siri Enable",SiriEnable.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;t.value=t.getDefaultValue();return t}SiriEnable.UUID="00000255-0000-1000-8000-0026BB765291";return SiriEnable}(n.Characteristic);t.SiriEnable=Dr;n.Characteristic.SiriEnable=Dr;var _r=function(e){i.__extends(SiriEndpointSessionStatus,e);function SiriEndpointSessionStatus(){var t=e.call(this,"Siri Endpoint Session Status",SiriEndpointSessionStatus.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}SiriEndpointSessionStatus.UUID="00000254-0000-1000-8000-0026BB765291";return SiriEndpointSessionStatus}(n.Characteristic);t.SiriEndpointSessionStatus=_r;n.Characteristic.SiriEndpointSessionStatus=_r;var Ir=function(e){i.__extends(SiriEngineVersion,e);function SiriEngineVersion(){var t=e.call(this,"Siri Engine Version",SiriEngineVersion.UUID,{format:"string",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SiriEngineVersion.UUID="0000025A-0000-1000-8000-0026BB765291";return SiriEngineVersion}(n.Characteristic);t.SiriEngineVersion=Ir;n.Characteristic.SiriEngineVersion=Ir;var br=function(e){i.__extends(SiriInputType,e);function SiriInputType(){var t=e.call(this,"Siri Input Type",SiriInputType.UUID,{format:"uint8",perms:["pr"],minValue:0,maxValue:0,validValues:[0]})||this;t.value=t.getDefaultValue();return t}SiriInputType.UUID="00000132-0000-1000-8000-0026BB765291";SiriInputType.PUSH_BUTTON_TRIGGERED_APPLE_TV=0;return SiriInputType}(n.Characteristic);t.SiriInputType=br;n.Characteristic.SiriInputType=br;var wr=function(e){i.__extends(SiriLightOnUse,e);function SiriLightOnUse(){var t=e.call(this,"Siri Light On Use",SiriLightOnUse.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;t.value=t.getDefaultValue();return t}SiriLightOnUse.UUID="00000258-0000-1000-8000-0026BB765291";return SiriLightOnUse}(n.Characteristic);t.SiriLightOnUse=wr;n.Characteristic.SiriLightOnUse=wr;var Rr=function(e){i.__extends(SiriListening,e);function SiriListening(){var t=e.call(this,"Siri Listening",SiriListening.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;t.value=t.getDefaultValue();return t}SiriListening.UUID="00000256-0000-1000-8000-0026BB765291";return SiriListening}(n.Characteristic);t.SiriListening=Rr;n.Characteristic.SiriListening=Rr;var Nr=function(e){i.__extends(SiriTouchToUse,e);function SiriTouchToUse(){var t=e.call(this,"Siri Touch To Use",SiriTouchToUse.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;t.value=t.getDefaultValue();return t}SiriTouchToUse.UUID="00000257-0000-1000-8000-0026BB765291";return SiriTouchToUse}(n.Characteristic);t.SiriTouchToUse=Nr;n.Characteristic.SiriTouchToUse=Nr;var Ur=function(e){i.__extends(SlatType,e);function SlatType(){var t=e.call(this,"Slat Type",SlatType.UUID,{format:"uint8",perms:["pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}SlatType.UUID="000000C0-0000-1000-8000-0026BB765291";SlatType.HORIZONTAL=0;SlatType.VERTICAL=1;return SlatType}(n.Characteristic);t.SlatType=Ur;n.Characteristic.SlatType=Ur;var Pr=function(e){i.__extends(SleepDiscoveryMode,e);function SleepDiscoveryMode(){var t=e.call(this,"Sleep Discovery Mode",SleepDiscoveryMode.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}SleepDiscoveryMode.UUID="000000E8-0000-1000-8000-0026BB765291";SleepDiscoveryMode.NOT_DISCOVERABLE=0;SleepDiscoveryMode.ALWAYS_DISCOVERABLE=1;return SleepDiscoveryMode}(n.Characteristic);t.SleepDiscoveryMode=Pr;n.Characteristic.SleepDiscoveryMode=Pr;var Or=function(e){i.__extends(SleepInterval,e);function SleepInterval(){var t=e.call(this,"Sleep Interval",SleepInterval.UUID,{format:"uint32",perms:["ev","pr"],minValue:0,minStep:1})||this;t.value=t.getDefaultValue();return t}SleepInterval.UUID="0000023A-0000-1000-8000-0026BB765291";return SleepInterval}(n.Characteristic);t.SleepInterval=Or;n.Characteristic.SleepInterval=Or;var Lr=function(e){i.__extends(SmokeDetected,e);function SmokeDetected(){var t=e.call(this,"Smoke Detected",SmokeDetected.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}SmokeDetected.UUID="00000076-0000-1000-8000-0026BB765291";SmokeDetected.SMOKE_NOT_DETECTED=0;SmokeDetected.SMOKE_DETECTED=1;return SmokeDetected}(n.Characteristic);t.SmokeDetected=Lr;n.Characteristic.SmokeDetected=Lr;var Mr=function(e){i.__extends(SoftwareRevision,e);function SoftwareRevision(){var t=e.call(this,"Software Revision",SoftwareRevision.UUID,{format:"string",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SoftwareRevision.UUID="00000054-0000-1000-8000-0026BB765291";return SoftwareRevision}(n.Characteristic);t.SoftwareRevision=Mr;n.Characteristic.SoftwareRevision=Mr;var Br=function(e){i.__extends(StagedFirmwareVersion,e);function StagedFirmwareVersion(){var t=e.call(this,"Staged Firmware Version",StagedFirmwareVersion.UUID,{format:"string",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}StagedFirmwareVersion.UUID="00000249-0000-1000-8000-0026BB765291";return StagedFirmwareVersion}(n.Characteristic);t.StagedFirmwareVersion=Br;n.Characteristic.StagedFirmwareVersion=Br;var xr=function(e){i.__extends(StatusActive,e);function StatusActive(){var t=e.call(this,"Status Active",StatusActive.UUID,{format:"bool",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}StatusActive.UUID="00000075-0000-1000-8000-0026BB765291";return StatusActive}(n.Characteristic);t.StatusActive=xr;n.Characteristic.StatusActive=xr;var Fr=function(e){i.__extends(StatusFault,e);function StatusFault(){var t=e.call(this,"Status Fault",StatusFault.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}StatusFault.UUID="00000077-0000-1000-8000-0026BB765291";StatusFault.NO_FAULT=0;StatusFault.GENERAL_FAULT=1;return StatusFault}(n.Characteristic);t.StatusFault=Fr;n.Characteristic.StatusFault=Fr;var kr=function(e){i.__extends(StatusJammed,e);function StatusJammed(){var t=e.call(this,"Status Jammed",StatusJammed.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}StatusJammed.UUID="00000078-0000-1000-8000-0026BB765291";StatusJammed.NOT_JAMMED=0;StatusJammed.JAMMED=1;return StatusJammed}(n.Characteristic);t.StatusJammed=kr;n.Characteristic.StatusJammed=kr;var Vr=function(e){i.__extends(StatusLowBattery,e);function StatusLowBattery(){var t=e.call(this,"Status Low Battery",StatusLowBattery.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}StatusLowBattery.UUID="00000079-0000-1000-8000-0026BB765291";StatusLowBattery.BATTERY_LEVEL_NORMAL=0;StatusLowBattery.BATTERY_LEVEL_LOW=1;return StatusLowBattery}(n.Characteristic);t.StatusLowBattery=Vr;n.Characteristic.StatusLowBattery=Vr;var Hr=function(e){i.__extends(StatusTampered,e);function StatusTampered(){var t=e.call(this,"Status Tampered",StatusTampered.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}StatusTampered.UUID="0000007A-0000-1000-8000-0026BB765291";StatusTampered.NOT_TAMPERED=0;StatusTampered.TAMPERED=1;return StatusTampered}(n.Characteristic);t.StatusTampered=Hr;n.Characteristic.StatusTampered=Hr;var jr=function(e){i.__extends(StreamingStatus,e);function StreamingStatus(){var t=e.call(this,"Streaming Status",StreamingStatus.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}StreamingStatus.UUID="00000120-0000-1000-8000-0026BB765291";return StreamingStatus}(n.Characteristic);t.StreamingStatus=jr;n.Characteristic.StreamingStatus=jr;var Wr=function(e){i.__extends(SulphurDioxideDensity,e);function SulphurDioxideDensity(){var t=e.call(this,"Sulphur Dioxide Density",SulphurDioxideDensity.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;t.value=t.getDefaultValue();return t}SulphurDioxideDensity.UUID="000000C5-0000-1000-8000-0026BB765291";return SulphurDioxideDensity}(n.Characteristic);t.SulphurDioxideDensity=Wr;n.Characteristic.SulphurDioxideDensity=Wr;var Gr=function(e){i.__extends(SupportedAssetTypes,e);function SupportedAssetTypes(){var t=e.call(this,"Supported Asset Types",SupportedAssetTypes.UUID,{format:"uint32",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedAssetTypes.UUID="00000268-0000-1000-8000-0026BB765291";return SupportedAssetTypes}(n.Characteristic);t.SupportedAssetTypes=Gr;n.Characteristic.SupportedAssetTypes=Gr;var Xr=function(e){i.__extends(SupportedAudioRecordingConfiguration,e);function SupportedAudioRecordingConfiguration(){var t=e.call(this,"Supported Audio Recording Configuration",SupportedAudioRecordingConfiguration.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}SupportedAudioRecordingConfiguration.UUID="00000207-0000-1000-8000-0026BB765291";return SupportedAudioRecordingConfiguration}(n.Characteristic);t.SupportedAudioRecordingConfiguration=Xr;n.Characteristic.SupportedAudioRecordingConfiguration=Xr;var qr=function(e){i.__extends(SupportedAudioStreamConfiguration,e);function SupportedAudioStreamConfiguration(){var t=e.call(this,"Supported Audio Stream Configuration",SupportedAudioStreamConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedAudioStreamConfiguration.UUID="00000115-0000-1000-8000-0026BB765291";return SupportedAudioStreamConfiguration}(n.Characteristic);t.SupportedAudioStreamConfiguration=qr;n.Characteristic.SupportedAudioStreamConfiguration=qr;var Yr=function(e){i.__extends(SupportedCameraRecordingConfiguration,e);function SupportedCameraRecordingConfiguration(){var t=e.call(this,"Supported Camera Recording Configuration",SupportedCameraRecordingConfiguration.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}SupportedCameraRecordingConfiguration.UUID="00000205-0000-1000-8000-0026BB765291";return SupportedCameraRecordingConfiguration}(n.Characteristic);t.SupportedCameraRecordingConfiguration=Yr;n.Characteristic.SupportedCameraRecordingConfiguration=Yr;var Kr=function(e){i.__extends(SupportedCharacteristicValueTransitionConfiguration,e);function SupportedCharacteristicValueTransitionConfiguration(){var t=e.call(this,"Supported Characteristic Value Transition Configuration",SupportedCharacteristicValueTransitionConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedCharacteristicValueTransitionConfiguration.UUID="00000144-0000-1000-8000-0026BB765291";return SupportedCharacteristicValueTransitionConfiguration}(n.Characteristic);t.SupportedCharacteristicValueTransitionConfiguration=Kr;n.Characteristic.SupportedCharacteristicValueTransitionConfiguration=Kr;var Qr=function(e){i.__extends(SupportedDataStreamTransportConfiguration,e);function SupportedDataStreamTransportConfiguration(){var t=e.call(this,"Supported Data Stream Transport Configuration",SupportedDataStreamTransportConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedDataStreamTransportConfiguration.UUID="00000130-0000-1000-8000-0026BB765291";return SupportedDataStreamTransportConfiguration}(n.Characteristic);t.SupportedDataStreamTransportConfiguration=Qr;n.Characteristic.SupportedDataStreamTransportConfiguration=Qr;var $r=function(e){i.__extends(SupportedDiagnosticsModes,e);function SupportedDiagnosticsModes(){var t=e.call(this,"Supported Diagnostics Modes",SupportedDiagnosticsModes.UUID,{format:"uint32",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedDiagnosticsModes.UUID="0000024C-0000-1000-8000-0026BB765291";return SupportedDiagnosticsModes}(n.Characteristic);t.SupportedDiagnosticsModes=$r;n.Characteristic.SupportedDiagnosticsModes=$r;var zr=function(e){i.__extends(SupportedDiagnosticsSnapshot,e);function SupportedDiagnosticsSnapshot(){var t=e.call(this,"Supported Diagnostics Snapshot",SupportedDiagnosticsSnapshot.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedDiagnosticsSnapshot.UUID="00000238-0000-1000-8000-0026BB765291";return SupportedDiagnosticsSnapshot}(n.Characteristic);t.SupportedDiagnosticsSnapshot=zr;n.Characteristic.SupportedDiagnosticsSnapshot=zr;var Jr=function(e){i.__extends(SupportedFirmwareUpdateConfiguration,e);function SupportedFirmwareUpdateConfiguration(){var t=e.call(this,"Supported Firmware Update Configuration",SupportedFirmwareUpdateConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedFirmwareUpdateConfiguration.UUID="00000233-0000-1000-8000-0026BB765291";return SupportedFirmwareUpdateConfiguration}(n.Characteristic);t.SupportedFirmwareUpdateConfiguration=Jr;n.Characteristic.SupportedFirmwareUpdateConfiguration=Jr;var Zr=function(e){i.__extends(SupportedMetrics,e);function SupportedMetrics(){var t=e.call(this,"Supported Metrics",SupportedMetrics.UUID,{format:"tlv8",perms:["pr","pw"]})||this;t.value=t.getDefaultValue();return t}SupportedMetrics.UUID="00000271-0000-1000-8000-0026BB765291";return SupportedMetrics}(n.Characteristic);t.SupportedMetrics=Zr;n.Characteristic.SupportedMetrics=Zr;var ei=function(e){i.__extends(SupportedRouterConfiguration,e);function SupportedRouterConfiguration(){var t=e.call(this,"Supported Router Configuration",SupportedRouterConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedRouterConfiguration.UUID="00000210-0000-1000-8000-0026BB765291";return SupportedRouterConfiguration}(n.Characteristic);t.SupportedRouterConfiguration=ei;n.Characteristic.SupportedRouterConfiguration=ei;var ti=function(e){i.__extends(SupportedRTPConfiguration,e);function SupportedRTPConfiguration(){var t=e.call(this,"Supported RTP Configuration",SupportedRTPConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedRTPConfiguration.UUID="00000116-0000-1000-8000-0026BB765291";return SupportedRTPConfiguration}(n.Characteristic);t.SupportedRTPConfiguration=ti;n.Characteristic.SupportedRTPConfiguration=ti;var ri=function(e){i.__extends(SupportedSleepConfiguration,e);function SupportedSleepConfiguration(){var t=e.call(this,"Supported Sleep Configuration",SupportedSleepConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedSleepConfiguration.UUID="00000251-0000-1000-8000-0026BB765291";return SupportedSleepConfiguration}(n.Characteristic);t.SupportedSleepConfiguration=ri;n.Characteristic.SupportedSleepConfiguration=ri;var ii=function(e){i.__extends(SupportedTransferTransportConfiguration,e);function SupportedTransferTransportConfiguration(){var t=e.call(this,"Supported Transfer Transport Configuration",SupportedTransferTransportConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedTransferTransportConfiguration.UUID="00000202-0000-1000-8000-0026BB765291";return SupportedTransferTransportConfiguration}(n.Characteristic);t.SupportedTransferTransportConfiguration=ii;n.Characteristic.SupportedTransferTransportConfiguration=ii;var ni=function(e){i.__extends(SupportedVideoRecordingConfiguration,e);function SupportedVideoRecordingConfiguration(){var t=e.call(this,"Supported Video Recording Configuration",SupportedVideoRecordingConfiguration.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}SupportedVideoRecordingConfiguration.UUID="00000206-0000-1000-8000-0026BB765291";return SupportedVideoRecordingConfiguration}(n.Characteristic);t.SupportedVideoRecordingConfiguration=ni;n.Characteristic.SupportedVideoRecordingConfiguration=ni;var ai=function(e){i.__extends(SupportedVideoStreamConfiguration,e);function SupportedVideoStreamConfiguration(){var t=e.call(this,"Supported Video Stream Configuration",SupportedVideoStreamConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}SupportedVideoStreamConfiguration.UUID="00000114-0000-1000-8000-0026BB765291";return SupportedVideoStreamConfiguration}(n.Characteristic);t.SupportedVideoStreamConfiguration=ai;n.Characteristic.SupportedVideoStreamConfiguration=ai;var oi=function(e){i.__extends(SwingMode,e);function SwingMode(){var t=e.call(this,"Swing Mode",SwingMode.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}SwingMode.UUID="000000B6-0000-1000-8000-0026BB765291";SwingMode.SWING_DISABLED=0;SwingMode.SWING_ENABLED=1;return SwingMode}(n.Characteristic);t.SwingMode=oi;n.Characteristic.SwingMode=oi;var si=function(e){i.__extends(TapType,e);function TapType(){var t=e.call(this,"Tap Type",TapType.UUID,{format:"uint16",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}TapType.UUID="0000022F-0000-1000-8000-0026BB765291";return TapType}(n.Characteristic);t.TapType=si;n.Characteristic.TapType=si;var ci=function(e){i.__extends(TargetAirPurifierState,e);function TargetAirPurifierState(){var t=e.call(this,"Target Air Purifier State",TargetAirPurifierState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}TargetAirPurifierState.UUID="000000A8-0000-1000-8000-0026BB765291";TargetAirPurifierState.MANUAL=0;TargetAirPurifierState.AUTO=1;return TargetAirPurifierState}(n.Characteristic);t.TargetAirPurifierState=ci;n.Characteristic.TargetAirPurifierState=ci;var ui=function(e){i.__extends(TargetAirQuality,e);function TargetAirQuality(){var t=e.call(this,"Target Air Quality",TargetAirQuality.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}TargetAirQuality.UUID="000000AE-0000-1000-8000-0026BB765291";TargetAirQuality.EXCELLENT=0;TargetAirQuality.GOOD=1;TargetAirQuality.FAIR=2;return TargetAirQuality}(n.Characteristic);t.TargetAirQuality=ui;n.Characteristic.TargetAirQuality=ui;var li=function(e){i.__extends(TargetControlList,e);function TargetControlList(){var t=e.call(this,"Target Control List",TargetControlList.UUID,{format:"tlv8",perms:["pr","pw","wr"],adminOnlyAccess:[0,1]})||this;t.value=t.getDefaultValue();return t}TargetControlList.UUID="00000124-0000-1000-8000-0026BB765291";return TargetControlList}(n.Characteristic);t.TargetControlList=li;n.Characteristic.TargetControlList=li;var di=function(e){i.__extends(TargetControlSupportedConfiguration,e);function TargetControlSupportedConfiguration(){var t=e.call(this,"Target Control Supported Configuration",TargetControlSupportedConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}TargetControlSupportedConfiguration.UUID="00000123-0000-1000-8000-0026BB765291";return TargetControlSupportedConfiguration}(n.Characteristic);t.TargetControlSupportedConfiguration=di;n.Characteristic.TargetControlSupportedConfiguration=di;var hi=function(e){i.__extends(TargetDoorState,e);function TargetDoorState(){var t=e.call(this,"Target Door State",TargetDoorState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}TargetDoorState.UUID="00000032-0000-1000-8000-0026BB765291";TargetDoorState.OPEN=0;TargetDoorState.CLOSED=1;return TargetDoorState}(n.Characteristic);t.TargetDoorState=hi;n.Characteristic.TargetDoorState=hi;var fi=function(e){i.__extends(TargetFanState,e);function TargetFanState(){var t=e.call(this,"Target Fan State",TargetFanState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}TargetFanState.UUID="000000BF-0000-1000-8000-0026BB765291";TargetFanState.MANUAL=0;TargetFanState.AUTO=1;return TargetFanState}(n.Characteristic);t.TargetFanState=fi;n.Characteristic.TargetFanState=fi;var pi=function(e){i.__extends(TargetHeaterCoolerState,e);function TargetHeaterCoolerState(){var t=e.call(this,"Target Heater-Cooler State",TargetHeaterCoolerState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}TargetHeaterCoolerState.UUID="000000B2-0000-1000-8000-0026BB765291";TargetHeaterCoolerState.AUTO=0;TargetHeaterCoolerState.HEAT=1;TargetHeaterCoolerState.COOL=2;return TargetHeaterCoolerState}(n.Characteristic);t.TargetHeaterCoolerState=pi;n.Characteristic.TargetHeaterCoolerState=pi;var vi=function(e){i.__extends(TargetHeatingCoolingState,e);function TargetHeatingCoolingState(){var t=e.call(this,"Target Heating Cooling State",TargetHeatingCoolingState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;t.value=t.getDefaultValue();return t}TargetHeatingCoolingState.UUID="00000033-0000-1000-8000-0026BB765291";TargetHeatingCoolingState.OFF=0;TargetHeatingCoolingState.HEAT=1;TargetHeatingCoolingState.COOL=2;TargetHeatingCoolingState.AUTO=3;return TargetHeatingCoolingState}(n.Characteristic);t.TargetHeatingCoolingState=vi;n.Characteristic.TargetHeatingCoolingState=vi;var mi=function(e){i.__extends(TargetHorizontalTiltAngle,e);function TargetHorizontalTiltAngle(){var t=e.call(this,"Target Horizontal Tilt Angle",TargetHorizontalTiltAngle.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;t.value=t.getDefaultValue();return t}TargetHorizontalTiltAngle.UUID="0000007B-0000-1000-8000-0026BB765291";return TargetHorizontalTiltAngle}(n.Characteristic);t.TargetHorizontalTiltAngle=mi;n.Characteristic.TargetHorizontalTiltAngle=mi;var gi=function(e){i.__extends(TargetHumidifierDehumidifierState,e);function TargetHumidifierDehumidifierState(){var t=e.call(this,"Target Humidifier-Dehumidifier State",TargetHumidifierDehumidifierState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}TargetHumidifierDehumidifierState.UUID="000000B4-0000-1000-8000-0026BB765291";TargetHumidifierDehumidifierState.AUTO=0;TargetHumidifierDehumidifierState.HUMIDIFIER_OR_DEHUMIDIFIER=0;TargetHumidifierDehumidifierState.HUMIDIFIER=1;TargetHumidifierDehumidifierState.DEHUMIDIFIER=2;return TargetHumidifierDehumidifierState}(n.Characteristic);t.TargetHumidifierDehumidifierState=gi;n.Characteristic.TargetHumidifierDehumidifierState=gi;var yi=function(e){i.__extends(TargetMediaState,e);function TargetMediaState(){var t=e.call(this,"Target Media State",TargetMediaState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}TargetMediaState.UUID="00000137-0000-1000-8000-0026BB765291";TargetMediaState.PLAY=0;TargetMediaState.PAUSE=1;TargetMediaState.STOP=2;return TargetMediaState}(n.Characteristic);t.TargetMediaState=yi;n.Characteristic.TargetMediaState=yi;var Si=function(e){i.__extends(TargetPosition,e);function TargetPosition(){var t=e.call(this,"Target Position",TargetPosition.UUID,{format:"uint8",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}TargetPosition.UUID="0000007C-0000-1000-8000-0026BB765291";return TargetPosition}(n.Characteristic);t.TargetPosition=Si;n.Characteristic.TargetPosition=Si;var Ci=function(e){i.__extends(TargetRelativeHumidity,e);function TargetRelativeHumidity(){var t=e.call(this,"Target Relative Humidity",TargetRelativeHumidity.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}TargetRelativeHumidity.UUID="00000034-0000-1000-8000-0026BB765291";return TargetRelativeHumidity}(n.Characteristic);t.TargetRelativeHumidity=Ci;n.Characteristic.TargetRelativeHumidity=Ci;var Ti=function(e){i.__extends(TargetSlatState,e);function TargetSlatState(){var t=e.call(this,"Target Slat State",TargetSlatState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}TargetSlatState.UUID="000000BE-0000-1000-8000-0026BB765291";TargetSlatState.MANUAL=0;TargetSlatState.AUTO=1;return TargetSlatState}(n.Characteristic);t.TargetSlatState=Ti;n.Characteristic.TargetSlatState=Ti;var Ei=function(e){i.__extends(TargetTemperature,e);function TargetTemperature(){var t=e.call(this,"Target Temperature",TargetTemperature.UUID,{format:"float",perms:["ev","pr","pw"],unit:"celsius",minValue:10,maxValue:38,minStep:.1})||this;t.value=t.getDefaultValue();return t}TargetTemperature.UUID="00000035-0000-1000-8000-0026BB765291";return TargetTemperature}(n.Characteristic);t.TargetTemperature=Ei;n.Characteristic.TargetTemperature=Ei;var Ai=function(e){i.__extends(TargetTiltAngle,e);function TargetTiltAngle(){var t=e.call(this,"Target Tilt Angle",TargetTiltAngle.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;t.value=t.getDefaultValue();return t}TargetTiltAngle.UUID="000000C2-0000-1000-8000-0026BB765291";return TargetTiltAngle}(n.Characteristic);t.TargetTiltAngle=Ai;n.Characteristic.TargetTiltAngle=Ai;var Di=function(e){i.__extends(TargetVerticalTiltAngle,e);function TargetVerticalTiltAngle(){var t=e.call(this,"Target Vertical Tilt Angle",TargetVerticalTiltAngle.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;t.value=t.getDefaultValue();return t}TargetVerticalTiltAngle.UUID="0000007D-0000-1000-8000-0026BB765291";return TargetVerticalTiltAngle}(n.Characteristic);t.TargetVerticalTiltAngle=Di;n.Characteristic.TargetVerticalTiltAngle=Di;var _i=function(e){i.__extends(TargetVisibilityState,e);function TargetVisibilityState(){var t=e.call(this,"Target Visibility State",TargetVisibilityState.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}TargetVisibilityState.UUID="00000134-0000-1000-8000-0026BB765291";TargetVisibilityState.SHOWN=0;TargetVisibilityState.HIDDEN=1;return TargetVisibilityState}(n.Characteristic);t.TargetVisibilityState=_i;n.Characteristic.TargetVisibilityState=_i;var Ii=function(e){i.__extends(TemperatureDisplayUnits,e);function TemperatureDisplayUnits(){var t=e.call(this,"Temperature Display Units",TemperatureDisplayUnits.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}TemperatureDisplayUnits.UUID="00000036-0000-1000-8000-0026BB765291";TemperatureDisplayUnits.CELSIUS=0;TemperatureDisplayUnits.FAHRENHEIT=1;return TemperatureDisplayUnits}(n.Characteristic);t.TemperatureDisplayUnits=Ii;n.Characteristic.TemperatureDisplayUnits=Ii;var bi=function(e){i.__extends(ThirdPartyCameraActive,e);function ThirdPartyCameraActive(){var t=e.call(this,"Third Party Camera Active",ThirdPartyCameraActive.UUID,{format:"uint8",perms:["ev","pr"],validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}ThirdPartyCameraActive.UUID="0000021C-0000-1000-8000-0026BB765291";ThirdPartyCameraActive.OFF=0;ThirdPartyCameraActive.ON=1;return ThirdPartyCameraActive}(n.Characteristic);t.ThirdPartyCameraActive=bi;n.Characteristic.ThirdPartyCameraActive=bi;var wi=function(e){i.__extends(ThreadControlPoint,e);function ThreadControlPoint(){var t=e.call(this,"Thread Control Point",ThreadControlPoint.UUID,{format:"tlv8",perms:["pw"]})||this;t.value=t.getDefaultValue();return t}ThreadControlPoint.UUID="00000704-0000-1000-8000-0026BB765291";return ThreadControlPoint}(n.Characteristic);t.ThreadControlPoint=wi;n.Characteristic.ThreadControlPoint=wi;var Ri=function(e){i.__extends(ThreadNodeCapabilities,e);function ThreadNodeCapabilities(){var t=e.call(this,"Thread Node Capabilities",ThreadNodeCapabilities.UUID,{format:"uint16",perms:["pr"],minValue:0,maxValue:31,minStep:1})||this;t.value=t.getDefaultValue();return t}ThreadNodeCapabilities.UUID="00000702-0000-1000-8000-0026BB765291";return ThreadNodeCapabilities}(n.Characteristic);t.ThreadNodeCapabilities=Ri;n.Characteristic.ThreadNodeCapabilities=Ri;var Ni=function(e){i.__extends(ThreadOpenThreadVersion,e);function ThreadOpenThreadVersion(){var t=e.call(this,"Thread OpenThread Version",ThreadOpenThreadVersion.UUID,{format:"string",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}ThreadOpenThreadVersion.UUID="00000706-0000-1000-8000-0026BB765291";return ThreadOpenThreadVersion}(n.Characteristic);t.ThreadOpenThreadVersion=Ni;n.Characteristic.ThreadOpenThreadVersion=Ni;var Ui=function(e){i.__extends(ThreadStatus,e);function ThreadStatus(){var t=e.call(this,"Thread Status",ThreadStatus.UUID,{format:"uint16",perms:["ev","pr"],minValue:0,maxValue:6,minStep:1})||this;t.value=t.getDefaultValue();return t}ThreadStatus.UUID="00000703-0000-1000-8000-0026BB765291";return ThreadStatus}(n.Characteristic);t.ThreadStatus=Ui;n.Characteristic.ThreadStatus=Ui;var Pi=function(e){i.__extends(TimeUpdate,e);function TimeUpdate(){var t=e.call(this,"Time Update",TimeUpdate.UUID,{format:"bool",perms:["pr","pw"]})||this;t.value=t.getDefaultValue();return t}TimeUpdate.UUID="0000009A-0000-1000-8000-0026BB765291";return TimeUpdate}(n.Characteristic);t.TimeUpdate=Pi;n.Characteristic.TimeUpdate=Pi;var Oi=function(e){i.__extends(Token,e);function Token(){var t=e.call(this,"Token",Token.UUID,{format:"data",perms:["pw"]})||this;t.value=t.getDefaultValue();return t}Token.UUID="00000231-0000-1000-8000-0026BB765291";return Token}(n.Characteristic);t.Token=Oi;n.Characteristic.Token=Oi;var Li=function(e){i.__extends(TransmitPower,e);function TransmitPower(){var t=e.call(this,"Transmit Power",TransmitPower.UUID,{format:"int",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}TransmitPower.UUID="00000242-0000-1000-8000-0026BB765291";return TransmitPower}(n.Characteristic);t.TransmitPower=Li;n.Characteristic.TransmitPower=Li;var Mi=function(e){i.__extends(TunnelConnectionTimeout,e);function TunnelConnectionTimeout(){var t=e.call(this,"Tunnel Connection Timeout",TunnelConnectionTimeout.UUID,{format:"int",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}TunnelConnectionTimeout.UUID="00000061-0000-1000-8000-0026BB765291";return TunnelConnectionTimeout}(n.Characteristic);t.TunnelConnectionTimeout=Mi;n.Characteristic.TunnelConnectionTimeout=Mi;var Bi=function(e){i.__extends(TunneledAccessoryAdvertising,e);function TunneledAccessoryAdvertising(){var t=e.call(this,"Tunneled Accessory Advertising",TunneledAccessoryAdvertising.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}TunneledAccessoryAdvertising.UUID="00000060-0000-1000-8000-0026BB765291";return TunneledAccessoryAdvertising}(n.Characteristic);t.TunneledAccessoryAdvertising=Bi;n.Characteristic.TunneledAccessoryAdvertising=Bi;var xi=function(e){i.__extends(TunneledAccessoryConnected,e);function TunneledAccessoryConnected(){var t=e.call(this,"Tunneled Accessory Connected",TunneledAccessoryConnected.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}TunneledAccessoryConnected.UUID="00000059-0000-1000-8000-0026BB765291";return TunneledAccessoryConnected}(n.Characteristic);t.TunneledAccessoryConnected=xi;n.Characteristic.TunneledAccessoryConnected=xi;var Fi=function(e){i.__extends(TunneledAccessoryStateNumber,e);function TunneledAccessoryStateNumber(){var t=e.call(this,"Tunneled Accessory State Number",TunneledAccessoryStateNumber.UUID,{format:"int",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}TunneledAccessoryStateNumber.UUID="00000058-0000-1000-8000-0026BB765291";return TunneledAccessoryStateNumber}(n.Characteristic);t.TunneledAccessoryStateNumber=Fi;n.Characteristic.TunneledAccessoryStateNumber=Fi;var ki=function(e){i.__extends(ValveType,e);function ValveType(){var t=e.call(this,"Valve Type",ValveType.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;t.value=t.getDefaultValue();return t}ValveType.UUID="000000D5-0000-1000-8000-0026BB765291";ValveType.GENERIC_VALVE=0;ValveType.IRRIGATION=1;ValveType.SHOWER_HEAD=2;ValveType.WATER_FAUCET=3;return ValveType}(n.Characteristic);t.ValveType=ki;n.Characteristic.ValveType=ki;var Vi=function(e){i.__extends(Version,e);function Version(){var t=e.call(this,"Version",Version.UUID,{format:"string",perms:["pr"],maxLen:64})||this;t.value=t.getDefaultValue();return t}Version.UUID="00000037-0000-1000-8000-0026BB765291";return Version}(n.Characteristic);t.Version=Vi;n.Characteristic.Version=Vi;var Hi=function(e){i.__extends(VideoAnalysisActive,e);function VideoAnalysisActive(){var t=e.call(this,"Video Analysis Active",VideoAnalysisActive.UUID,{format:"uint8",perms:["ev","pr","pw"]})||this;t.value=t.getDefaultValue();return t}VideoAnalysisActive.UUID="00000229-0000-1000-8000-0026BB765291";return VideoAnalysisActive}(n.Characteristic);t.VideoAnalysisActive=Hi;n.Characteristic.VideoAnalysisActive=Hi;var ji=function(e){i.__extends(VOCDensity,e);function VOCDensity(){var t=e.call(this,"VOC Density",VOCDensity.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;t.value=t.getDefaultValue();return t}VOCDensity.UUID="000000C8-0000-1000-8000-0026BB765291";return VOCDensity}(n.Characteristic);t.VOCDensity=ji;n.Characteristic.VOCDensity=ji;var Wi=function(e){i.__extends(Volume,e);function Volume(){var t=e.call(this,"Volume",Volume.UUID,{format:"uint8",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}Volume.UUID="00000119-0000-1000-8000-0026BB765291";return Volume}(n.Characteristic);t.Volume=Wi;n.Characteristic.Volume=Wi;var Gi=function(e){i.__extends(VolumeControlType,e);function VolumeControlType(){var t=e.call(this,"Volume Control Type",VolumeControlType.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;t.value=t.getDefaultValue();return t}VolumeControlType.UUID="000000E9-0000-1000-8000-0026BB765291";VolumeControlType.NONE=0;VolumeControlType.RELATIVE=1;VolumeControlType.RELATIVE_WITH_CURRENT=2;VolumeControlType.ABSOLUTE=3;return VolumeControlType}(n.Characteristic);t.VolumeControlType=Gi;n.Characteristic.VolumeControlType=Gi;var Xi=function(e){i.__extends(VolumeSelector,e);function VolumeSelector(){var t=e.call(this,"Volume Selector",VolumeSelector.UUID,{format:"uint8",perms:["pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;t.value=t.getDefaultValue();return t}VolumeSelector.UUID="000000EA-0000-1000-8000-0026BB765291";VolumeSelector.INCREMENT=0;VolumeSelector.DECREMENT=1;return VolumeSelector}(n.Characteristic);t.VolumeSelector=Xi;n.Characteristic.VolumeSelector=Xi;var qi=function(e){i.__extends(WakeConfiguration,e);function WakeConfiguration(){var t=e.call(this,"Wake Configuration",WakeConfiguration.UUID,{format:"tlv8",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}WakeConfiguration.UUID="00000222-0000-1000-8000-0026BB765291";return WakeConfiguration}(n.Characteristic);t.WakeConfiguration=qi;n.Characteristic.WakeConfiguration=qi;var Yi=function(e){i.__extends(WANConfigurationList,e);function WANConfigurationList(){var t=e.call(this,"WAN Configuration List",WANConfigurationList.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}WANConfigurationList.UUID="00000211-0000-1000-8000-0026BB765291";return WANConfigurationList}(n.Characteristic);t.WANConfigurationList=Yi;n.Characteristic.WANConfigurationList=Yi;var Ki=function(e){i.__extends(WANStatusList,e);function WANStatusList(){var t=e.call(this,"WAN Status List",WANStatusList.UUID,{format:"tlv8",perms:["ev","pr"]})||this;t.value=t.getDefaultValue();return t}WANStatusList.UUID="00000212-0000-1000-8000-0026BB765291";return WANStatusList}(n.Characteristic);t.WANStatusList=Ki;n.Characteristic.WANStatusList=Ki;var Qi=function(e){i.__extends(WaterLevel,e);function WaterLevel(){var t=e.call(this,"Water Level",WaterLevel.UUID,{format:"float",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;t.value=t.getDefaultValue();return t}WaterLevel.UUID="000000B5-0000-1000-8000-0026BB765291";return WaterLevel}(n.Characteristic);t.WaterLevel=Qi;n.Characteristic.WaterLevel=Qi;var $i=function(e){i.__extends(WiFiCapabilities,e);function WiFiCapabilities(){var t=e.call(this,"Wi-Fi Capabilities",WiFiCapabilities.UUID,{format:"uint32",perms:["pr"]})||this;t.value=t.getDefaultValue();return t}WiFiCapabilities.UUID="0000022C-0000-1000-8000-0026BB765291";return WiFiCapabilities}(n.Characteristic);t.WiFiCapabilities=$i;n.Characteristic.WiFiCapabilities=$i;var zi=function(e){i.__extends(WiFiConfigurationControl,e);function WiFiConfigurationControl(){var t=e.call(this,"Wi-Fi Configuration Control",WiFiConfigurationControl.UUID,{format:"tlv8",perms:["ev","pr","pw","tw","wr"]})||this;t.value=t.getDefaultValue();return t}WiFiConfigurationControl.UUID="0000022D-0000-1000-8000-0026BB765291";return WiFiConfigurationControl}(n.Characteristic);t.WiFiConfigurationControl=zi;n.Characteristic.WiFiConfigurationControl=zi;var Ji=function(e){i.__extends(WiFiSatelliteStatus,e);function WiFiSatelliteStatus(){var t=e.call(this,"Wi-Fi Satellite Status",WiFiSatelliteStatus.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,validValues:[0,1,2]})||this;t.value=t.getDefaultValue();return t}WiFiSatelliteStatus.UUID="0000021E-0000-1000-8000-0026BB765291";WiFiSatelliteStatus.UNKNOWN=0;WiFiSatelliteStatus.CONNECTED=1;WiFiSatelliteStatus.NOT_CONNECTED=2;return WiFiSatelliteStatus}(n.Characteristic);t.WiFiSatelliteStatus=Ji;n.Characteristic.WiFiSatelliteStatus=Ji},6017:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SecuritySystem=t.ProtocolInformation=t.PowerManagement=t.Pairing=t.Outlet=t.OccupancySensor=t.NFCAccess=t.MotionSensor=t.Microphone=t.LockMechanism=t.LockManagement=t.LightSensor=t.Lightbulb=t.LeakSensor=t.IrrigationSystem=t.InputSource=t.HumiditySensor=t.HumidifierDehumidifier=t.HeaterCooler=t.GarageDoorOpener=t.FirmwareUpdate=t.FilterMaintenance=t.Faucet=t.Fanv2=t.Fan=t.Doorbell=t.Door=t.Diagnostics=t.DataStreamTransportManagement=t.ContactSensor=t.CloudRelay=t.CarbonMonoxideSensor=t.CarbonDioxideSensor=t.CameraRTPStreamManagement=t.CameraRecordingManagement=t.CameraOperatingMode=t.CameraControl=t.BridgingState=t.BridgeConfiguration=t.Battery=t.AudioStreamManagement=t.Assistant=t.AssetUpdate=t.AirQualitySensor=t.AirPurifier=t.AccessoryRuntimeInformation=t.AccessoryMetrics=t.AccessoryInformation=t.AccessControl=t.AccessCode=void 0;t.WindowCovering=t.Window=t.WiFiTransport=t.WiFiSatellite=t.WiFiRouter=t.Valve=t.Tunnel=t.TransferTransportManagement=t.TimeInformation=t.ThreadTransport=t.Thermostat=t.TemperatureSensor=t.TelevisionSpeaker=t.Television=t.TargetControlManagement=t.TargetControl=t.TapManagement=t.Switch=t.StatelessProgrammableSwitch=t.StatefulProgrammableSwitch=t.Speaker=t.SmokeSensor=t.SmartSpeaker=t.Slats=t.SiriEndpoint=t.Siri=t.ServiceLabel=void 0;var i=r(6867);var n=r(8117);var a=r(877);var o=function(e){i.__extends(AccessCode,e);function AccessCode(t,r){var i=e.call(this,t,AccessCode.UUID,r)||this;i.addCharacteristic(n.Characteristic.AccessCodeControlPoint);i.addCharacteristic(n.Characteristic.AccessCodeSupportedConfiguration);i.addCharacteristic(n.Characteristic.ConfigurationState);return i}AccessCode.UUID="00000260-0000-1000-8000-0026BB765291";return AccessCode}(a.Service);t.AccessCode=o;a.Service.AccessCode=o;var s=function(e){i.__extends(AccessControl,e);function AccessControl(t,r){var i=e.call(this,t,AccessControl.UUID,r)||this;i.addCharacteristic(n.Characteristic.AccessControlLevel);i.addOptionalCharacteristic(n.Characteristic.PasswordSetting);return i}AccessControl.UUID="000000DA-0000-1000-8000-0026BB765291";return AccessControl}(a.Service);t.AccessControl=s;a.Service.AccessControl=s;var c=function(e){i.__extends(AccessoryInformation,e);function AccessoryInformation(t,r){var i=e.call(this,t,AccessoryInformation.UUID,r)||this;i.addCharacteristic(n.Characteristic.Identify);i.addCharacteristic(n.Characteristic.Manufacturer);i.addCharacteristic(n.Characteristic.Model);if(!i.testCharacteristic(n.Characteristic.Name)){i.addCharacteristic(n.Characteristic.Name).updateValue("Unnamed Service")}i.addCharacteristic(n.Characteristic.SerialNumber);i.addCharacteristic(n.Characteristic.FirmwareRevision);i.addOptionalCharacteristic(n.Characteristic.AccessoryFlags);i.addOptionalCharacteristic(n.Characteristic.AppMatchingIdentifier);i.addOptionalCharacteristic(n.Characteristic.ConfiguredName);i.addOptionalCharacteristic(n.Characteristic.HardwareFinish);i.addOptionalCharacteristic(n.Characteristic.HardwareRevision);i.addOptionalCharacteristic(n.Characteristic.ProductData);i.addOptionalCharacteristic(n.Characteristic.SoftwareRevision);return i}AccessoryInformation.UUID="0000003E-0000-1000-8000-0026BB765291";return AccessoryInformation}(a.Service);t.AccessoryInformation=c;a.Service.AccessoryInformation=c;var u=function(e){i.__extends(AccessoryMetrics,e);function AccessoryMetrics(t,r){var i=e.call(this,t,AccessoryMetrics.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addCharacteristic(n.Characteristic.MetricsBufferFullState);i.addCharacteristic(n.Characteristic.SupportedMetrics);return i}AccessoryMetrics.UUID="00000270-0000-1000-8000-0026BB765291";return AccessoryMetrics}(a.Service);t.AccessoryMetrics=u;a.Service.AccessoryMetrics=u;var l=function(e){i.__extends(AccessoryRuntimeInformation,e);function AccessoryRuntimeInformation(t,r){var i=e.call(this,t,AccessoryRuntimeInformation.UUID,r)||this;i.addCharacteristic(n.Characteristic.Ping);i.addOptionalCharacteristic(n.Characteristic.ActivityInterval);i.addOptionalCharacteristic(n.Characteristic.HeartBeat);i.addOptionalCharacteristic(n.Characteristic.SleepInterval);return i}AccessoryRuntimeInformation.UUID="00000239-0000-1000-8000-0026BB765291";return AccessoryRuntimeInformation}(a.Service);t.AccessoryRuntimeInformation=l;a.Service.AccessoryRuntimeInformation=l;var d=function(e){i.__extends(AirPurifier,e);function AirPurifier(t,r){var i=e.call(this,t,AirPurifier.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addCharacteristic(n.Characteristic.CurrentAirPurifierState);i.addCharacteristic(n.Characteristic.TargetAirPurifierState);i.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.RotationSpeed);i.addOptionalCharacteristic(n.Characteristic.SwingMode);return i}AirPurifier.UUID="000000BB-0000-1000-8000-0026BB765291";return AirPurifier}(a.Service);t.AirPurifier=d;a.Service.AirPurifier=d;var h=function(e){i.__extends(AirQualitySensor,e);function AirQualitySensor(t,r){var i=e.call(this,t,AirQualitySensor.UUID,r)||this;i.addCharacteristic(n.Characteristic.AirQuality);i.addOptionalCharacteristic(n.Characteristic.NitrogenDioxideDensity);i.addOptionalCharacteristic(n.Characteristic.OzoneDensity);i.addOptionalCharacteristic(n.Characteristic.PM10Density);i.addOptionalCharacteristic(n.Characteristic.PM2_5Density);i.addOptionalCharacteristic(n.Characteristic.SulphurDioxideDensity);i.addOptionalCharacteristic(n.Characteristic.VOCDensity);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusActive);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}AirQualitySensor.UUID="0000008D-0000-1000-8000-0026BB765291";return AirQualitySensor}(a.Service);t.AirQualitySensor=h;a.Service.AirQualitySensor=h;var p=function(e){i.__extends(AssetUpdate,e);function AssetUpdate(t,r){var i=e.call(this,t,AssetUpdate.UUID,r)||this;i.addCharacteristic(n.Characteristic.AssetUpdateReadiness);i.addCharacteristic(n.Characteristic.SupportedAssetTypes);return i}AssetUpdate.UUID="00000267-0000-1000-8000-0026BB765291";return AssetUpdate}(a.Service);t.AssetUpdate=p;a.Service.AssetUpdate=p;var v=function(e){i.__extends(Assistant,e);function Assistant(t,r){var i=e.call(this,t,Assistant.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addCharacteristic(n.Characteristic.Identifier);if(!i.testCharacteristic(n.Characteristic.Name)){i.addCharacteristic(n.Characteristic.Name).updateValue("Unnamed Service")}return i}Assistant.UUID="0000026A-0000-1000-8000-0026BB765291";return Assistant}(a.Service);t.Assistant=v;a.Service.Assistant=v;var m=function(e){i.__extends(AudioStreamManagement,e);function AudioStreamManagement(t,r){var i=e.call(this,t,AudioStreamManagement.UUID,r)||this;i.addCharacteristic(n.Characteristic.SupportedAudioStreamConfiguration);i.addCharacteristic(n.Characteristic.SelectedAudioStreamConfiguration);return i}AudioStreamManagement.UUID="00000127-0000-1000-8000-0026BB765291";return AudioStreamManagement}(a.Service);t.AudioStreamManagement=m;a.Service.AudioStreamManagement=m;var g=function(e){i.__extends(Battery,e);function Battery(t,r){var i=e.call(this,t,Battery.UUID,r)||this;i.addCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.BatteryLevel);i.addOptionalCharacteristic(n.Characteristic.ChargingState);i.addOptionalCharacteristic(n.Characteristic.Name);return i}Battery.UUID="00000096-0000-1000-8000-0026BB765291";return Battery}(a.Service);t.Battery=g;a.Service.BatteryService=g;a.Service.Battery=g;var y=function(e){i.__extends(BridgeConfiguration,e);function BridgeConfiguration(t,r){var i=e.call(this,t,BridgeConfiguration.UUID,r)||this;i.addCharacteristic(n.Characteristic.ConfigureBridgedAccessoryStatus);i.addCharacteristic(n.Characteristic.DiscoverBridgedAccessories);i.addCharacteristic(n.Characteristic.DiscoveredBridgedAccessories);i.addCharacteristic(n.Characteristic.ConfigureBridgedAccessory);i.addOptionalCharacteristic(n.Characteristic.Name);return i}BridgeConfiguration.UUID="000000A1-0000-1000-8000-0026BB765291";return BridgeConfiguration}(a.Service);t.BridgeConfiguration=y;a.Service.BridgeConfiguration=y;var C=function(e){i.__extends(BridgingState,e);function BridgingState(t,r){var i=e.call(this,t,BridgingState.UUID,r)||this;i.addCharacteristic(n.Characteristic.Reachable);i.addCharacteristic(n.Characteristic.LinkQuality);i.addCharacteristic(n.Characteristic.AccessoryIdentifier);i.addCharacteristic(n.Characteristic.Category);i.addOptionalCharacteristic(n.Characteristic.Name);return i}BridgingState.UUID="00000062-0000-1000-8000-0026BB765291";return BridgingState}(a.Service);t.BridgingState=C;a.Service.BridgingState=C;var T=function(e){i.__extends(CameraControl,e);function CameraControl(t,r){var i=e.call(this,t,CameraControl.UUID,r)||this;i.addCharacteristic(n.Characteristic.On);i.addOptionalCharacteristic(n.Characteristic.CurrentHorizontalTiltAngle);i.addOptionalCharacteristic(n.Characteristic.CurrentVerticalTiltAngle);i.addOptionalCharacteristic(n.Characteristic.TargetHorizontalTiltAngle);i.addOptionalCharacteristic(n.Characteristic.TargetVerticalTiltAngle);i.addOptionalCharacteristic(n.Characteristic.NightVision);i.addOptionalCharacteristic(n.Characteristic.OpticalZoom);i.addOptionalCharacteristic(n.Characteristic.DigitalZoom);i.addOptionalCharacteristic(n.Characteristic.ImageRotation);i.addOptionalCharacteristic(n.Characteristic.ImageMirroring);i.addOptionalCharacteristic(n.Characteristic.Name);return i}CameraControl.UUID="00000111-0000-1000-8000-0026BB765291";return CameraControl}(a.Service);t.CameraControl=T;a.Service.CameraControl=T;var E=function(e){i.__extends(CameraOperatingMode,e);function CameraOperatingMode(t,r){var i=e.call(this,t,CameraOperatingMode.UUID,r)||this;i.addCharacteristic(n.Characteristic.EventSnapshotsActive);i.addCharacteristic(n.Characteristic.HomeKitCameraActive);i.addOptionalCharacteristic(n.Characteristic.CameraOperatingModeIndicator);i.addOptionalCharacteristic(n.Characteristic.ManuallyDisabled);i.addOptionalCharacteristic(n.Characteristic.NightVision);i.addOptionalCharacteristic(n.Characteristic.PeriodicSnapshotsActive);i.addOptionalCharacteristic(n.Characteristic.ThirdPartyCameraActive);i.addOptionalCharacteristic(n.Characteristic.DiagonalFieldOfView);return i}CameraOperatingMode.UUID="0000021A-0000-1000-8000-0026BB765291";return CameraOperatingMode}(a.Service);t.CameraOperatingMode=E;a.Service.CameraOperatingMode=E;var D=function(e){i.__extends(CameraRecordingManagement,e);function CameraRecordingManagement(t,r){var i=e.call(this,t,CameraRecordingManagement.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addCharacteristic(n.Characteristic.SelectedCameraRecordingConfiguration);i.addCharacteristic(n.Characteristic.SupportedAudioRecordingConfiguration);i.addCharacteristic(n.Characteristic.SupportedCameraRecordingConfiguration);i.addCharacteristic(n.Characteristic.SupportedVideoRecordingConfiguration);i.addOptionalCharacteristic(n.Characteristic.RecordingAudioActive);return i}CameraRecordingManagement.UUID="00000204-0000-1000-8000-0026BB765291";return CameraRecordingManagement}(a.Service);t.CameraRecordingManagement=D;a.Service.CameraEventRecordingManagement=D;a.Service.CameraRecordingManagement=D;var _=function(e){i.__extends(CameraRTPStreamManagement,e);function CameraRTPStreamManagement(t,r){var i=e.call(this,t,CameraRTPStreamManagement.UUID,r)||this;i.addCharacteristic(n.Characteristic.SelectedRTPStreamConfiguration);i.addCharacteristic(n.Characteristic.SetupEndpoints);i.addCharacteristic(n.Characteristic.StreamingStatus);i.addCharacteristic(n.Characteristic.SupportedAudioStreamConfiguration);i.addCharacteristic(n.Characteristic.SupportedRTPConfiguration);i.addCharacteristic(n.Characteristic.SupportedVideoStreamConfiguration);i.addOptionalCharacteristic(n.Characteristic.Active);return i}CameraRTPStreamManagement.UUID="00000110-0000-1000-8000-0026BB765291";return CameraRTPStreamManagement}(a.Service);t.CameraRTPStreamManagement=_;a.Service.CameraRTPStreamManagement=_;var I=function(e){i.__extends(CarbonDioxideSensor,e);function CarbonDioxideSensor(t,r){var i=e.call(this,t,CarbonDioxideSensor.UUID,r)||this;i.addCharacteristic(n.Characteristic.CarbonDioxideDetected);i.addOptionalCharacteristic(n.Characteristic.CarbonDioxideLevel);i.addOptionalCharacteristic(n.Characteristic.CarbonDioxidePeakLevel);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusActive);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}CarbonDioxideSensor.UUID="00000097-0000-1000-8000-0026BB765291";return CarbonDioxideSensor}(a.Service);t.CarbonDioxideSensor=I;a.Service.CarbonDioxideSensor=I;var b=function(e){i.__extends(CarbonMonoxideSensor,e);function CarbonMonoxideSensor(t,r){var i=e.call(this,t,CarbonMonoxideSensor.UUID,r)||this;i.addCharacteristic(n.Characteristic.CarbonMonoxideDetected);i.addOptionalCharacteristic(n.Characteristic.CarbonMonoxideLevel);i.addOptionalCharacteristic(n.Characteristic.CarbonMonoxidePeakLevel);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusActive);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}CarbonMonoxideSensor.UUID="0000007F-0000-1000-8000-0026BB765291";return CarbonMonoxideSensor}(a.Service);t.CarbonMonoxideSensor=b;a.Service.CarbonMonoxideSensor=b;var w=function(e){i.__extends(CloudRelay,e);function CloudRelay(t,r){var i=e.call(this,t,CloudRelay.UUID,r)||this;i.addCharacteristic(n.Characteristic.RelayControlPoint);i.addCharacteristic(n.Characteristic.RelayState);i.addCharacteristic(n.Characteristic.RelayEnabled);return i}CloudRelay.UUID="0000005A-0000-1000-8000-0026BB765291";return CloudRelay}(a.Service);t.CloudRelay=w;a.Service.Relay=w;a.Service.CloudRelay=w;var R=function(e){i.__extends(ContactSensor,e);function ContactSensor(t,r){var i=e.call(this,t,ContactSensor.UUID,r)||this;i.addCharacteristic(n.Characteristic.ContactSensorState);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusActive);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}ContactSensor.UUID="00000080-0000-1000-8000-0026BB765291";return ContactSensor}(a.Service);t.ContactSensor=R;a.Service.ContactSensor=R;var N=function(e){i.__extends(DataStreamTransportManagement,e);function DataStreamTransportManagement(t,r){var i=e.call(this,t,DataStreamTransportManagement.UUID,r)||this;i.addCharacteristic(n.Characteristic.SetupDataStreamTransport);i.addCharacteristic(n.Characteristic.SupportedDataStreamTransportConfiguration);i.addCharacteristic(n.Characteristic.Version);return i}DataStreamTransportManagement.UUID="00000129-0000-1000-8000-0026BB765291";return DataStreamTransportManagement}(a.Service);t.DataStreamTransportManagement=N;a.Service.DataStreamTransportManagement=N;var U=function(e){i.__extends(Diagnostics,e);function Diagnostics(t,r){var i=e.call(this,t,Diagnostics.UUID,r)||this;i.addCharacteristic(n.Characteristic.SupportedDiagnosticsSnapshot);i.addOptionalCharacteristic(n.Characteristic.SelectedDiagnosticsModes);i.addOptionalCharacteristic(n.Characteristic.SupportedDiagnosticsModes);return i}Diagnostics.UUID="00000237-0000-1000-8000-0026BB765291";return Diagnostics}(a.Service);t.Diagnostics=U;a.Service.Diagnostics=U;var P=function(e){i.__extends(Door,e);function Door(t,r){var i=e.call(this,t,Door.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentPosition);i.addCharacteristic(n.Characteristic.PositionState);i.addCharacteristic(n.Characteristic.TargetPosition);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.ObstructionDetected);i.addOptionalCharacteristic(n.Characteristic.HoldPosition);return i}Door.UUID="00000081-0000-1000-8000-0026BB765291";return Door}(a.Service);t.Door=P;a.Service.Door=P;var O=function(e){i.__extends(Doorbell,e);function Doorbell(t,r){var i=e.call(this,t,Doorbell.UUID,r)||this;i.addCharacteristic(n.Characteristic.ProgrammableSwitchEvent);i.addOptionalCharacteristic(n.Characteristic.Brightness);i.addOptionalCharacteristic(n.Characteristic.Mute);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.OperatingStateResponse);i.addOptionalCharacteristic(n.Characteristic.Volume);return i}Doorbell.UUID="00000121-0000-1000-8000-0026BB765291";return Doorbell}(a.Service);t.Doorbell=O;a.Service.Doorbell=O;var L=function(e){i.__extends(Fan,e);function Fan(t,r){var i=e.call(this,t,Fan.UUID,r)||this;i.addCharacteristic(n.Characteristic.On);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.RotationDirection);i.addOptionalCharacteristic(n.Characteristic.RotationSpeed);return i}Fan.UUID="00000040-0000-1000-8000-0026BB765291";return Fan}(a.Service);t.Fan=L;a.Service.Fan=L;var B=function(e){i.__extends(Fanv2,e);function Fanv2(t,r){var i=e.call(this,t,Fanv2.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addOptionalCharacteristic(n.Characteristic.CurrentFanState);i.addOptionalCharacteristic(n.Characteristic.TargetFanState);i.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.RotationDirection);i.addOptionalCharacteristic(n.Characteristic.RotationSpeed);i.addOptionalCharacteristic(n.Characteristic.SwingMode);return i}Fanv2.UUID="000000B7-0000-1000-8000-0026BB765291";return Fanv2}(a.Service);t.Fanv2=B;a.Service.Fanv2=B;var x=function(e){i.__extends(Faucet,e);function Faucet(t,r){var i=e.call(this,t,Faucet.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusFault);return i}Faucet.UUID="000000D7-0000-1000-8000-0026BB765291";return Faucet}(a.Service);t.Faucet=x;a.Service.Faucet=x;var k=function(e){i.__extends(FilterMaintenance,e);function FilterMaintenance(t,r){var i=e.call(this,t,FilterMaintenance.UUID,r)||this;i.addCharacteristic(n.Characteristic.FilterChangeIndication);i.addOptionalCharacteristic(n.Characteristic.FilterLifeLevel);i.addOptionalCharacteristic(n.Characteristic.ResetFilterIndication);i.addOptionalCharacteristic(n.Characteristic.Name);return i}FilterMaintenance.UUID="000000BA-0000-1000-8000-0026BB765291";return FilterMaintenance}(a.Service);t.FilterMaintenance=k;a.Service.FilterMaintenance=k;var V=function(e){i.__extends(FirmwareUpdate,e);function FirmwareUpdate(t,r){var i=e.call(this,t,FirmwareUpdate.UUID,r)||this;i.addCharacteristic(n.Characteristic.FirmwareUpdateReadiness);i.addCharacteristic(n.Characteristic.FirmwareUpdateStatus);i.addOptionalCharacteristic(n.Characteristic.StagedFirmwareVersion);i.addOptionalCharacteristic(n.Characteristic.SupportedFirmwareUpdateConfiguration);return i}FirmwareUpdate.UUID="00000236-0000-1000-8000-0026BB765291";return FirmwareUpdate}(a.Service);t.FirmwareUpdate=V;a.Service.FirmwareUpdate=V;var H=function(e){i.__extends(GarageDoorOpener,e);function GarageDoorOpener(t,r){var i=e.call(this,t,GarageDoorOpener.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentDoorState);i.addCharacteristic(n.Characteristic.TargetDoorState);i.addCharacteristic(n.Characteristic.ObstructionDetected);i.addOptionalCharacteristic(n.Characteristic.LockCurrentState);i.addOptionalCharacteristic(n.Characteristic.LockTargetState);i.addOptionalCharacteristic(n.Characteristic.Name);return i}GarageDoorOpener.UUID="00000041-0000-1000-8000-0026BB765291";return GarageDoorOpener}(a.Service);t.GarageDoorOpener=H;a.Service.GarageDoorOpener=H;var j=function(e){i.__extends(HeaterCooler,e);function HeaterCooler(t,r){var i=e.call(this,t,HeaterCooler.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addCharacteristic(n.Characteristic.CurrentHeaterCoolerState);i.addCharacteristic(n.Characteristic.TargetHeaterCoolerState);i.addCharacteristic(n.Characteristic.CurrentTemperature);i.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.RotationSpeed);i.addOptionalCharacteristic(n.Characteristic.SwingMode);i.addOptionalCharacteristic(n.Characteristic.CoolingThresholdTemperature);i.addOptionalCharacteristic(n.Characteristic.HeatingThresholdTemperature);i.addOptionalCharacteristic(n.Characteristic.TemperatureDisplayUnits);return i}HeaterCooler.UUID="000000BC-0000-1000-8000-0026BB765291";return HeaterCooler}(a.Service);t.HeaterCooler=j;a.Service.HeaterCooler=j;var W=function(e){i.__extends(HumidifierDehumidifier,e);function HumidifierDehumidifier(t,r){var i=e.call(this,t,HumidifierDehumidifier.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addCharacteristic(n.Characteristic.CurrentHumidifierDehumidifierState);i.addCharacteristic(n.Characteristic.TargetHumidifierDehumidifierState);i.addCharacteristic(n.Characteristic.CurrentRelativeHumidity);i.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.RelativeHumidityDehumidifierThreshold);i.addOptionalCharacteristic(n.Characteristic.RelativeHumidityHumidifierThreshold);i.addOptionalCharacteristic(n.Characteristic.RotationSpeed);i.addOptionalCharacteristic(n.Characteristic.SwingMode);i.addOptionalCharacteristic(n.Characteristic.WaterLevel);return i}HumidifierDehumidifier.UUID="000000BD-0000-1000-8000-0026BB765291";return HumidifierDehumidifier}(a.Service);t.HumidifierDehumidifier=W;a.Service.HumidifierDehumidifier=W;var G=function(e){i.__extends(HumiditySensor,e);function HumiditySensor(t,r){var i=e.call(this,t,HumiditySensor.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentRelativeHumidity);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusActive);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}HumiditySensor.UUID="00000082-0000-1000-8000-0026BB765291";return HumiditySensor}(a.Service);t.HumiditySensor=G;a.Service.HumiditySensor=G;var X=function(e){i.__extends(InputSource,e);function InputSource(t,r){var i=e.call(this,t,InputSource.UUID,r)||this;i.addCharacteristic(n.Characteristic.ConfiguredName);i.addCharacteristic(n.Characteristic.InputSourceType);i.addCharacteristic(n.Characteristic.IsConfigured);if(!i.testCharacteristic(n.Characteristic.Name)){i.addCharacteristic(n.Characteristic.Name).updateValue("Unnamed Service")}i.addCharacteristic(n.Characteristic.CurrentVisibilityState);i.addOptionalCharacteristic(n.Characteristic.Identifier);i.addOptionalCharacteristic(n.Characteristic.InputDeviceType);i.addOptionalCharacteristic(n.Characteristic.TargetVisibilityState);return i}InputSource.UUID="000000D9-0000-1000-8000-0026BB765291";return InputSource}(a.Service);t.InputSource=X;a.Service.InputSource=X;var q=function(e){i.__extends(IrrigationSystem,e);function IrrigationSystem(t,r){var i=e.call(this,t,IrrigationSystem.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addCharacteristic(n.Characteristic.ProgramMode);i.addCharacteristic(n.Characteristic.InUse);i.addOptionalCharacteristic(n.Characteristic.RemainingDuration);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusFault);return i}IrrigationSystem.UUID="000000CF-0000-1000-8000-0026BB765291";return IrrigationSystem}(a.Service);t.IrrigationSystem=q;a.Service.IrrigationSystem=q;var Y=function(e){i.__extends(LeakSensor,e);function LeakSensor(t,r){var i=e.call(this,t,LeakSensor.UUID,r)||this;i.addCharacteristic(n.Characteristic.LeakDetected);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusActive);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}LeakSensor.UUID="00000083-0000-1000-8000-0026BB765291";return LeakSensor}(a.Service);t.LeakSensor=Y;a.Service.LeakSensor=Y;var K=function(e){i.__extends(Lightbulb,e);function Lightbulb(t,r){var i=e.call(this,t,Lightbulb.UUID,r)||this;i.addCharacteristic(n.Characteristic.On);i.addOptionalCharacteristic(n.Characteristic.Brightness);i.addOptionalCharacteristic(n.Characteristic.CharacteristicValueActiveTransitionCount);i.addOptionalCharacteristic(n.Characteristic.CharacteristicValueTransitionControl);i.addOptionalCharacteristic(n.Characteristic.ColorTemperature);i.addOptionalCharacteristic(n.Characteristic.Hue);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.Saturation);i.addOptionalCharacteristic(n.Characteristic.SupportedCharacteristicValueTransitionConfiguration);return i}Lightbulb.UUID="00000043-0000-1000-8000-0026BB765291";return Lightbulb}(a.Service);t.Lightbulb=K;a.Service.Lightbulb=K;var $=function(e){i.__extends(LightSensor,e);function LightSensor(t,r){var i=e.call(this,t,LightSensor.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentAmbientLightLevel);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusActive);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}LightSensor.UUID="00000084-0000-1000-8000-0026BB765291";return LightSensor}(a.Service);t.LightSensor=$;a.Service.LightSensor=$;var z=function(e){i.__extends(LockManagement,e);function LockManagement(t,r){var i=e.call(this,t,LockManagement.UUID,r)||this;i.addCharacteristic(n.Characteristic.LockControlPoint);i.addCharacteristic(n.Characteristic.Version);i.addOptionalCharacteristic(n.Characteristic.AdministratorOnlyAccess);i.addOptionalCharacteristic(n.Characteristic.AudioFeedback);i.addOptionalCharacteristic(n.Characteristic.CurrentDoorState);i.addOptionalCharacteristic(n.Characteristic.LockManagementAutoSecurityTimeout);i.addOptionalCharacteristic(n.Characteristic.LockLastKnownAction);i.addOptionalCharacteristic(n.Characteristic.Logs);i.addOptionalCharacteristic(n.Characteristic.MotionDetected);return i}LockManagement.UUID="00000044-0000-1000-8000-0026BB765291";return LockManagement}(a.Service);t.LockManagement=z;a.Service.LockManagement=z;var J=function(e){i.__extends(LockMechanism,e);function LockMechanism(t,r){var i=e.call(this,t,LockMechanism.UUID,r)||this;i.addCharacteristic(n.Characteristic.LockCurrentState);i.addCharacteristic(n.Characteristic.LockTargetState);i.addOptionalCharacteristic(n.Characteristic.Name);return i}LockMechanism.UUID="00000045-0000-1000-8000-0026BB765291";return LockMechanism}(a.Service);t.LockMechanism=J;a.Service.LockMechanism=J;var ee=function(e){i.__extends(Microphone,e);function Microphone(t,r){var i=e.call(this,t,Microphone.UUID,r)||this;i.addCharacteristic(n.Characteristic.Mute);i.addOptionalCharacteristic(n.Characteristic.Volume);return i}Microphone.UUID="00000112-0000-1000-8000-0026BB765291";return Microphone}(a.Service);t.Microphone=ee;a.Service.Microphone=ee;var te=function(e){i.__extends(MotionSensor,e);function MotionSensor(t,r){var i=e.call(this,t,MotionSensor.UUID,r)||this;i.addCharacteristic(n.Characteristic.MotionDetected);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusActive);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}MotionSensor.UUID="00000085-0000-1000-8000-0026BB765291";return MotionSensor}(a.Service);t.MotionSensor=te;a.Service.MotionSensor=te;var re=function(e){i.__extends(NFCAccess,e);function NFCAccess(t,r){var i=e.call(this,t,NFCAccess.UUID,r)||this;i.addCharacteristic(n.Characteristic.ConfigurationState);i.addCharacteristic(n.Characteristic.NFCAccessControlPoint);i.addCharacteristic(n.Characteristic.NFCAccessSupportedConfiguration);return i}NFCAccess.UUID="00000266-0000-1000-8000-0026BB765291";return NFCAccess}(a.Service);t.NFCAccess=re;a.Service.NFCAccess=re;var ie=function(e){i.__extends(OccupancySensor,e);function OccupancySensor(t,r){var i=e.call(this,t,OccupancySensor.UUID,r)||this;i.addCharacteristic(n.Characteristic.OccupancyDetected);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusActive);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}OccupancySensor.UUID="00000086-0000-1000-8000-0026BB765291";return OccupancySensor}(a.Service);t.OccupancySensor=ie;a.Service.OccupancySensor=ie;var ne=function(e){i.__extends(Outlet,e);function Outlet(t,r){var i=e.call(this,t,Outlet.UUID,r)||this;i.addCharacteristic(n.Characteristic.On);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.OutletInUse);return i}Outlet.UUID="00000047-0000-1000-8000-0026BB765291";return Outlet}(a.Service);t.Outlet=ne;a.Service.Outlet=ne;var ae=function(e){i.__extends(Pairing,e);function Pairing(t,r){var i=e.call(this,t,Pairing.UUID,r)||this;i.addCharacteristic(n.Characteristic.ListPairings);i.addCharacteristic(n.Characteristic.PairSetup);i.addCharacteristic(n.Characteristic.PairVerify);i.addCharacteristic(n.Characteristic.PairingFeatures);return i}Pairing.UUID="00000055-0000-1000-8000-0026BB765291";return Pairing}(a.Service);t.Pairing=ae;a.Service.Pairing=ae;var oe=function(e){i.__extends(PowerManagement,e);function PowerManagement(t,r){var i=e.call(this,t,PowerManagement.UUID,r)||this;i.addCharacteristic(n.Characteristic.WakeConfiguration);i.addOptionalCharacteristic(n.Characteristic.SelectedSleepConfiguration);i.addOptionalCharacteristic(n.Characteristic.SupportedSleepConfiguration);return i}PowerManagement.UUID="00000221-0000-1000-8000-0026BB765291";return PowerManagement}(a.Service);t.PowerManagement=oe;a.Service.PowerManagement=oe;var se=function(e){i.__extends(ProtocolInformation,e);function ProtocolInformation(t,r){var i=e.call(this,t,ProtocolInformation.UUID,r)||this;i.addCharacteristic(n.Characteristic.Version);return i}ProtocolInformation.UUID="000000A2-0000-1000-8000-0026BB765291";return ProtocolInformation}(a.Service);t.ProtocolInformation=se;a.Service.ProtocolInformation=se;var ce=function(e){i.__extends(SecuritySystem,e);function SecuritySystem(t,r){var i=e.call(this,t,SecuritySystem.UUID,r)||this;i.addCharacteristic(n.Characteristic.SecuritySystemCurrentState);i.addCharacteristic(n.Characteristic.SecuritySystemTargetState);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.SecuritySystemAlarmType);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}SecuritySystem.UUID="0000007E-0000-1000-8000-0026BB765291";return SecuritySystem}(a.Service);t.SecuritySystem=ce;a.Service.SecuritySystem=ce;var ue=function(e){i.__extends(ServiceLabel,e);function ServiceLabel(t,r){var i=e.call(this,t,ServiceLabel.UUID,r)||this;i.addCharacteristic(n.Characteristic.ServiceLabelNamespace);return i}ServiceLabel.UUID="000000CC-0000-1000-8000-0026BB765291";return ServiceLabel}(a.Service);t.ServiceLabel=ue;a.Service.ServiceLabel=ue;var le=function(e){i.__extends(Siri,e);function Siri(t,r){var i=e.call(this,t,Siri.UUID,r)||this;i.addCharacteristic(n.Characteristic.SiriInputType);i.addOptionalCharacteristic(n.Characteristic.MultifunctionButton);i.addOptionalCharacteristic(n.Characteristic.SiriEnable);i.addOptionalCharacteristic(n.Characteristic.SiriEngineVersion);i.addOptionalCharacteristic(n.Characteristic.SiriLightOnUse);i.addOptionalCharacteristic(n.Characteristic.SiriListening);i.addOptionalCharacteristic(n.Characteristic.SiriTouchToUse);return i}Siri.UUID="00000133-0000-1000-8000-0026BB765291";return Siri}(a.Service);t.Siri=le;a.Service.Siri=le;var de=function(e){i.__extends(SiriEndpoint,e);function SiriEndpoint(t,r){var i=e.call(this,t,SiriEndpoint.UUID,r)||this;i.addCharacteristic(n.Characteristic.SiriEndpointSessionStatus);i.addCharacteristic(n.Characteristic.Version);i.addOptionalCharacteristic(n.Characteristic.ActiveIdentifier);i.addOptionalCharacteristic(n.Characteristic.ManuallyDisabled);return i}SiriEndpoint.UUID="00000253-0000-1000-8000-0026BB765291";return SiriEndpoint}(a.Service);t.SiriEndpoint=de;a.Service.SiriEndpoint=de;var he=function(e){i.__extends(Slats,e);function Slats(t,r){var i=e.call(this,t,Slats.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentSlatState);i.addCharacteristic(n.Characteristic.SlatType);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.SwingMode);i.addOptionalCharacteristic(n.Characteristic.CurrentTiltAngle);i.addOptionalCharacteristic(n.Characteristic.TargetTiltAngle);return i}Slats.UUID="000000B9-0000-1000-8000-0026BB765291";return Slats}(a.Service);t.Slats=he;a.Service.Slat=he;a.Service.Slats=he;var fe=function(e){i.__extends(SmartSpeaker,e);function SmartSpeaker(t,r){var i=e.call(this,t,SmartSpeaker.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentMediaState);i.addCharacteristic(n.Characteristic.TargetMediaState);i.addOptionalCharacteristic(n.Characteristic.AirPlayEnable);i.addOptionalCharacteristic(n.Characteristic.ConfiguredName);i.addOptionalCharacteristic(n.Characteristic.Mute);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.Volume);return i}SmartSpeaker.UUID="00000228-0000-1000-8000-0026BB765291";return SmartSpeaker}(a.Service);t.SmartSpeaker=fe;a.Service.SmartSpeaker=fe;var pe=function(e){i.__extends(SmokeSensor,e);function SmokeSensor(t,r){var i=e.call(this,t,SmokeSensor.UUID,r)||this;i.addCharacteristic(n.Characteristic.SmokeDetected);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusActive);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}SmokeSensor.UUID="00000087-0000-1000-8000-0026BB765291";return SmokeSensor}(a.Service);t.SmokeSensor=pe;a.Service.SmokeSensor=pe;var ve=function(e){i.__extends(Speaker,e);function Speaker(t,r){var i=e.call(this,t,Speaker.UUID,r)||this;i.addCharacteristic(n.Characteristic.Mute);i.addOptionalCharacteristic(n.Characteristic.Active);i.addOptionalCharacteristic(n.Characteristic.Volume);return i}Speaker.UUID="00000113-0000-1000-8000-0026BB765291";return Speaker}(a.Service);t.Speaker=ve;a.Service.Speaker=ve;var me=function(e){i.__extends(StatefulProgrammableSwitch,e);function StatefulProgrammableSwitch(t,r){var i=e.call(this,t,StatefulProgrammableSwitch.UUID,r)||this;i.addCharacteristic(n.Characteristic.ProgrammableSwitchEvent);i.addCharacteristic(n.Characteristic.ProgrammableSwitchOutputState);i.addOptionalCharacteristic(n.Characteristic.Name);return i}StatefulProgrammableSwitch.UUID="00000088-0000-1000-8000-0026BB765291";return StatefulProgrammableSwitch}(a.Service);t.StatefulProgrammableSwitch=me;a.Service.StatefulProgrammableSwitch=me;var ge=function(e){i.__extends(StatelessProgrammableSwitch,e);function StatelessProgrammableSwitch(t,r){var i=e.call(this,t,StatelessProgrammableSwitch.UUID,r)||this;i.addCharacteristic(n.Characteristic.ProgrammableSwitchEvent);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.ServiceLabelIndex);return i}StatelessProgrammableSwitch.UUID="00000089-0000-1000-8000-0026BB765291";return StatelessProgrammableSwitch}(a.Service);t.StatelessProgrammableSwitch=ge;a.Service.StatelessProgrammableSwitch=ge;var ye=function(e){i.__extends(Switch,e);function Switch(t,r){var i=e.call(this,t,Switch.UUID,r)||this;i.addCharacteristic(n.Characteristic.On);i.addOptionalCharacteristic(n.Characteristic.Name);return i}Switch.UUID="00000049-0000-1000-8000-0026BB765291";return Switch}(a.Service);t.Switch=ye;a.Service.Switch=ye;var Se=function(e){i.__extends(TapManagement,e);function TapManagement(t,r){var i=e.call(this,t,TapManagement.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addCharacteristic(n.Characteristic.CryptoHash);i.addCharacteristic(n.Characteristic.TapType);i.addCharacteristic(n.Characteristic.Token);return i}TapManagement.UUID="0000022E-0000-1000-8000-0026BB765291";return TapManagement}(a.Service);t.TapManagement=Se;a.Service.TapManagement=Se;var Ce=function(e){i.__extends(TargetControl,e);function TargetControl(t,r){var i=e.call(this,t,TargetControl.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addCharacteristic(n.Characteristic.ActiveIdentifier);i.addCharacteristic(n.Characteristic.ButtonEvent);i.addOptionalCharacteristic(n.Characteristic.Name);return i}TargetControl.UUID="00000125-0000-1000-8000-0026BB765291";return TargetControl}(a.Service);t.TargetControl=Ce;a.Service.TargetControl=Ce;var Te=function(e){i.__extends(TargetControlManagement,e);function TargetControlManagement(t,r){var i=e.call(this,t,TargetControlManagement.UUID,r)||this;i.addCharacteristic(n.Characteristic.TargetControlSupportedConfiguration);i.addCharacteristic(n.Characteristic.TargetControlList);return i}TargetControlManagement.UUID="00000122-0000-1000-8000-0026BB765291";return TargetControlManagement}(a.Service);t.TargetControlManagement=Te;a.Service.TargetControlManagement=Te;var Ee=function(e){i.__extends(Television,e);function Television(t,r){var i=e.call(this,t,Television.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addCharacteristic(n.Characteristic.ActiveIdentifier);i.addCharacteristic(n.Characteristic.ConfiguredName);i.addCharacteristic(n.Characteristic.RemoteKey);i.addCharacteristic(n.Characteristic.SleepDiscoveryMode);i.addOptionalCharacteristic(n.Characteristic.Brightness);i.addOptionalCharacteristic(n.Characteristic.ClosedCaptions);i.addOptionalCharacteristic(n.Characteristic.DisplayOrder);i.addOptionalCharacteristic(n.Characteristic.CurrentMediaState);i.addOptionalCharacteristic(n.Characteristic.TargetMediaState);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.PictureMode);i.addOptionalCharacteristic(n.Characteristic.PowerModeSelection);return i}Television.UUID="000000D8-0000-1000-8000-0026BB765291";return Television}(a.Service);t.Television=Ee;a.Service.Television=Ee;var Ae=function(e){i.__extends(TelevisionSpeaker,e);function TelevisionSpeaker(t,r){var i=e.call(this,t,TelevisionSpeaker.UUID,r)||this;i.addCharacteristic(n.Characteristic.Mute);i.addOptionalCharacteristic(n.Characteristic.Active);i.addOptionalCharacteristic(n.Characteristic.Volume);i.addOptionalCharacteristic(n.Characteristic.VolumeControlType);i.addOptionalCharacteristic(n.Characteristic.VolumeSelector);return i}TelevisionSpeaker.UUID="00000113-0000-1000-8000-0026BB765291";return TelevisionSpeaker}(a.Service);t.TelevisionSpeaker=Ae;a.Service.TelevisionSpeaker=Ae;var De=function(e){i.__extends(TemperatureSensor,e);function TemperatureSensor(t,r){var i=e.call(this,t,TemperatureSensor.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentTemperature);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.StatusActive);i.addOptionalCharacteristic(n.Characteristic.StatusFault);i.addOptionalCharacteristic(n.Characteristic.StatusLowBattery);i.addOptionalCharacteristic(n.Characteristic.StatusTampered);return i}TemperatureSensor.UUID="0000008A-0000-1000-8000-0026BB765291";return TemperatureSensor}(a.Service);t.TemperatureSensor=De;a.Service.TemperatureSensor=De;var _e=function(e){i.__extends(Thermostat,e);function Thermostat(t,r){var i=e.call(this,t,Thermostat.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentHeatingCoolingState);i.addCharacteristic(n.Characteristic.TargetHeatingCoolingState);i.addCharacteristic(n.Characteristic.CurrentTemperature);i.addCharacteristic(n.Characteristic.TargetTemperature);i.addCharacteristic(n.Characteristic.TemperatureDisplayUnits);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.CurrentRelativeHumidity);i.addOptionalCharacteristic(n.Characteristic.TargetRelativeHumidity);i.addOptionalCharacteristic(n.Characteristic.CoolingThresholdTemperature);i.addOptionalCharacteristic(n.Characteristic.HeatingThresholdTemperature);return i}Thermostat.UUID="0000004A-0000-1000-8000-0026BB765291";return Thermostat}(a.Service);t.Thermostat=_e;a.Service.Thermostat=_e;var Ie=function(e){i.__extends(ThreadTransport,e);function ThreadTransport(t,r){var i=e.call(this,t,ThreadTransport.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentTransport);i.addCharacteristic(n.Characteristic.ThreadControlPoint);i.addCharacteristic(n.Characteristic.ThreadNodeCapabilities);i.addCharacteristic(n.Characteristic.ThreadStatus);i.addOptionalCharacteristic(n.Characteristic.CCAEnergyDetectThreshold);i.addOptionalCharacteristic(n.Characteristic.CCASignalDetectThreshold);i.addOptionalCharacteristic(n.Characteristic.EventRetransmissionMaximum);i.addOptionalCharacteristic(n.Characteristic.EventTransmissionCounters);i.addOptionalCharacteristic(n.Characteristic.MACRetransmissionMaximum);i.addOptionalCharacteristic(n.Characteristic.MACTransmissionCounters);i.addOptionalCharacteristic(n.Characteristic.ReceiverSensitivity);i.addOptionalCharacteristic(n.Characteristic.ReceivedSignalStrengthIndication);i.addOptionalCharacteristic(n.Characteristic.SignalToNoiseRatio);i.addOptionalCharacteristic(n.Characteristic.ThreadOpenThreadVersion);i.addOptionalCharacteristic(n.Characteristic.TransmitPower);i.addOptionalCharacteristic(n.Characteristic.MaximumTransmitPower);return i}ThreadTransport.UUID="00000701-0000-1000-8000-0026BB765291";return ThreadTransport}(a.Service);t.ThreadTransport=Ie;a.Service.ThreadTransport=Ie;var be=function(e){i.__extends(TimeInformation,e);function TimeInformation(t,r){var i=e.call(this,t,TimeInformation.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentTime);i.addCharacteristic(n.Characteristic.DayoftheWeek);i.addCharacteristic(n.Characteristic.TimeUpdate);i.addOptionalCharacteristic(n.Characteristic.Name);return i}TimeInformation.UUID="00000099-0000-1000-8000-0026BB765291";return TimeInformation}(a.Service);t.TimeInformation=be;a.Service.TimeInformation=be;var we=function(e){i.__extends(TransferTransportManagement,e);function TransferTransportManagement(t,r){var i=e.call(this,t,TransferTransportManagement.UUID,r)||this;i.addCharacteristic(n.Characteristic.SupportedTransferTransportConfiguration);i.addCharacteristic(n.Characteristic.SetupTransferTransport);return i}TransferTransportManagement.UUID="00000203-0000-1000-8000-0026BB765291";return TransferTransportManagement}(a.Service);t.TransferTransportManagement=we;a.Service.TransferTransportManagement=we;var Re=function(e){i.__extends(Tunnel,e);function Tunnel(t,r){var i=e.call(this,t,Tunnel.UUID,r)||this;i.addCharacteristic(n.Characteristic.AccessoryIdentifier);i.addCharacteristic(n.Characteristic.TunnelConnectionTimeout);i.addCharacteristic(n.Characteristic.TunneledAccessoryAdvertising);i.addCharacteristic(n.Characteristic.TunneledAccessoryConnected);i.addCharacteristic(n.Characteristic.TunneledAccessoryStateNumber);return i}Tunnel.UUID="00000056-0000-1000-8000-0026BB765291";return Tunnel}(a.Service);t.Tunnel=Re;a.Service.TunneledBTLEAccessoryService=Re;a.Service.Tunnel=Re;var Ne=function(e){i.__extends(Valve,e);function Valve(t,r){var i=e.call(this,t,Valve.UUID,r)||this;i.addCharacteristic(n.Characteristic.Active);i.addCharacteristic(n.Characteristic.InUse);i.addCharacteristic(n.Characteristic.ValveType);i.addOptionalCharacteristic(n.Characteristic.IsConfigured);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.RemainingDuration);i.addOptionalCharacteristic(n.Characteristic.ServiceLabelIndex);i.addOptionalCharacteristic(n.Characteristic.SetDuration);i.addOptionalCharacteristic(n.Characteristic.StatusFault);return i}Valve.UUID="000000D0-0000-1000-8000-0026BB765291";return Valve}(a.Service);t.Valve=Ne;a.Service.Valve=Ne;var Ue=function(e){i.__extends(WiFiRouter,e);function WiFiRouter(t,r){var i=e.call(this,t,WiFiRouter.UUID,r)||this;i.addCharacteristic(n.Characteristic.ConfiguredName);i.addCharacteristic(n.Characteristic.ManagedNetworkEnable);i.addCharacteristic(n.Characteristic.NetworkAccessViolationControl);i.addCharacteristic(n.Characteristic.NetworkClientProfileControl);i.addCharacteristic(n.Characteristic.NetworkClientStatusControl);i.addCharacteristic(n.Characteristic.RouterStatus);i.addCharacteristic(n.Characteristic.SupportedRouterConfiguration);i.addCharacteristic(n.Characteristic.WANConfigurationList);i.addCharacteristic(n.Characteristic.WANStatusList);return i}WiFiRouter.UUID="0000020A-0000-1000-8000-0026BB765291";return WiFiRouter}(a.Service);t.WiFiRouter=Ue;a.Service.WiFiRouter=Ue;var Pe=function(e){i.__extends(WiFiSatellite,e);function WiFiSatellite(t,r){var i=e.call(this,t,WiFiSatellite.UUID,r)||this;i.addCharacteristic(n.Characteristic.WiFiSatelliteStatus);return i}WiFiSatellite.UUID="0000020F-0000-1000-8000-0026BB765291";return WiFiSatellite}(a.Service);t.WiFiSatellite=Pe;a.Service.WiFiSatellite=Pe;var Oe=function(e){i.__extends(WiFiTransport,e);function WiFiTransport(t,r){var i=e.call(this,t,WiFiTransport.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentTransport);i.addCharacteristic(n.Characteristic.WiFiCapabilities);i.addOptionalCharacteristic(n.Characteristic.WiFiConfigurationControl);return i}WiFiTransport.UUID="0000022A-0000-1000-8000-0026BB765291";return WiFiTransport}(a.Service);t.WiFiTransport=Oe;a.Service.WiFiTransport=Oe;var Le=function(e){i.__extends(Window,e);function Window(t,r){var i=e.call(this,t,Window.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentPosition);i.addCharacteristic(n.Characteristic.PositionState);i.addCharacteristic(n.Characteristic.TargetPosition);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.ObstructionDetected);i.addOptionalCharacteristic(n.Characteristic.HoldPosition);return i}Window.UUID="0000008B-0000-1000-8000-0026BB765291";return Window}(a.Service);t.Window=Le;a.Service.Window=Le;var Me=function(e){i.__extends(WindowCovering,e);function WindowCovering(t,r){var i=e.call(this,t,WindowCovering.UUID,r)||this;i.addCharacteristic(n.Characteristic.CurrentPosition);i.addCharacteristic(n.Characteristic.PositionState);i.addCharacteristic(n.Characteristic.TargetPosition);i.addOptionalCharacteristic(n.Characteristic.CurrentHorizontalTiltAngle);i.addOptionalCharacteristic(n.Characteristic.TargetHorizontalTiltAngle);i.addOptionalCharacteristic(n.Characteristic.Name);i.addOptionalCharacteristic(n.Characteristic.ObstructionDetected);i.addOptionalCharacteristic(n.Characteristic.HoldPosition);i.addOptionalCharacteristic(n.Characteristic.CurrentVerticalTiltAngle);i.addOptionalCharacteristic(n.Characteristic.TargetVerticalTiltAngle);return i}WindowCovering.UUID="0000008C-0000-1000-8000-0026BB765291";return WindowCovering}(a.Service);t.WindowCovering=Me;a.Service.WindowCovering=Me},9696:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(6867);i.__exportStar(r(5893),t);i.__exportStar(r(6017),t)},3476:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AccessoryInfo=t.PermissionTypes=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=i.__importDefault(r(6113));var o=i.__importDefault(r(326));var s=i.__importDefault(r(3837));var c=r(3939);var u=r(3949);function getVersion(){var e=r(6064);return e.version}var l;(function(e){e[e["USER"]=0]="USER";e[e["ADMIN"]=1]="ADMIN"})(l=t.PermissionTypes||(t.PermissionTypes={}));var d=function(){function AccessoryInfo(e){var t=this;this.configVersion=1;this.lastFirmwareVersion="";this.paired=function(){return Object.keys(t.pairedClients).length>0};this.username=e;this.displayName="";this.model="";this.category=1;this.pincode="";this.signSk=Buffer.alloc(0);this.signPk=Buffer.alloc(0);this.pairedClients={};this.pairedAdminClients=0;this.configHash="";this.setupID=""}AccessoryInfo.prototype.addPairedClient=function(e,t,r){this.pairedClients[e]={username:e,publicKey:t,permission:r};if(r===1){this.pairedAdminClients++}};AccessoryInfo.prototype.updatePermission=function(e,t){var r=this.pairedClients[e];if(r){var i=r.permission;r.permission=t;if(i===1&&t!==1){this.pairedAdminClients--}else if(i!==1&&t===1){this.pairedAdminClients++}}};AccessoryInfo.prototype.listPairings=function(){var e,t;var r=[];try{for(var n=i.__values(Object.values(this.pairedClients)),a=n.next();!a.done;a=n.next()){var o=a.value;r.push(o)}}catch(t){e={error:t}}finally{try{if(a&&!a.done&&(t=n.return))t.call(n)}finally{if(e)throw e.error}}return r};AccessoryInfo.prototype.removePairedClient=function(e,t){var r,n;this._removePairedClient0(e,t);if(this.pairedAdminClients===0){try{for(var a=i.__values(Object.keys(this.pairedClients)),o=a.next();!o.done;o=a.next()){var s=o.value;this._removePairedClient0(e,s)}}catch(e){r={error:e}}finally{try{if(o&&!o.done&&(n=a.return))n.call(a)}finally{if(r)throw r.error}}}};AccessoryInfo.prototype._removePairedClient0=function(e,t){if(this.pairedClients[t]&&this.pairedClients[t].permission===1){this.pairedAdminClients--}delete this.pairedClients[t];c.EventedHTTPServer.destroyExistingConnectionsAfterUnpair(e,t)};AccessoryInfo.prototype.isPaired=function(e){return!!this.pairedClients[e]};AccessoryInfo.prototype.hasAdminPermissions=function(e){if(!e){return false}var t=this.pairedClients[e];return!!t&&t.permission===1};AccessoryInfo.prototype.getClientPublicKey=function(e){var t=this.pairedClients[e];if(t){return t.publicKey}else{return undefined}};AccessoryInfo.prototype.checkForCurrentConfigurationNumberIncrement=function(e,t){var r=a.default.createHash("sha1");r.update(JSON.stringify(e));var i=r.digest("hex");var n=false;if(i!==this.configHash){this.configVersion++;this.configHash=i;this.ensureConfigVersionBounds();n=true}if(t){var o=getVersion();if(this.lastFirmwareVersion!==o){this.lastFirmwareVersion=o;n=true}}if(n){this.save()}return n};AccessoryInfo.prototype.getConfigVersion=function(){return this.configVersion};AccessoryInfo.prototype.ensureConfigVersionBounds=function(){this.configVersion=this.configVersion%(65535+1);if(this.configVersion===0){this.configVersion=1}};AccessoryInfo.prototype.save=function(){var e,t;var r={displayName:this.displayName,category:this.category,pincode:this.pincode,signSk:this.signSk.toString("hex"),signPk:this.signPk.toString("hex"),pairedClients:{},pairedClientsPermission:{},configVersion:this.configVersion,configHash:this.configHash,setupID:this.setupID,lastFirmwareVersion:this.lastFirmwareVersion};try{for(var n=i.__values(Object.entries(this.pairedClients)),a=n.next();!a.done;a=n.next()){var o=i.__read(a.value,2),s=o[0],c=o[1];r.pairedClients[s]=c.publicKey.toString("hex");r.pairedClientsPermission[s]=c.permission}}catch(t){e={error:t}}finally{try{if(a&&!a.done&&(t=n.return))t.call(n)}finally{if(e)throw e.error}}var l=AccessoryInfo.persistKey(this.username);u.HAPStorage.storage().setItemSync(l,r)};AccessoryInfo.persistKey=function(e){return s.default.format("AccessoryInfo.%s.json",e.replace(/:/g,"").toUpperCase())};AccessoryInfo.create=function(e){AccessoryInfo.assertValidUsername(e);var t=new AccessoryInfo(e);t.lastFirmwareVersion=getVersion();var r=o.default.sign.keyPair();t.signSk=Buffer.from(r.secretKey);t.signPk=Buffer.from(r.publicKey);return t};AccessoryInfo.load=function(e){var t,r;AccessoryInfo.assertValidUsername(e);var n=AccessoryInfo.persistKey(e);var a=u.HAPStorage.storage().getItem(n);if(a){var o=new AccessoryInfo(e);o.displayName=a.displayName||"";o.category=a.category||"";o.pincode=a.pincode||"";o.signSk=Buffer.from(a.signSk||"","hex");o.signPk=Buffer.from(a.signPk||"","hex");o.pairedClients={};try{for(var s=i.__values(Object.keys(a.pairedClients||{})),c=s.next();!c.done;c=s.next()){var l=c.value;var d=a.pairedClients[l];var h=a.pairedClientsPermission?a.pairedClientsPermission[l]:undefined;if(h===undefined){h=1}o.pairedClients[l]={username:l,publicKey:Buffer.from(d,"hex"),permission:h};if(h===1){o.pairedAdminClients++}}}catch(e){t={error:e}}finally{try{if(c&&!c.done&&(r=s.return))r.call(s)}finally{if(t)throw t.error}}o.configVersion=a.configVersion||1;o.configHash=a.configHash||"";o.setupID=a.setupID||"";o.lastFirmwareVersion=a.lastFirmwareVersion||getVersion();o.ensureConfigVersionBounds();return o}else{return null}};AccessoryInfo.remove=function(e){var t=AccessoryInfo.persistKey(e);u.HAPStorage.storage().removeItemSync(t)};AccessoryInfo.assertValidUsername=function(e){n.default.ok(AccessoryInfo.deviceIdPattern.test(e),"The supplied username ("+e+") is not valid "+"(expected a format like 'XX:XX:XX:XX:XX:XX' with XX being a valid hexadecimal string). "+"Note that, if you had this accessory already paired with the invalid username, you will need to repair "+"the accessory and reconfigure your services in the Home app. "+"Using an invalid username will lead to unexpected behaviour.")};AccessoryInfo.deviceIdPattern=/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/;return AccessoryInfo}();t.AccessoryInfo=d},786:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ControllerStorage=void 0;var i=r(6867);var n=i.__importDefault(r(3837));var a=i.__importDefault(r(7031));var o=r(3949);var s=(0,a.default)("HAP-NodeJS:ControllerStorage");var c=function(){function ControllerStorage(e){this.initialized=false;this.fileCreated=false;this.purgeUnidentifiedAccessoryData=true;this.trackedControllers=[];this.controllerData={};this.accessoryUUID=e.UUID}ControllerStorage.prototype.enqueueSaveRequest=function(e){var t=this;var r;if(e===void 0){e=0}if(this.parent){this.parent.enqueueSaveRequest(e);return}var i=Date.now()+e;if(this.queuedSaveTimeout){if(i<=((r=this.queuedSaveTime)!==null&&r!==void 0?r:0)){return}clearTimeout(this.queuedSaveTimeout)}this.queuedSaveTimeout=setTimeout((function(){t.queuedSaveTimeout=t.queuedSaveTime=undefined;t.save()}),e).unref();this.queuedSaveTime=Date.now()+e};ControllerStorage.prototype.linkAccessory=function(e){if(!this.linkedAccessories){this.linkedAccessories=[]}var t=e.controllerStorage;this.linkedAccessories.push(t);t.parent=this;var r=this.restoredAccessories&&this.restoredAccessories[e.UUID];if(this.initialized){t.init(r)}};ControllerStorage.prototype.trackController=function(e){e.setupStateChangeDelegate(this.handleStateChange.bind(this,e));if(!this.initialized){this.trackedControllers.push(e)}else{this.restoreController(e)}};ControllerStorage.prototype.untrackController=function(e){var t=this.trackedControllers.indexOf(e);if(t!==-1){this.trackedControllers.splice(t,1)}e.setupStateChangeDelegate(undefined);this.purgeControllerData(e)};ControllerStorage.prototype.purgeControllerData=function(e){delete this.controllerData[e.controllerId()];if(this.initialized){this.enqueueSaveRequest(100)}};ControllerStorage.prototype.handleStateChange=function(e){var t=e.controllerId();var r=e.serialize();if(!r){delete this.controllerData[t]}else{var i=this.controllerData[t];if(!i){this.controllerData[t]={data:r}}else{i.data=r}}if(this.initialized){this.enqueueSaveRequest(100)}};ControllerStorage.prototype.restoreController=function(e){if(!this.initialized){throw new Error("Illegal state. Controller data wasn't loaded yet!")}var t=this.controllerData[e.controllerId()];if(t){try{e.deserialize(t.data)}catch(t){console.warn("Could not initialize controller of type '".concat(e.controllerId(),"' from data stored on disk. Resetting to default: ").concat(t.stack));e.handleFactoryReset()}t.purgeOnNextLoad=undefined}};ControllerStorage.prototype.init=function(e){var t=this;if(this.initialized){throw new Error("ControllerStorage for accessory ".concat(this.accessoryUUID," was already initialized!"))}this.initialized=true;e&&e.forEach((function(e){return t.controllerData[e.type]=e.controllerData}));var r=[];this.trackedControllers.forEach((function(e){t.restoreController(e);r.push(e.controllerId())}));this.trackedControllers.splice(0,this.trackedControllers.length);var n=false;Object.entries(this.controllerData).forEach((function(e){var a=i.__read(e,2),o=a[0],s=a[1];if(s.purgeOnNextLoad){delete t.controllerData[o];n=true;return}if(!r.includes(o)){s.purgeOnNextLoad=true}}));if(n){this.enqueueSaveRequest(500)}};ControllerStorage.prototype.load=function(e){if(this.username){throw new Error("ControllerStorage was already loaded!")}this.username=e;var t=ControllerStorage.persistKey(e);var r=o.HAPStorage.storage().getItem(t);var i;if(r){this.fileCreated=true;i=r.accessories[this.accessoryUUID];delete r.accessories[this.accessoryUUID]}this.init(i);if(this.linkedAccessories){this.linkedAccessories.forEach((function(e){var t=r&&r.accessories[e.accessoryUUID];e.init(t);if(r){delete r.accessories[e.accessoryUUID]}}))}if(r&&Object.keys(r.accessories).length>0){if(!this.purgeUnidentifiedAccessoryData){this.restoredAccessories=r.accessories}else{s("Purging unidentified controller data for bridge %s",e)}}};ControllerStorage.prototype.save=function(){var e;if(this.parent){this.parent.save();return}if(!this.initialized){throw new Error("ControllerStorage has not yet been loaded!")}if(!this.username){throw new Error("Cannot save controllerData for a storage without a username!")}var t=(e={},e[this.accessoryUUID]=this.controllerData,e);if(this.linkedAccessories){this.linkedAccessories.forEach((function(e){return t[e.accessoryUUID]=e.controllerData}))}var r=this.restoredAccessories||{};Object.entries(t).forEach((function(e){var t=i.__read(e,2),n=t[0],a=t[1];var o=Object.entries(a);if(o.length>0){r[n]=o.map((function(e){var t=i.__read(e,2),r=t[0],n=t[1];return{type:r,controllerData:n}}))}}));var n=ControllerStorage.persistKey(this.username);if(Object.keys(r).length>0){var a={accessories:r};this.fileCreated=true;o.HAPStorage.storage().setItemSync(n,a)}else if(this.fileCreated){this.fileCreated=false;o.HAPStorage.storage().removeItemSync(n)}};ControllerStorage.persistKey=function(e){return n.default.format("ControllerStorage.%s.json",e.replace(/:/g,"").toUpperCase())};ControllerStorage.remove=function(e){var t=ControllerStorage.persistKey(e);o.HAPStorage.storage().removeItemSync(t)};return ControllerStorage}();t.ControllerStorage=c},3949:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HAPStorage=void 0;var i=r(6867);var n=i.__importDefault(r(1351));var a=function(){function HAPStorage(){}HAPStorage.storage=function(){return this.INSTANCE.storage()};HAPStorage.setCustomStoragePath=function(e){this.INSTANCE.setCustomStoragePath(e)};HAPStorage.prototype.storage=function(){if(!this.localStore){this.localStore=n.default.create();if(this.customStoragePath){this.localStore.initSync({dir:this.customStoragePath})}else{this.localStore.initSync()}}return this.localStore};HAPStorage.prototype.setCustomStoragePath=function(e){if(this.localStore){throw new Error("Cannot change storage path after it has already been initialized!")}this.customStoragePath=e};HAPStorage.INSTANCE=new HAPStorage;return HAPStorage}();t.HAPStorage=a},4245:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.IdentifierCache=void 0;var i=r(6867);var n=i.__importDefault(r(6113));var a=i.__importDefault(r(3837));var o=r(3949);var s=function(){function IdentifierCache(e){this.username=e;this._cache={};this._usedCache=null;this._savedCacheHash=""}IdentifierCache.prototype.startTrackingUsage=function(){this._usedCache={}};IdentifierCache.prototype.stopTrackingUsageAndExpireUnused=function(){this._cache=this._usedCache||this._cache;this._usedCache=null};IdentifierCache.prototype.getCache=function(e){var t=this._cache[e];if(this._usedCache&&typeof t!=="undefined"){this._usedCache[e]=t}return t};IdentifierCache.prototype.setCache=function(e,t){this._cache[e]=t;if(this._usedCache){this._usedCache[e]=t}return t};IdentifierCache.prototype.getAID=function(e){var t=e;this.getCache("|nextAID");return this.getCache(t)||this.setCache(t,this.getNextAID())};IdentifierCache.prototype.getIID=function(e,t,r,i){var n=e+"|"+t+(r?"|"+r:"")+(i?"|"+i:"");this.getCache(e+"|nextIID");return this.getCache(n)||this.setCache(n,this.getNextIID(e))};IdentifierCache.prototype.getNextAID=function(){var e="|nextAID";var t=this.getCache(e)||2;this.setCache(e,t+1);return t};IdentifierCache.prototype.getNextIID=function(e){var t=e+"|nextIID";var r=this.getCache(t)||2;this.setCache(t,r+1);return r};IdentifierCache.prototype.save=function(){var e=n.default.createHash("sha1").update(JSON.stringify(this._cache)).digest("hex");if(e!==this._savedCacheHash){var t={cache:this._cache};var r=IdentifierCache.persistKey(this.username);o.HAPStorage.storage().setItemSync(r,t);this._savedCacheHash=e}};IdentifierCache.persistKey=function(e){return a.default.format("IdentifierCache.%s.json",e.replace(/:/g,"").toUpperCase())};IdentifierCache.load=function(e){var t=IdentifierCache.persistKey(e);var r=o.HAPStorage.storage().getItem(t);if(r){var i=new IdentifierCache(e);i._cache=r.cache;i._savedCacheHash=n.default.createHash("sha1").update(JSON.stringify(i._cache)).digest("hex");return i}else{return null}};IdentifierCache.remove=function(e){var t=this.persistKey(e);o.HAPStorage.storage().removeItemSync(t)};return IdentifierCache}();t.IdentifierCache=s},6753:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AccessControlManagement=t.AccessControlEvent=t.AccessLevel=void 0;var i=r(6867);var n=r(2361);var a=r(8117);var o=r(877);var s=i.__importStar(r(2571));var c;(function(e){e[e["PASSWORD"]=1]="PASSWORD";e[e["PASSWORD_REQUIRED"]=2]="PASSWORD_REQUIRED"})(c||(c={}));var u;(function(e){e[e["ANYONE"]=0]="ANYONE";e[e["HOME_MEMBERS_ONLY"]=1]="HOME_MEMBERS_ONLY"})(u=t.AccessLevel||(t.AccessLevel={}));var l;(function(e){e["ACCESS_LEVEL_UPDATED"]="update-control-level";e["PASSWORD_SETTING_UPDATED"]="update-password"})(l=t.AccessControlEvent||(t.AccessControlEvent={}));var d=function(e){i.__extends(AccessControlManagement,e);function AccessControlManagement(t,r){var i=e.call(this)||this;i.accessLevel=0;i.passwordRequired=false;i.accessControlService=r||new o.Service.AccessControl;i.setupServiceHandlers(t);return i}AccessControlManagement.prototype.getService=function(){return this.accessControlService};AccessControlManagement.prototype.getAccessLevel=function(){return this.accessLevel};AccessControlManagement.prototype.getPassword=function(){return this.passwordRequired?this.password:undefined};AccessControlManagement.prototype.destroy=function(){this.removeAllListeners();this.accessControlService.getCharacteristic(a.Characteristic.AccessControlLevel).removeOnSet();if(this.accessControlService.testCharacteristic(a.Characteristic.PasswordSetting)){this.accessControlService.getCharacteristic(a.Characteristic.PasswordSetting).removeOnSet()}};AccessControlManagement.prototype.handleAccessLevelChange=function(e){var t=this;this.accessLevel=e;setTimeout((function(){t.emit("update-control-level",t.accessLevel)}),0).unref()};AccessControlManagement.prototype.handlePasswordChange=function(e){var t=this;var r=Buffer.from(e,"base64");var i=s.decode(r);if(i[1]){this.password=i[1].toString("utf8")}else{this.password=undefined}this.passwordRequired=!!i[2][0];setTimeout((function(){t.emit("update-password",t.password,t.passwordRequired)}),0).unref()};AccessControlManagement.prototype.setupServiceHandlers=function(e){var t=this;this.accessControlService.getCharacteristic(a.Characteristic.AccessControlLevel).onSet((function(e){return t.handleAccessLevelChange(e)})).updateValue(0);if(e){this.accessControlService.getCharacteristic(a.Characteristic.PasswordSetting).onSet((function(e){return t.handlePasswordChange(e)})).updateValue("")}};return AccessControlManagement}(n.EventEmitter);t.AccessControlManagement=d},5164:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.clone=void 0;var i=r(6867);function clone(e,t){var r,n,a,o;var s={};try{for(var c=i.__values(Object.entries(e)),u=c.next();!u.done;u=c.next()){var l=i.__read(u.value,2),d=l[0],h=l[1];s[d]=h}}catch(e){r={error:e}}finally{try{if(u&&!u.done&&(n=c.return))n.call(c)}finally{if(r)throw r.error}}if(t){try{for(var p=i.__values(Object.entries(t)),v=p.next();!v.done;v=p.next()){var m=i.__read(v.value,2),d=m[0],h=m[1];s[d]=h}}catch(e){a={error:e}}finally{try{if(v&&!v.done&&(o=p.return))o.call(p)}finally{if(a)throw a.error}}}return s}t.clone=clone},3223:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ColorUtils=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=new Map([[100,[19,222.1]],[101,[18.7,222.2]],[102,[18.4,222.3]],[103,[18.2,222.3]],[104,[17.9,222.4]],[105,[17.6,222.5]],[106,[17.3,222.7]],[107,[17,222.8]],[108,[16.7,222.9]],[109,[16.4,223]],[110,[16.1,223.2]],[111,[15.8,223.3]],[112,[15.4,223.4]],[113,[15.2,223.6]],[114,[14.9,223.8]],[115,[14.7,223.9]],[116,[14.3,224.1]],[117,[14.1,224.2]],[118,[13.8,224.4]],[119,[13.5,224.6]],[120,[13.2,224.8]],[121,[12.9,225]],[122,[12.5,225.3]],[123,[12.2,225.6]],[124,[11.8,225.9]],[125,[11.4,226.3]],[126,[11.1,226.7]],[127,[10.7,227.1]],[128,[10.3,227.6]],[129,[9.9,228]],[130,[9.6,228.5]],[131,[9.3,229.1]],[132,[8.9,229.6]],[133,[8.5,230.2]],[134,[8.2,230.9]],[135,[7.8,231.6]],[136,[7.5,232.5]],[137,[7.1,233.5]],[138,[6.7,234.6]],[139,[6.3,235.8]],[140,[6,237.1]],[141,[5.6,238.9]],[142,[5.2,240.9]],[143,[5,242.9]],[144,[4.8,244.9]],[145,[4.6,246.9]],[146,[4.4,249.3]],[147,[4.3,251.9]],[148,[4.1,254.9]],[149,[3.9,258]],[150,[3.7,261.8]],[151,[3.4,265.9]],[152,[3.2,271]],[153,[3,276.4]],[154,[2.8,283.6]],[155,[2.6,290.4]],[156,[2.3,295.3]],[157,[2.1,300]],[158,[1.9,300]],[159,[1.6,300]],[160,[1.4,195.8]],[161,[1.2,84.3]],[162,[1.3,58.2]],[163,[1.5,55.9]],[164,[1.7,53.2]],[165,[1.9,50.2]],[166,[2.1,47.1]],[167,[2.4,44.5]],[168,[2.6,42.6]],[169,[2.9,40.9]],[170,[3.1,39.5]],[171,[3.4,38.3]],[172,[3.7,37.3]],[173,[3.9,36.5]],[174,[4.2,35.7]],[175,[4.4,35.1]],[176,[4.6,34.5]],[177,[4.9,34]],[178,[5.1,33.5]],[179,[5.3,33]],[180,[5.6,32.7]],[181,[5.8,32.3]],[182,[6,32]],[183,[6.3,31.7]],[184,[6.5,31.4]],[185,[6.7,31.2]],[186,[7,30.9]],[187,[7.2,30.7]],[188,[7.4,30.5]],[189,[7.6,30.3]],[190,[7.9,30.1]],[191,[8.1,29.9]],[192,[8.4,29.7]],[193,[8.6,29.6]],[194,[8.9,29.5]],[195,[9.1,29.3]],[196,[9.4,29.2]],[197,[9.6,29.1]],[198,[9.8,29]],[199,[10,28.9]],[200,[10.2,28.7]],[201,[10.5,28.7]],[202,[10.7,28.6]],[203,[11,28.5]],[204,[11.2,28.4]],[205,[11.4,28.3]],[206,[11.6,28.3]],[207,[11.8,28.2]],[208,[12.1,28.1]],[209,[12.3,28.1]],[210,[12.5,28]],[211,[12.7,28]],[212,[12.9,27.9]],[213,[13.2,27.8]],[214,[13.4,27.8]],[215,[13.6,27.7]],[216,[13.8,27.7]],[217,[14,27.7]],[218,[14.3,27.6]],[219,[14.5,27.6]],[220,[14.7,27.5]],[221,[14.9,27.5]],[222,[15.1,27.5]],[223,[15.3,27.4]],[224,[15.5,27.4]],[225,[15.8,27.4]],[226,[16,27.3]],[227,[16.2,27.3]],[228,[16.4,27.3]],[229,[16.6,27.3]],[230,[16.8,27.2]],[231,[17,27.2]],[232,[17.2,27.2]],[233,[17.4,27.2]],[234,[17.6,27.2]],[235,[17.8,27.1]],[236,[18,27.1]],[237,[18.2,27.1]],[238,[18.4,27.1]],[239,[18.7,27.1]],[240,[18.8,27]],[241,[19,27]],[242,[19.2,27]],[243,[19.4,27]],[244,[19.6,27]],[245,[19.8,27]],[246,[20,27]],[247,[20.3,26.9]],[248,[20.5,26.9]],[249,[20.6,26.9]],[250,[20.8,26.9]],[251,[21,26.9]],[252,[21.3,26.9]],[253,[21.5,26.9]],[254,[21.6,26.9]],[255,[21.8,26.8]],[256,[22,26.8]],[257,[22.2,26.8]],[258,[22.4,26.8]],[259,[22.6,26.8]],[260,[22.8,26.8]],[261,[23,26.8]],[262,[23.2,26.8]],[263,[23.4,26.8]],[264,[23.6,26.8]],[265,[23.8,26.8]],[266,[24,26.8]],[267,[24.1,26.8]],[268,[24.3,26.8]],[269,[24.5,26.8]],[270,[24.7,26.8]],[271,[24.8,26.8]],[272,[25.1,26.7]],[273,[25.3,26.7]],[274,[25.4,26.7]],[275,[25.6,26.7]],[276,[25.8,26.7]],[277,[26,26.7]],[278,[26.1,26.7]],[279,[26.3,26.7]],[280,[26.5,26.7]],[281,[26.7,26.7]],[282,[26.9,26.7]],[283,[27.1,26.7]],[284,[27.3,26.7]],[285,[27.5,26.7]],[286,[27.7,26.7]],[287,[27.8,26.7]],[288,[28,26.7]],[289,[28.2,26.7]],[290,[28.4,26.7]],[291,[28.6,26.7]],[292,[28.8,26.7]],[293,[28.9,26.7]],[294,[29.1,26.7]],[295,[29.3,26.7]],[296,[29.5,26.7]],[297,[29.6,26.7]],[298,[29.8,26.7]],[299,[30,26.7]],[300,[30.2,26.7]],[301,[30.4,26.7]],[302,[30.5,26.7]],[303,[30.7,26.7]],[304,[30.9,26.7]],[305,[31.1,26.7]],[306,[31.2,26.7]],[307,[31.4,26.7]],[308,[31.6,26.7]],[309,[31.8,26.8]],[310,[31.9,26.8]],[311,[32.1,26.8]],[312,[32.3,26.8]],[313,[32.5,26.8]],[314,[32.6,26.8]],[315,[32.8,26.8]],[316,[33,26.8]],[317,[33.2,26.8]],[318,[33.3,26.8]],[319,[33.5,26.8]],[320,[33.7,26.8]],[321,[33.8,26.8]],[322,[34,26.8]],[323,[34.2,26.8]],[324,[34.4,26.8]],[325,[34.5,26.8]],[326,[34.7,26.8]],[327,[34.9,26.8]],[328,[35.1,26.8]],[329,[35.2,26.8]],[330,[35.4,26.8]],[331,[35.5,26.8]],[332,[35.7,26.8]],[333,[35.9,26.8]],[334,[36.1,26.8]],[335,[36.3,26.9]],[336,[36.5,26.9]],[337,[36.7,26.9]],[338,[36.9,26.9]],[339,[37.1,26.9]],[340,[37.2,26.9]],[341,[37.4,26.9]],[342,[37.5,26.9]],[343,[37.7,26.9]],[344,[37.9,26.9]],[345,[38.1,26.9]],[346,[38.3,26.9]],[347,[38.5,26.9]],[348,[38.7,26.9]],[349,[38.9,26.9]],[350,[39,26.9]],[351,[39.2,26.9]],[352,[39.3,27]],[353,[39.5,27]],[354,[39.7,27]],[355,[39.9,27]],[356,[40.1,27]],[357,[40.2,27]],[358,[40.4,27]],[359,[40.6,27]],[360,[40.8,27]],[361,[40.9,27]],[362,[41.1,27]],[363,[41.2,27]],[364,[41.4,27]],[365,[41.6,27]],[366,[41.8,27]],[367,[42,27]],[368,[42.1,27.1]],[369,[42.3,27.1]],[370,[42.4,27.1]],[371,[42.6,27.1]],[372,[42.8,27.1]],[373,[43,27.1]],[374,[43.1,27.1]],[375,[43.2,27.1]],[376,[43.4,27.1]],[377,[43.6,27.1]],[378,[43.8,27.1]],[379,[43.9,27.1]],[380,[44.1,27.1]],[381,[44.3,27.2]],[382,[44.4,27.2]],[383,[44.6,27.2]],[384,[44.7,27.2]],[385,[44.9,27.2]],[386,[45.1,27.2]],[387,[45.3,27.2]],[388,[45.5,27.2]],[389,[45.6,27.2]],[390,[45.8,27.2]],[391,[46,27.2]],[392,[46.2,27.2]],[393,[46.4,27.3]],[394,[46.5,27.3]],[395,[46.7,27.3]],[396,[46.9,27.3]],[397,[47.1,27.3]],[398,[47.2,27.3]],[399,[47.4,27.3]],[400,[47.6,27.3]],[401,[47.7,27.3]],[402,[47.9,27.3]],[403,[48.1,27.3]],[404,[48.3,27.3]],[405,[48.5,27.4]],[406,[48.7,27.4]],[407,[48.8,27.4]],[408,[49,27.4]],[409,[49.2,27.4]],[410,[49.4,27.4]],[411,[49.6,27.4]],[412,[49.7,27.4]],[413,[49.9,27.4]],[414,[50.1,27.4]],[415,[50.2,27.4]],[416,[50.4,27.4]],[417,[50.6,27.5]],[418,[50.7,27.5]],[419,[50.9,27.5]],[420,[51.1,27.5]],[421,[51.2,27.5]],[422,[51.4,27.5]],[423,[51.6,27.5]],[424,[51.7,27.5]],[425,[51.9,27.5]],[426,[52.1,27.5]],[427,[51.2,27.6]],[428,[52.4,27.6]],[429,[52.5,27.6]],[430,[52.7,27.6]],[431,[52.9,27.6]],[432,[53.1,27.6]],[433,[53.2,27.6]],[434,[53.4,27.6]],[435,[53.6,27.6]],[436,[53.7,27.6]],[437,[53.9,27.6]],[438,[54.1,27.7]],[439,[54.2,27.7]],[440,[54.3,27.7]],[441,[54.5,27.7]],[442,[54.7,27.7]],[443,[54.8,27.7]],[444,[55,27.7]],[445,[55.2,27.7]],[446,[55.3,27.7]],[447,[55.5,27.7]],[448,[55.7,27.7]],[449,[55.8,27.8]],[450,[56,27.8]],[451,[56.2,27.8]],[452,[56.3,27.8]],[453,[56.5,27.8]],[454,[56.7,27.8]],[455,[56.8,27.8]],[456,[57,27.8]],[457,[57.2,27.8]],[458,[57.3,27.9]],[459,[57.4,27.9]],[460,[57.6,27.9]],[461,[57.8,27.9]],[462,[57.9,27.9]],[463,[58.1,27.9]],[464,[58.3,27.9]],[465,[58.4,27.9]],[466,[58.6,27.9]],[467,[58.8,27.9]],[468,[59,28]],[469,[59.1,28]],[470,[59.2,28]],[471,[59.4,28]],[472,[59.6,28]],[473,[59.7,28]],[474,[60,28]],[475,[60.1,28]],[476,[60.2,28]],[477,[60.4,28]],[478,[60.6,28.1]],[479,[60.7,28.1]],[480,[60.9,28.1]],[481,[60.1,28.1]],[482,[60.3,28.1]],[483,[61.4,28.1]],[484,[61.5,28.1]],[485,[61.7,28.1]],[486,[61.9,28.1]],[487,[62,28.2]],[488,[62.2,28.2]],[489,[62.3,28.2]],[490,[62.5,28.2]],[491,[62.7,28.2]],[492,[62.8,28.2]],[493,[63,28.2]],[494,[63.2,28.2]],[495,[63.3,28.2]],[496,[63.4,28.2]],[497,[63.6,28.2]],[498,[63.8,28.3]],[499,[63.9,28.3]],[500,[64.1,28.3]]]);var o=function(){function ColorUtils(){}ColorUtils.colorTemperatureToHueAndSaturation=function(e,t){if(t===void 0){t=true}if(e>500){e=500}else if(e<100){e=100}e=Math.round(e);var r=a.get(e);(0,n.default)(e!=null,"lookup for temperature "+e+" did not yield any results");if(t){r[0]=Math.round(r[0]);r[1]=Math.round(r[1])}return{saturation:r[0],hue:r[1]}};return ColorUtils}();t.ColorUtils=o},3939:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HAPConnection=t.HAPConnectionEvent=t.HAPConnectionState=t.EventedHTTPServer=t.EventedHTTPServerEvent=t.HAPEncryption=void 0;var i=r(6867);var n=r(35);var a=i.__importDefault(r(9491));var o=i.__importDefault(r(7031));var s=r(2361);var c=i.__importDefault(r(3685));var u=i.__importDefault(r(1808));var l=i.__importDefault(r(2037));var d=i.__importStar(r(6831));var h=r(3887);var p=i.__importStar(r(5752));var v=(0,o.default)("HAP-NodeJS:EventedHTTPServer");var m=(0,o.default)("HAP-NodeJS:EventedHTTPServer:Connection");var g=(0,o.default)("HAP-NodeJS:EventEmitter");var y=function(){function HAPEncryption(e,t,r,i,n){this.accessoryToControllerCount=0;this.controllerToAccessoryCount=0;this.clientPublicKey=e;this.secretKey=t;this.publicKey=r;this.sharedSecret=i;this.hkdfPairEncryptionKey=n;this.accessoryToControllerKey=Buffer.alloc(0);this.controllerToAccessoryKey=Buffer.alloc(0)}return HAPEncryption}();t.HAPEncryption=y;var C;(function(e){e["LISTENING"]="listening";e["CONNECTION_OPENED"]="connection-opened";e["REQUEST"]="request";e["CONNECTION_CLOSED"]="connection-closed"})(C=t.EventedHTTPServerEvent||(t.EventedHTTPServerEvent={}));var T=function(e){i.__extends(EventedHTTPServer,e);function EventedHTTPServer(){var t=e.call(this)||this;t.connections=new Set;t.connectionsByUsername=new Map;t.tcpServer=u.default.createServer();return t}EventedHTTPServer.prototype.scheduleNextConnectionIdleTimeout=function(){var e,t;this.connectionIdleTimeout=undefined;if(!this.tcpServer.listening){return}v("Running idle timeout timer...");var r=(new Date).getTime();var n=-1;try{for(var a=i.__values(this.connections),o=a.next();!o.done;o=a.next()){var s=o.value;var c=r-s.lastSocketOperation;if(c>=EventedHTTPServer.MAX_CONNECTION_IDLE_TIME){v("[%s] Closing connection as it was inactive for "+c+"ms");s.close()}else{n=Math.max(n,EventedHTTPServer.MAX_CONNECTION_IDLE_TIME-c)}}}catch(t){e={error:t}}finally{try{if(o&&!o.done&&(t=a.return))t.call(a)}finally{if(e)throw e.error}}if(this.connections.size>=EventedHTTPServer.CONNECTION_TIMEOUT_LIMIT){this.connectionIdleTimeout=setTimeout(this.scheduleNextConnectionIdleTimeout.bind(this),n)}};EventedHTTPServer.prototype.address=function(){return this.tcpServer.address()};EventedHTTPServer.prototype.listen=function(e,t){var r=this;this.tcpServer.listen(e,t,(function(){var e=r.tcpServer.address();v("Server listening on %s:%s",e.family==="IPv6"?"[".concat(e.address,"]"):e.address,e.port);r.connectionLoggingInterval=setInterval((function(){var e=i.__spreadArray([],i.__read(r.connections),false).map((function(e){return"".concat(e.remoteAddress,":").concat(e.remotePort)})).join(", ");v("Currently %d hap connections open: %s",r.connections.size,e)}),6e4);r.connectionLoggingInterval.unref();r.emit("listening",e.port,e.address)}));this.tcpServer.on("connection",this.onConnection.bind(this))};EventedHTTPServer.prototype.stop=function(){var e,t;if(this.connectionLoggingInterval!=null){clearInterval(this.connectionLoggingInterval);this.connectionLoggingInterval=undefined}if(this.connectionIdleTimeout!=null){clearTimeout(this.connectionIdleTimeout);this.connectionIdleTimeout=undefined}this.tcpServer.close();try{for(var r=i.__values(this.connections),n=r.next();!n.done;n=r.next()){var a=n.value;a.close()}}catch(t){e={error:t}}finally{try{if(n&&!n.done&&(t=r.return))t.call(r)}finally{if(e)throw e.error}}};EventedHTTPServer.prototype.destroy=function(){this.stop();this.removeAllListeners()};EventedHTTPServer.prototype.broadcastEvent=function(e,t,r,n,a){var o,s;try{for(var c=i.__values(this.connections),u=c.next();!u.done;u=c.next()){var l=u.value;if(l===n){v("[%s] Muting event '%s' notification for this connection since it originated here.",l.remoteAddress,e+"."+t);continue}l.sendEvent(e,t,r,a)}}catch(e){o={error:e}}finally{try{if(u&&!u.done&&(s=c.return))s.call(c)}finally{if(o)throw o.error}}};EventedHTTPServer.prototype.onConnection=function(e){var t=this;var r=new _(this,e);r.on("request",(function(e,i){t.emit("request",r,e,i)}));r.on("authenticated",this.handleConnectionAuthenticated.bind(this,r));r.on("closed",this.handleConnectionClose.bind(this,r));this.connections.add(r);v("[%s] New connection from client on interface %s (%s)",r.remoteAddress,r.networkInterface,r.localAddress);this.emit("connection-opened",r);if(this.connections.size>=EventedHTTPServer.CONNECTION_TIMEOUT_LIMIT&&!this.connectionIdleTimeout){this.scheduleNextConnectionIdleTimeout()}};EventedHTTPServer.prototype.handleConnectionAuthenticated=function(e,t){var r=this.connectionsByUsername.get(t);if(!r){this.connectionsByUsername.set(t,[e])}else if(!r.includes(e)){r.push(e)}};EventedHTTPServer.prototype.handleConnectionClose=function(e){this.emit("connection-closed",e);this.connections.delete(e);if(e.username){var t=this.connectionsByUsername.get(e.username);if(t){var r=t.indexOf(e);if(r!==-1){t.splice(r,1)}if(t.length===0){this.connectionsByUsername.delete(e.username)}}}};EventedHTTPServer.destroyExistingConnectionsAfterUnpair=function(e,t){var r,n;var a=e.server.connectionsByUsername.get(t);if(a){try{for(var o=i.__values(a),s=o.next();!s.done;s=o.next()){var c=s.value;c.closeConnectionAsOfUnpair(e)}}catch(e){r={error:e}}finally{try{if(s&&!s.done&&(n=o.return))n.call(o)}finally{if(r)throw r.error}}}};EventedHTTPServer.CONNECTION_TIMEOUT_LIMIT=16;EventedHTTPServer.MAX_CONNECTION_IDLE_TIME=60*60*1e3;return EventedHTTPServer}(s.EventEmitter);t.EventedHTTPServer=T;var E;(function(e){e[e["CONNECTING"]=0]="CONNECTING";e[e["FULLY_SET_UP"]=1]="FULLY_SET_UP";e[e["AUTHENTICATED"]=2]="AUTHENTICATED";e[e["TO_BE_TEARED_DOWN"]=3]="TO_BE_TEARED_DOWN";e[e["CLOSING"]=4]="CLOSING";e[e["CLOSED"]=5]="CLOSED"})(E=t.HAPConnectionState||(t.HAPConnectionState={}));var D;(function(e){e["REQUEST"]="request";e["AUTHENTICATED"]="authenticated";e["CLOSED"]="closed"})(D=t.HAPConnectionEvent||(t.HAPConnectionEvent={}));var _=function(e){i.__extends(HAPConnection,e);function HAPConnection(t,r){var i=e.call(this)||this;i.state=0;i.lastSocketOperation=(new Date).getTime();i.pendingClientSocketData=Buffer.alloc(0);i.handlingRequest=false;i.registeredEvents=new Set;i.queuedEvents=[];i.eventsQueuedForImmediateDelivery=false;i.server=t;i.sessionID=p.generate(r.remoteAddress+":"+r.remotePort);i.localAddress=r.localAddress;i.remoteAddress=r.remoteAddress;i.remotePort=r.remotePort;i.networkInterface=HAPConnection.getLocalNetworkInterface(r);i.tcpSocket=r;i.tcpSocket.on("data",i.onTCPSocketData.bind(i));i.tcpSocket.on("close",i.onTCPSocketClose.bind(i));i.tcpSocket.on("error",i.onTCPSocketError.bind(i));i.tcpSocket.setNoDelay(true);i.internalHttpServer=c.default.createServer();i.internalHttpServer.timeout=0;i.internalHttpServer.keepAliveTimeout=0;i.internalHttpServer.on("listening",i.onHttpServerListening.bind(i));i.internalHttpServer.on("request",i.handleHttpServerRequest.bind(i));i.internalHttpServer.on("error",i.onHttpServerError.bind(i));i.internalHttpServer.listen(0,i.internalHttpServerAddress=(0,h.getOSLoopbackAddressIfAvailable)());return i}HAPConnection.prototype.debugListenerRegistration=function(e,t,r){if(t===void 0){t=true}if(r===void 0){r=-1}var i=(new Error).stack.split("\n")[3];var n=this.listeners(e).length;var a=e==="authenticated"?"\t":"\t\t";var o=!t?"\t":"\t\t";g("[".concat(this.remoteAddress,"] ").concat(t?"Registered":"Unregistered"," event '").concat(String(e).toUpperCase(),"' ").concat(a,"(total: ").concat(n).concat(!t?" Before: "+r:"",") ").concat(o).concat(i))};HAPConnection.prototype.on=function(t,r){var i=e.prototype.on.call(this,t,r);this.debugListenerRegistration(t);return i};HAPConnection.prototype.addListener=function(t,r){var i=e.prototype.addListener.call(this,t,r);this.debugListenerRegistration(t);return i};HAPConnection.prototype.removeListener=function(t,r){var i=this.listeners(t).length;var n=e.prototype.removeListener.call(this,t,r);this.debugListenerRegistration(t,false,i);return n};HAPConnection.prototype.off=function(t,r){var i=e.prototype.off.call(this,t,r);var n=this.listeners(t).length;this.debugListenerRegistration(t,false,n);return i};HAPConnection.prototype.connectionAuthenticated=function(e){this.state=2;this.username=e;this.emit("authenticated",e)};HAPConnection.prototype.isAuthenticated=function(){return this.state===2};HAPConnection.prototype.close=function(){if(this.state>=4){return}this.state=4;this.tcpSocket.destroy()};HAPConnection.prototype.closeConnectionAsOfUnpair=function(e){if(this===e){this.state=3}else{this.close()}};HAPConnection.prototype.sendEvent=function(e,t,r,i){(0,a.default)(e!=null,"HAPConnection.sendEvent: aid must be defined!");(0,a.default)(t!=null,"HAPConnection.sendEvent: iid must be defined!");var n=e+"."+t;if(!this.registeredEvents.has(n)){return}var o={aid:e,iid:t,value:r};if(i){this.queuedEvents.push(o);this.eventsQueuedForImmediateDelivery=true;if(this.eventsTimer){clearTimeout(this.eventsTimer);this.eventsTimer=undefined}this.handleEventsTimeout();return}for(var s=this.queuedEvents.length-1;s>=0;s--){var c=this.queuedEvents[s];if(c.aid===e&&c.iid===t){if(c.value===r){return}break}}this.queuedEvents.push(o);if(!this.eventsTimer){this.eventsTimer=setTimeout(this.handleEventsTimeout.bind(this),250);this.eventsTimer.unref()}};HAPConnection.prototype.handleEventsTimeout=function(){this.eventsTimer=undefined;if(this.state>2){return}this.writeQueuedEventNotifications()};HAPConnection.prototype.writeQueuedEventNotifications=function(){var e,t;if(this.queuedEvents.length===0||this.handlingRequest){return}if(this.eventsTimer){clearTimeout(this.eventsTimer);this.eventsTimer=undefined}var r={characteristics:[]};try{for(var n=i.__values(this.queuedEvents),a=n.next();!a.done;a=n.next()){var o=a.value;if(!this.registeredEvents.has(o.aid+"."+o.iid)){continue}r.characteristics.push(o)}}catch(t){e={error:t}}finally{try{if(a&&!a.done&&(t=n.return))t.call(n)}finally{if(e)throw e.error}}this.queuedEvents.splice(0,this.queuedEvents.length);this.eventsQueuedForImmediateDelivery=false;this.writeEventNotification(r)};HAPConnection.prototype.writeEventNotification=function(e){m("[%s] Sending HAP event notifications %o",this.remoteAddress,e.characteristics);(0,a.default)(!this.handlingRequest,"Can't write event notifications while handling a request!");e.characteristics.reverse();var t=Buffer.from(JSON.stringify(e),"utf8");var r=Buffer.from("EVENT/1.0 200 OK\r\n"+"Content-Type: application/hap+json\r\n"+"Content-Length: "+t.length+"\r\n"+"\r\n","utf8");var i=Buffer.concat([r,t]);this.tcpSocket.write(this.encrypt(i),this.handleTCPSocketWriteFulfilled.bind(this))};HAPConnection.prototype.enableEventNotifications=function(e,t){this.registeredEvents.add(e+"."+t)};HAPConnection.prototype.disableEventNotifications=function(e,t){this.registeredEvents.delete(e+"."+t)};HAPConnection.prototype.hasEventNotifications=function(e,t){return this.registeredEvents.has(e+"."+t)};HAPConnection.prototype.getRegisteredEvents=function(){return this.registeredEvents};HAPConnection.prototype.clearRegisteredEvents=function(){this.registeredEvents.clear()};HAPConnection.prototype.encrypt=function(e){if(this.encryption&&this.encryption.accessoryToControllerKey.length>0&&this.encryption.controllerToAccessoryCount>0){return d.layerEncrypt(e,this.encryption)}return e};HAPConnection.prototype.decrypt=function(e){if(this.encryption&&this.encryption.controllerToAccessoryKey.length>0){return d.layerDecrypt(e,this.encryption)}return e};HAPConnection.prototype.onHttpServerListening=function(){var e=this;var t=this.internalHttpServer.address();var r=t.family==="IPv6"?"[".concat(t.address,"]"):t.address;this.internalHttpServerPort=t.port;m("[%s] Internal HTTP server listening on %s:%s",this.remoteAddress,r,t.port);this.internalHttpServer.on("close",this.onHttpServerClose.bind(this));this.httpSocket=u.default.createConnection(this.internalHttpServerPort,this.internalHttpServerAddress);this.httpSocket.setNoDelay(true);this.httpSocket.on("data",this.handleHttpServerResponse.bind(this));this.httpSocket.on("error",this.onHttpSocketError.bind(this));this.httpSocket.on("close",this.onHttpSocketClose.bind(this));this.httpSocket.on("connect",(function(){e.state=1;m("[%s] Internal HTTP socket connected. HAPConnection now fully set up!",e.remoteAddress);if(e.pendingClientSocketData&&e.pendingClientSocketData.length>0){e.httpSocket.write(e.pendingClientSocketData)}e.pendingClientSocketData=undefined}))};HAPConnection.prototype.onTCPSocketData=function(e){if(this.state>2){return}this.handlingRequest=true;this.lastSocketOperation=(new Date).getTime();try{e=this.decrypt(e)}catch(e){m("[%s] Error occurred trying to decrypt incoming packet: %s",this.remoteAddress,e.message);this.close();return}if(this.state<1){this.pendingClientSocketData=Buffer.concat([this.pendingClientSocketData,e])}else{this.httpSocket.write(e)}};HAPConnection.prototype.handleHttpServerRequest=function(e,t){if(this.state>2){return}m("[%s] HTTP request: %s",this.remoteAddress,e.url);e.socket.setNoDelay(true);this.emit("request",e,t)};HAPConnection.prototype.handleHttpServerResponse=function(e){var t=this;e=this.encrypt(e);this.tcpSocket.write(e,this.handleTCPSocketWriteFulfilled.bind(this));m("[%s] HTTP Response is finished",this.remoteAddress);this.handlingRequest=false;if(this.state===3){setTimeout((function(){return t.close()}),10)}else if(this.state<3){if(!this.eventsTimer||this.eventsQueuedForImmediateDelivery){this.writeQueuedEventNotifications()}}};HAPConnection.prototype.handleTCPSocketWriteFulfilled=function(){this.lastSocketOperation=(new Date).getTime()};HAPConnection.prototype.onTCPSocketError=function(e){m("[%s] Client connection error: %s",this.remoteAddress,e.message)};HAPConnection.prototype.onTCPSocketClose=function(){this.state=5;m("[%s] Client connection closed",this.remoteAddress);if(this.httpSocket){this.httpSocket.destroy()}this.internalHttpServer.close();this.emit("closed");this.removeAllListeners()};HAPConnection.prototype.onHttpServerError=function(e){m("[%s] HTTP server error: %s",this.remoteAddress,e.message);if(e.code==="EADDRINUSE"){this.internalHttpServerPort=undefined;this.internalHttpServer.close();this.internalHttpServer.listen(0,this.internalHttpServerAddress=(0,h.getOSLoopbackAddressIfAvailable)())}};HAPConnection.prototype.onHttpServerClose=function(){m("[%s] HTTP server was closed",this.remoteAddress);this.close()};HAPConnection.prototype.onHttpSocketError=function(e){m("[%s] HTTP connection error: ",this.remoteAddress,e.message)};HAPConnection.prototype.onHttpSocketClose=function(){m("[%s] HTTP connection was closed",this.remoteAddress);this.internalHttpServer.close()};HAPConnection.prototype.getLocalAddress=function(e){var t,r,n,a;var o=l.default.networkInterfaces()[this.networkInterface];if(e==="ipv4"){try{for(var s=i.__values(o),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.family==="IPv4"||u.family===4){return u.address}}}catch(e){t={error:e}}finally{try{if(c&&!c.done&&(r=s.return))r.call(s)}finally{if(t)throw t.error}}throw new Error("Could not find "+e+" address for interface "+this.networkInterface)}else{var d=undefined;try{for(var h=i.__values(o),p=h.next();!p.done;p=h.next()){var u=p.value;if(u.family==="IPv6"||u.family===6){if(!u.scopeid){return u.address}else if(!d){d=u.address}}}}catch(e){n={error:e}}finally{try{if(p&&!p.done&&(a=h.return))a.call(h)}finally{if(n)throw n.error}}if(!d){throw new Error("Could not find "+e+" address for interface "+this.networkInterface)}return d}};HAPConnection.getLocalNetworkInterface=function(e){var t,r,a,o,s,c,d,h;var p=e.localAddress;if(p.startsWith("::ffff:")){p=p.substring(7)}else{var v=p.indexOf("%");if(v!==-1){p=p.substring(0,v)}}var m=l.default.networkInterfaces();try{for(var g=i.__values(Object.entries(m)),y=g.next();!y.done;y=g.next()){var C=i.__read(y.value,2),T=C[0],E=C[1];try{for(var D=(a=void 0,i.__values(E)),_=D.next();!_.done;_=D.next()){var I=_.value;if(I.address===p){return T}}}catch(e){a={error:e}}finally{try{if(_&&!_.done&&(o=D.return))o.call(D)}finally{if(a)throw a.error}}}}catch(e){t={error:e}}finally{try{if(y&&!y.done&&(r=g.return))r.call(g)}finally{if(t)throw t.error}}var b=u.default.isIPv4(p)?"IPv4":"IPv6";try{for(var w=i.__values(Object.entries(m)),R=w.next();!R.done;R=w.next()){var N=i.__read(R.value,2),T=N[0],E=N[1];try{for(var U=(d=void 0,i.__values(E)),P=U.next();!P.done;P=U.next()){var I=P.value;if(I.family!==b){continue}if((0,n.getNetAddress)(p,I.netmask)===(0,n.getNetAddress)(I.address,I.netmask)){return T}}}catch(e){d={error:e}}finally{try{if(P&&!P.done&&(h=U.return))h.call(U)}finally{if(d)throw d.error}}}}catch(e){s={error:e}}finally{try{if(R&&!R.done&&(c=w.return))c.call(w)}finally{if(s)throw s.error}}console.log("WARNING couldn't map socket coming from remote address ".concat(e.remoteAddress,":").concat(e.remotePort,"     at local address ").concat(e.localAddress," to a interface!"));return Object.keys(m)[1]};return HAPConnection}(s.EventEmitter);t.HAPConnection=_},6831:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.layerDecrypt=t.layerEncrypt=t.chacha20_poly1305_encryptAndSeal=t.chacha20_poly1305_decryptAndVerify=t.writeUInt64LE=t.HKDF=t.generateCurve25519SharedSecKey=t.generateCurve25519KeyPair=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=i.__importDefault(r(6113));var o=i.__importDefault(r(1473));var s=i.__importDefault(r(326));if(!a.default.getCiphers().includes("chacha20-poly1305")){n.default.fail("The cipher 'chacha20-poly1305' is not supported with your current running nodejs version v"+process.version+". "+"At least a nodejs version of v10.17.0 (excluding v11.0 and v11.1) is required!")}function generateCurve25519KeyPair(){return s.default.box.keyPair()}t.generateCurve25519KeyPair=generateCurve25519KeyPair;function generateCurve25519SharedSecKey(e,t){return s.default.scalarMult(e,t)}t.generateCurve25519SharedSecKey=generateCurve25519SharedSecKey;function HKDF(e,t,r,i,n){return(0,o.default)(r,n,{hash:e,salt:t,info:i})}t.HKDF=HKDF;var c=4294967295;var u=9007199254740991;function uintHighLow(e){(0,n.default)(e>-1&&e<=u,"number out of range");(0,n.default)(Math.floor(e)===e,"number must be an integer");var t=0;var r=e&4294967295;var i=r<0?(e&2147483647)+2147483648:r;if(e>c){t=(e-i)/(c+1)}return[t,i]}function writeUInt64LE(e,t,r){if(r===void 0){r=0}var i=uintHighLow(e);t.writeUInt32LE(i[1],r);t.writeUInt32LE(i[0],r+4)}t.writeUInt64LE=writeUInt64LE;function chacha20_poly1305_decryptAndVerify(e,t,r,i,n){if(t.length<12){t=Buffer.concat([Buffer.alloc(12-t.length,0),t])}var o=a.default.createDecipheriv("chacha20-poly1305",e,t,{authTagLength:16});if(r){o.setAAD(r)}o.setAuthTag(n);var s=o.update(i);o.final();return s}t.chacha20_poly1305_decryptAndVerify=chacha20_poly1305_decryptAndVerify;function chacha20_poly1305_encryptAndSeal(e,t,r,i){if(t.length<12){t=Buffer.concat([Buffer.alloc(12-t.length,0),t])}var n=a.default.createCipheriv("chacha20-poly1305",e,t,{authTagLength:16});if(r){n.setAAD(r)}var o=n.update(i);n.final();var s=n.getAuthTag();return{ciphertext:o,authTag:s}}t.chacha20_poly1305_encryptAndSeal=chacha20_poly1305_encryptAndSeal;function layerEncrypt(e,t){var r=Buffer.alloc(0);var i=e.length;for(var n=0;n<i;){var a=Math.min(i-n,1024);var o=Buffer.alloc(2);o.writeUInt16LE(a,0);var s=Buffer.alloc(8);writeUInt64LE(t.accessoryToControllerCount++,s,0);var c=chacha20_poly1305_encryptAndSeal(t.accessoryToControllerKey,s,o,e.slice(n,n+a));n+=a;r=Buffer.concat([r,o,c.ciphertext,c.authTag])}return r}t.layerEncrypt=layerEncrypt;function layerDecrypt(e,t){if(t.incompleteFrame){e=Buffer.concat([t.incompleteFrame,e]);t.incompleteFrame=undefined}var r=Buffer.alloc(0);var i=e.length;for(var n=0;n<i;){var a=e.slice(n,n+2).readUInt16LE(0);var o=i-n-2-16;if(a>o){t.incompleteFrame=e.slice(n);break}var s=Buffer.alloc(8);writeUInt64LE(t.controllerToAccessoryCount++,s,0);var c=chacha20_poly1305_decryptAndVerify(t.controllerToAccessoryKey,s,e.slice(n,n+2),e.slice(n+2,n+2+a),e.slice(n+2+a,n+2+a+16));r=Buffer.concat([r,c]);n+=18+a}return r}t.layerDecrypt=layerDecrypt},2716:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HapStatusError=void 0;var i=r(6867);var n=r(4080);var a=function(e){i.__extends(HapStatusError,e);function HapStatusError(t){var r=e.call(this,"HAP Status Error: "+t)||this;Object.setPrototypeOf(r,HapStatusError.prototype);if((0,n.IsKnownHAPStatusError)(t)){r.hapStatus=t}else{r.hapStatus=-70402}return r}return HapStatusError}(Error);t.HapStatusError=a},3887:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOSLoopbackAddressIfAvailable=t.getOSLoopbackAddress=t.findLoopbackAddress=void 0;var i=r(6867);var n=i.__importDefault(r(2037));function findLoopbackAddress(){var e,t,r,a;var o=undefined;var s=undefined;var c=undefined;try{for(var u=i.__values(Object.entries(n.default.networkInterfaces())),l=u.next();!l.done;l=u.next()){var d=i.__read(l.value,2),h=d[0],p=d[1];var v=false;try{for(var m=(r=void 0,i.__values(p)),g=m.next();!g.done;g=m.next()){var y=g.value;if(!y.internal){continue}v=true;if(y.family==="IPv4"||y.family===4){if(!c){c=y.address}}else if(y.family==="IPv6"||y.family===6){if(y.scopeid){if(!s){s=y.address+"%"+h}}else if(!o){o=y.address}}}}catch(e){r={error:e}}finally{try{if(g&&!g.done&&(a=m.return))a.call(m)}finally{if(r)throw r.error}}if(v){break}}}catch(t){e={error:t}}finally{try{if(l&&!l.done&&(t=u.return))t.call(u)}finally{if(e)throw e.error}}var C=c||o||s;if(!C){throw new Error("Could not find a valid loopback address on the platform!")}return C}t.findLoopbackAddress=findLoopbackAddress;var a=undefined;function getOSLoopbackAddress(){return a!==null&&a!==void 0?a:a=findLoopbackAddress()}t.getOSLoopbackAddress=getOSLoopbackAddress;function getOSLoopbackAddressIfAvailable(){try{return a!==null&&a!==void 0?a:a=findLoopbackAddress()}catch(e){console.log(e.stack);return undefined}}t.getOSLoopbackAddressIfAvailable=getOSLoopbackAddressIfAvailable},7417:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.once=void 0;var i=r(6867);function once(e){var t=false;return function(){var r=[];for(var n=0;n<arguments.length;n++){r[n]=arguments[n]}if(t){throw new Error("This callback function has already been called by someone else; it can only be called one time.")}else{t=true;return e.apply(void 0,i.__spreadArray([],i.__read(r),false))}}}t.once=once},4719:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.awaitEventOnce=t.PromiseTimeout=void 0;function PromiseTimeout(e){return new Promise((function(t){setTimeout((function(){return t()}),e)}))}t.PromiseTimeout=PromiseTimeout;function awaitEventOnce(e,t,r){if(r===void 0){r=5e3}return new Promise((function(i,n){var a;var resolveListener=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}clearTimeout(a);i(e.length?e.length===1?e[0]:e:undefined)};a=setTimeout((function(){e.removeListener(t,resolveListener);n(new Error("awaitEvent for event ".concat(t," timed out!")))}),r);e.once(t,resolveListener)}))}t.awaitEventOnce=awaitEventOnce},1996:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.numericUpperBound=t.numericLowerBound=t.isIntegerNumericFormat=t.isUnsignedNumericFormat=t.isNumericFormat=t.formatOutgoingCharacteristicValue=void 0;function formatOutgoingCharacteristicValue(e,t){var r;if(typeof e==="boolean"){return e?1:0}else if(typeof e==="number"){if(!t.minStep||t.minStep>=1){return e}var i=(r=t.minValue)!==null&&r!==void 0?r:0;var n=1/t.minStep;return Math.round((Math.round((e-i)*n)/n+i)*1e4)/1e4}return e}t.formatOutgoingCharacteristicValue=formatOutgoingCharacteristicValue;function isNumericFormat(e){switch(e){case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":return true;default:return false}}t.isNumericFormat=isNumericFormat;function isUnsignedNumericFormat(e){switch(e){case"uint8":case"uint16":case"uint32":case"uint64":return true;default:return false}}t.isUnsignedNumericFormat=isUnsignedNumericFormat;function isIntegerNumericFormat(e){switch(e){case"int":case"uint8":case"uint16":case"uint32":case"uint64":return true;default:return false}}t.isIntegerNumericFormat=isIntegerNumericFormat;function numericLowerBound(e){switch(e){case"int":return-2147483648;case"float":return-Number.MAX_VALUE;case"uint8":case"uint16":case"uint32":case"uint64":return 0;default:throw new Error("Unable to determine numeric lower bound for "+e)}}t.numericLowerBound=numericLowerBound;function numericUpperBound(e){switch(e){case"int":return 2147483647;case"float":return Number.MAX_VALUE;case"uint8":return 255;case"uint16":return 65535;case"uint32":return 4294967295;case"uint64":return 0x10000000000000000;default:throw new Error("Unable to determine numeric lower bound for "+e)}}t.numericUpperBound=numericUpperBound},9727:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.epochMillisFromMillisSince2001_01_01Buffer=t.epochMillisFromMillisSince2001_01_01=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=r(2571);var o=Date.UTC(2001,0,1,0,0,0,0);function epochMillisFromMillisSince2001_01_01(e){return o+e}t.epochMillisFromMillisSince2001_01_01=epochMillisFromMillisSince2001_01_01;function epochMillisFromMillisSince2001_01_01Buffer(e){(0,n.default)(e.length===8,"can only parse 64 bit buffers!");var t=(0,a.readUInt64LE)(e);return epochMillisFromMillisSince2001_01_01(t)}t.epochMillisFromMillisSince2001_01_01Buffer=epochMillisFromMillisSince2001_01_01Buffer},2571:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.writeVariableUIntLE=t.readVariableUIntLE=t.readUInt16=t.writeUInt16=t.writeFloat32LE=t.readUInt32=t.writeUInt32=t.readUInt64BE=t.readUInt64LE=t.readUInt64=t.writeUInt64=t.decodeList=t.decodeWithLists=t.decode=t.encode=void 0;var i=r(6867);var n=i.__importDefault(r(9491));var a=i.__importStar(r(6831));var o=0;function encode(e,t){var r,n;var a=[];for(var s=2;s<arguments.length;s++){a[s-2]=arguments[s]}var c=[];if(typeof t==="number"){t=Buffer.from([t])}else if(typeof t==="string"){t=Buffer.from(t)}if(Array.isArray(t)){var u=true;try{for(var l=i.__values(t),d=l.next();!d.done;d=l.next()){var h=d.value;if(!u){c.push(Buffer.from([o,0]))}u=false;c.push(encode(e,h))}}catch(e){r={error:e}}finally{try{if(d&&!d.done&&(n=l.return))n.call(l)}finally{if(r)throw r.error}}if(u){c.push(Buffer.from([e,0]))}}else if(t.length<=255){c.push(Buffer.concat([Buffer.from([e,t.length]),t]))}else{var p=t.length;var v=0;for(;p>0;){if(p>=255){c.push(Buffer.concat([Buffer.from([e,255]),t.slice(v,v+255)]));p-=255;v+=255}else{c.push(Buffer.concat([Buffer.from([e,p]),t.slice(v)]));p-=p}}}if(a.length>=2){var m=i.__read(a),g=m[0],y=m[1],C=m.slice(2);var T=encode.apply(void 0,i.__spreadArray([g,y],i.__read(C),false));c.push(T)}return Buffer.concat(c)}t.encode=encode;function decode(e){(0,n.default)(e instanceof Buffer,"Illegal argument. tlv.decode() expects Buffer type!");var t={};var r=e.length;var i=0;for(;r>0;){var a=e[i];var o=e[i+1];i+=2;r-=2;var s=e.slice(i,i+o);if(t[a]){t[a]=Buffer.concat([t[a],s])}else{t[a]=s}i+=o;r-=o}return t}t.decode=decode;function decodeWithLists(e){var t={};var r=e.length;var i=0;var n=-1;var a=-1;var o=false;for(;r>0;){var s=e.readUInt8(i++);var c=e.readUInt8(i++);r-=2;var u=e.slice(i,i+c);i+=c;r-=c;if(s===0&&c===0){o=true;continue}var l=t[s];if(l){if(o&&n===s){if(Array.isArray(l)){l.push(u)}else{t[s]=[l,u]}}else if(n===s&&a===255){if(Array.isArray(l)){var d=l[l.length-1];l[l.length-1]=Buffer.concat([d,u])}else{t[s]=Buffer.concat([l,u])}}else{throw new Error("Found duplicated tlv entry with type ".concat(s," and length ").concat(c,"         (lastItemWasDelimiter: ").concat(o,", lastType: ").concat(n,", lastLength: ").concat(a,")"))}}else{t[s]=u}n=s;a=c;o=false}return t}t.decodeWithLists=decodeWithLists;function decodeList(e,t){var r=[];var i=e.length;var n=0;var a=undefined;for(;i>0;){var o=e[n];var s=e[n+1];var c=e.slice(n+2,n+2+s);if(o===t){if(a!==undefined){r.push(a)}a={}}if(a===undefined){throw new Error("Error parsing tlv list: Encountered uninitialized storage object")}if(a[o]){a[o]=Buffer.concat([a[o],c])}else{a[o]=c}n+=2+s;i-=2+s}if(a!==undefined){r.push(a)}return r}t.decodeList=decodeList;function writeUInt64(e){var t=new Float64Array(1);t[0]=e;var r=Buffer.alloc(t.buffer.byteLength);var i=new Uint8Array(t.buffer);for(var n=0;n<r.length;n++){r[n]=i[n]}return r}t.writeUInt64=writeUInt64;function readUInt64(e){var t=new Float64Array(e);return t[0]}t.readUInt64=readUInt64;function readUInt64LE(e,t){if(t===void 0){t=0}var r=e.readUInt32LE(t);return e.readUInt32LE(t+4)*4294967296+r}t.readUInt64LE=readUInt64LE;function readUInt64BE(e,t){if(t===void 0){t=0}return readUInt64LE(e,t)}t.readUInt64BE=readUInt64BE;function writeUInt32(e){var t=Buffer.alloc(4);t.writeUInt32LE(e,0);return t}t.writeUInt32=writeUInt32;function readUInt32(e){return e.readUInt32LE(0)}t.readUInt32=readUInt32;function writeFloat32LE(e){var t=Buffer.alloc(4);t.writeFloatLE(e,0);return t}t.writeFloat32LE=writeFloat32LE;function writeUInt16(e){var t=Buffer.alloc(2);t.writeUInt16LE(e,0);return t}t.writeUInt16=writeUInt16;function readUInt16(e){return e.readUInt16LE(0)}t.readUInt16=readUInt16;function readVariableUIntLE(e,t){if(t===void 0){t=0}(0,n.default)(t===0,"Can't define a offset different than 0!");switch(e.length){case 1:return e.readUInt8(t);case 2:return e.readUInt16LE(t);case 4:return e.readUInt32LE(t);case 8:return readUInt64LE(e,t);default:throw new Error("Can't read uint LE with length "+e.length)}}t.readVariableUIntLE=readVariableUIntLE;function writeVariableUIntLE(e,t){if(t===void 0){t=0}(0,n.default)(e>=0,"Can't encode a negative integer as unsigned integer");(0,n.default)(t===0,"Can't define a offset different than 0!");if(e<=255){var r=Buffer.alloc(1);r.writeUInt8(e,t);return r}else if(e<=65535){return writeUInt16(e)}else if(e<=4294967295){return writeUInt32(e)}else{var r=Buffer.alloc(8);a.writeUInt64LE(e,r,t);return r}}t.writeVariableUIntLE=writeVariableUIntLE},5752:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.toLongForm=t.toShortForm=t.write=t.unparse=t.isValid=t.generate=t.BASE_UUID=void 0;var i=r(6867);var n=i.__importDefault(r(6113));t.BASE_UUID="-0000-1000-8000-0026BB765291";function generate(e){var t=n.default.createHash("sha1");t.update(e);var r=t.digest("hex");var i=-1;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){i+=1;switch(e){case"y":return(parseInt("0x"+r[i],16)&3|8).toString(16);case"x":default:return r[i]}}))}t.generate=generate;var a=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function isValid(e){return a.test(e)}t.isValid=isValid;function unparse(e,t){if(t===void 0){t=0}if(typeof e==="string"&&isValid(e)){return e}var r=t;return e.toString("hex",r,r+=4)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+6)}t.unparse=unparse;function write(e,t,r){if(r===void 0){r=0}var i=Buffer.from(e.replace(/-/g,""),"hex");if(t){i.copy(t,r);return t}else{return i}}t.write=write;var o=/^0*([0-9a-f]{1,8})-([0-9a-f]{4}-){3}[0-9a-f]{12}$/i;function toShortForm(e,r){if(r===void 0){r=t.BASE_UUID}if(!isValid(e)){throw new TypeError("uuid was not a valid UUID or short form UUID")}if(r&&!isValid("00000000"+r)){throw new TypeError("base was not a valid base UUID")}if(r&&!e.endsWith(r)){return e.toUpperCase()}return e.replace(o,"$1").toUpperCase()}t.toShortForm=toShortForm;var s=/^[0-9a-f]{1,8}$/i;function toLongForm(e,r){if(r===void 0){r=t.BASE_UUID}if(isValid(e)){return e.toUpperCase()}if(!s.test(e)){throw new TypeError("uuid was not a valid UUID or short form UUID")}if(!isValid("00000000"+r)){throw new TypeError("base was not a valid base UUID")}return(("00000000"+e).substr(-8)+r).toUpperCase()}t.toLongForm=toLongForm},1624:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ResourceRequestType=void 0;var r;(function(e){e["IMAGE"]="image"})(r=t.ResourceRequestType||(t.ResourceRequestType={}))},502:e=>{"use strict";var t=typeof BigInt!=="undefined"&&BigInt;e.exports=function hasNativeBigInts(){return typeof t==="function"&&typeof BigInt==="function"&&typeof t(42)==="bigint"&&typeof BigInt(42)==="bigint"}},6394:(e,t,r)=>{"use strict";var i=r(1626);var n=i("%Object.defineProperty%",true);var a=function hasPropertyDescriptors(){if(n){try{n({},"a",{value:1});return true}catch(e){return false}}return false};a.hasArrayLengthDefineBug=function hasArrayLengthDefineBug(){if(!a()){return null}try{return n([],"length",{value:1}).length!==1}catch(e){return true}};e.exports=a},9299:(e,t,r)=>{"use strict";var i=typeof Symbol!=="undefined"&&Symbol;var n=r(8005);e.exports=function hasNativeSymbols(){if(typeof i!=="function"){return false}if(typeof Symbol!=="function"){return false}if(typeof i("foo")!=="symbol"){return false}if(typeof Symbol("bar")!=="symbol"){return false}return n()}},8005:e=>{"use strict";e.exports=function hasSymbols(){if(typeof Symbol!=="function"||typeof Object.getOwnPropertySymbols!=="function"){return false}if(typeof Symbol.iterator==="symbol"){return true}var e={};var t=Symbol("test");var r=Object(t);if(typeof t==="string"){return false}if(Object.prototype.toString.call(t)!=="[object Symbol]"){return false}if(Object.prototype.toString.call(r)!=="[object Symbol]"){return false}var i=42;e[t]=i;for(t in e){return false}if(typeof Object.keys==="function"&&Object.keys(e).length!==0){return false}if(typeof Object.getOwnPropertyNames==="function"&&Object.getOwnPropertyNames(e).length!==0){return false}var n=Object.getOwnPropertySymbols(e);if(n.length!==1||n[0]!==t){return false}if(!Object.prototype.propertyIsEnumerable.call(e,t)){return false}if(typeof Object.getOwnPropertyDescriptor==="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==i||a.enumerable!==true){return false}}return true}},3192:(e,t,r)=>{"use strict";var i=r(8005);e.exports=function hasToStringTagShams(){return i()&&!!Symbol.toStringTag}},9143:(e,t,r)=>{"use strict";var i=r(7978);e.exports=i.call(Function.call,Object.prototype.hasOwnProperty)},5078:(e,t,r)=>{"use strict";var i=r(3192)();var n=r(6379);var a=n("Object.prototype.toString");var o=function isArguments(e){if(i&&e&&typeof e==="object"&&Symbol.toStringTag in e){return false}return a(e)==="[object Arguments]"};var s=function isArguments(e){if(o(e)){return true}return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&a(e)!=="[object Array]"&&a(e.callee)==="[object Function]"};var c=function(){return o(arguments)}();o.isLegacyArguments=s;e.exports=c?o:s},4111:(e,t,r)=>{"use strict";var i=r(502)();if(i){var n=BigInt.prototype.valueOf;var a=function tryBigIntObject(e){try{n.call(e);return true}catch(e){}return false};e.exports=function isBigInt(e){if(e===null||typeof e==="undefined"||typeof e==="boolean"||typeof e==="string"||typeof e==="number"||typeof e==="symbol"||typeof e==="function"){return false}if(typeof e==="bigint"){return true}return a(e)}}else{e.exports=function isBigInt(e){return false&&0}}},2385:(e,t,r)=>{"use strict";var i=r(6379);var n=i("Boolean.prototype.toString");var a=i("Object.prototype.toString");var o=function booleanBrandCheck(e){try{n(e);return true}catch(e){return false}};var s="[object Boolean]";var c=r(3192)();e.exports=function isBoolean(e){if(typeof e==="boolean"){return true}if(e===null||typeof e!=="object"){return false}return c&&Symbol.toStringTag in e?o(e):a(e)===s}},8443:e=>{"use strict";var t=Function.prototype.toString;var r=typeof Reflect==="object"&&Reflect!==null&&Reflect.apply;var i;var n;if(typeof r==="function"&&typeof Object.defineProperty==="function"){try{i=Object.defineProperty({},"length",{get:function(){throw n}});n={};r((function(){throw 42}),null,i)}catch(e){if(e!==n){r=null}}}else{r=null}var a=/^\s*class\b/;var o=function isES6ClassFunction(e){try{var r=t.call(e);return a.test(r)}catch(e){return false}};var s=function tryFunctionToStr(e){try{if(o(e)){return false}t.call(e);return true}catch(e){return false}};var c=Object.prototype.toString;var u="[object Object]";var l="[object Function]";var d="[object GeneratorFunction]";var h="[object HTMLAllCollection]";var p="[object HTML document.all class]";var v="[object HTMLCollection]";var m=typeof Symbol==="function"&&!!Symbol.toStringTag;var g=!(0 in[,]);var y=function isDocumentDotAll(){return false};if(typeof document==="object"){var C=document.all;if(c.call(C)===c.call(document.all)){y=function isDocumentDotAll(e){if((g||!e)&&(typeof e==="undefined"||typeof e==="object")){try{var t=c.call(e);return(t===h||t===p||t===v||t===u)&&e("")==null}catch(e){}}return false}}}e.exports=r?function isCallable(e){if(y(e)){return true}if(!e){return false}if(typeof e!=="function"&&typeof e!=="object"){return false}try{r(e,null,i)}catch(e){if(e!==n){return false}}return!o(e)&&s(e)}:function isCallable(e){if(y(e)){return true}if(!e){return false}if(typeof e!=="function"&&typeof e!=="object"){return false}if(m){return s(e)}if(o(e)){return false}var t=c.call(e);if(t!==l&&t!==d&&!/^\[object HTML/.test(t)){return false}return s(e)}},8753:(e,t,r)=>{"use strict";var i=Date.prototype.getDay;var n=function tryDateGetDayCall(e){try{i.call(e);return true}catch(e){return false}};var a=Object.prototype.toString;var o="[object Date]";var s=r(3192)();e.exports=function isDateObject(e){if(typeof e!=="object"||e===null){return false}return s?n(e):a.call(e)===o}},2050:e=>{"use strict";var t=typeof Map==="function"&&Map.prototype?Map:null;var r=typeof Set==="function"&&Set.prototype?Set:null;var i;if(!t){i=function isMap(e){return false}}var n=t?Map.prototype.has:null;var a=r?Set.prototype.has:null;if(!i&&!n){i=function isMap(e){return false}}e.exports=i||function isMap(e){if(!e||typeof e!=="object"){return false}try{n.call(e);if(a){try{a.call(e)}catch(e){return true}}return e instanceof t}catch(e){}return false}},39:(e,t,r)=>{"use strict";var i=Number.prototype.toString;var n=function tryNumberObject(e){try{i.call(e);return true}catch(e){return false}};var a=Object.prototype.toString;var o="[object Number]";var s=r(3192)();e.exports=function isNumberObject(e){if(typeof e==="number"){return true}if(typeof e!=="object"){return false}return s?n(e):a.call(e)===o}},3089:(e,t,r)=>{"use strict";var i=r(6379);var n=r(3192)();var a;var o;var s;var c;if(n){a=i("Object.prototype.hasOwnProperty");o=i("RegExp.prototype.exec");s={};var throwRegexMarker=function(){throw s};c={toString:throwRegexMarker,valueOf:throwRegexMarker};if(typeof Symbol.toPrimitive==="symbol"){c[Symbol.toPrimitive]=throwRegexMarker}}var u=i("Object.prototype.toString");var l=Object.getOwnPropertyDescriptor;var d="[object RegExp]";e.exports=n?function isRegex(e){if(!e||typeof e!=="object"){return false}var t=l(e,"lastIndex");var r=t&&a(t,"value");if(!r){return false}try{o(e,c)}catch(e){return e===s}}:function isRegex(e){if(!e||typeof e!=="object"&&typeof e!=="function"){return false}return u(e)===d}},8181:e=>{"use strict";var t=typeof Map==="function"&&Map.prototype?Map:null;var r=typeof Set==="function"&&Set.prototype?Set:null;var i;if(!r){i=function isSet(e){return false}}var n=t?Map.prototype.has:null;var a=r?Set.prototype.has:null;if(!i&&!a){i=function isSet(e){return false}}e.exports=i||function isSet(e){if(!e||typeof e!=="object"){return false}try{a.call(e);if(n){try{n.call(e)}catch(e){return true}}return e instanceof r}catch(e){}return false}},4264:(e,t,r)=>{"use strict";var i=String.prototype.valueOf;var n=function tryStringObject(e){try{i.call(e);return true}catch(e){return false}};var a=Object.prototype.toString;var o="[object String]";var s=r(3192)();e.exports=function isString(e){if(typeof e==="string"){return true}if(typeof e!=="object"){return false}return s?n(e):a.call(e)===o}},2154:(e,t,r)=>{"use strict";var i=Object.prototype.toString;var n=r(9299)();if(n){var a=Symbol.prototype.toString;var o=/^Symbol\(.*\)$/;var s=function isRealSymbolObject(e){if(typeof e.valueOf()!=="symbol"){return false}return o.test(a.call(e))};e.exports=function isSymbol(e){if(typeof e==="symbol"){return true}if(i.call(e)!=="[object Symbol]"){return false}try{return s(e)}catch(e){return false}}}else{e.exports=function isSymbol(e){return false&&0}}},9159:(e,t,r)=>{"use strict";var i=r(8958);var n=r(8285);var a=r(6379);var o=a("Object.prototype.toString");var s=r(3192)();var c=r(3833);var u=typeof globalThis==="undefined"?global:globalThis;var l=n();var d=a("Array.prototype.indexOf",true)||function indexOf(e,t){for(var r=0;r<e.length;r+=1){if(e[r]===t){return r}}return-1};var h=a("String.prototype.slice");var p={};var v=Object.getPrototypeOf;if(s&&c&&v){i(l,(function(e){var t=new u[e];if(Symbol.toStringTag in t){var r=v(t);var i=c(r,Symbol.toStringTag);if(!i){var n=v(r);i=c(n,Symbol.toStringTag)}p[e]=i.get}}))}var m=function tryAllTypedArrays(e){var t=false;i(p,(function(r,i){if(!t){try{t=r.call(e)===i}catch(e){}}}));return t};e.exports=function isTypedArray(e){if(!e||typeof e!=="object"){return false}if(!s||!(Symbol.toStringTag in e)){var t=h(o(e),8,-1);return d(l,t)>-1}if(!c){return false}return m(e)}},9682:e=>{"use strict";var t=typeof WeakMap==="function"&&WeakMap.prototype?WeakMap:null;var r=typeof WeakSet==="function"&&WeakSet.prototype?WeakSet:null;var i;if(!t){i=function isWeakMap(e){return false}}var n=t?t.prototype.has:null;var a=r?r.prototype.has:null;if(!i&&!n){i=function isWeakMap(e){return false}}e.exports=i||function isWeakMap(e){if(!e||typeof e!=="object"){return false}try{n.call(e,n);if(a){try{a.call(e,a)}catch(e){return true}}return e instanceof t}catch(e){}return false}},6077:(e,t,r)=>{"use strict";var i=r(1626);var n=r(6379);var a=i("%WeakSet%",true);var o=n("WeakSet.prototype.has",true);if(o){var s=n("WeakMap.prototype.has",true);e.exports=function isWeakSet(e){if(!e||typeof e!=="object"){return false}try{o(e,o);if(s){try{s(e,s)}catch(e){return true}}return e instanceof a}catch(e){}return false}}else{e.exports=function isWeakSet(e){return false}}},4774:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return t.call(e)=="[object Array]"}},6582:(e,t,r)=>{var i=r(2781).Stream;e.exports=function(e,t){var r=new i,n=0,a=0,o=false,s=false,c=false,u=0,l=false;t=t||{};var d=t.failures?"failure":"error";var h={};r.writable=true;r.readable=true;function queueData(e,t){var i=u+1;if(t===i){if(e!==undefined){r.emit.apply(r,["data",e])}u++;i++}else{h[t]=e}if(h.hasOwnProperty(i)){var c=h[i];delete h[i];return queueData(c,i)}a++;if(n===a){if(s)s=false,r.emit("drain");if(o)end()}}function next(e,i,n){if(c)return;l=true;if(!e||t.failures){queueData(i,n)}if(e){r.emit.apply(r,[d,e])}l=false}function wrappedMapper(t,r,i){return e.call(null,t,(function(e,t){i(e,t,r)}))}r.write=function(e){if(o)throw new Error("map stream is not writable");l=false;n++;try{var t=wrappedMapper(e,n,next);s=t===false;return!s}catch(e){if(l)throw e;next(e);return!s}};function end(e){o=true;r.writable=false;if(e!==undefined){return queueData(e,n)}else if(n==a){r.readable=false,r.emit("end"),r.destroy()}}r.end=function(e){if(o)return;end(e)};r.destroy=function(){o=c=true;r.writable=r.readable=s=false;process.nextTick((function(){r.emit("close")}))};r.pause=function(){s=true};r.resume=function(){s=false};return r}},4680:(e,t,r)=>{var i=r(1017);var n=r(7147);var a=parseInt("0777",8);e.exports=mkdirP.mkdirp=mkdirP.mkdirP=mkdirP;function mkdirP(e,t,r,o){if(typeof t==="function"){r=t;t={}}else if(!t||typeof t!=="object"){t={mode:t}}var s=t.mode;var c=t.fs||n;if(s===undefined){s=a}if(!o)o=null;var u=r||function(){};e=i.resolve(e);c.mkdir(e,s,(function(r){if(!r){o=o||e;return u(null,o)}switch(r.code){case"ENOENT":if(i.dirname(e)===e)return u(r);mkdirP(i.dirname(e),t,(function(r,i){if(r)u(r,i);else mkdirP(e,t,u,i)}));break;default:c.stat(e,(function(e,t){if(e||!t.isDirectory())u(r,o);else u(null,o)}));break}}))}mkdirP.sync=function sync(e,t,r){if(!t||typeof t!=="object"){t={mode:t}}var o=t.mode;var s=t.fs||n;if(o===undefined){o=a}if(!r)r=null;e=i.resolve(e);try{s.mkdirSync(e,o);r=r||e}catch(n){switch(n.code){case"ENOENT":r=sync(i.dirname(e),t,r);sync(e,t,r);break;default:var c;try{c=s.statSync(e)}catch(e){throw n}if(!c.isDirectory())throw n;break}}return r}},721:e=>{var t=1e3;var r=t*60;var i=r*60;var n=i*24;var a=n*7;var o=n*365.25;e.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0){return parse(e)}else if(r==="number"&&isFinite(e)){return t.long?fmtLong(e):fmtShort(e)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function parse(e){e=String(e);if(e.length>100){return}var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!s){return}var c=parseFloat(s[1]);var u=(s[2]||"ms").toLowerCase();switch(u){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*a;case"days":case"day":case"d":return c*n;case"hours":case"hour":case"hrs":case"hr":case"h":return c*i;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return undefined}}function fmtShort(e){var a=Math.abs(e);if(a>=n){return Math.round(e/n)+"d"}if(a>=i){return Math.round(e/i)+"h"}if(a>=r){return Math.round(e/r)+"m"}if(a>=t){return Math.round(e/t)+"s"}return e+"ms"}function fmtLong(e){var a=Math.abs(e);if(a>=n){return plural(e,a,n,"day")}if(a>=i){return plural(e,a,i,"hour")}if(a>=r){return plural(e,a,r,"minute")}if(a>=t){return plural(e,a,t,"second")}return e+" ms"}function plural(e,t,r,i){var n=t>=r*1.5;return Math.round(e/r)+" "+i+(n?"s":"")}},576:(e,t)=>{var prefix=function(e){return"_"+e};var defined=function(e){return e};t.stringify=function(e){if(typeof e==="object"&&e&&e.name)return t.stringify(e.name,e.protocol,e.subtypes);return Array.prototype.concat.apply([],arguments).filter(defined).map(prefix).join(".")};t.parse=function(e){var t=e.split(".");for(var r=0;r<t.length;r++){if(t[r][0]!=="_")continue;t[r]=t[r].slice(1)}return{name:t.shift(),protocol:t.shift()||null,subtypes:t}};t.tcp=function(e){return t.stringify(e,"tcp",Array.prototype.concat.apply([],Array.prototype.slice.call(arguments,1)))};t.udp=function(e){return t.stringify(e,"udp",Array.prototype.concat.apply([],Array.prototype.slice.call(arguments,1)))}},9535:(e,t,r)=>{var i=r(9594);var n=r(1891);var a=r(1303);var o=r(2361);var s=r(2037);var noop=function(){};e.exports=function(e){if(!e)e={};var t=new o.EventEmitter;var r=typeof e.port==="number"?e.port:5353;var s=e.type||"udp4";var c=e.ip||e.host||(s==="udp4"?"224.0.0.251":null);var u={address:c,port:r};var l={};var d=false;var h=null;if(s==="udp6"&&(!c||!e.interface)){throw new Error("For IPv6 multicast you must specify `ip` and `interface`")}var p=e.socket||n.createSocket({type:s,reuseAddr:e.reuseAddr!==false,toString:function(){return s}});p.on("error",(function(e){if(e.code==="EACCES"||e.code==="EADDRINUSE")t.emit("error",e);else t.emit("warning",e)}));p.on("message",(function(e,r){try{e=i.decode(e)}catch(e){t.emit("warning",e);return}t.emit("packet",e,r);if(e.type==="query")t.emit("query",e,r);if(e.type==="response")t.emit("response",e,r)}));p.on("listening",(function(){if(!r)r=u.port=p.address().port;if(e.multicast!==false){t.update();h=setInterval(t.update,5e3);p.setMulticastTTL(e.ttl||255);p.setMulticastLoopback(e.loopback!==false)}}));var v=a((function(t){if(!r||e.bind===false)return t(null);p.once("error",t);p.bind(r,e.bind||e.interface,(function(){p.removeListener("error",t);t(null)}))}));v((function(e){if(e)return t.emit("error",e);t.emit("ready")}));t.send=function(e,r,n){if(typeof r==="function")return t.send(e,null,r);if(!n)n=noop;if(!r)r=u;else if(!r.host&&!r.address)r.address=u.address;v(onbind);function onbind(t){if(d)return n();if(t)return n(t);var a=i.encode(e);p.send(a,0,a.length,r.port,r.address||r.host,n)}};t.response=t.respond=function(e,r,n){if(Array.isArray(e))e={answers:e};e.type="response";e.flags=(e.flags||0)|i.AUTHORITATIVE_ANSWER;t.send(e,r,n)};t.query=function(e,r,i,n){if(typeof r==="function")return t.query(e,null,null,r);if(typeof r==="object"&&r&&r.port)return t.query(e,null,r,i);if(typeof i==="function")return t.query(e,r,null,i);if(!n)n=noop;if(typeof e==="string")e=[{name:e,type:r||"ANY"}];if(Array.isArray(e))e={type:"query",questions:e};e.type="query";t.send(e,i,n)};t.destroy=function(e){if(!e)e=noop;if(d)return process.nextTick(e);d=true;clearInterval(h);for(var t in l){try{p.dropMembership(c,t)}catch(e){}}l={};p.close(e)};t.update=function(){var r=e.interface?[].concat(e.interface):allInterfaces();var i=false;for(var n=0;n<r.length;n++){var a=r[n];if(l[a])continue;try{p.addMembership(c,a);l[a]=true;i=true}catch(e){t.emit("warning",e)}}if(i){if(p.setMulticastInterface){try{p.setMulticastInterface(e.interface||defaultInterface())}catch(e){t.emit("warning",e)}}t.emit("networkInterface")}};return t};function defaultInterface(){var e=s.networkInterfaces();var t=Object.keys(e);for(var r=0;r<t.length;r++){var i=e[t[r]];for(var n=0;n<i.length;n++){var a=i[n];if(isIPv4(a.family)&&!a.internal){if(s.platform()==="darwin"&&t[r]==="en0")return a.address;return"0.0.0.0"}}}return"127.0.0.1"}function allInterfaces(){var e=s.networkInterfaces();var t=Object.keys(e);var r=[];for(var i=0;i<t.length;i++){var n=e[t[i]];for(var a=0;a<n.length;a++){var o=n[a];if(isIPv4(o.family)){r.push(o.address);break}}}return r}function isIPv4(e){return e===4||e==="IPv4"}},9477:(e,t,r)=>{var i=r(7147),n=r(1017),a=r(4680),o=r(1048),s={dir:"persist",stringify:JSON.stringify,parse:JSON.parse,encoding:"utf8",logging:false,continuous:true,interval:false,ttl:false},c=24*60*60*1e3,isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isFunction=function(e){return typeof e==="function"},noop=function(e){if(e)throw e},noopWithoutError=function(){};var LocalStorage=function(e){if(!(this instanceof LocalStorage)){return new LocalStorage(e)}this.data={};this.ttls={};this.changes={};this.setOptions(e)};LocalStorage.prototype={setOptions:function(e){var t={};if(!e){t=s}else{for(var r in s){if(e.hasOwnProperty(r)){t[r]=e[r]}else{t[r]=s[r]}}t.dir=this.resolveDir(t.dir);t.ttlDir=t.dir+"-ttl";t.ttl=t.ttl?isNumber(t.ttl)&&t.ttl>0?t.ttl:c:false}if(isFunction(t.logging)){this.log=t.logging;t.logging=true}this.options=t},init:function(e,t){if(isFunction(e)){t=e;e=null}if(e){this.setOptions(e)}t=isFunction(t)?t:noop;var r=o.defer();var i=[];var n=this.options;var a={dir:n.dir};i.push(this.parseDataDir());if(n.ttl){a.ttlDir=n.ttlDir;i.push(this.parseTTLDir())}if(n.interval&&n.interval>0){this._persistInterval=setInterval(this.persist.bind(this),n.interval)}o.all(i).then((function(){r.resolve(a);t(null,a)}),(function(e){r.reject(e);t(e)}));return r.promise},initSync:function(e){if(e){this.setOptions(e)}var t=this.options;if(t.logging){this.log("options:");this.log(t.stringify(t))}this.parseDataDirSync();if(t.ttl){this.parseTTLDirSync()}if(t.interval&&t.interval>0){this._persistInterval=setInterval(this.persistSync.bind(this),t.interval)}},key:function(e){var t=this.keys();if(t.length<=e){return null}return t[e]},keys:function(){return Object.keys(this.data)},length:function(){return this.keys().length},forEach:function(e){return this.keys().forEach(function(t){e(t,this.data[t])}.bind(this))},values:function(e){e=isFunction(e)?e:noopWithoutError;var t=this.keys().map(function(e){return this.data[e]}.bind(this));e(t);return t},valuesWithKeyMatch:function(e,t){t=isFunction(t)?t:noopWithoutError;e=e||/.*/;var r=e instanceof RegExp?function(t){return e.test(t)}:function(t){return e.indexOf(t)!==-1};var i=[];this.keys().forEach(function(e){if(r(e)){i.push(this.data[e])}}.bind(this));t(i);return i},setItem:function(e,t,r){r=isFunction(r)?r:noop;var i=this.options;var n;var a="set ("+e+": "+i.stringify(t)+")";var s=o.defer();var c=[];this.data[e]=t;if(i.ttl){this.ttls[e]=(new Date).getTime()+i.ttl}n={key:e,value:t,queued:!!i.interval,manual:!i.interval&&!i.continuous};var onSuccess=function(){r(null,n);s.resolve(n)};var onError=function(e){r(e);s.reject(e)};this.log(a);if(i.interval||!i.continuous){this.changes[e]={onSuccess:onSuccess,onError:onError}}else{c.push(this.persistKey(e));o.all(c).then(function(e){s.resolve(e);r(null,e)}.bind(this),(function(e){s.reject(e);r(e)}))}return s.promise},setItemSync:function(e,t){this.data[e]=t;if(this.options.ttl){this.ttls[e]=(new Date).getTime()+this.options.ttl}this.persistKeySync(e);this.log("set ("+e+": "+this.options.stringify(t)+")")},getItem:function(e,t){t=isFunction(t)?t:noop;if(this.isExpired(e)){this.log(e+" has expired");if(this.options.interval||!this.options.continuous){t(null,null);return}this.removeItem(e,(function(){t(null,null)}))}else{t(null,this.data[e]);return this.data[e]}},getItemSync:function(e){if(this.isExpired(e)){this.removeItemSync(e)}else{return this.data[e]}},removeItem:function(e,t){t=isFunction(t)?t:noop;var r=o.defer();var i=[];i.push(this.removePersistedKey(e));o.all(i).then(function(){delete this.data[e];delete this.ttls[e];this.log("removed: "+e);t(null,this.data);r.resolve(this.data)}.bind(this),(function(e){t(e);r.reject(e)}));return r.promise},removeItemSync:function(e){this.removePersistedKeySync(e);delete this.data[e];delete this.ttls[e];this.log("removed: "+e)},clear:function(e){e=isFunction(e)?e:noop;var t=o.defer();var r;var i=[];var n=this.keys();for(var a=0;a<n.length;a++){i.push(this.removePersistedKey(n[a]))}o.all(i).then(function(r){this.data={};this.ttls={};this.changes={};t.resolve(r);e(null,r)}.bind(this),(function(r){t.reject(r);e(r)}));return t.promise},clearSync:function(){var e=this.keys(true);for(var t=0;t<e.length;t++){this.removePersistedKeySync(e[t])}this.data={};this.ttls={};this.changes={}},persist:function(e){e=isFunction(e)?e:noop;var t=o.defer();var r;var i=[];for(var n in this.data){if(this.changes[n]){i.push(this.persistKey(n))}}o.all(i).then(function(r){t.resolve(r);e(null,r);this.log("persist done")}.bind(this),(function(i){t.reject(r);e(i)}));return t.promise},persistSync:function(){for(var e in this.data){if(this.changes[e]){this.persistKeySync(e)}}this.log("persistSync done")},persistKey:function(e,t){t=isFunction(t)?t:noop;var r=this;var s=this.options;var c=s.stringify(this.data[e]);var u=n.join(s.dir,e);var l;var d=o.defer();var h;var fail=function(i){r.changes[e]&&r.changes[e].onError&&r.changes[e].onError(i);d.reject(i);return t(i)};var done=function(){r.changes[e]&&r.changes[e].onSuccess&&r.changes[e].onSuccess();delete r.changes[e];r.log("wrote: "+e);h={key:e,data:c,file:u};d.resolve(h);t(null,h)};a(n.dirname(u),(function(t){if(t){fail(t)}i.writeFile(u,c,s.encoding,function(t){if(t){fail(t)}if(s.ttl){l=n.join(s.ttlDir,e);a(n.dirname(l),(function(t){i.writeFile(l,s.stringify(r.ttls[e]),s.encoding,(function(){if(t){fail(t)}else{done()}}))}))}else{done()}}.bind(this))}));return d.promise},persistKeySync:function(e){var t=this.options;var r=n.join(t.dir,e);try{a.sync(n.dirname(r));i.writeFileSync(r,t.stringify(this.data[e]));this.changes[e]&&this.changes[e].onSuccess&&this.changes[e].onSuccess()}catch(t){this.changes[e]&&this.changes[e].onError&&this.changes[e].onError(t);throw t}var o;if(t.ttl){o=n.join(t.ttlDir,e);a.sync(n.dirname(o));i.writeFileSync(o,t.stringify(this.ttls[e]))}delete this.changes[e];this.log("wrote: "+e)},removePersistedKey:function(e,t){t=isFunction(t)?t:noop;var r=this.options;var a=o.defer();var s;var c=n.join(r.dir,e);i.exists(c,(function(o){if(o){i.unlink(c,(function(o){s={key:e,removed:!o,exists:true};var fail=function(e){a.reject(e);t(e)};var done=function(){a.resolve(s);t(null,s)};if(o){return fail(o)}if(r.ttl){var c=n.join(r.ttlDir,e);i.exists(c,(function(e){if(e){i.unlink(c,(function(e){if(e){fail(e)}done()}))}else{done()}}))}else{done()}}))}else{s={key:e,removed:false,exists:false};a.resolve(s);t(null,s)}}));return a.promise},parseString:function(e){try{return this.options.parse(e)}catch(e){this.log("parse error: ",this.options.stringify(e));return undefined}},parseTTLDir:function(e){return this.parseDir(this.options.ttlDir,this.parseTTLFile.bind(this),e)},parseTTLDirSync:function(){return this.parseDirSync(this.options.ttlDir,this.ttls)},parseDataDir:function(e){return this.parseDir(this.options.dir,this.parseDataFile.bind(this),e)},parseDataDirSync:function(){return this.parseDirSync(this.options.dir,this.data)},parseDir:function(e,t,r){r=isFunction(r)?r:noop;var n=o.defer();var s=[];var c={dir:e};i.exists(e,function(u){if(u){i.readdir(e,function(e,i){if(e){n.reject(e);r(e)}for(var a in i){var u=i[a];if(u[0]!=="."){s.push(t(u))}}o.all(s).then((function(){n.resolve(c);r(null,c)}),(function(e){n.reject(e);r(e)}))}.bind(this))}else{a(e,function(t){if(t){console.error(t);n.reject(t);r(t)}else{this.log("created "+e);n.resolve(c);r(null,c)}}.bind(this))}}.bind(this));return n.promise},parseDirSync:function(e,t){var r=i.existsSync(e);if(r){var o=i.readdirSync(e);for(var s=0;s<o.length;s++){var c=o[s];if(o[s]&&c[0]!=="."){var u=i.readFileSync(n.join(e,c),this.options.encoding);t[c]=this.parseString(u)}}}else{a.sync(e)}},parseDataFile:function(e,t){return this.parseFile(e,this.options.dir,this.data,t)},parseDataFileSync:function(e){return this.parseFileSync(e,this.options.dir,this.data)},parseTTLFile:function(e,t){return this.parseFile(e,this.options.ttlDir,this.ttls,t)},parseTTLFileSync:function(e){return this.parseFileSync(e,this.options.ttlDir,this.ttls)},parseFile:function(e,t,r,a){a=isFunction(a)?a:noop;var s=o.defer();var c;var u=n.join(t,e);var l=this.options;i.readFile(u,l.encoding,function(i,n){if(i){s.reject(i);return a(i)}var o=this.parseString(n);r[e]=o;this.log("loaded: "+t+"/"+e);c={key:e,value:o,file:u};s.resolve(c);a(null,c)}.bind(this));return s.promise},parseFileSync:function(e,t,r){var a=n.join(t,e);r[e]=i.readFileSync(a,this.options.encoding);this.log("loaded: "+t+"/"+e);return r[e]},isExpired:function(e){if(!this.options.ttl)return false;return this.ttls[e]<(new Date).getTime()},removePersistedKeySync:function(e){var t=this.options;var r=n.join(t.dir,e);if(i.existsSync(r)){i.unlinkSync(r)}if(t.ttl){var a=n.join(t.ttlDir,e);if(i.existsSync(a)){i.unlinkSync(a)}}},resolveDir:function(e){e=n.normalize(e);if(e!==n.resolve(e)){e=n.join(__dirname,"storage",e||"");this.log("Made dir absolute: "+e)}return e},stopInterval:function(){clearInterval(this._persistInterval)},log:function(){this.options&&this.options.logging&&console.log.apply(console,arguments)}};e.exports=LocalStorage},1351:(e,t,r)=>{var i=r(9477);(function(e){var t;e.create=function(e){return i(e)};e.init=function(r,i){t=e.create(r);return t.init(i)};e.initSync=function(r){t=e.create(r);return t.initSync()};e.key=function(e){return t.key(e)};e.keys=function(){return t.keys()};e.length=function(){return t.length()};e.forEach=function(e){return t.forEach(e)};e.values=function(e){return t.values(e)};e.valuesWithKeyMatch=function(e,r){return t.valuesWithKeyMatch(e,r)};e.setItem=function(e,r,i){return t.setItem(e,r,i)};e.setItemSync=function(e,r){return t.setItemSync(e,r)};e.getItem=function(e,r){return t.getItem(e,r)};e.getItemSync=function(e){return t.getItemSync(e)};e.removeItem=function(e,r){return t.removeItem(e,r)};e.removeItemSync=function(e){return t.removeItemSync(e)};e.clear=function(e){return t.clear(e)};e.clearSync=function(){return t.clearSync()};e.persist=function(e){return t.persist(e)};e.persistSync=function(){return t.persistSync()};e.persistKey=function(e,r){return t.persistKey(e,r)};e.persistKeySync=function(e){return t.persistKeySync(e)}})(e.exports)},7720:(e,t,r)=>{var i=typeof Map==="function"&&Map.prototype;var n=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null;var a=i&&n&&typeof n.get==="function"?n.get:null;var o=i&&Map.prototype.forEach;var s=typeof Set==="function"&&Set.prototype;var c=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null;var u=s&&c&&typeof c.get==="function"?c.get:null;var l=s&&Set.prototype.forEach;var d=typeof WeakMap==="function"&&WeakMap.prototype;var h=d?WeakMap.prototype.has:null;var p=typeof WeakSet==="function"&&WeakSet.prototype;var v=p?WeakSet.prototype.has:null;var m=typeof WeakRef==="function"&&WeakRef.prototype;var g=m?WeakRef.prototype.deref:null;var y=Boolean.prototype.valueOf;var C=Object.prototype.toString;var T=Function.prototype.toString;var E=String.prototype.match;var D=String.prototype.slice;var _=String.prototype.replace;var I=String.prototype.toUpperCase;var b=String.prototype.toLowerCase;var w=RegExp.prototype.test;var R=Array.prototype.concat;var N=Array.prototype.join;var U=Array.prototype.slice;var P=Math.floor;var O=typeof BigInt==="function"?BigInt.prototype.valueOf:null;var L=Object.getOwnPropertySymbols;var B=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?Symbol.prototype.toString:null;var x=typeof Symbol==="function"&&typeof Symbol.iterator==="object";var k=typeof Symbol==="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===x?"object":"symbol")?Symbol.toStringTag:null;var V=Object.prototype.propertyIsEnumerable;var H=(typeof Reflect==="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function addNumericSeparator(e,t){if(e===Infinity||e===-Infinity||e!==e||e&&e>-1e3&&e<1e3||w.call(/e/,t)){return t}var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e==="number"){var i=e<0?-P(-e):P(e);if(i!==e){var n=String(i);var a=D.call(t,n.length+1);return _.call(n,r,"$&_")+"."+_.call(_.call(a,/([0-9]{3})/g,"$&_"),/_$/,"")}}return _.call(t,r,"$&_")}var j=r(4904);var W=j.custom;var G=isSymbol(W)?W:null;e.exports=function inspect_(e,t,r,i){var n=t||{};if(has(n,"quoteStyle")&&(n.quoteStyle!=="single"&&n.quoteStyle!=="double")){throw new TypeError('option "quoteStyle" must be "single" or "double"')}if(has(n,"maxStringLength")&&(typeof n.maxStringLength==="number"?n.maxStringLength<0&&n.maxStringLength!==Infinity:n.maxStringLength!==null)){throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`')}var s=has(n,"customInspect")?n.customInspect:true;if(typeof s!=="boolean"&&s!=="symbol"){throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`")}if(has(n,"indent")&&n.indent!==null&&n.indent!=="\t"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0)){throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`')}if(has(n,"numericSeparator")&&typeof n.numericSeparator!=="boolean"){throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`')}var c=n.numericSeparator;if(typeof e==="undefined"){return"undefined"}if(e===null){return"null"}if(typeof e==="boolean"){return e?"true":"false"}if(typeof e==="string"){return inspectString(e,n)}if(typeof e==="number"){if(e===0){return Infinity/e>0?"0":"-0"}var d=String(e);return c?addNumericSeparator(e,d):d}if(typeof e==="bigint"){var h=String(e)+"n";return c?addNumericSeparator(e,h):h}var p=typeof n.depth==="undefined"?5:n.depth;if(typeof r==="undefined"){r=0}if(r>=p&&p>0&&typeof e==="object"){return isArray(e)?"[Array]":"[Object]"}var v=getIndent(n,r);if(typeof i==="undefined"){i=[]}else if(indexOf(i,e)>=0){return"[Circular]"}function inspect(e,t,a){if(t){i=U.call(i);i.push(t)}if(a){var o={depth:n.depth};if(has(n,"quoteStyle")){o.quoteStyle=n.quoteStyle}return inspect_(e,o,r+1,i)}return inspect_(e,n,r+1,i)}if(typeof e==="function"&&!isRegExp(e)){var m=nameOf(e);var g=arrObjKeys(e,inspect);return"[Function"+(m?": "+m:" (anonymous)")+"]"+(g.length>0?" { "+N.call(g,", ")+" }":"")}if(isSymbol(e)){var C=x?_.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):B.call(e);return typeof e==="object"&&!x?markBoxed(C):C}if(isElement(e)){var T="<"+b.call(String(e.nodeName));var E=e.attributes||[];for(var I=0;I<E.length;I++){T+=" "+E[I].name+"="+wrapQuotes(quote(E[I].value),"double",n)}T+=">";if(e.childNodes&&e.childNodes.length){T+="..."}T+="</"+b.call(String(e.nodeName))+">";return T}if(isArray(e)){if(e.length===0){return"[]"}var w=arrObjKeys(e,inspect);if(v&&!singleLineValues(w)){return"["+indentedJoin(w,v)+"]"}return"[ "+N.call(w,", ")+" ]"}if(isError(e)){var P=arrObjKeys(e,inspect);if(!("cause"in Error.prototype)&&"cause"in e&&!V.call(e,"cause")){return"{ ["+String(e)+"] "+N.call(R.call("[cause]: "+inspect(e.cause),P),", ")+" }"}if(P.length===0){return"["+String(e)+"]"}return"{ ["+String(e)+"] "+N.call(P,", ")+" }"}if(typeof e==="object"&&s){if(G&&typeof e[G]==="function"&&j){return j(e,{depth:p-r})}else if(s!=="symbol"&&typeof e.inspect==="function"){return e.inspect()}}if(isMap(e)){var L=[];o.call(e,(function(t,r){L.push(inspect(r,e,true)+" => "+inspect(t,e))}));return collectionOf("Map",a.call(e),L,v)}if(isSet(e)){var W=[];l.call(e,(function(t){W.push(inspect(t,e))}));return collectionOf("Set",u.call(e),W,v)}if(isWeakMap(e)){return weakCollectionOf("WeakMap")}if(isWeakSet(e)){return weakCollectionOf("WeakSet")}if(isWeakRef(e)){return weakCollectionOf("WeakRef")}if(isNumber(e)){return markBoxed(inspect(Number(e)))}if(isBigInt(e)){return markBoxed(inspect(O.call(e)))}if(isBoolean(e)){return markBoxed(y.call(e))}if(isString(e)){return markBoxed(inspect(String(e)))}if(!isDate(e)&&!isRegExp(e)){var X=arrObjKeys(e,inspect);var q=H?H(e)===Object.prototype:e instanceof Object||e.constructor===Object;var Y=e instanceof Object?"":"null prototype";var K=!q&&k&&Object(e)===e&&k in e?D.call(toStr(e),8,-1):Y?"Object":"";var $=q||typeof e.constructor!=="function"?"":e.constructor.name?e.constructor.name+" ":"";var z=$+(K||Y?"["+N.call(R.call([],K||[],Y||[]),": ")+"] ":"");if(X.length===0){return z+"{}"}if(v){return z+"{"+indentedJoin(X,v)+"}"}return z+"{ "+N.call(X,", ")+" }"}return String(e)};function wrapQuotes(e,t,r){var i=(r.quoteStyle||t)==="double"?'"':"'";return i+e+i}function quote(e){return _.call(String(e),/"/g,"&quot;")}function isArray(e){return toStr(e)==="[object Array]"&&(!k||!(typeof e==="object"&&k in e))}function isDate(e){return toStr(e)==="[object Date]"&&(!k||!(typeof e==="object"&&k in e))}function isRegExp(e){return toStr(e)==="[object RegExp]"&&(!k||!(typeof e==="object"&&k in e))}function isError(e){return toStr(e)==="[object Error]"&&(!k||!(typeof e==="object"&&k in e))}function isString(e){return toStr(e)==="[object String]"&&(!k||!(typeof e==="object"&&k in e))}function isNumber(e){return toStr(e)==="[object Number]"&&(!k||!(typeof e==="object"&&k in e))}function isBoolean(e){return toStr(e)==="[object Boolean]"&&(!k||!(typeof e==="object"&&k in e))}function isSymbol(e){if(x){return e&&typeof e==="object"&&e instanceof Symbol}if(typeof e==="symbol"){return true}if(!e||typeof e!=="object"||!B){return false}try{B.call(e);return true}catch(e){}return false}function isBigInt(e){if(!e||typeof e!=="object"||!O){return false}try{O.call(e);return true}catch(e){}return false}var X=Object.prototype.hasOwnProperty||function(e){return e in this};function has(e,t){return X.call(e,t)}function toStr(e){return C.call(e)}function nameOf(e){if(e.name){return e.name}var t=E.call(T.call(e),/^function\s*([\w$]+)/);if(t){return t[1]}return null}function indexOf(e,t){if(e.indexOf){return e.indexOf(t)}for(var r=0,i=e.length;r<i;r++){if(e[r]===t){return r}}return-1}function isMap(e){if(!a||!e||typeof e!=="object"){return false}try{a.call(e);try{u.call(e)}catch(e){return true}return e instanceof Map}catch(e){}return false}function isWeakMap(e){if(!h||!e||typeof e!=="object"){return false}try{h.call(e,h);try{v.call(e,v)}catch(e){return true}return e instanceof WeakMap}catch(e){}return false}function isWeakRef(e){if(!g||!e||typeof e!=="object"){return false}try{g.call(e);return true}catch(e){}return false}function isSet(e){if(!u||!e||typeof e!=="object"){return false}try{u.call(e);try{a.call(e)}catch(e){return true}return e instanceof Set}catch(e){}return false}function isWeakSet(e){if(!v||!e||typeof e!=="object"){return false}try{v.call(e,v);try{h.call(e,h)}catch(e){return true}return e instanceof WeakSet}catch(e){}return false}function isElement(e){if(!e||typeof e!=="object"){return false}if(typeof HTMLElement!=="undefined"&&e instanceof HTMLElement){return true}return typeof e.nodeName==="string"&&typeof e.getAttribute==="function"}function inspectString(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength;var i="... "+r+" more character"+(r>1?"s":"");return inspectString(D.call(e,0,t.maxStringLength),t)+i}var n=_.call(_.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,lowbyte);return wrapQuotes(n,"single",t)}function lowbyte(e){var t=e.charCodeAt(0);var r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];if(r){return"\\"+r}return"\\x"+(t<16?"0":"")+I.call(t.toString(16))}function markBoxed(e){return"Object("+e+")"}function weakCollectionOf(e){return e+" { ? }"}function collectionOf(e,t,r,i){var n=i?indentedJoin(r,i):N.call(r,", ");return e+" ("+t+") {"+n+"}"}function singleLineValues(e){for(var t=0;t<e.length;t++){if(indexOf(e[t],"\n")>=0){return false}}return true}function getIndent(e,t){var r;if(e.indent==="\t"){r="\t"}else if(typeof e.indent==="number"&&e.indent>0){r=N.call(Array(e.indent+1)," ")}else{return null}return{base:r,prev:N.call(Array(t+1),r)}}function indentedJoin(e,t){if(e.length===0){return""}var r="\n"+t.prev+t.base;return r+N.call(e,","+r)+"\n"+t.prev}function arrObjKeys(e,t){var r=isArray(e);var i=[];if(r){i.length=e.length;for(var n=0;n<e.length;n++){i[n]=has(e,n)?t(e[n],e):""}}var a=typeof L==="function"?L(e):[];var o;if(x){o={};for(var s=0;s<a.length;s++){o["$"+a[s]]=a[s]}}for(var c in e){if(!has(e,c)){continue}if(r&&String(Number(c))===c&&c<e.length){continue}if(x&&o["$"+c]instanceof Symbol){continue}else if(w.call(/[^\w$]/,c)){i.push(t(c,e)+": "+t(e[c],e))}else{i.push(c+": "+t(e[c],e))}}if(typeof L==="function"){for(var u=0;u<a.length;u++){if(V.call(e,a[u])){i.push("["+t(a[u])+"]: "+t(e[a[u]],e))}}}return i}},4904:(e,t,r)=>{e.exports=r(3837).inspect},135:e=>{"use strict";var numberIsNaN=function(e){return e!==e};e.exports=function is(e,t){if(e===0&&t===0){return 1/e===1/t}if(e===t){return true}if(numberIsNaN(e)&&numberIsNaN(t)){return true}return false}},2324:(e,t,r)=>{"use strict";var i=r(9576);var n=r(1743);var a=r(135);var o=r(9026);var s=r(7576);var c=n(o(),Object);i(c,{getPolyfill:o,implementation:a,shim:s});e.exports=c},9026:(e,t,r)=>{"use strict";var i=r(135);e.exports=function getPolyfill(){return typeof Object.is==="function"?Object.is:i}},7576:(e,t,r)=>{"use strict";var i=r(9026);var n=r(9576);e.exports=function shimObjectIs(){var e=i();n(Object,{is:e},{is:function testObjectIs(){return Object.is!==e}});return e}},8207:(e,t,r)=>{"use strict";var i;if(!Object.keys){var n=Object.prototype.hasOwnProperty;var a=Object.prototype.toString;var o=r(2461);var s=Object.prototype.propertyIsEnumerable;var c=!s.call({toString:null},"toString");var u=s.call((function(){}),"prototype");var l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var equalsConstructorPrototype=function(e){var t=e.constructor;return t&&t.prototype===e};var d={$applicationCache:true,$console:true,$external:true,$frame:true,$frameElement:true,$frames:true,$innerHeight:true,$innerWidth:true,$onmozfullscreenchange:true,$onmozfullscreenerror:true,$outerHeight:true,$outerWidth:true,$pageXOffset:true,$pageYOffset:true,$parent:true,$scrollLeft:true,$scrollTop:true,$scrollX:true,$scrollY:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true};var h=function(){if(typeof window==="undefined"){return false}for(var e in window){try{if(!d["$"+e]&&n.call(window,e)&&window[e]!==null&&typeof window[e]==="object"){try{equalsConstructorPrototype(window[e])}catch(e){return true}}}catch(e){return true}}return false}();var equalsConstructorPrototypeIfNotBuggy=function(e){if(typeof window==="undefined"||!h){return equalsConstructorPrototype(e)}try{return equalsConstructorPrototype(e)}catch(e){return false}};i=function keys(e){var t=e!==null&&typeof e==="object";var r=a.call(e)==="[object Function]";var i=o(e);var s=t&&a.call(e)==="[object String]";var d=[];if(!t&&!r&&!i){throw new TypeError("Object.keys called on a non-object")}var h=u&&r;if(s&&e.length>0&&!n.call(e,0)){for(var p=0;p<e.length;++p){d.push(String(p))}}if(i&&e.length>0){for(var v=0;v<e.length;++v){d.push(String(v))}}else{for(var m in e){if(!(h&&m==="prototype")&&n.call(e,m)){d.push(String(m))}}}if(c){var g=equalsConstructorPrototypeIfNotBuggy(e);for(var y=0;y<l.length;++y){if(!(g&&l[y]==="constructor")&&n.call(e,l[y])){d.push(l[y])}}}return d}}e.exports=i},2738:(e,t,r)=>{"use strict";var i=Array.prototype.slice;var n=r(2461);var a=Object.keys;var o=a?function keys(e){return a(e)}:r(8207);var s=Object.keys;o.shim=function shimObjectKeys(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);if(!e){Object.keys=function keys(e){if(n(e)){return s(i.call(e))}return s(e)}}}else{Object.keys=o}return Object.keys||o};e.exports=o},2461:e=>{"use strict";var t=Object.prototype.toString;e.exports=function isArguments(e){var r=t.call(e);var i=r==="[object Arguments]";if(!i){i=r!=="[object Array]"&&e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&t.call(e.callee)==="[object Function]"}return i}},8474:(e,t,r)=>{"use strict";var i=r(2738);var n=r(8005)();var a=r(6379);var o=Object;var s=a("Array.prototype.push");var c=a("Object.prototype.propertyIsEnumerable");var u=n?Object.getOwnPropertySymbols:null;e.exports=function assign(e,t){if(e==null){throw new TypeError("target must be an object")}var r=o(e);if(arguments.length===1){return r}for(var a=1;a<arguments.length;++a){var l=o(arguments[a]);var d=i(l);var h=n&&(Object.getOwnPropertySymbols||u);if(h){var p=h(l);for(var v=0;v<p.length;++v){var m=p[v];if(c(l,m)){s(d,m)}}}for(var g=0;g<d.length;++g){var y=d[g];if(c(l,y)){var C=l[y];r[y]=C}}}return r}},7835:(e,t,r)=>{"use strict";var i=r(9576);var n=r(1743);var a=r(8474);var o=r(7375);var s=r(4094);var c=n.apply(o());var u=function assign(e,t){return c(Object,arguments)};i(u,{getPolyfill:o,implementation:a,shim:s});e.exports=u},7375:(e,t,r)=>{"use strict";var i=r(8474);var lacksProperEnumerationOrder=function(){if(!Object.assign){return false}var e="abcdefghijklmnopqrst";var t=e.split("");var r={};for(var i=0;i<t.length;++i){r[t[i]]=t[i]}var n=Object.assign({},r);var a="";for(var o in n){a+=o}return e!==a};var assignHasPendingExceptions=function(){if(!Object.assign||!Object.preventExtensions){return false}var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}return false};e.exports=function getPolyfill(){if(!Object.assign){return i}if(lacksProperEnumerationOrder()){return i}if(assignHasPendingExceptions()){return i}return Object.assign}},4094:(e,t,r)=>{"use strict";var i=r(9576);var n=r(7375);e.exports=function shimAssign(){var e=n();i(Object,{assign:e},{assign:function(){return Object.assign!==e}});return e}},1566:(e,t,r)=>{e.exports=r(4306)},1048:e=>{
/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
(function(t){"use strict";if(typeof bootstrap==="function"){bootstrap("promise",t)}else if(true){e.exports=t()}else{}})((function(){"use strict";var e=false;try{throw new Error}catch(t){e=!!t.stack}var t=captureLine();var r;var noop=function(){};var i=function(){var e={task:void 0,next:null};var t=e;var r=false;var n=void 0;var a=false;function flush(){while(e.next){e=e.next;var t=e.task;e.task=void 0;var i=e.domain;if(i){e.domain=void 0;i.enter()}try{t()}catch(e){if(a){if(i){i.exit()}setTimeout(flush,0);if(i){i.enter()}throw e}else{setTimeout((function(){throw e}),0)}}if(i){i.exit()}}r=false}i=function(e){t=t.next={task:e,domain:a&&process.domain,next:null};if(!r){r=true;n()}};if(typeof process!=="undefined"&&process.nextTick){a=true;n=function(){process.nextTick(flush)}}else if(typeof setImmediate==="function"){if(typeof window!=="undefined"){n=setImmediate.bind(window,flush)}else{n=function(){setImmediate(flush)}}}else if(typeof MessageChannel!=="undefined"){var o=new MessageChannel;o.port1.onmessage=function(){n=requestPortTick;o.port1.onmessage=flush;flush()};var requestPortTick=function(){o.port2.postMessage(0)};n=function(){setTimeout(flush,0);requestPortTick()}}else{n=function(){setTimeout(flush,0)}}return i}();var n=Function.call;function uncurryThis(e){return function(){return n.apply(e,arguments)}}var a=uncurryThis(Array.prototype.slice);var o=uncurryThis(Array.prototype.reduce||function(e,t){var r=0,i=this.length;if(arguments.length===1){do{if(r in this){t=this[r++];break}if(++r>=i){throw new TypeError}}while(1)}for(;r<i;r++){if(r in this){t=e(t,this[r],r)}}return t});var s=uncurryThis(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++){if(this[t]===e){return t}}return-1});var c=uncurryThis(Array.prototype.map||function(e,t){var r=this;var i=[];o(r,(function(n,a,o){i.push(e.call(t,a,o,r))}),void 0);return i});var u=Object.create||function(e){function Type(){}Type.prototype=e;return new Type};var l=uncurryThis(Object.prototype.hasOwnProperty);var d=Object.keys||function(e){var t=[];for(var r in e){if(l(e,r)){t.push(r)}}return t};var h=uncurryThis(Object.prototype.toString);function isObject(e){return e===Object(e)}function isStopIteration(e){return h(e)==="[object StopIteration]"||e instanceof p}var p;if(typeof ReturnValue!=="undefined"){p=ReturnValue}else{p=function(e){this.value=e}}var v="From previous event:";function makeStackTraceLong(t,r){if(e&&r.stack&&typeof t==="object"&&t!==null&&t.stack&&t.stack.indexOf(v)===-1){var i=[];for(var n=r;!!n;n=n.source){if(n.stack){i.unshift(n.stack)}}i.unshift(t.stack);var a=i.join("\n"+v+"\n");t.stack=filterStackString(a)}}function filterStackString(e){var t=e.split("\n");var r=[];for(var i=0;i<t.length;++i){var n=t[i];if(!isInternalFrame(n)&&!isNodeFrame(n)&&n){r.push(n)}}return r.join("\n")}function isNodeFrame(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function getFileNameAndLineNumber(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t){return[t[1],Number(t[2])]}var r=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(r){return[r[1],Number(r[2])]}var i=/.*@(.+):(\d+)$/.exec(e);if(i){return[i[1],Number(i[2])]}}function isInternalFrame(e){var i=getFileNameAndLineNumber(e);if(!i){return false}var n=i[0];var a=i[1];return n===r&&a>=t&&a<=C}function captureLine(){if(!e){return}try{throw new Error}catch(e){var t=e.stack.split("\n");var i=t[0].indexOf("@")>0?t[1]:t[2];var n=getFileNameAndLineNumber(i);if(!n){return}r=n[0];return n[1]}}function deprecate(e,t,r){return function(){if(typeof console!=="undefined"&&typeof console.warn==="function"){console.warn(t+" is deprecated, use "+r+" instead.",new Error("").stack)}return e.apply(e,arguments)}}function Q(e){if(e instanceof Promise){return e}if(isPromiseAlike(e)){return coerce(e)}else{return fulfill(e)}}Q.resolve=Q;Q.nextTick=i;Q.longStackSupport=false;if(typeof process==="object"&&process&&process.env&&process.env.Q_DEBUG){Q.longStackSupport=true}Q.defer=defer;function defer(){var t=[],r=[],i;var n=u(defer.prototype);var s=u(Promise.prototype);s.promiseDispatch=function(e,n,o){var s=a(arguments);if(t){t.push(s);if(n==="when"&&o[1]){r.push(o[1])}}else{Q.nextTick((function(){i.promiseDispatch.apply(i,s)}))}};s.valueOf=function(){if(t){return s}var e=nearer(i);if(isPromise(e)){i=e}return e};s.inspect=function(){if(!i){return{state:"pending"}}return i.inspect()};if(Q.longStackSupport&&e){try{throw new Error}catch(e){s.stack=e.stack.substring(e.stack.indexOf("\n")+1)}}function become(e){i=e;s.source=e;o(t,(function(t,r){Q.nextTick((function(){e.promiseDispatch.apply(e,r)}))}),void 0);t=void 0;r=void 0}n.promise=s;n.resolve=function(e){if(i){return}become(Q(e))};n.fulfill=function(e){if(i){return}become(fulfill(e))};n.reject=function(e){if(i){return}become(reject(e))};n.notify=function(e){if(i){return}o(r,(function(t,r){Q.nextTick((function(){r(e)}))}),void 0)};return n}defer.prototype.makeNodeResolver=function(){var e=this;return function(t,r){if(t){e.reject(t)}else if(arguments.length>2){e.resolve(a(arguments,1))}else{e.resolve(r)}}};Q.Promise=promise;Q.promise=promise;function promise(e){if(typeof e!=="function"){throw new TypeError("resolver must be a function.")}var t=defer();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}promise.race=race;promise.all=all;promise.reject=reject;promise.resolve=Q;Q.passByCopy=function(e){return e};Promise.prototype.passByCopy=function(){return this};Q.join=function(e,t){return Q(e).join(t)};Promise.prototype.join=function(e){return Q([this,e]).spread((function(e,t){if(e===t){return e}else{throw new Error("Can't join: not the same: "+e+" "+t)}}))};Q.race=race;function race(e){return promise((function(t,r){for(var i=0,n=e.length;i<n;i++){Q(e[i]).then(t,r)}}))}Promise.prototype.race=function(){return this.then(Q.race)};Q.makePromise=Promise;function Promise(e,t,r){if(t===void 0){t=function(e){return reject(new Error("Promise does not support operation: "+e))}}if(r===void 0){r=function(){return{state:"unknown"}}}var i=u(Promise.prototype);i.promiseDispatch=function(r,n,a){var o;try{if(e[n]){o=e[n].apply(i,a)}else{o=t.call(i,n,a)}}catch(e){o=reject(e)}if(r){r(o)}};i.inspect=r;if(r){var n=r();if(n.state==="rejected"){i.exception=n.reason}i.valueOf=function(){var e=r();if(e.state==="pending"||e.state==="rejected"){return i}return e.value}}return i}Promise.prototype.toString=function(){return"[object Promise]"};Promise.prototype.then=function(e,t,r){var i=this;var n=defer();var a=false;function _fulfilled(t){try{return typeof e==="function"?e(t):t}catch(e){return reject(e)}}function _rejected(e){if(typeof t==="function"){makeStackTraceLong(e,i);try{return t(e)}catch(e){return reject(e)}}return reject(e)}function _progressed(e){return typeof r==="function"?r(e):e}Q.nextTick((function(){i.promiseDispatch((function(e){if(a){return}a=true;n.resolve(_fulfilled(e))}),"when",[function(e){if(a){return}a=true;n.resolve(_rejected(e))}])}));i.promiseDispatch(void 0,"when",[void 0,function(e){var t;var r=false;try{t=_progressed(e)}catch(e){r=true;if(Q.onerror){Q.onerror(e)}else{throw e}}if(!r){n.notify(t)}}]);return n.promise};Q.tap=function(e,t){return Q(e).tap(t)};Promise.prototype.tap=function(e){e=Q(e);return this.then((function(t){return e.fcall(t).thenResolve(t)}))};Q.when=when;function when(e,t,r,i){return Q(e).then(t,r,i)}Promise.prototype.thenResolve=function(e){return this.then((function(){return e}))};Q.thenResolve=function(e,t){return Q(e).thenResolve(t)};Promise.prototype.thenReject=function(e){return this.then((function(){throw e}))};Q.thenReject=function(e,t){return Q(e).thenReject(t)};Q.nearer=nearer;function nearer(e){if(isPromise(e)){var t=e.inspect();if(t.state==="fulfilled"){return t.value}}return e}Q.isPromise=isPromise;function isPromise(e){return e instanceof Promise}Q.isPromiseAlike=isPromiseAlike;function isPromiseAlike(e){return isObject(e)&&typeof e.then==="function"}Q.isPending=isPending;function isPending(e){return isPromise(e)&&e.inspect().state==="pending"}Promise.prototype.isPending=function(){return this.inspect().state==="pending"};Q.isFulfilled=isFulfilled;function isFulfilled(e){return!isPromise(e)||e.inspect().state==="fulfilled"}Promise.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"};Q.isRejected=isRejected;function isRejected(e){return isPromise(e)&&e.inspect().state==="rejected"}Promise.prototype.isRejected=function(){return this.inspect().state==="rejected"};var m=[];var g=[];var y=true;function resetUnhandledRejections(){m.length=0;g.length=0;if(!y){y=true}}function trackRejection(e,t){if(!y){return}g.push(e);if(t&&typeof t.stack!=="undefined"){m.push(t.stack)}else{m.push("(no stack) "+t)}}function untrackRejection(e){if(!y){return}var t=s(g,e);if(t!==-1){g.splice(t,1);m.splice(t,1)}}Q.resetUnhandledRejections=resetUnhandledRejections;Q.getUnhandledReasons=function(){return m.slice()};Q.stopUnhandledRejectionTracking=function(){resetUnhandledRejections();y=false};resetUnhandledRejections();Q.reject=reject;function reject(e){var t=Promise({when:function(t){if(t){untrackRejection(this)}return t?t(e):this}},(function fallback(){return this}),(function inspect(){return{state:"rejected",reason:e}}));trackRejection(t,e);return t}Q.fulfill=fulfill;function fulfill(e){return Promise({when:function(){return e},get:function(t){return e[t]},set:function(t,r){e[t]=r},delete:function(t){delete e[t]},post:function(t,r){if(t===null||t===void 0){return e.apply(void 0,r)}else{return e[t].apply(e,r)}},apply:function(t,r){return e.apply(t,r)},keys:function(){return d(e)}},void 0,(function inspect(){return{state:"fulfilled",value:e}}))}function coerce(e){var t=defer();Q.nextTick((function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}}));return t.promise}Q.master=master;function master(e){return Promise({isDef:function(){}},(function fallback(t,r){return dispatch(e,t,r)}),(function(){return Q(e).inspect()}))}Q.spread=spread;function spread(e,t,r){return Q(e).spread(t,r)}Promise.prototype.spread=function(e,t){return this.all().then((function(t){return e.apply(void 0,t)}),t)};Q.async=async;function async(e){return function(){function continuer(e,n){var a;if(typeof StopIteration==="undefined"){try{a=t[e](n)}catch(e){return reject(e)}if(a.done){return Q(a.value)}else{return when(a.value,r,i)}}else{try{a=t[e](n)}catch(e){if(isStopIteration(e)){return Q(e.value)}else{return reject(e)}}return when(a,r,i)}}var t=e.apply(this,arguments);var r=continuer.bind(continuer,"next");var i=continuer.bind(continuer,"throw");return r()}}Q.spawn=spawn;function spawn(e){Q.done(Q.async(e)())}Q["return"]=_return;function _return(e){throw new p(e)}Q.promised=promised;function promised(e){return function(){return spread([this,all(arguments)],(function(t,r){return e.apply(t,r)}))}}Q.dispatch=dispatch;function dispatch(e,t,r){return Q(e).dispatch(t,r)}Promise.prototype.dispatch=function(e,t){var r=this;var i=defer();Q.nextTick((function(){r.promiseDispatch(i.resolve,e,t)}));return i.promise};Q.get=function(e,t){return Q(e).dispatch("get",[t])};Promise.prototype.get=function(e){return this.dispatch("get",[e])};Q.set=function(e,t,r){return Q(e).dispatch("set",[t,r])};Promise.prototype.set=function(e,t){return this.dispatch("set",[e,t])};Q.del=Q["delete"]=function(e,t){return Q(e).dispatch("delete",[t])};Promise.prototype.del=Promise.prototype["delete"]=function(e){return this.dispatch("delete",[e])};Q.mapply=Q.post=function(e,t,r){return Q(e).dispatch("post",[t,r])};Promise.prototype.mapply=Promise.prototype.post=function(e,t){return this.dispatch("post",[e,t])};Q.send=Q.mcall=Q.invoke=function(e,t){return Q(e).dispatch("post",[t,a(arguments,2)])};Promise.prototype.send=Promise.prototype.mcall=Promise.prototype.invoke=function(e){return this.dispatch("post",[e,a(arguments,1)])};Q.fapply=function(e,t){return Q(e).dispatch("apply",[void 0,t])};Promise.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])};Q["try"]=Q.fcall=function(e){return Q(e).dispatch("apply",[void 0,a(arguments,1)])};Promise.prototype.fcall=function(){return this.dispatch("apply",[void 0,a(arguments)])};Q.fbind=function(e){var t=Q(e);var r=a(arguments,1);return function fbound(){return t.dispatch("apply",[this,r.concat(a(arguments))])}};Promise.prototype.fbind=function(){var e=this;var t=a(arguments);return function fbound(){return e.dispatch("apply",[this,t.concat(a(arguments))])}};Q.keys=function(e){return Q(e).dispatch("keys",[])};Promise.prototype.keys=function(){return this.dispatch("keys",[])};Q.all=all;function all(e){return when(e,(function(e){var t=0;var r=defer();o(e,(function(i,n,a){var o;if(isPromise(n)&&(o=n.inspect()).state==="fulfilled"){e[a]=o.value}else{++t;when(n,(function(i){e[a]=i;if(--t===0){r.resolve(e)}}),r.reject,(function(e){r.notify({index:a,value:e})}))}}),void 0);if(t===0){r.resolve(e)}return r.promise}))}Promise.prototype.all=function(){return all(this)};Q.allResolved=deprecate(allResolved,"allResolved","allSettled");function allResolved(e){return when(e,(function(e){e=c(e,Q);return when(all(c(e,(function(e){return when(e,noop,noop)}))),(function(){return e}))}))}Promise.prototype.allResolved=function(){return allResolved(this)};Q.allSettled=allSettled;function allSettled(e){return Q(e).allSettled()}Promise.prototype.allSettled=function(){return this.then((function(e){return all(c(e,(function(e){e=Q(e);function regardless(){return e.inspect()}return e.then(regardless,regardless)})))}))};Q.fail=Q["catch"]=function(e,t){return Q(e).then(void 0,t)};Promise.prototype.fail=Promise.prototype["catch"]=function(e){return this.then(void 0,e)};Q.progress=progress;function progress(e,t){return Q(e).then(void 0,void 0,t)}Promise.prototype.progress=function(e){return this.then(void 0,void 0,e)};Q.fin=Q["finally"]=function(e,t){return Q(e)["finally"](t)};Promise.prototype.fin=Promise.prototype["finally"]=function(e){e=Q(e);return this.then((function(t){return e.fcall().then((function(){return t}))}),(function(t){return e.fcall().then((function(){throw t}))}))};Q.done=function(e,t,r,i){return Q(e).done(t,r,i)};Promise.prototype.done=function(e,t,r){var onUnhandledError=function(e){Q.nextTick((function(){makeStackTraceLong(e,i);if(Q.onerror){Q.onerror(e)}else{throw e}}))};var i=e||t||r?this.then(e,t,r):this;if(typeof process==="object"&&process&&process.domain){onUnhandledError=process.domain.bind(onUnhandledError)}i.then(void 0,onUnhandledError)};Q.timeout=function(e,t,r){return Q(e).timeout(t,r)};Promise.prototype.timeout=function(e,t){var r=defer();var i=setTimeout((function(){if(!t||"string"===typeof t){t=new Error(t||"Timed out after "+e+" ms");t.code="ETIMEDOUT"}r.reject(t)}),e);this.then((function(e){clearTimeout(i);r.resolve(e)}),(function(e){clearTimeout(i);r.reject(e)}),r.notify);return r.promise};Q.delay=function(e,t){if(t===void 0){t=e;e=void 0}return Q(e).delay(t)};Promise.prototype.delay=function(e){return this.then((function(t){var r=defer();setTimeout((function(){r.resolve(t)}),e);return r.promise}))};Q.nfapply=function(e,t){return Q(e).nfapply(t)};Promise.prototype.nfapply=function(e){var t=defer();var r=a(e);r.push(t.makeNodeResolver());this.fapply(r).fail(t.reject);return t.promise};Q.nfcall=function(e){var t=a(arguments,1);return Q(e).nfapply(t)};Promise.prototype.nfcall=function(){var e=a(arguments);var t=defer();e.push(t.makeNodeResolver());this.fapply(e).fail(t.reject);return t.promise};Q.nfbind=Q.denodeify=function(e){var t=a(arguments,1);return function(){var r=t.concat(a(arguments));var i=defer();r.push(i.makeNodeResolver());Q(e).fapply(r).fail(i.reject);return i.promise}};Promise.prototype.nfbind=Promise.prototype.denodeify=function(){var e=a(arguments);e.unshift(this);return Q.denodeify.apply(void 0,e)};Q.nbind=function(e,t){var r=a(arguments,2);return function(){var i=r.concat(a(arguments));var n=defer();i.push(n.makeNodeResolver());function bound(){return e.apply(t,arguments)}Q(bound).fapply(i).fail(n.reject);return n.promise}};Promise.prototype.nbind=function(){var e=a(arguments,0);e.unshift(this);return Q.nbind.apply(void 0,e)};Q.nmapply=Q.npost=function(e,t,r){return Q(e).npost(t,r)};Promise.prototype.nmapply=Promise.prototype.npost=function(e,t){var r=a(t||[]);var i=defer();r.push(i.makeNodeResolver());this.dispatch("post",[e,r]).fail(i.reject);return i.promise};Q.nsend=Q.nmcall=Q.ninvoke=function(e,t){var r=a(arguments,2);var i=defer();r.push(i.makeNodeResolver());Q(e).dispatch("post",[t,r]).fail(i.reject);return i.promise};Promise.prototype.nsend=Promise.prototype.nmcall=Promise.prototype.ninvoke=function(e){var t=a(arguments,1);var r=defer();t.push(r.makeNodeResolver());this.dispatch("post",[e,t]).fail(r.reject);return r.promise};Q.nodeify=nodeify;function nodeify(e,t){return Q(e).nodeify(t)}Promise.prototype.nodeify=function(e){if(e){this.then((function(t){Q.nextTick((function(){e(null,t)}))}),(function(t){Q.nextTick((function(){e(t)}))}))}else{return this}};var C=captureLine();return Q}))},5026:(e,t,r)=>{"use strict";var i=r(1253).functionsHaveConfigurableNames();var n=Object;var a=TypeError;e.exports=function flags(){if(this!=null&&this!==n(this)){throw new a("RegExp.prototype.flags getter called on non-object")}var e="";if(this.hasIndices){e+="d"}if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.dotAll){e+="s"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};if(i&&Object.defineProperty){Object.defineProperty(e.exports,"name",{value:"get flags"})}},4174:(e,t,r)=>{"use strict";var i=r(9576);var n=r(1743);var a=r(5026);var o=r(7580);var s=r(1873);var c=n(o());i(c,{getPolyfill:o,implementation:a,shim:s});e.exports=c},7580:(e,t,r)=>{"use strict";var i=r(5026);var n=r(9576).supportsDescriptors;var a=Object.getOwnPropertyDescriptor;e.exports=function getPolyfill(){if(n&&/a/gim.flags==="gim"){var e=a(RegExp.prototype,"flags");if(e&&typeof e.get==="function"&&typeof RegExp.prototype.dotAll==="boolean"&&typeof RegExp.prototype.hasIndices==="boolean"){var t="";var r={};Object.defineProperty(r,"hasIndices",{get:function(){t+="d"}});Object.defineProperty(r,"sticky",{get:function(){t+="y"}});if(t==="dy"){return e.get}}}return i}},1873:(e,t,r)=>{"use strict";var i=r(9576).supportsDescriptors;var n=r(7580);var a=Object.getOwnPropertyDescriptor;var o=Object.defineProperty;var s=TypeError;var c=Object.getPrototypeOf;var u=/a/;e.exports=function shimFlags(){if(!i||!c){throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors")}var e=n();var t=c(u);var r=a(t,"flags");if(!r||r.get!==e){o(t,"flags",{configurable:true,enumerable:false,get:e})}return e}},1954:(e,t,r)=>{
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var i=r(4300);var n=i.Buffer;function copyProps(e,t){for(var r in e){t[r]=e[r]}}if(n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow){e.exports=i}else{copyProps(i,t);t.Buffer=SafeBuffer}function SafeBuffer(e,t,r){return n(e,t,r)}SafeBuffer.prototype=Object.create(n.prototype);copyProps(n,SafeBuffer);SafeBuffer.from=function(e,t,r){if(typeof e==="number"){throw new TypeError("Argument must not be a number")}return n(e,t,r)};SafeBuffer.alloc=function(e,t,r){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}var i=n(e);if(t!==undefined){if(typeof r==="string"){i.fill(t,r)}else{i.fill(t)}}else{i.fill(0)}return i};SafeBuffer.allocUnsafe=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return n(e)};SafeBuffer.allocUnsafeSlow=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return i.SlowBuffer(e)}},740:(e,t,r)=>{(function(e){e.parser=function(e,t){return new SAXParser(e,t)};e.SAXParser=SAXParser;e.SAXStream=SAXStream;e.createStream=createStream;e.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function SAXParser(t,r){if(!(this instanceof SAXParser)){return new SAXParser(t,r)}var i=this;clearBuffers(i);i.q=i.c="";i.bufferCheckPosition=e.MAX_BUFFER_LENGTH;i.opt=r||{};i.opt.lowercase=i.opt.lowercase||i.opt.lowercasetags;i.looseCase=i.opt.lowercase?"toLowerCase":"toUpperCase";i.tags=[];i.closed=i.closedRoot=i.sawRoot=false;i.tag=i.error=null;i.strict=!!t;i.noscript=!!(t||i.opt.noscript);i.state=v.BEGIN;i.strictEntities=i.opt.strictEntities;i.ENTITIES=i.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES);i.attribList=[];if(i.opt.xmlns){i.ns=Object.create(u)}i.trackPosition=i.opt.position!==false;if(i.trackPosition){i.position=i.line=i.column=0}emit(i,"onready")}if(!Object.create){Object.create=function(e){function F(){}F.prototype=e;var t=new F;return t}}if(!Object.keys){Object.keys=function(e){var t=[];for(var r in e)if(e.hasOwnProperty(r))t.push(r);return t}}function checkBufferLength(r){var i=Math.max(e.MAX_BUFFER_LENGTH,10);var n=0;for(var a=0,o=t.length;a<o;a++){var s=r[t[a]].length;if(s>i){switch(t[a]){case"textNode":closeText(r);break;case"cdata":emitNode(r,"oncdata",r.cdata);r.cdata="";break;case"script":emitNode(r,"onscript",r.script);r.script="";break;default:error(r,"Max buffer length exceeded: "+t[a])}}n=Math.max(n,s)}var c=e.MAX_BUFFER_LENGTH-n;r.bufferCheckPosition=c+r.position}function clearBuffers(e){for(var r=0,i=t.length;r<i;r++){e[t[r]]=""}}function flushBuffers(e){closeText(e);if(e.cdata!==""){emitNode(e,"oncdata",e.cdata);e.cdata=""}if(e.script!==""){emitNode(e,"onscript",e.script);e.script=""}}SAXParser.prototype={end:function(){end(this)},write:write,resume:function(){this.error=null;return this},close:function(){return this.write(null)},flush:function(){flushBuffers(this)}};var i;try{i=r(2781).Stream}catch(e){i=function(){}}var n=e.EVENTS.filter((function(e){return e!=="error"&&e!=="end"}));function createStream(e,t){return new SAXStream(e,t)}function SAXStream(e,t){if(!(this instanceof SAXStream)){return new SAXStream(e,t)}i.apply(this);this._parser=new SAXParser(e,t);this.writable=true;this.readable=true;var r=this;this._parser.onend=function(){r.emit("end")};this._parser.onerror=function(e){r.emit("error",e);r._parser.error=null};this._decoder=null;n.forEach((function(e){Object.defineProperty(r,"on"+e,{get:function(){return r._parser["on"+e]},set:function(t){if(!t){r.removeAllListeners(e);r._parser["on"+e]=t;return t}r.on(e,t)},enumerable:true,configurable:false})}))}SAXStream.prototype=Object.create(i.prototype,{constructor:{value:SAXStream}});SAXStream.prototype.write=function(e){if(typeof Buffer==="function"&&typeof Buffer.isBuffer==="function"&&Buffer.isBuffer(e)){if(!this._decoder){var t=r(1576).StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}this._parser.write(e.toString());this.emit("data",e);return true};SAXStream.prototype.end=function(e){if(e&&e.length){this.write(e)}this._parser.end();return true};SAXStream.prototype.on=function(e,t){var r=this;if(!r._parser["on"+e]&&n.indexOf(e)!==-1){r._parser["on"+e]=function(){var t=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e);r.emit.apply(r,t)}}return i.prototype.on.call(r,e,t)};var a="[CDATA[";var o="DOCTYPE";var s="http://www.w3.org/XML/1998/namespace";var c="http://www.w3.org/2000/xmlns/";var u={xml:s,xmlns:c};var l=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;var d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;var h=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;var p=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function isWhitespace(e){return e===" "||e==="\n"||e==="\r"||e==="\t"}function isQuote(e){return e==='"'||e==="'"}function isAttribEnd(e){return e===">"||isWhitespace(e)}function isMatch(e,t){return e.test(t)}function notMatch(e,t){return!isMatch(e,t)}var v=0;e.STATE={BEGIN:v++,BEGIN_WHITESPACE:v++,TEXT:v++,TEXT_ENTITY:v++,OPEN_WAKA:v++,SGML_DECL:v++,SGML_DECL_QUOTED:v++,DOCTYPE:v++,DOCTYPE_QUOTED:v++,DOCTYPE_DTD:v++,DOCTYPE_DTD_QUOTED:v++,COMMENT_STARTING:v++,COMMENT:v++,COMMENT_ENDING:v++,COMMENT_ENDED:v++,CDATA:v++,CDATA_ENDING:v++,CDATA_ENDING_2:v++,PROC_INST:v++,PROC_INST_BODY:v++,PROC_INST_ENDING:v++,OPEN_TAG:v++,OPEN_TAG_SLASH:v++,ATTRIB:v++,ATTRIB_NAME:v++,ATTRIB_NAME_SAW_WHITE:v++,ATTRIB_VALUE:v++,ATTRIB_VALUE_QUOTED:v++,ATTRIB_VALUE_CLOSED:v++,ATTRIB_VALUE_UNQUOTED:v++,ATTRIB_VALUE_ENTITY_Q:v++,ATTRIB_VALUE_ENTITY_U:v++,CLOSE_TAG:v++,CLOSE_TAG_SAW_WHITE:v++,SCRIPT:v++,SCRIPT_ENDING:v++};e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"};e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830};Object.keys(e.ENTITIES).forEach((function(t){var r=e.ENTITIES[t];var i=typeof r==="number"?String.fromCharCode(r):r;e.ENTITIES[t]=i}));for(var m in e.STATE){e.STATE[e.STATE[m]]=m}v=e.STATE;function emit(e,t,r){e[t]&&e[t](r)}function emitNode(e,t,r){if(e.textNode)closeText(e);emit(e,t,r)}function closeText(e){e.textNode=textopts(e.opt,e.textNode);if(e.textNode)emit(e,"ontext",e.textNode);e.textNode=""}function textopts(e,t){if(e.trim)t=t.trim();if(e.normalize)t=t.replace(/\s+/g," ");return t}function error(e,t){closeText(e);if(e.trackPosition){t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c}t=new Error(t);e.error=t;emit(e,"onerror",t);return e}function end(e){if(e.sawRoot&&!e.closedRoot)strictFail(e,"Unclosed root tag");if(e.state!==v.BEGIN&&e.state!==v.BEGIN_WHITESPACE&&e.state!==v.TEXT){error(e,"Unexpected end")}closeText(e);e.c="";e.closed=true;emit(e,"onend");SAXParser.call(e,e.strict,e.opt);return e}function strictFail(e,t){if(typeof e!=="object"||!(e instanceof SAXParser)){throw new Error("bad call to strictFail")}if(e.strict){error(e,t)}}function newTag(e){if(!e.strict)e.tagName=e.tagName[e.looseCase]();var t=e.tags[e.tags.length-1]||e;var r=e.tag={name:e.tagName,attributes:{}};if(e.opt.xmlns){r.ns=t.ns}e.attribList.length=0;emitNode(e,"onopentagstart",r)}function qname(e,t){var r=e.indexOf(":");var i=r<0?["",e]:e.split(":");var n=i[0];var a=i[1];if(t&&e==="xmlns"){n="xmlns";a=""}return{prefix:n,local:a}}function attrib(e){if(!e.strict){e.attribName=e.attribName[e.looseCase]()}if(e.attribList.indexOf(e.attribName)!==-1||e.tag.attributes.hasOwnProperty(e.attribName)){e.attribName=e.attribValue="";return}if(e.opt.xmlns){var t=qname(e.attribName,true);var r=t.prefix;var i=t.local;if(r==="xmlns"){if(i==="xml"&&e.attribValue!==s){strictFail(e,"xml: prefix must be bound to "+s+"\n"+"Actual: "+e.attribValue)}else if(i==="xmlns"&&e.attribValue!==c){strictFail(e,"xmlns: prefix must be bound to "+c+"\n"+"Actual: "+e.attribValue)}else{var n=e.tag;var a=e.tags[e.tags.length-1]||e;if(n.ns===a.ns){n.ns=Object.create(a.ns)}n.ns[i]=e.attribValue}}e.attribList.push([e.attribName,e.attribValue])}else{e.tag.attributes[e.attribName]=e.attribValue;emitNode(e,"onattribute",{name:e.attribName,value:e.attribValue})}e.attribName=e.attribValue=""}function openTag(e,t){if(e.opt.xmlns){var r=e.tag;var i=qname(e.tagName);r.prefix=i.prefix;r.local=i.local;r.uri=r.ns[i.prefix]||"";if(r.prefix&&!r.uri){strictFail(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName));r.uri=i.prefix}var n=e.tags[e.tags.length-1]||e;if(r.ns&&n.ns!==r.ns){Object.keys(r.ns).forEach((function(t){emitNode(e,"onopennamespace",{prefix:t,uri:r.ns[t]})}))}for(var a=0,o=e.attribList.length;a<o;a++){var s=e.attribList[a];var c=s[0];var u=s[1];var l=qname(c,true);var d=l.prefix;var h=l.local;var p=d===""?"":r.ns[d]||"";var m={name:c,value:u,prefix:d,local:h,uri:p};if(d&&d!=="xmlns"&&!p){strictFail(e,"Unbound namespace prefix: "+JSON.stringify(d));m.uri=d}e.tag.attributes[c]=m;emitNode(e,"onattribute",m)}e.attribList.length=0}e.tag.isSelfClosing=!!t;e.sawRoot=true;e.tags.push(e.tag);emitNode(e,"onopentag",e.tag);if(!t){if(!e.noscript&&e.tagName.toLowerCase()==="script"){e.state=v.SCRIPT}else{e.state=v.TEXT}e.tag=null;e.tagName=""}e.attribName=e.attribValue="";e.attribList.length=0}function closeTag(e){if(!e.tagName){strictFail(e,"Weird empty close tag.");e.textNode+="</>";e.state=v.TEXT;return}if(e.script){if(e.tagName!=="script"){e.script+="</"+e.tagName+">";e.tagName="";e.state=v.SCRIPT;return}emitNode(e,"onscript",e.script);e.script=""}var t=e.tags.length;var r=e.tagName;if(!e.strict){r=r[e.looseCase]()}var i=r;while(t--){var n=e.tags[t];if(n.name!==i){strictFail(e,"Unexpected close tag")}else{break}}if(t<0){strictFail(e,"Unmatched closing tag: "+e.tagName);e.textNode+="</"+e.tagName+">";e.state=v.TEXT;return}e.tagName=r;var a=e.tags.length;while(a-- >t){var o=e.tag=e.tags.pop();e.tagName=e.tag.name;emitNode(e,"onclosetag",e.tagName);var s={};for(var c in o.ns){s[c]=o.ns[c]}var u=e.tags[e.tags.length-1]||e;if(e.opt.xmlns&&o.ns!==u.ns){Object.keys(o.ns).forEach((function(t){var r=o.ns[t];emitNode(e,"onclosenamespace",{prefix:t,uri:r})}))}}if(t===0)e.closedRoot=true;e.tagName=e.attribValue=e.attribName="";e.attribList.length=0;e.state=v.TEXT}function parseEntity(e){var t=e.entity;var r=t.toLowerCase();var i;var n="";if(e.ENTITIES[t]){return e.ENTITIES[t]}if(e.ENTITIES[r]){return e.ENTITIES[r]}t=r;if(t.charAt(0)==="#"){if(t.charAt(1)==="x"){t=t.slice(2);i=parseInt(t,16);n=i.toString(16)}else{t=t.slice(1);i=parseInt(t,10);n=i.toString(10)}}t=t.replace(/^0+/,"");if(isNaN(i)||n.toLowerCase()!==t){strictFail(e,"Invalid character entity");return"&"+e.entity+";"}return String.fromCodePoint(i)}function beginWhiteSpace(e,t){if(t==="<"){e.state=v.OPEN_WAKA;e.startTagPosition=e.position}else if(!isWhitespace(t)){strictFail(e,"Non-whitespace before first tag.");e.textNode=t;e.state=v.TEXT}}function charAt(e,t){var r="";if(t<e.length){r=e.charAt(t)}return r}function write(e){var t=this;if(this.error){throw this.error}if(t.closed){return error(t,"Cannot write after close. Assign an onready handler.")}if(e===null){return end(t)}if(typeof e==="object"){e=e.toString()}var r=0;var i="";while(true){i=charAt(e,r++);t.c=i;if(!i){break}if(t.trackPosition){t.position++;if(i==="\n"){t.line++;t.column=0}else{t.column++}}switch(t.state){case v.BEGIN:t.state=v.BEGIN_WHITESPACE;if(i==="\ufeff"){continue}beginWhiteSpace(t,i);continue;case v.BEGIN_WHITESPACE:beginWhiteSpace(t,i);continue;case v.TEXT:if(t.sawRoot&&!t.closedRoot){var n=r-1;while(i&&i!=="<"&&i!=="&"){i=charAt(e,r++);if(i&&t.trackPosition){t.position++;if(i==="\n"){t.line++;t.column=0}else{t.column++}}}t.textNode+=e.substring(n,r-1)}if(i==="<"&&!(t.sawRoot&&t.closedRoot&&!t.strict)){t.state=v.OPEN_WAKA;t.startTagPosition=t.position}else{if(!isWhitespace(i)&&(!t.sawRoot||t.closedRoot)){strictFail(t,"Text data outside of root node.")}if(i==="&"){t.state=v.TEXT_ENTITY}else{t.textNode+=i}}continue;case v.SCRIPT:if(i==="<"){t.state=v.SCRIPT_ENDING}else{t.script+=i}continue;case v.SCRIPT_ENDING:if(i==="/"){t.state=v.CLOSE_TAG}else{t.script+="<"+i;t.state=v.SCRIPT}continue;case v.OPEN_WAKA:if(i==="!"){t.state=v.SGML_DECL;t.sgmlDecl=""}else if(isWhitespace(i)){}else if(isMatch(l,i)){t.state=v.OPEN_TAG;t.tagName=i}else if(i==="/"){t.state=v.CLOSE_TAG;t.tagName=""}else if(i==="?"){t.state=v.PROC_INST;t.procInstName=t.procInstBody=""}else{strictFail(t,"Unencoded <");if(t.startTagPosition+1<t.position){var s=t.position-t.startTagPosition;i=new Array(s).join(" ")+i}t.textNode+="<"+i;t.state=v.TEXT}continue;case v.SGML_DECL:if((t.sgmlDecl+i).toUpperCase()===a){emitNode(t,"onopencdata");t.state=v.CDATA;t.sgmlDecl="";t.cdata=""}else if(t.sgmlDecl+i==="--"){t.state=v.COMMENT;t.comment="";t.sgmlDecl=""}else if((t.sgmlDecl+i).toUpperCase()===o){t.state=v.DOCTYPE;if(t.doctype||t.sawRoot){strictFail(t,"Inappropriately located doctype declaration")}t.doctype="";t.sgmlDecl=""}else if(i===">"){emitNode(t,"onsgmldeclaration",t.sgmlDecl);t.sgmlDecl="";t.state=v.TEXT}else if(isQuote(i)){t.state=v.SGML_DECL_QUOTED;t.sgmlDecl+=i}else{t.sgmlDecl+=i}continue;case v.SGML_DECL_QUOTED:if(i===t.q){t.state=v.SGML_DECL;t.q=""}t.sgmlDecl+=i;continue;case v.DOCTYPE:if(i===">"){t.state=v.TEXT;emitNode(t,"ondoctype",t.doctype);t.doctype=true}else{t.doctype+=i;if(i==="["){t.state=v.DOCTYPE_DTD}else if(isQuote(i)){t.state=v.DOCTYPE_QUOTED;t.q=i}}continue;case v.DOCTYPE_QUOTED:t.doctype+=i;if(i===t.q){t.q="";t.state=v.DOCTYPE}continue;case v.DOCTYPE_DTD:t.doctype+=i;if(i==="]"){t.state=v.DOCTYPE}else if(isQuote(i)){t.state=v.DOCTYPE_DTD_QUOTED;t.q=i}continue;case v.DOCTYPE_DTD_QUOTED:t.doctype+=i;if(i===t.q){t.state=v.DOCTYPE_DTD;t.q=""}continue;case v.COMMENT:if(i==="-"){t.state=v.COMMENT_ENDING}else{t.comment+=i}continue;case v.COMMENT_ENDING:if(i==="-"){t.state=v.COMMENT_ENDED;t.comment=textopts(t.opt,t.comment);if(t.comment){emitNode(t,"oncomment",t.comment)}t.comment=""}else{t.comment+="-"+i;t.state=v.COMMENT}continue;case v.COMMENT_ENDED:if(i!==">"){strictFail(t,"Malformed comment");t.comment+="--"+i;t.state=v.COMMENT}else{t.state=v.TEXT}continue;case v.CDATA:if(i==="]"){t.state=v.CDATA_ENDING}else{t.cdata+=i}continue;case v.CDATA_ENDING:if(i==="]"){t.state=v.CDATA_ENDING_2}else{t.cdata+="]"+i;t.state=v.CDATA}continue;case v.CDATA_ENDING_2:if(i===">"){if(t.cdata){emitNode(t,"oncdata",t.cdata)}emitNode(t,"onclosecdata");t.cdata="";t.state=v.TEXT}else if(i==="]"){t.cdata+="]"}else{t.cdata+="]]"+i;t.state=v.CDATA}continue;case v.PROC_INST:if(i==="?"){t.state=v.PROC_INST_ENDING}else if(isWhitespace(i)){t.state=v.PROC_INST_BODY}else{t.procInstName+=i}continue;case v.PROC_INST_BODY:if(!t.procInstBody&&isWhitespace(i)){continue}else if(i==="?"){t.state=v.PROC_INST_ENDING}else{t.procInstBody+=i}continue;case v.PROC_INST_ENDING:if(i===">"){emitNode(t,"onprocessinginstruction",{name:t.procInstName,body:t.procInstBody});t.procInstName=t.procInstBody="";t.state=v.TEXT}else{t.procInstBody+="?"+i;t.state=v.PROC_INST_BODY}continue;case v.OPEN_TAG:if(isMatch(d,i)){t.tagName+=i}else{newTag(t);if(i===">"){openTag(t)}else if(i==="/"){t.state=v.OPEN_TAG_SLASH}else{if(!isWhitespace(i)){strictFail(t,"Invalid character in tag name")}t.state=v.ATTRIB}}continue;case v.OPEN_TAG_SLASH:if(i===">"){openTag(t,true);closeTag(t)}else{strictFail(t,"Forward-slash in opening tag not followed by >");t.state=v.ATTRIB}continue;case v.ATTRIB:if(isWhitespace(i)){continue}else if(i===">"){openTag(t)}else if(i==="/"){t.state=v.OPEN_TAG_SLASH}else if(isMatch(l,i)){t.attribName=i;t.attribValue="";t.state=v.ATTRIB_NAME}else{strictFail(t,"Invalid attribute name")}continue;case v.ATTRIB_NAME:if(i==="="){t.state=v.ATTRIB_VALUE}else if(i===">"){strictFail(t,"Attribute without value");t.attribValue=t.attribName;attrib(t);openTag(t)}else if(isWhitespace(i)){t.state=v.ATTRIB_NAME_SAW_WHITE}else if(isMatch(d,i)){t.attribName+=i}else{strictFail(t,"Invalid attribute name")}continue;case v.ATTRIB_NAME_SAW_WHITE:if(i==="="){t.state=v.ATTRIB_VALUE}else if(isWhitespace(i)){continue}else{strictFail(t,"Attribute without value");t.tag.attributes[t.attribName]="";t.attribValue="";emitNode(t,"onattribute",{name:t.attribName,value:""});t.attribName="";if(i===">"){openTag(t)}else if(isMatch(l,i)){t.attribName=i;t.state=v.ATTRIB_NAME}else{strictFail(t,"Invalid attribute name");t.state=v.ATTRIB}}continue;case v.ATTRIB_VALUE:if(isWhitespace(i)){continue}else if(isQuote(i)){t.q=i;t.state=v.ATTRIB_VALUE_QUOTED}else{strictFail(t,"Unquoted attribute value");t.state=v.ATTRIB_VALUE_UNQUOTED;t.attribValue=i}continue;case v.ATTRIB_VALUE_QUOTED:if(i!==t.q){if(i==="&"){t.state=v.ATTRIB_VALUE_ENTITY_Q}else{t.attribValue+=i}continue}attrib(t);t.q="";t.state=v.ATTRIB_VALUE_CLOSED;continue;case v.ATTRIB_VALUE_CLOSED:if(isWhitespace(i)){t.state=v.ATTRIB}else if(i===">"){openTag(t)}else if(i==="/"){t.state=v.OPEN_TAG_SLASH}else if(isMatch(l,i)){strictFail(t,"No whitespace between attributes");t.attribName=i;t.attribValue="";t.state=v.ATTRIB_NAME}else{strictFail(t,"Invalid attribute name")}continue;case v.ATTRIB_VALUE_UNQUOTED:if(!isAttribEnd(i)){if(i==="&"){t.state=v.ATTRIB_VALUE_ENTITY_U}else{t.attribValue+=i}continue}attrib(t);if(i===">"){openTag(t)}else{t.state=v.ATTRIB}continue;case v.CLOSE_TAG:if(!t.tagName){if(isWhitespace(i)){continue}else if(notMatch(l,i)){if(t.script){t.script+="</"+i;t.state=v.SCRIPT}else{strictFail(t,"Invalid tagname in closing tag.")}}else{t.tagName=i}}else if(i===">"){closeTag(t)}else if(isMatch(d,i)){t.tagName+=i}else if(t.script){t.script+="</"+t.tagName;t.tagName="";t.state=v.SCRIPT}else{if(!isWhitespace(i)){strictFail(t,"Invalid tagname in closing tag")}t.state=v.CLOSE_TAG_SAW_WHITE}continue;case v.CLOSE_TAG_SAW_WHITE:if(isWhitespace(i)){continue}if(i===">"){closeTag(t)}else{strictFail(t,"Invalid characters in closing tag")}continue;case v.TEXT_ENTITY:case v.ATTRIB_VALUE_ENTITY_Q:case v.ATTRIB_VALUE_ENTITY_U:var c;var u;switch(t.state){case v.TEXT_ENTITY:c=v.TEXT;u="textNode";break;case v.ATTRIB_VALUE_ENTITY_Q:c=v.ATTRIB_VALUE_QUOTED;u="attribValue";break;case v.ATTRIB_VALUE_ENTITY_U:c=v.ATTRIB_VALUE_UNQUOTED;u="attribValue";break}if(i===";"){t[u]+=parseEntity(t);t.entity="";t.state=c}else if(isMatch(t.entity.length?p:h,i)){t.entity+=i}else{strictFail(t,"Invalid character in entity name");t[u]+="&"+t.entity+i;t.entity="";t.state=c}continue;default:throw new Error(t,"Unknown state: "+t.state)}}if(t.position>=t.bufferCheckPosition){checkBufferLength(t)}return t}
/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */if(!String.fromCodePoint){(function(){var e=String.fromCharCode;var t=Math.floor;var fromCodePoint=function(){var r=16384;var i=[];var n;var a;var o=-1;var s=arguments.length;if(!s){return""}var c="";while(++o<s){var u=Number(arguments[o]);if(!isFinite(u)||u<0||u>1114111||t(u)!==u){throw RangeError("Invalid code point: "+u)}if(u<=65535){i.push(u)}else{u-=65536;n=(u>>10)+55296;a=u%1024+56320;i.push(n,a)}if(o+1===s||i.length>r){c+=e.apply(null,i);i.length=0}}return c};if(Object.defineProperty){Object.defineProperty(String,"fromCodePoint",{value:fromCodePoint,configurable:true,writable:true})}else{String.fromCodePoint=fromCodePoint}})()}})(false?0:t)},1357:(e,t,r)=>{"use strict";var i=r(1626);var n=r(6379);var a=r(7720);var o=i("%TypeError%");var s=i("%WeakMap%",true);var c=i("%Map%",true);var u=n("WeakMap.prototype.get",true);var l=n("WeakMap.prototype.set",true);var d=n("WeakMap.prototype.has",true);var h=n("Map.prototype.get",true);var p=n("Map.prototype.set",true);var v=n("Map.prototype.has",true);var listGetNode=function(e,t){for(var r=e,i;(i=r.next)!==null;r=i){if(i.key===t){r.next=i.next;i.next=e.next;e.next=i;return i}}};var listGet=function(e,t){var r=listGetNode(e,t);return r&&r.value};var listSet=function(e,t,r){var i=listGetNode(e,t);if(i){i.value=r}else{e.next={key:t,next:e.next,value:r}}};var listHas=function(e,t){return!!listGetNode(e,t)};e.exports=function getSideChannel(){var e;var t;var r;var i={assert:function(e){if(!i.has(e)){throw new o("Side channel does not contain "+a(e))}},get:function(i){if(s&&i&&(typeof i==="object"||typeof i==="function")){if(e){return u(e,i)}}else if(c){if(t){return h(t,i)}}else{if(r){return listGet(r,i)}}},has:function(i){if(s&&i&&(typeof i==="object"||typeof i==="function")){if(e){return d(e,i)}}else if(c){if(t){return v(t,i)}}else{if(r){return listHas(r,i)}}return false},set:function(i,n){if(s&&i&&(typeof i==="object"||typeof i==="function")){if(!e){e=new s}l(e,i,n)}else if(c){if(!t){t=new c}p(t,i,n)}else{if(!r){r={key:{},next:null}}listSet(r,i,n)}}};return i}},5957:(e,t,r)=>{r(1207).install()},1207:(e,t,r)=>{e=r.nmd(e);var i=r(6893).SourceMapConsumer;var n=r(1017);var a;try{a=r(7147);if(!a.existsSync||!a.readFileSync){a=null}}catch(e){}var o=r(8779);function dynamicRequire(e,t){return e.require(t)}var s=false;var c=false;var u=false;var l="auto";var d={};var h={};var p=/^data:application\/json[^,]+base64,/;var v=[];var m=[];function isInBrowser(){if(l==="browser")return true;if(l==="node")return false;return typeof window!=="undefined"&&typeof XMLHttpRequest==="function"&&!(window.require&&window.module&&window.process&&window.process.type==="renderer")}function hasGlobalProcessEventEmitter(){return typeof process==="object"&&process!==null&&typeof process.on==="function"}function globalProcessVersion(){if(typeof process==="object"&&process!==null){return process.version}else{return""}}function globalProcessStderr(){if(typeof process==="object"&&process!==null){return process.stderr}}function globalProcessExit(e){if(typeof process==="object"&&process!==null&&typeof process.exit==="function"){return process.exit(e)}}function handlerExec(e){return function(t){for(var r=0;r<e.length;r++){var i=e[r](t);if(i){return i}}return null}}var g=handlerExec(v);v.push((function(e){e=e.trim();if(/^file:/.test(e)){e=e.replace(/file:\/\/\/(\w:)?/,(function(e,t){return t?"":"/"}))}if(e in d){return d[e]}var t="";try{if(!a){var r=new XMLHttpRequest;r.open("GET",e,false);r.send(null);if(r.readyState===4&&r.status===200){t=r.responseText}}else if(a.existsSync(e)){t=a.readFileSync(e,"utf8")}}catch(e){}return d[e]=t}));function supportRelativeURL(e,t){if(!e)return t;var r=n.dirname(e);var i=/^\w+:\/\/[^\/]*/.exec(r);var a=i?i[0]:"";var o=r.slice(a.length);if(a&&/^\/\w\:/.test(o)){a+="/";return a+n.resolve(r.slice(a.length),t).replace(/\\/g,"/")}return a+n.resolve(r.slice(a.length),t)}function retrieveSourceMapURL(e){var t;if(isInBrowser()){try{var r=new XMLHttpRequest;r.open("GET",e,false);r.send(null);t=r.readyState===4?r.responseText:null;var i=r.getResponseHeader("SourceMap")||r.getResponseHeader("X-SourceMap");if(i){return i}}catch(e){}}t=g(e);var n=/(?:\/\/[@#][\s]*sourceMappingURL=([^\s'"]+)[\s]*$)|(?:\/\*[@#][\s]*sourceMappingURL=([^\s*'"]+)[\s]*(?:\*\/)[\s]*$)/gm;var a,o;while(o=n.exec(t))a=o;if(!a)return null;return a[1]}var y=handlerExec(m);m.push((function(e){var t=retrieveSourceMapURL(e);if(!t)return null;var r;if(p.test(t)){var i=t.slice(t.indexOf(",")+1);r=o(i,"base64").toString();t=e}else{t=supportRelativeURL(e,t);r=g(t)}if(!r){return null}return{url:t,map:r}}));function mapSourcePosition(e){var t=h[e.source];if(!t){var r=y(e.source);if(r){t=h[e.source]={url:r.url,map:new i(r.map)};if(t.map.sourcesContent){t.map.sources.forEach((function(e,r){var i=t.map.sourcesContent[r];if(i){var n=supportRelativeURL(t.url,e);d[n]=i}}))}}else{t=h[e.source]={url:null,map:null}}}if(t&&t.map&&typeof t.map.originalPositionFor==="function"){var n=t.map.originalPositionFor(e);if(n.source!==null){n.source=supportRelativeURL(t.url,n.source);return n}}return e}function mapEvalOrigin(e){var t=/^eval at ([^(]+) \((.+):(\d+):(\d+)\)$/.exec(e);if(t){var r=mapSourcePosition({source:t[2],line:+t[3],column:t[4]-1});return"eval at "+t[1]+" ("+r.source+":"+r.line+":"+(r.column+1)+")"}t=/^eval at ([^(]+) \((.+)\)$/.exec(e);if(t){return"eval at "+t[1]+" ("+mapEvalOrigin(t[2])+")"}return e}function CallSiteToString(){var e;var t="";if(this.isNative()){t="native"}else{e=this.getScriptNameOrSourceURL();if(!e&&this.isEval()){t=this.getEvalOrigin();t+=", "}if(e){t+=e}else{t+="<anonymous>"}var r=this.getLineNumber();if(r!=null){t+=":"+r;var i=this.getColumnNumber();if(i){t+=":"+i}}}var n="";var a=this.getFunctionName();var o=true;var s=this.isConstructor();var c=!(this.isToplevel()||s);if(c){var u=this.getTypeName();if(u==="[object Object]"){u="null"}var l=this.getMethodName();if(a){if(u&&a.indexOf(u)!=0){n+=u+"."}n+=a;if(l&&a.indexOf("."+l)!=a.length-l.length-1){n+=" [as "+l+"]"}}else{n+=u+"."+(l||"<anonymous>")}}else if(s){n+="new "+(a||"<anonymous>")}else if(a){n+=a}else{n+=t;o=false}if(o){n+=" ("+t+")"}return n}function cloneCallSite(e){var t={};Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach((function(r){t[r]=/^(?:is|get)/.test(r)?function(){return e[r].call(e)}:e[r]}));t.toString=CallSiteToString;return t}function wrapCallSite(e,t){if(t===undefined){t={nextPosition:null,curPosition:null}}if(e.isNative()){t.curPosition=null;return e}var r=e.getFileName()||e.getScriptNameOrSourceURL();if(r){var i=e.getLineNumber();var n=e.getColumnNumber()-1;var a=/^v(10\.1[6-9]|10\.[2-9][0-9]|10\.[0-9]{3,}|1[2-9]\d*|[2-9]\d|\d{3,}|11\.11)/;var o=a.test(globalProcessVersion())?0:62;if(i===1&&n>o&&!isInBrowser()&&!e.isEval()){n-=o}var s=mapSourcePosition({source:r,line:i,column:n});t.curPosition=s;e=cloneCallSite(e);var c=e.getFunctionName;e.getFunctionName=function(){if(t.nextPosition==null){return c()}return t.nextPosition.name||c()};e.getFileName=function(){return s.source};e.getLineNumber=function(){return s.line};e.getColumnNumber=function(){return s.column+1};e.getScriptNameOrSourceURL=function(){return s.source};return e}var u=e.isEval()&&e.getEvalOrigin();if(u){u=mapEvalOrigin(u);e=cloneCallSite(e);e.getEvalOrigin=function(){return u};return e}return e}function prepareStackTrace(e,t){if(u){d={};h={}}var r=e.name||"Error";var i=e.message||"";var n=r+": "+i;var a={nextPosition:null,curPosition:null};var o=[];for(var s=t.length-1;s>=0;s--){o.push("\n    at "+wrapCallSite(t[s],a));a.nextPosition=a.curPosition}a.curPosition=a.nextPosition=null;return n+o.reverse().join("")}function getErrorSource(e){var t=/\n    at [^(]+ \((.*):(\d+):(\d+)\)/.exec(e.stack);if(t){var r=t[1];var i=+t[2];var n=+t[3];var o=d[r];if(!o&&a&&a.existsSync(r)){try{o=a.readFileSync(r,"utf8")}catch(e){o=""}}if(o){var s=o.split(/(?:\r\n|\r|\n)/)[i-1];if(s){return r+":"+i+"\n"+s+"\n"+new Array(n).join(" ")+"^"}}}return null}function printErrorAndExit(e){var t=getErrorSource(e);var r=globalProcessStderr();if(r&&r._handle&&r._handle.setBlocking){r._handle.setBlocking(true)}if(t){console.error();console.error(t)}console.error(e.stack);globalProcessExit(1)}function shimEmitUncaughtException(){var e=process.emit;process.emit=function(t){if(t==="uncaughtException"){var r=arguments[1]&&arguments[1].stack;var i=this.listeners(t).length>0;if(r&&!i){return printErrorAndExit(arguments[1])}}return e.apply(this,arguments)}}var C=v.slice(0);var T=m.slice(0);t.wrapCallSite=wrapCallSite;t.getErrorSource=getErrorSource;t.mapSourcePosition=mapSourcePosition;t.retrieveSourceMap=y;t.install=function(t){t=t||{};if(t.environment){l=t.environment;if(["node","browser","auto"].indexOf(l)===-1){throw new Error("environment "+l+" was unknown. Available options are {auto, browser, node}")}}if(t.retrieveFile){if(t.overrideRetrieveFile){v.length=0}v.unshift(t.retrieveFile)}if(t.retrieveSourceMap){if(t.overrideRetrieveSourceMap){m.length=0}m.unshift(t.retrieveSourceMap)}if(t.hookRequire&&!isInBrowser()){var r=dynamicRequire(e,"module");var i=r.prototype._compile;if(!i.__sourceMapSupport){r.prototype._compile=function(e,t){d[t]=e;h[t]=undefined;return i.call(this,e,t)};r.prototype._compile.__sourceMapSupport=true}}if(!u){u="emptyCacheBetweenOperations"in t?t.emptyCacheBetweenOperations:false}if(!s){s=true;Error.prepareStackTrace=prepareStackTrace}if(!c){var n="handleUncaughtExceptions"in t?t.handleUncaughtExceptions:true;try{var a=dynamicRequire(e,"worker_threads");if(a.isMainThread===false){n=false}}catch(e){}if(n&&hasGlobalProcessEventEmitter()){c=true;shimEmitUncaughtException()}}};t.resetRetrieveHandlers=function(){v.length=0;m.length=0;v=C.slice(0);m=T.slice(0);y=handlerExec(m);g=handlerExec(v)}},9837:(e,t,r)=>{var i=r(9572);var n=Object.prototype.hasOwnProperty;var a=typeof Map!=="undefined";function ArraySet(){this._array=[];this._set=a?new Map:Object.create(null)}ArraySet.fromArray=function ArraySet_fromArray(e,t){var r=new ArraySet;for(var i=0,n=e.length;i<n;i++){r.add(e[i],t)}return r};ArraySet.prototype.size=function ArraySet_size(){return a?this._set.size:Object.getOwnPropertyNames(this._set).length};ArraySet.prototype.add=function ArraySet_add(e,t){var r=a?e:i.toSetString(e);var o=a?this.has(e):n.call(this._set,r);var s=this._array.length;if(!o||t){this._array.push(e)}if(!o){if(a){this._set.set(e,s)}else{this._set[r]=s}}};ArraySet.prototype.has=function ArraySet_has(e){if(a){return this._set.has(e)}else{var t=i.toSetString(e);return n.call(this._set,t)}};ArraySet.prototype.indexOf=function ArraySet_indexOf(e){if(a){var t=this._set.get(e);if(t>=0){return t}}else{var r=i.toSetString(e);if(n.call(this._set,r)){return this._set[r]}}throw new Error('"'+e+'" is not in the set.')};ArraySet.prototype.at=function ArraySet_at(e){if(e>=0&&e<this._array.length){return this._array[e]}throw new Error("No element indexed by "+e)};ArraySet.prototype.toArray=function ArraySet_toArray(){return this._array.slice()};t.I=ArraySet},6385:(e,t,r)=>{var i=r(3436);var n=5;var a=1<<n;var o=a-1;var s=a;function toVLQSigned(e){return e<0?(-e<<1)+1:(e<<1)+0}function fromVLQSigned(e){var t=(e&1)===1;var r=e>>1;return t?-r:r}t.encode=function base64VLQ_encode(e){var t="";var r;var a=toVLQSigned(e);do{r=a&o;a>>>=n;if(a>0){r|=s}t+=i.encode(r)}while(a>0);return t};t.decode=function base64VLQ_decode(e,t,r){var a=e.length;var c=0;var u=0;var l,d;do{if(t>=a){throw new Error("Expected more digits in base 64 VLQ value.")}d=i.decode(e.charCodeAt(t++));if(d===-1){throw new Error("Invalid base64 digit: "+e.charAt(t-1))}l=!!(d&s);d&=o;c=c+(d<<u);u+=n}while(l);r.value=fromVLQSigned(c);r.rest=t}},3436:(e,t)=>{var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<r.length){return r[e]}throw new TypeError("Must be between 0 and 63: "+e)};t.decode=function(e){var t=65;var r=90;var i=97;var n=122;var a=48;var o=57;var s=43;var c=47;var u=26;var l=52;if(t<=e&&e<=r){return e-t}if(i<=e&&e<=n){return e-i+u}if(a<=e&&e<=o){return e-a+l}if(e==s){return 62}if(e==c){return 63}return-1}},4932:(e,t)=>{t.GREATEST_LOWER_BOUND=1;t.LEAST_UPPER_BOUND=2;function recursiveSearch(e,r,i,n,a,o){var s=Math.floor((r-e)/2)+e;var c=a(i,n[s],true);if(c===0){return s}else if(c>0){if(r-s>1){return recursiveSearch(s,r,i,n,a,o)}if(o==t.LEAST_UPPER_BOUND){return r<n.length?r:-1}else{return s}}else{if(s-e>1){return recursiveSearch(e,s,i,n,a,o)}if(o==t.LEAST_UPPER_BOUND){return s}else{return e<0?-1:e}}}t.search=function search(e,r,i,n){if(r.length===0){return-1}var a=recursiveSearch(-1,r.length,e,r,i,n||t.GREATEST_LOWER_BOUND);if(a<0){return-1}while(a-1>=0){if(i(r[a],r[a-1],true)!==0){break}--a}return a}},8365:(e,t,r)=>{var i=r(9572);function generatedPositionAfter(e,t){var r=e.generatedLine;var n=t.generatedLine;var a=e.generatedColumn;var o=t.generatedColumn;return n>r||n==r&&o>=a||i.compareByGeneratedPositionsInflated(e,t)<=0}function MappingList(){this._array=[];this._sorted=true;this._last={generatedLine:-1,generatedColumn:0}}MappingList.prototype.unsortedForEach=function MappingList_forEach(e,t){this._array.forEach(e,t)};MappingList.prototype.add=function MappingList_add(e){if(generatedPositionAfter(this._last,e)){this._last=e;this._array.push(e)}else{this._sorted=false;this._array.push(e)}};MappingList.prototype.toArray=function MappingList_toArray(){if(!this._sorted){this._array.sort(i.compareByGeneratedPositionsInflated);this._sorted=true}return this._array};t.H=MappingList},660:(e,t)=>{function swap(e,t,r){var i=e[t];e[t]=e[r];e[r]=i}function randomIntInRange(e,t){return Math.round(e+Math.random()*(t-e))}function doQuickSort(e,t,r,i){if(r<i){var n=randomIntInRange(r,i);var a=r-1;swap(e,n,i);var o=e[i];for(var s=r;s<i;s++){if(t(e[s],o)<=0){a+=1;swap(e,a,s)}}swap(e,a+1,s);var c=a+1;doQuickSort(e,t,r,c-1);doQuickSort(e,t,c+1,i)}}t.U=function(e,t){doQuickSort(e,t,0,e.length-1)}},969:(e,t,r)=>{var i;var n=r(9572);var a=r(4932);var o=r(9837).I;var s=r(6385);var c=r(660).U;function SourceMapConsumer(e,t){var r=e;if(typeof e==="string"){r=n.parseSourceMapInput(e)}return r.sections!=null?new IndexedSourceMapConsumer(r,t):new BasicSourceMapConsumer(r,t)}SourceMapConsumer.fromSourceMap=function(e,t){return BasicSourceMapConsumer.fromSourceMap(e,t)};SourceMapConsumer.prototype._version=3;SourceMapConsumer.prototype.__generatedMappings=null;Object.defineProperty(SourceMapConsumer.prototype,"_generatedMappings",{configurable:true,enumerable:true,get:function(){if(!this.__generatedMappings){this._parseMappings(this._mappings,this.sourceRoot)}return this.__generatedMappings}});SourceMapConsumer.prototype.__originalMappings=null;Object.defineProperty(SourceMapConsumer.prototype,"_originalMappings",{configurable:true,enumerable:true,get:function(){if(!this.__originalMappings){this._parseMappings(this._mappings,this.sourceRoot)}return this.__originalMappings}});SourceMapConsumer.prototype._charIsMappingSeparator=function SourceMapConsumer_charIsMappingSeparator(e,t){var r=e.charAt(t);return r===";"||r===","};SourceMapConsumer.prototype._parseMappings=function SourceMapConsumer_parseMappings(e,t){throw new Error("Subclasses must implement _parseMappings")};SourceMapConsumer.GENERATED_ORDER=1;SourceMapConsumer.ORIGINAL_ORDER=2;SourceMapConsumer.GREATEST_LOWER_BOUND=1;SourceMapConsumer.LEAST_UPPER_BOUND=2;SourceMapConsumer.prototype.eachMapping=function SourceMapConsumer_eachMapping(e,t,r){var i=t||null;var a=r||SourceMapConsumer.GENERATED_ORDER;var o;switch(a){case SourceMapConsumer.GENERATED_ORDER:o=this._generatedMappings;break;case SourceMapConsumer.ORIGINAL_ORDER:o=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var s=this.sourceRoot;o.map((function(e){var t=e.source===null?null:this._sources.at(e.source);t=n.computeSourceURL(s,t,this._sourceMapURL);return{source:t,generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:e.name===null?null:this._names.at(e.name)}}),this).forEach(e,i)};SourceMapConsumer.prototype.allGeneratedPositionsFor=function SourceMapConsumer_allGeneratedPositionsFor(e){var t=n.getArg(e,"line");var r={source:n.getArg(e,"source"),originalLine:t,originalColumn:n.getArg(e,"column",0)};r.source=this._findSourceIndex(r.source);if(r.source<0){return[]}var i=[];var o=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,a.LEAST_UPPER_BOUND);if(o>=0){var s=this._originalMappings[o];if(e.column===undefined){var c=s.originalLine;while(s&&s.originalLine===c){i.push({line:n.getArg(s,"generatedLine",null),column:n.getArg(s,"generatedColumn",null),lastColumn:n.getArg(s,"lastGeneratedColumn",null)});s=this._originalMappings[++o]}}else{var u=s.originalColumn;while(s&&s.originalLine===t&&s.originalColumn==u){i.push({line:n.getArg(s,"generatedLine",null),column:n.getArg(s,"generatedColumn",null),lastColumn:n.getArg(s,"lastGeneratedColumn",null)});s=this._originalMappings[++o]}}}return i};t.SourceMapConsumer=SourceMapConsumer;function BasicSourceMapConsumer(e,t){var r=e;if(typeof e==="string"){r=n.parseSourceMapInput(e)}var i=n.getArg(r,"version");var a=n.getArg(r,"sources");var s=n.getArg(r,"names",[]);var c=n.getArg(r,"sourceRoot",null);var u=n.getArg(r,"sourcesContent",null);var l=n.getArg(r,"mappings");var d=n.getArg(r,"file",null);if(i!=this._version){throw new Error("Unsupported version: "+i)}if(c){c=n.normalize(c)}a=a.map(String).map(n.normalize).map((function(e){return c&&n.isAbsolute(c)&&n.isAbsolute(e)?n.relative(c,e):e}));this._names=o.fromArray(s.map(String),true);this._sources=o.fromArray(a,true);this._absoluteSources=this._sources.toArray().map((function(e){return n.computeSourceURL(c,e,t)}));this.sourceRoot=c;this.sourcesContent=u;this._mappings=l;this._sourceMapURL=t;this.file=d}BasicSourceMapConsumer.prototype=Object.create(SourceMapConsumer.prototype);BasicSourceMapConsumer.prototype.consumer=SourceMapConsumer;BasicSourceMapConsumer.prototype._findSourceIndex=function(e){var t=e;if(this.sourceRoot!=null){t=n.relative(this.sourceRoot,t)}if(this._sources.has(t)){return this._sources.indexOf(t)}var r;for(r=0;r<this._absoluteSources.length;++r){if(this._absoluteSources[r]==e){return r}}return-1};BasicSourceMapConsumer.fromSourceMap=function SourceMapConsumer_fromSourceMap(e,t){var r=Object.create(BasicSourceMapConsumer.prototype);var i=r._names=o.fromArray(e._names.toArray(),true);var a=r._sources=o.fromArray(e._sources.toArray(),true);r.sourceRoot=e._sourceRoot;r.sourcesContent=e._generateSourcesContent(r._sources.toArray(),r.sourceRoot);r.file=e._file;r._sourceMapURL=t;r._absoluteSources=r._sources.toArray().map((function(e){return n.computeSourceURL(r.sourceRoot,e,t)}));var s=e._mappings.toArray().slice();var u=r.__generatedMappings=[];var l=r.__originalMappings=[];for(var d=0,h=s.length;d<h;d++){var p=s[d];var v=new Mapping;v.generatedLine=p.generatedLine;v.generatedColumn=p.generatedColumn;if(p.source){v.source=a.indexOf(p.source);v.originalLine=p.originalLine;v.originalColumn=p.originalColumn;if(p.name){v.name=i.indexOf(p.name)}l.push(v)}u.push(v)}c(r.__originalMappings,n.compareByOriginalPositions);return r};BasicSourceMapConsumer.prototype._version=3;Object.defineProperty(BasicSourceMapConsumer.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function Mapping(){this.generatedLine=0;this.generatedColumn=0;this.source=null;this.originalLine=null;this.originalColumn=null;this.name=null}BasicSourceMapConsumer.prototype._parseMappings=function SourceMapConsumer_parseMappings(e,t){var r=1;var i=0;var a=0;var o=0;var u=0;var l=0;var d=e.length;var h=0;var p={};var v={};var m=[];var g=[];var y,C,T,E,D;while(h<d){if(e.charAt(h)===";"){r++;h++;i=0}else if(e.charAt(h)===","){h++}else{y=new Mapping;y.generatedLine=r;for(E=h;E<d;E++){if(this._charIsMappingSeparator(e,E)){break}}C=e.slice(h,E);T=p[C];if(T){h+=C.length}else{T=[];while(h<E){s.decode(e,h,v);D=v.value;h=v.rest;T.push(D)}if(T.length===2){throw new Error("Found a source, but no line and column")}if(T.length===3){throw new Error("Found a source and line, but no column")}p[C]=T}y.generatedColumn=i+T[0];i=y.generatedColumn;if(T.length>1){y.source=u+T[1];u+=T[1];y.originalLine=a+T[2];a=y.originalLine;y.originalLine+=1;y.originalColumn=o+T[3];o=y.originalColumn;if(T.length>4){y.name=l+T[4];l+=T[4]}}g.push(y);if(typeof y.originalLine==="number"){m.push(y)}}}c(g,n.compareByGeneratedPositionsDeflated);this.__generatedMappings=g;c(m,n.compareByOriginalPositions);this.__originalMappings=m};BasicSourceMapConsumer.prototype._findMapping=function SourceMapConsumer_findMapping(e,t,r,i,n,o){if(e[r]<=0){throw new TypeError("Line must be greater than or equal to 1, got "+e[r])}if(e[i]<0){throw new TypeError("Column must be greater than or equal to 0, got "+e[i])}return a.search(e,t,n,o)};BasicSourceMapConsumer.prototype.computeColumnSpans=function SourceMapConsumer_computeColumnSpans(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var r=this._generatedMappings[e+1];if(t.generatedLine===r.generatedLine){t.lastGeneratedColumn=r.generatedColumn-1;continue}}t.lastGeneratedColumn=Infinity}};BasicSourceMapConsumer.prototype.originalPositionFor=function SourceMapConsumer_originalPositionFor(e){var t={generatedLine:n.getArg(e,"line"),generatedColumn:n.getArg(e,"column")};var r=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",n.compareByGeneratedPositionsDeflated,n.getArg(e,"bias",SourceMapConsumer.GREATEST_LOWER_BOUND));if(r>=0){var i=this._generatedMappings[r];if(i.generatedLine===t.generatedLine){var a=n.getArg(i,"source",null);if(a!==null){a=this._sources.at(a);a=n.computeSourceURL(this.sourceRoot,a,this._sourceMapURL)}var o=n.getArg(i,"name",null);if(o!==null){o=this._names.at(o)}return{source:a,line:n.getArg(i,"originalLine",null),column:n.getArg(i,"originalColumn",null),name:o}}}return{source:null,line:null,column:null,name:null}};BasicSourceMapConsumer.prototype.hasContentsOfAllSources=function BasicSourceMapConsumer_hasContentsOfAllSources(){if(!this.sourcesContent){return false}return this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return e==null}))};BasicSourceMapConsumer.prototype.sourceContentFor=function SourceMapConsumer_sourceContentFor(e,t){if(!this.sourcesContent){return null}var r=this._findSourceIndex(e);if(r>=0){return this.sourcesContent[r]}var i=e;if(this.sourceRoot!=null){i=n.relative(this.sourceRoot,i)}var a;if(this.sourceRoot!=null&&(a=n.urlParse(this.sourceRoot))){var o=i.replace(/^file:\/\//,"");if(a.scheme=="file"&&this._sources.has(o)){return this.sourcesContent[this._sources.indexOf(o)]}if((!a.path||a.path=="/")&&this._sources.has("/"+i)){return this.sourcesContent[this._sources.indexOf("/"+i)]}}if(t){return null}else{throw new Error('"'+i+'" is not in the SourceMap.')}};BasicSourceMapConsumer.prototype.generatedPositionFor=function SourceMapConsumer_generatedPositionFor(e){var t=n.getArg(e,"source");t=this._findSourceIndex(t);if(t<0){return{line:null,column:null,lastColumn:null}}var r={source:t,originalLine:n.getArg(e,"line"),originalColumn:n.getArg(e,"column")};var i=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,n.getArg(e,"bias",SourceMapConsumer.GREATEST_LOWER_BOUND));if(i>=0){var a=this._originalMappings[i];if(a.source===r.source){return{line:n.getArg(a,"generatedLine",null),column:n.getArg(a,"generatedColumn",null),lastColumn:n.getArg(a,"lastGeneratedColumn",null)}}}return{line:null,column:null,lastColumn:null}};i=BasicSourceMapConsumer;function IndexedSourceMapConsumer(e,t){var r=e;if(typeof e==="string"){r=n.parseSourceMapInput(e)}var i=n.getArg(r,"version");var a=n.getArg(r,"sections");if(i!=this._version){throw new Error("Unsupported version: "+i)}this._sources=new o;this._names=new o;var s={line:-1,column:0};this._sections=a.map((function(e){if(e.url){throw new Error("Support for url field in sections not implemented.")}var r=n.getArg(e,"offset");var i=n.getArg(r,"line");var a=n.getArg(r,"column");if(i<s.line||i===s.line&&a<s.column){throw new Error("Section offsets must be ordered and non-overlapping.")}s=r;return{generatedOffset:{generatedLine:i+1,generatedColumn:a+1},consumer:new SourceMapConsumer(n.getArg(e,"map"),t)}}))}IndexedSourceMapConsumer.prototype=Object.create(SourceMapConsumer.prototype);IndexedSourceMapConsumer.prototype.constructor=SourceMapConsumer;IndexedSourceMapConsumer.prototype._version=3;Object.defineProperty(IndexedSourceMapConsumer.prototype,"sources",{get:function(){var e=[];for(var t=0;t<this._sections.length;t++){for(var r=0;r<this._sections[t].consumer.sources.length;r++){e.push(this._sections[t].consumer.sources[r])}}return e}});IndexedSourceMapConsumer.prototype.originalPositionFor=function IndexedSourceMapConsumer_originalPositionFor(e){var t={generatedLine:n.getArg(e,"line"),generatedColumn:n.getArg(e,"column")};var r=a.search(t,this._sections,(function(e,t){var r=e.generatedLine-t.generatedOffset.generatedLine;if(r){return r}return e.generatedColumn-t.generatedOffset.generatedColumn}));var i=this._sections[r];if(!i){return{source:null,line:null,column:null,name:null}}return i.consumer.originalPositionFor({line:t.generatedLine-(i.generatedOffset.generatedLine-1),column:t.generatedColumn-(i.generatedOffset.generatedLine===t.generatedLine?i.generatedOffset.generatedColumn-1:0),bias:e.bias})};IndexedSourceMapConsumer.prototype.hasContentsOfAllSources=function IndexedSourceMapConsumer_hasContentsOfAllSources(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))};IndexedSourceMapConsumer.prototype.sourceContentFor=function IndexedSourceMapConsumer_sourceContentFor(e,t){for(var r=0;r<this._sections.length;r++){var i=this._sections[r];var n=i.consumer.sourceContentFor(e,true);if(n){return n}}if(t){return null}else{throw new Error('"'+e+'" is not in the SourceMap.')}};IndexedSourceMapConsumer.prototype.generatedPositionFor=function IndexedSourceMapConsumer_generatedPositionFor(e){for(var t=0;t<this._sections.length;t++){var r=this._sections[t];if(r.consumer._findSourceIndex(n.getArg(e,"source"))===-1){continue}var i=r.consumer.generatedPositionFor(e);if(i){var a={line:i.line+(r.generatedOffset.generatedLine-1),column:i.column+(r.generatedOffset.generatedLine===i.line?r.generatedOffset.generatedColumn-1:0)};return a}}return{line:null,column:null}};IndexedSourceMapConsumer.prototype._parseMappings=function IndexedSourceMapConsumer_parseMappings(e,t){this.__generatedMappings=[];this.__originalMappings=[];for(var r=0;r<this._sections.length;r++){var i=this._sections[r];var a=i.consumer._generatedMappings;for(var o=0;o<a.length;o++){var s=a[o];var u=i.consumer._sources.at(s.source);u=n.computeSourceURL(i.consumer.sourceRoot,u,this._sourceMapURL);this._sources.add(u);u=this._sources.indexOf(u);var l=null;if(s.name){l=i.consumer._names.at(s.name);this._names.add(l);l=this._names.indexOf(l)}var d={source:u,generatedLine:s.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:s.generatedColumn+(i.generatedOffset.generatedLine===s.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:s.originalLine,originalColumn:s.originalColumn,name:l};this.__generatedMappings.push(d);if(typeof d.originalLine==="number"){this.__originalMappings.push(d)}}}c(this.__generatedMappings,n.compareByGeneratedPositionsDeflated);c(this.__originalMappings,n.compareByOriginalPositions)};i=IndexedSourceMapConsumer},5905:(e,t,r)=>{var i=r(6385);var n=r(9572);var a=r(9837).I;var o=r(8365).H;function SourceMapGenerator(e){if(!e){e={}}this._file=n.getArg(e,"file",null);this._sourceRoot=n.getArg(e,"sourceRoot",null);this._skipValidation=n.getArg(e,"skipValidation",false);this._sources=new a;this._names=new a;this._mappings=new o;this._sourcesContents=null}SourceMapGenerator.prototype._version=3;SourceMapGenerator.fromSourceMap=function SourceMapGenerator_fromSourceMap(e){var t=e.sourceRoot;var r=new SourceMapGenerator({file:e.file,sourceRoot:t});e.eachMapping((function(e){var i={generated:{line:e.generatedLine,column:e.generatedColumn}};if(e.source!=null){i.source=e.source;if(t!=null){i.source=n.relative(t,i.source)}i.original={line:e.originalLine,column:e.originalColumn};if(e.name!=null){i.name=e.name}}r.addMapping(i)}));e.sources.forEach((function(i){var a=i;if(t!==null){a=n.relative(t,i)}if(!r._sources.has(a)){r._sources.add(a)}var o=e.sourceContentFor(i);if(o!=null){r.setSourceContent(i,o)}}));return r};SourceMapGenerator.prototype.addMapping=function SourceMapGenerator_addMapping(e){var t=n.getArg(e,"generated");var r=n.getArg(e,"original",null);var i=n.getArg(e,"source",null);var a=n.getArg(e,"name",null);if(!this._skipValidation){this._validateMapping(t,r,i,a)}if(i!=null){i=String(i);if(!this._sources.has(i)){this._sources.add(i)}}if(a!=null){a=String(a);if(!this._names.has(a)){this._names.add(a)}}this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:r!=null&&r.line,originalColumn:r!=null&&r.column,source:i,name:a})};SourceMapGenerator.prototype.setSourceContent=function SourceMapGenerator_setSourceContent(e,t){var r=e;if(this._sourceRoot!=null){r=n.relative(this._sourceRoot,r)}if(t!=null){if(!this._sourcesContents){this._sourcesContents=Object.create(null)}this._sourcesContents[n.toSetString(r)]=t}else if(this._sourcesContents){delete this._sourcesContents[n.toSetString(r)];if(Object.keys(this._sourcesContents).length===0){this._sourcesContents=null}}};SourceMapGenerator.prototype.applySourceMap=function SourceMapGenerator_applySourceMap(e,t,r){var i=t;if(t==null){if(e.file==null){throw new Error("SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, "+'or the source map\'s "file" property. Both were omitted.')}i=e.file}var o=this._sourceRoot;if(o!=null){i=n.relative(o,i)}var s=new a;var c=new a;this._mappings.unsortedForEach((function(t){if(t.source===i&&t.originalLine!=null){var a=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});if(a.source!=null){t.source=a.source;if(r!=null){t.source=n.join(r,t.source)}if(o!=null){t.source=n.relative(o,t.source)}t.originalLine=a.line;t.originalColumn=a.column;if(a.name!=null){t.name=a.name}}}var u=t.source;if(u!=null&&!s.has(u)){s.add(u)}var l=t.name;if(l!=null&&!c.has(l)){c.add(l)}}),this);this._sources=s;this._names=c;e.sources.forEach((function(t){var i=e.sourceContentFor(t);if(i!=null){if(r!=null){t=n.join(r,t)}if(o!=null){t=n.relative(o,t)}this.setSourceContent(t,i)}}),this)};SourceMapGenerator.prototype._validateMapping=function SourceMapGenerator_validateMapping(e,t,r,i){if(t&&typeof t.line!=="number"&&typeof t.column!=="number"){throw new Error("original.line and original.column are not numbers -- you probably meant to omit "+"the original mapping entirely and only map the generated position. If so, pass "+"null for the original mapping instead of an object with empty or null values.")}if(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!t&&!r&&!i){return}else if(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&r){return}else{throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:t,name:i}))}};SourceMapGenerator.prototype._serializeMappings=function SourceMapGenerator_serializeMappings(){var e=0;var t=1;var r=0;var a=0;var o=0;var s=0;var c="";var u;var l;var d;var h;var p=this._mappings.toArray();for(var v=0,m=p.length;v<m;v++){l=p[v];u="";if(l.generatedLine!==t){e=0;while(l.generatedLine!==t){u+=";";t++}}else{if(v>0){if(!n.compareByGeneratedPositionsInflated(l,p[v-1])){continue}u+=","}}u+=i.encode(l.generatedColumn-e);e=l.generatedColumn;if(l.source!=null){h=this._sources.indexOf(l.source);u+=i.encode(h-s);s=h;u+=i.encode(l.originalLine-1-a);a=l.originalLine-1;u+=i.encode(l.originalColumn-r);r=l.originalColumn;if(l.name!=null){d=this._names.indexOf(l.name);u+=i.encode(d-o);o=d}}c+=u}return c};SourceMapGenerator.prototype._generateSourcesContent=function SourceMapGenerator_generateSourcesContent(e,t){return e.map((function(e){if(!this._sourcesContents){return null}if(t!=null){e=n.relative(t,e)}var r=n.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null}),this)};SourceMapGenerator.prototype.toJSON=function SourceMapGenerator_toJSON(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};if(this._file!=null){e.file=this._file}if(this._sourceRoot!=null){e.sourceRoot=this._sourceRoot}if(this._sourcesContents){e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)}return e};SourceMapGenerator.prototype.toString=function SourceMapGenerator_toString(){return JSON.stringify(this.toJSON())};t.h=SourceMapGenerator},9200:(e,t,r)=>{var i;var n=r(5905).h;var a=r(9572);var o=/(\r?\n)/;var s=10;var c="$$$isSourceNode$$$";function SourceNode(e,t,r,i,n){this.children=[];this.sourceContents={};this.line=e==null?null:e;this.column=t==null?null:t;this.source=r==null?null:r;this.name=n==null?null:n;this[c]=true;if(i!=null)this.add(i)}SourceNode.fromStringWithSourceMap=function SourceNode_fromStringWithSourceMap(e,t,r){var i=new SourceNode;var n=e.split(o);var s=0;var shiftNextLine=function(){var e=getNextLine();var t=getNextLine()||"";return e+t;function getNextLine(){return s<n.length?n[s++]:undefined}};var c=1,u=0;var l=null;t.eachMapping((function(e){if(l!==null){if(c<e.generatedLine){addMappingWithCode(l,shiftNextLine());c++;u=0}else{var t=n[s]||"";var r=t.substr(0,e.generatedColumn-u);n[s]=t.substr(e.generatedColumn-u);u=e.generatedColumn;addMappingWithCode(l,r);l=e;return}}while(c<e.generatedLine){i.add(shiftNextLine());c++}if(u<e.generatedColumn){var t=n[s]||"";i.add(t.substr(0,e.generatedColumn));n[s]=t.substr(e.generatedColumn);u=e.generatedColumn}l=e}),this);if(s<n.length){if(l){addMappingWithCode(l,shiftNextLine())}i.add(n.splice(s).join(""))}t.sources.forEach((function(e){var n=t.sourceContentFor(e);if(n!=null){if(r!=null){e=a.join(r,e)}i.setSourceContent(e,n)}}));return i;function addMappingWithCode(e,t){if(e===null||e.source===undefined){i.add(t)}else{var n=r?a.join(r,e.source):e.source;i.add(new SourceNode(e.originalLine,e.originalColumn,n,t,e.name))}}};SourceNode.prototype.add=function SourceNode_add(e){if(Array.isArray(e)){e.forEach((function(e){this.add(e)}),this)}else if(e[c]||typeof e==="string"){if(e){this.children.push(e)}}else{throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e)}return this};SourceNode.prototype.prepend=function SourceNode_prepend(e){if(Array.isArray(e)){for(var t=e.length-1;t>=0;t--){this.prepend(e[t])}}else if(e[c]||typeof e==="string"){this.children.unshift(e)}else{throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e)}return this};SourceNode.prototype.walk=function SourceNode_walk(e){var t;for(var r=0,i=this.children.length;r<i;r++){t=this.children[r];if(t[c]){t.walk(e)}else{if(t!==""){e(t,{source:this.source,line:this.line,column:this.column,name:this.name})}}}};SourceNode.prototype.join=function SourceNode_join(e){var t;var r;var i=this.children.length;if(i>0){t=[];for(r=0;r<i-1;r++){t.push(this.children[r]);t.push(e)}t.push(this.children[r]);this.children=t}return this};SourceNode.prototype.replaceRight=function SourceNode_replaceRight(e,t){var r=this.children[this.children.length-1];if(r[c]){r.replaceRight(e,t)}else if(typeof r==="string"){this.children[this.children.length-1]=r.replace(e,t)}else{this.children.push("".replace(e,t))}return this};SourceNode.prototype.setSourceContent=function SourceNode_setSourceContent(e,t){this.sourceContents[a.toSetString(e)]=t};SourceNode.prototype.walkSourceContents=function SourceNode_walkSourceContents(e){for(var t=0,r=this.children.length;t<r;t++){if(this.children[t][c]){this.children[t].walkSourceContents(e)}}var i=Object.keys(this.sourceContents);for(var t=0,r=i.length;t<r;t++){e(a.fromSetString(i[t]),this.sourceContents[i[t]])}};SourceNode.prototype.toString=function SourceNode_toString(){var e="";this.walk((function(t){e+=t}));return e};SourceNode.prototype.toStringWithSourceMap=function SourceNode_toStringWithSourceMap(e){var t={code:"",line:1,column:0};var r=new n(e);var i=false;var a=null;var o=null;var c=null;var u=null;this.walk((function(e,n){t.code+=e;if(n.source!==null&&n.line!==null&&n.column!==null){if(a!==n.source||o!==n.line||c!==n.column||u!==n.name){r.addMapping({source:n.source,original:{line:n.line,column:n.column},generated:{line:t.line,column:t.column},name:n.name})}a=n.source;o=n.line;c=n.column;u=n.name;i=true}else if(i){r.addMapping({generated:{line:t.line,column:t.column}});a=null;i=false}for(var l=0,d=e.length;l<d;l++){if(e.charCodeAt(l)===s){t.line++;t.column=0;if(l+1===d){a=null;i=false}else if(i){r.addMapping({source:n.source,original:{line:n.line,column:n.column},generated:{line:t.line,column:t.column},name:n.name})}}else{t.column++}}}));this.walkSourceContents((function(e,t){r.setSourceContent(e,t)}));return{code:t.code,map:r}};i=SourceNode},9572:(e,t)=>{function getArg(e,t,r){if(t in e){return e[t]}else if(arguments.length===3){return r}else{throw new Error('"'+t+'" is a required argument.')}}t.getArg=getArg;var r=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/;var i=/^data:.+\,.+$/;function urlParse(e){var t=e.match(r);if(!t){return null}return{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}}t.urlParse=urlParse;function urlGenerate(e){var t="";if(e.scheme){t+=e.scheme+":"}t+="//";if(e.auth){t+=e.auth+"@"}if(e.host){t+=e.host}if(e.port){t+=":"+e.port}if(e.path){t+=e.path}return t}t.urlGenerate=urlGenerate;function normalize(e){var r=e;var i=urlParse(e);if(i){if(!i.path){return e}r=i.path}var n=t.isAbsolute(r);var a=r.split(/\/+/);for(var o,s=0,c=a.length-1;c>=0;c--){o=a[c];if(o==="."){a.splice(c,1)}else if(o===".."){s++}else if(s>0){if(o===""){a.splice(c+1,s);s=0}else{a.splice(c,2);s--}}}r=a.join("/");if(r===""){r=n?"/":"."}if(i){i.path=r;return urlGenerate(i)}return r}t.normalize=normalize;function join(e,t){if(e===""){e="."}if(t===""){t="."}var r=urlParse(t);var n=urlParse(e);if(n){e=n.path||"/"}if(r&&!r.scheme){if(n){r.scheme=n.scheme}return urlGenerate(r)}if(r||t.match(i)){return t}if(n&&!n.host&&!n.path){n.host=t;return urlGenerate(n)}var a=t.charAt(0)==="/"?t:normalize(e.replace(/\/+$/,"")+"/"+t);if(n){n.path=a;return urlGenerate(n)}return a}t.join=join;t.isAbsolute=function(e){return e.charAt(0)==="/"||r.test(e)};function relative(e,t){if(e===""){e="."}e=e.replace(/\/$/,"");var r=0;while(t.indexOf(e+"/")!==0){var i=e.lastIndexOf("/");if(i<0){return t}e=e.slice(0,i);if(e.match(/^([^\/]+:\/)?\/*$/)){return t}++r}return Array(r+1).join("../")+t.substr(e.length+1)}t.relative=relative;var n=function(){var e=Object.create(null);return!("__proto__"in e)}();function identity(e){return e}function toSetString(e){if(isProtoString(e)){return"$"+e}return e}t.toSetString=n?identity:toSetString;function fromSetString(e){if(isProtoString(e)){return e.slice(1)}return e}t.fromSetString=n?identity:fromSetString;function isProtoString(e){if(!e){return false}var t=e.length;if(t<9){return false}if(e.charCodeAt(t-1)!==95||e.charCodeAt(t-2)!==95||e.charCodeAt(t-3)!==111||e.charCodeAt(t-4)!==116||e.charCodeAt(t-5)!==111||e.charCodeAt(t-6)!==114||e.charCodeAt(t-7)!==112||e.charCodeAt(t-8)!==95||e.charCodeAt(t-9)!==95){return false}for(var r=t-10;r>=0;r--){if(e.charCodeAt(r)!==36){return false}}return true}function compareByOriginalPositions(e,t,r){var i=strcmp(e.source,t.source);if(i!==0){return i}i=e.originalLine-t.originalLine;if(i!==0){return i}i=e.originalColumn-t.originalColumn;if(i!==0||r){return i}i=e.generatedColumn-t.generatedColumn;if(i!==0){return i}i=e.generatedLine-t.generatedLine;if(i!==0){return i}return strcmp(e.name,t.name)}t.compareByOriginalPositions=compareByOriginalPositions;function compareByGeneratedPositionsDeflated(e,t,r){var i=e.generatedLine-t.generatedLine;if(i!==0){return i}i=e.generatedColumn-t.generatedColumn;if(i!==0||r){return i}i=strcmp(e.source,t.source);if(i!==0){return i}i=e.originalLine-t.originalLine;if(i!==0){return i}i=e.originalColumn-t.originalColumn;if(i!==0){return i}return strcmp(e.name,t.name)}t.compareByGeneratedPositionsDeflated=compareByGeneratedPositionsDeflated;function strcmp(e,t){if(e===t){return 0}if(e===null){return 1}if(t===null){return-1}if(e>t){return 1}return-1}function compareByGeneratedPositionsInflated(e,t){var r=e.generatedLine-t.generatedLine;if(r!==0){return r}r=e.generatedColumn-t.generatedColumn;if(r!==0){return r}r=strcmp(e.source,t.source);if(r!==0){return r}r=e.originalLine-t.originalLine;if(r!==0){return r}r=e.originalColumn-t.originalColumn;if(r!==0){return r}return strcmp(e.name,t.name)}t.compareByGeneratedPositionsInflated=compareByGeneratedPositionsInflated;function parseSourceMapInput(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))}t.parseSourceMapInput=parseSourceMapInput;function computeSourceURL(e,t,r){t=t||"";if(e){if(e[e.length-1]!=="/"&&t[0]!=="/"){e+="/"}t=e+t}if(r){var i=urlParse(r);if(!i){throw new Error("sourceMapURL could not be parsed")}if(i.path){var n=i.path.lastIndexOf("/");if(n>=0){i.path=i.path.substring(0,n+1)}}t=join(urlGenerate(i),t)}return normalize(t)}t.computeSourceURL=computeSourceURL},6893:(e,t,r)=>{r(5905).h;t.SourceMapConsumer=r(969).SourceMapConsumer;r(9200)},7607:(e,t,r)=>{var i=r(4306);var n=r(1576).StringDecoder;e.exports=split;function split(e,t,r){var a=new n;var o="";var s=r&&r.maxLength;var c=r&&r.trailing===false?false:true;if("function"===typeof e)t=e,e=null;if(!e)e=/\r?\n/;function emit(e,r){if(t){try{r=t(r)}catch(t){return e.emit("error",t)}if("undefined"!==typeof r)e.queue(r)}else e.queue(r)}function next(t,r){var i=((o!=null?o:"")+r).split(e);o=i.pop();if(s&&o.length>s)return t.emit("error",new Error("maximum buffer reached"));for(var n=0;n<i.length;n++){var a=i[n];emit(t,a)}}return i((function(e){next(this,a.write(e))}),(function(){if(a.end)next(this,a.end());if(c&&o!=null)emit(this,o);this.queue(null)}))}},6659:(e,t,r)=>{var i=r(9376);var n=r(4306);e.exports=function(){var e;if(arguments.length==1&&Array.isArray(arguments[0])){e=arguments[0]}else{e=[].slice.call(arguments)}if(e.length==0)return n();else if(e.length==1)return e[0];var t=e[0],r=e[e.length-1],a=i(t,r);function recurse(e){if(e.length<2)return;e[0].pipe(e[1]);recurse(e.slice(1))}recurse(e);function onerror(){var e=[].slice.call(arguments);e.unshift("error");a.emit.apply(a,e)}for(var o=1;o<e.length-1;o++)e[o].on("error",onerror);return a}},4306:(e,t,r)=>{var i=r(2781);t=e.exports=through;through.through=through;function through(e,t,r){e=e||function(e){this.queue(e)};t=t||function(){this.queue(null)};var n=false,a=false,o=[],s=false;var c=new i;c.readable=c.writable=true;c.paused=false;c.autoDestroy=!(r&&r.autoDestroy===false);c.write=function(t){e.call(this,t);return!c.paused};function drain(){while(o.length&&!c.paused){var e=o.shift();if(null===e)return c.emit("end");else c.emit("data",e)}}c.queue=c.push=function(e){if(s)return c;if(e===null)s=true;o.push(e);drain();return c};c.on("end",(function(){c.readable=false;if(!c.writable&&c.autoDestroy)process.nextTick((function(){c.destroy()}))}));function _end(){c.writable=false;t.call(c);if(!c.readable&&c.autoDestroy)c.destroy()}c.end=function(e){if(n)return;n=true;if(arguments.length)c.write(e);_end();return c};c.destroy=function(){if(a)return;a=true;n=true;o.length=0;c.writable=c.readable=false;c.emit("close");return c};c.pause=function(){if(c.paused)return;c.paused=true;return c};c.resume=function(){if(c.paused){c.paused=false;c.emit("resume")}drain();if(!c.paused)c.emit("drain");return c};return c}},1303:e=>{"use strict";var t=nextTickArgs;process.nextTick(upgrade,42);e.exports=thunky;function thunky(e){var r=run;return thunk;function thunk(e){r(e||noop)}function run(i){var n=[i];r=wait;e(done);function wait(e){n.push(e)}function done(e){var i=arguments;r=isError(e)?run:finished;while(n.length)finished(n.shift());function finished(e){t(apply,e,i)}}}}function isError(e){return Object.prototype.toString.call(e)==="[object Error]"}function noop(){}function apply(e,t){e.apply(null,t)}function upgrade(e){if(e===42)t=process.nextTick}function nextTickArgs(e,t,r){process.nextTick((function(){e(t,r)}))}},6867:e=>{var t;var r;var i;var n;var a;var o;var s;var c;var u;var l;var d;var h;var p;var v;var m;var g;var y;var C;var T;var E;var D;var _;var I;var b;var w;(function(t){var r=typeof global==="object"?global:typeof self==="object"?self:typeof this==="object"?this:{};if(typeof define==="function"&&define.amd){define("tslib",["exports"],(function(e){t(createExporter(r,createExporter(e)))}))}else if(true&&typeof e.exports==="object"){t(createExporter(r,createExporter(e.exports)))}else{t(createExporter(r))}function createExporter(e,t){if(e!==r){if(typeof Object.create==="function"){Object.defineProperty(e,"__esModule",{value:true})}else{e.__esModule=true}}return function(r,i){return e[r]=t?t(r,i):i}}})((function(e){var R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[r]=t[r]};t=function(e,t){if(typeof t!=="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");R(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)};r=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]}return e};i=function(e,t){var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0)r[i]=e[i];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++){if(t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n]))r[i[n]]=e[i[n]]}return r};n=function(e,t,r,i){var n=arguments.length,a=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,r):i,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)if(o=e[s])a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a;return n>3&&a&&Object.defineProperty(t,r,a),a};a=function(e,t){return function(r,i){t(r,i,e)}};o=function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};s=function(e,t,r,i){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,n){function fulfilled(e){try{step(i.next(e))}catch(e){n(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){n(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};c=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,n,a,o;return o={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(s){if(i)throw new TypeError("Generator is already executing.");while(o&&(o=0,s[0]&&(r=0)),r)try{if(i=1,n&&(a=s[0]&2?n["return"]:s[0]?n["throw"]||((a=n["return"])&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;if(n=0,a)s=[s[0]&2,a.value];switch(s[0]){case 0:case 1:a=s;break;case 4:r.label++;return{value:s[1],done:false};case 5:r.label++;n=s[1];s=[0];continue;case 7:s=r.ops.pop();r.trys.pop();continue;default:if(!(a=r.trys,a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){r.label=s[1];break}if(s[0]===6&&r.label<a[1]){r.label=a[1];a=s;break}if(a&&r.label<a[2]){r.label=a[2];r.ops.push(s);break}if(a[2])r.ops.pop();r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e];n=0}finally{i=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};u=function(e,t){for(var r in e)if(r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r))w(t,e,r)};w=Object.create?function(e,t,r,i){if(i===undefined)i=r;var n=Object.getOwnPropertyDescriptor(t,r);if(!n||("get"in n?!t.__esModule:n.writable||n.configurable)){n={enumerable:true,get:function(){return t[r]}}}Object.defineProperty(e,i,n)}:function(e,t,r,i){if(i===undefined)i=r;e[i]=t[r]};l=function(e){var t=typeof Symbol==="function"&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&typeof e.length==="number")return{next:function(){if(e&&i>=e.length)e=void 0;return{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};d=function(e,t){var r=typeof Symbol==="function"&&e[Symbol.iterator];if(!r)return e;var i=r.call(e),n,a=[],o;try{while((t===void 0||t-- >0)&&!(n=i.next()).done)a.push(n.value)}catch(e){o={error:e}}finally{try{if(n&&!n.done&&(r=i["return"]))r.call(i)}finally{if(o)throw o.error}}return a};h=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e};p=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),n=0,t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,n++)i[n]=a[o];return i};v=function(e,t,r){if(r||arguments.length===2)for(var i=0,n=t.length,a;i<n;i++){if(a||!(i in t)){if(!a)a=Array.prototype.slice.call(t,0,i);a[i]=t[i]}}return e.concat(a||Array.prototype.slice.call(t))};m=function(e){return this instanceof m?(this.v=e,this):new m(e)};g=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(e,t||[]),n,a=[];return n={},verb("next"),verb("throw"),verb("return"),n[Symbol.asyncIterator]=function(){return this},n;function verb(e){if(i[e])n[e]=function(t){return new Promise((function(r,i){a.push([e,t,r,i])>1||resume(e,t)}))}}function resume(e,t){try{step(i[e](t))}catch(e){settle(a[0][3],e)}}function step(e){e.value instanceof m?Promise.resolve(e.value.v).then(fulfill,reject):settle(a[0][2],e)}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){if(e(t),a.shift(),a.length)resume(a[0][0],a[0][1])}};y=function(e){var t,r;return t={},verb("next"),verb("throw",(function(e){throw e})),verb("return"),t[Symbol.iterator]=function(){return this},t;function verb(i,n){t[i]=e[i]?function(t){return(r=!r)?{value:m(e[i](t)),done:i==="return"}:n?n(t):t}:n}};C=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof l==="function"?l(e):e[Symbol.iterator](),r={},verb("next"),verb("throw"),verb("return"),r[Symbol.asyncIterator]=function(){return this},r);function verb(t){r[t]=e[t]&&function(r){return new Promise((function(i,n){r=e[t](r),settle(i,n,r.done,r.value)}))}}function settle(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)}};T=function(e,t){if(Object.defineProperty){Object.defineProperty(e,"raw",{value:t})}else{e.raw=t}return e};var N=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t};E=function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(r!=="default"&&Object.prototype.hasOwnProperty.call(e,r))w(t,e,r);N(t,e);return t};D=function(e){return e&&e.__esModule?e:{default:e}};_=function(e,t,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t==="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(e):i?i.value:t.get(e)};I=function(e,t,r,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t==="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r};b=function(e,t){if(t===null||typeof t!=="object"&&typeof t!=="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e==="function"?t===e:e.has(t)};e("__extends",t);e("__assign",r);e("__rest",i);e("__decorate",n);e("__param",a);e("__metadata",o);e("__awaiter",s);e("__generator",c);e("__exportStar",u);e("__createBinding",w);e("__values",l);e("__read",d);e("__spread",h);e("__spreadArrays",p);e("__spreadArray",v);e("__await",m);e("__asyncGenerator",g);e("__asyncDelegator",y);e("__asyncValues",C);e("__makeTemplateObject",T);e("__importStar",E);e("__importDefault",D);e("__classPrivateFieldGet",_);e("__classPrivateFieldSet",I);e("__classPrivateFieldIn",b)}))},326:(e,t,r)=>{(function(e){"use strict";var gf=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r};var randombytes=function(){throw new Error("no PRNG")};var t=new Uint8Array(16);var i=new Uint8Array(32);i[0]=9;var n=gf(),a=gf([1]),o=gf([56129,1]),s=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),d=gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ts64(e,t,r,i){e[t]=r>>24&255;e[t+1]=r>>16&255;e[t+2]=r>>8&255;e[t+3]=r&255;e[t+4]=i>>24&255;e[t+5]=i>>16&255;e[t+6]=i>>8&255;e[t+7]=i&255}function vn(e,t,r,i,n){var a,o=0;for(a=0;a<n;a++)o|=e[t+a]^r[i+a];return(1&o-1>>>8)-1}function crypto_verify_16(e,t,r,i){return vn(e,t,r,i,16)}function crypto_verify_32(e,t,r,i){return vn(e,t,r,i,32)}function core_salsa20(e,t,r,i){var n=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,a=r[0]&255|(r[1]&255)<<8|(r[2]&255)<<16|(r[3]&255)<<24,o=r[4]&255|(r[5]&255)<<8|(r[6]&255)<<16|(r[7]&255)<<24,s=r[8]&255|(r[9]&255)<<8|(r[10]&255)<<16|(r[11]&255)<<24,c=r[12]&255|(r[13]&255)<<8|(r[14]&255)<<16|(r[15]&255)<<24,u=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,l=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,d=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,h=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,p=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,v=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,m=r[16]&255|(r[17]&255)<<8|(r[18]&255)<<16|(r[19]&255)<<24,g=r[20]&255|(r[21]&255)<<8|(r[22]&255)<<16|(r[23]&255)<<24,y=r[24]&255|(r[25]&255)<<8|(r[26]&255)<<16|(r[27]&255)<<24,C=r[28]&255|(r[29]&255)<<8|(r[30]&255)<<16|(r[31]&255)<<24,T=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24;var E=n,D=a,_=o,I=s,b=c,w=u,R=l,N=d,U=h,P=p,O=v,L=m,B=g,x=y,k=C,V=T,H;for(var j=0;j<20;j+=2){H=E+B|0;b^=H<<7|H>>>32-7;H=b+E|0;U^=H<<9|H>>>32-9;H=U+b|0;B^=H<<13|H>>>32-13;H=B+U|0;E^=H<<18|H>>>32-18;H=w+D|0;P^=H<<7|H>>>32-7;H=P+w|0;x^=H<<9|H>>>32-9;H=x+P|0;D^=H<<13|H>>>32-13;H=D+x|0;w^=H<<18|H>>>32-18;H=O+R|0;k^=H<<7|H>>>32-7;H=k+O|0;_^=H<<9|H>>>32-9;H=_+k|0;R^=H<<13|H>>>32-13;H=R+_|0;O^=H<<18|H>>>32-18;H=V+L|0;I^=H<<7|H>>>32-7;H=I+V|0;N^=H<<9|H>>>32-9;H=N+I|0;L^=H<<13|H>>>32-13;H=L+N|0;V^=H<<18|H>>>32-18;H=E+I|0;D^=H<<7|H>>>32-7;H=D+E|0;_^=H<<9|H>>>32-9;H=_+D|0;I^=H<<13|H>>>32-13;H=I+_|0;E^=H<<18|H>>>32-18;H=w+b|0;R^=H<<7|H>>>32-7;H=R+w|0;N^=H<<9|H>>>32-9;H=N+R|0;b^=H<<13|H>>>32-13;H=b+N|0;w^=H<<18|H>>>32-18;H=O+P|0;L^=H<<7|H>>>32-7;H=L+O|0;U^=H<<9|H>>>32-9;H=U+L|0;P^=H<<13|H>>>32-13;H=P+U|0;O^=H<<18|H>>>32-18;H=V+k|0;B^=H<<7|H>>>32-7;H=B+V|0;x^=H<<9|H>>>32-9;H=x+B|0;k^=H<<13|H>>>32-13;H=k+x|0;V^=H<<18|H>>>32-18}E=E+n|0;D=D+a|0;_=_+o|0;I=I+s|0;b=b+c|0;w=w+u|0;R=R+l|0;N=N+d|0;U=U+h|0;P=P+p|0;O=O+v|0;L=L+m|0;B=B+g|0;x=x+y|0;k=k+C|0;V=V+T|0;e[0]=E>>>0&255;e[1]=E>>>8&255;e[2]=E>>>16&255;e[3]=E>>>24&255;e[4]=D>>>0&255;e[5]=D>>>8&255;e[6]=D>>>16&255;e[7]=D>>>24&255;e[8]=_>>>0&255;e[9]=_>>>8&255;e[10]=_>>>16&255;e[11]=_>>>24&255;e[12]=I>>>0&255;e[13]=I>>>8&255;e[14]=I>>>16&255;e[15]=I>>>24&255;e[16]=b>>>0&255;e[17]=b>>>8&255;e[18]=b>>>16&255;e[19]=b>>>24&255;e[20]=w>>>0&255;e[21]=w>>>8&255;e[22]=w>>>16&255;e[23]=w>>>24&255;e[24]=R>>>0&255;e[25]=R>>>8&255;e[26]=R>>>16&255;e[27]=R>>>24&255;e[28]=N>>>0&255;e[29]=N>>>8&255;e[30]=N>>>16&255;e[31]=N>>>24&255;e[32]=U>>>0&255;e[33]=U>>>8&255;e[34]=U>>>16&255;e[35]=U>>>24&255;e[36]=P>>>0&255;e[37]=P>>>8&255;e[38]=P>>>16&255;e[39]=P>>>24&255;e[40]=O>>>0&255;e[41]=O>>>8&255;e[42]=O>>>16&255;e[43]=O>>>24&255;e[44]=L>>>0&255;e[45]=L>>>8&255;e[46]=L>>>16&255;e[47]=L>>>24&255;e[48]=B>>>0&255;e[49]=B>>>8&255;e[50]=B>>>16&255;e[51]=B>>>24&255;e[52]=x>>>0&255;e[53]=x>>>8&255;e[54]=x>>>16&255;e[55]=x>>>24&255;e[56]=k>>>0&255;e[57]=k>>>8&255;e[58]=k>>>16&255;e[59]=k>>>24&255;e[60]=V>>>0&255;e[61]=V>>>8&255;e[62]=V>>>16&255;e[63]=V>>>24&255}function core_hsalsa20(e,t,r,i){var n=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,a=r[0]&255|(r[1]&255)<<8|(r[2]&255)<<16|(r[3]&255)<<24,o=r[4]&255|(r[5]&255)<<8|(r[6]&255)<<16|(r[7]&255)<<24,s=r[8]&255|(r[9]&255)<<8|(r[10]&255)<<16|(r[11]&255)<<24,c=r[12]&255|(r[13]&255)<<8|(r[14]&255)<<16|(r[15]&255)<<24,u=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,l=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,d=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,h=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,p=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,v=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,m=r[16]&255|(r[17]&255)<<8|(r[18]&255)<<16|(r[19]&255)<<24,g=r[20]&255|(r[21]&255)<<8|(r[22]&255)<<16|(r[23]&255)<<24,y=r[24]&255|(r[25]&255)<<8|(r[26]&255)<<16|(r[27]&255)<<24,C=r[28]&255|(r[29]&255)<<8|(r[30]&255)<<16|(r[31]&255)<<24,T=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24;var E=n,D=a,_=o,I=s,b=c,w=u,R=l,N=d,U=h,P=p,O=v,L=m,B=g,x=y,k=C,V=T,H;for(var j=0;j<20;j+=2){H=E+B|0;b^=H<<7|H>>>32-7;H=b+E|0;U^=H<<9|H>>>32-9;H=U+b|0;B^=H<<13|H>>>32-13;H=B+U|0;E^=H<<18|H>>>32-18;H=w+D|0;P^=H<<7|H>>>32-7;H=P+w|0;x^=H<<9|H>>>32-9;H=x+P|0;D^=H<<13|H>>>32-13;H=D+x|0;w^=H<<18|H>>>32-18;H=O+R|0;k^=H<<7|H>>>32-7;H=k+O|0;_^=H<<9|H>>>32-9;H=_+k|0;R^=H<<13|H>>>32-13;H=R+_|0;O^=H<<18|H>>>32-18;H=V+L|0;I^=H<<7|H>>>32-7;H=I+V|0;N^=H<<9|H>>>32-9;H=N+I|0;L^=H<<13|H>>>32-13;H=L+N|0;V^=H<<18|H>>>32-18;H=E+I|0;D^=H<<7|H>>>32-7;H=D+E|0;_^=H<<9|H>>>32-9;H=_+D|0;I^=H<<13|H>>>32-13;H=I+_|0;E^=H<<18|H>>>32-18;H=w+b|0;R^=H<<7|H>>>32-7;H=R+w|0;N^=H<<9|H>>>32-9;H=N+R|0;b^=H<<13|H>>>32-13;H=b+N|0;w^=H<<18|H>>>32-18;H=O+P|0;L^=H<<7|H>>>32-7;H=L+O|0;U^=H<<9|H>>>32-9;H=U+L|0;P^=H<<13|H>>>32-13;H=P+U|0;O^=H<<18|H>>>32-18;H=V+k|0;B^=H<<7|H>>>32-7;H=B+V|0;x^=H<<9|H>>>32-9;H=x+B|0;k^=H<<13|H>>>32-13;H=k+x|0;V^=H<<18|H>>>32-18}e[0]=E>>>0&255;e[1]=E>>>8&255;e[2]=E>>>16&255;e[3]=E>>>24&255;e[4]=w>>>0&255;e[5]=w>>>8&255;e[6]=w>>>16&255;e[7]=w>>>24&255;e[8]=O>>>0&255;e[9]=O>>>8&255;e[10]=O>>>16&255;e[11]=O>>>24&255;e[12]=V>>>0&255;e[13]=V>>>8&255;e[14]=V>>>16&255;e[15]=V>>>24&255;e[16]=R>>>0&255;e[17]=R>>>8&255;e[18]=R>>>16&255;e[19]=R>>>24&255;e[20]=N>>>0&255;e[21]=N>>>8&255;e[22]=N>>>16&255;e[23]=N>>>24&255;e[24]=U>>>0&255;e[25]=U>>>8&255;e[26]=U>>>16&255;e[27]=U>>>24&255;e[28]=P>>>0&255;e[29]=P>>>8&255;e[30]=P>>>16&255;e[31]=P>>>24&255}function crypto_core_salsa20(e,t,r,i){core_salsa20(e,t,r,i)}function crypto_core_hsalsa20(e,t,r,i){core_hsalsa20(e,t,r,i)}var h=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function crypto_stream_salsa20_xor(e,t,r,i,n,a,o){var s=new Uint8Array(16),c=new Uint8Array(64);var u,l;for(l=0;l<16;l++)s[l]=0;for(l=0;l<8;l++)s[l]=a[l];while(n>=64){crypto_core_salsa20(c,s,o,h);for(l=0;l<64;l++)e[t+l]=r[i+l]^c[l];u=1;for(l=8;l<16;l++){u=u+(s[l]&255)|0;s[l]=u&255;u>>>=8}n-=64;t+=64;i+=64}if(n>0){crypto_core_salsa20(c,s,o,h);for(l=0;l<n;l++)e[t+l]=r[i+l]^c[l]}return 0}function crypto_stream_salsa20(e,t,r,i,n){var a=new Uint8Array(16),o=new Uint8Array(64);var s,c;for(c=0;c<16;c++)a[c]=0;for(c=0;c<8;c++)a[c]=i[c];while(r>=64){crypto_core_salsa20(o,a,n,h);for(c=0;c<64;c++)e[t+c]=o[c];s=1;for(c=8;c<16;c++){s=s+(a[c]&255)|0;a[c]=s&255;s>>>=8}r-=64;t+=64}if(r>0){crypto_core_salsa20(o,a,n,h);for(c=0;c<r;c++)e[t+c]=o[c]}return 0}function crypto_stream(e,t,r,i,n){var a=new Uint8Array(32);crypto_core_hsalsa20(a,i,n,h);var o=new Uint8Array(8);for(var s=0;s<8;s++)o[s]=i[s+16];return crypto_stream_salsa20(e,t,r,o,a)}function crypto_stream_xor(e,t,r,i,n,a,o){var s=new Uint8Array(32);crypto_core_hsalsa20(s,a,o,h);var c=new Uint8Array(8);for(var u=0;u<8;u++)c[u]=a[u+16];return crypto_stream_salsa20_xor(e,t,r,i,n,c,s)}var poly1305=function(e){this.buffer=new Uint8Array(16);this.r=new Uint16Array(10);this.h=new Uint16Array(10);this.pad=new Uint16Array(8);this.leftover=0;this.fin=0;var t,r,i,n,a,o,s,c;t=e[0]&255|(e[1]&255)<<8;this.r[0]=t&8191;r=e[2]&255|(e[3]&255)<<8;this.r[1]=(t>>>13|r<<3)&8191;i=e[4]&255|(e[5]&255)<<8;this.r[2]=(r>>>10|i<<6)&7939;n=e[6]&255|(e[7]&255)<<8;this.r[3]=(i>>>7|n<<9)&8191;a=e[8]&255|(e[9]&255)<<8;this.r[4]=(n>>>4|a<<12)&255;this.r[5]=a>>>1&8190;o=e[10]&255|(e[11]&255)<<8;this.r[6]=(a>>>14|o<<2)&8191;s=e[12]&255|(e[13]&255)<<8;this.r[7]=(o>>>11|s<<5)&8065;c=e[14]&255|(e[15]&255)<<8;this.r[8]=(s>>>8|c<<8)&8191;this.r[9]=c>>>5&127;this.pad[0]=e[16]&255|(e[17]&255)<<8;this.pad[1]=e[18]&255|(e[19]&255)<<8;this.pad[2]=e[20]&255|(e[21]&255)<<8;this.pad[3]=e[22]&255|(e[23]&255)<<8;this.pad[4]=e[24]&255|(e[25]&255)<<8;this.pad[5]=e[26]&255|(e[27]&255)<<8;this.pad[6]=e[28]&255|(e[29]&255)<<8;this.pad[7]=e[30]&255|(e[31]&255)<<8};poly1305.prototype.blocks=function(e,t,r){var i=this.fin?0:1<<11;var n,a,o,s,c,u,l,d,h;var p,v,m,g,y,C,T,E,D,_;var I=this.h[0],b=this.h[1],w=this.h[2],R=this.h[3],N=this.h[4],U=this.h[5],P=this.h[6],O=this.h[7],L=this.h[8],B=this.h[9];var x=this.r[0],k=this.r[1],V=this.r[2],H=this.r[3],j=this.r[4],W=this.r[5],G=this.r[6],X=this.r[7],q=this.r[8],Y=this.r[9];while(r>=16){n=e[t+0]&255|(e[t+1]&255)<<8;I+=n&8191;a=e[t+2]&255|(e[t+3]&255)<<8;b+=(n>>>13|a<<3)&8191;o=e[t+4]&255|(e[t+5]&255)<<8;w+=(a>>>10|o<<6)&8191;s=e[t+6]&255|(e[t+7]&255)<<8;R+=(o>>>7|s<<9)&8191;c=e[t+8]&255|(e[t+9]&255)<<8;N+=(s>>>4|c<<12)&8191;U+=c>>>1&8191;u=e[t+10]&255|(e[t+11]&255)<<8;P+=(c>>>14|u<<2)&8191;l=e[t+12]&255|(e[t+13]&255)<<8;O+=(u>>>11|l<<5)&8191;d=e[t+14]&255|(e[t+15]&255)<<8;L+=(l>>>8|d<<8)&8191;B+=d>>>5|i;h=0;p=h;p+=I*x;p+=b*(5*Y);p+=w*(5*q);p+=R*(5*X);p+=N*(5*G);h=p>>>13;p&=8191;p+=U*(5*W);p+=P*(5*j);p+=O*(5*H);p+=L*(5*V);p+=B*(5*k);h+=p>>>13;p&=8191;v=h;v+=I*k;v+=b*x;v+=w*(5*Y);v+=R*(5*q);v+=N*(5*X);h=v>>>13;v&=8191;v+=U*(5*G);v+=P*(5*W);v+=O*(5*j);v+=L*(5*H);v+=B*(5*V);h+=v>>>13;v&=8191;m=h;m+=I*V;m+=b*k;m+=w*x;m+=R*(5*Y);m+=N*(5*q);h=m>>>13;m&=8191;m+=U*(5*X);m+=P*(5*G);m+=O*(5*W);m+=L*(5*j);m+=B*(5*H);h+=m>>>13;m&=8191;g=h;g+=I*H;g+=b*V;g+=w*k;g+=R*x;g+=N*(5*Y);h=g>>>13;g&=8191;g+=U*(5*q);g+=P*(5*X);g+=O*(5*G);g+=L*(5*W);g+=B*(5*j);h+=g>>>13;g&=8191;y=h;y+=I*j;y+=b*H;y+=w*V;y+=R*k;y+=N*x;h=y>>>13;y&=8191;y+=U*(5*Y);y+=P*(5*q);y+=O*(5*X);y+=L*(5*G);y+=B*(5*W);h+=y>>>13;y&=8191;C=h;C+=I*W;C+=b*j;C+=w*H;C+=R*V;C+=N*k;h=C>>>13;C&=8191;C+=U*x;C+=P*(5*Y);C+=O*(5*q);C+=L*(5*X);C+=B*(5*G);h+=C>>>13;C&=8191;T=h;T+=I*G;T+=b*W;T+=w*j;T+=R*H;T+=N*V;h=T>>>13;T&=8191;T+=U*k;T+=P*x;T+=O*(5*Y);T+=L*(5*q);T+=B*(5*X);h+=T>>>13;T&=8191;E=h;E+=I*X;E+=b*G;E+=w*W;E+=R*j;E+=N*H;h=E>>>13;E&=8191;E+=U*V;E+=P*k;E+=O*x;E+=L*(5*Y);E+=B*(5*q);h+=E>>>13;E&=8191;D=h;D+=I*q;D+=b*X;D+=w*G;D+=R*W;D+=N*j;h=D>>>13;D&=8191;D+=U*H;D+=P*V;D+=O*k;D+=L*x;D+=B*(5*Y);h+=D>>>13;D&=8191;_=h;_+=I*Y;_+=b*q;_+=w*X;_+=R*G;_+=N*W;h=_>>>13;_&=8191;_+=U*j;_+=P*H;_+=O*V;_+=L*k;_+=B*x;h+=_>>>13;_&=8191;h=(h<<2)+h|0;h=h+p|0;p=h&8191;h=h>>>13;v+=h;I=p;b=v;w=m;R=g;N=y;U=C;P=T;O=E;L=D;B=_;t+=16;r-=16}this.h[0]=I;this.h[1]=b;this.h[2]=w;this.h[3]=R;this.h[4]=N;this.h[5]=U;this.h[6]=P;this.h[7]=O;this.h[8]=L;this.h[9]=B};poly1305.prototype.finish=function(e,t){var r=new Uint16Array(10);var i,n,a,o;if(this.leftover){o=this.leftover;this.buffer[o++]=1;for(;o<16;o++)this.buffer[o]=0;this.fin=1;this.blocks(this.buffer,0,16)}i=this.h[1]>>>13;this.h[1]&=8191;for(o=2;o<10;o++){this.h[o]+=i;i=this.h[o]>>>13;this.h[o]&=8191}this.h[0]+=i*5;i=this.h[0]>>>13;this.h[0]&=8191;this.h[1]+=i;i=this.h[1]>>>13;this.h[1]&=8191;this.h[2]+=i;r[0]=this.h[0]+5;i=r[0]>>>13;r[0]&=8191;for(o=1;o<10;o++){r[o]=this.h[o]+i;i=r[o]>>>13;r[o]&=8191}r[9]-=1<<13;n=(i^1)-1;for(o=0;o<10;o++)r[o]&=n;n=~n;for(o=0;o<10;o++)this.h[o]=this.h[o]&n|r[o];this.h[0]=(this.h[0]|this.h[1]<<13)&65535;this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535;this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535;this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535;this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535;this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535;this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535;this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535;a=this.h[0]+this.pad[0];this.h[0]=a&65535;for(o=1;o<8;o++){a=(this.h[o]+this.pad[o]|0)+(a>>>16)|0;this.h[o]=a&65535}e[t+0]=this.h[0]>>>0&255;e[t+1]=this.h[0]>>>8&255;e[t+2]=this.h[1]>>>0&255;e[t+3]=this.h[1]>>>8&255;e[t+4]=this.h[2]>>>0&255;e[t+5]=this.h[2]>>>8&255;e[t+6]=this.h[3]>>>0&255;e[t+7]=this.h[3]>>>8&255;e[t+8]=this.h[4]>>>0&255;e[t+9]=this.h[4]>>>8&255;e[t+10]=this.h[5]>>>0&255;e[t+11]=this.h[5]>>>8&255;e[t+12]=this.h[6]>>>0&255;e[t+13]=this.h[6]>>>8&255;e[t+14]=this.h[7]>>>0&255;e[t+15]=this.h[7]>>>8&255};poly1305.prototype.update=function(e,t,r){var i,n;if(this.leftover){n=16-this.leftover;if(n>r)n=r;for(i=0;i<n;i++)this.buffer[this.leftover+i]=e[t+i];r-=n;t+=n;this.leftover+=n;if(this.leftover<16)return;this.blocks(this.buffer,0,16);this.leftover=0}if(r>=16){n=r-r%16;this.blocks(e,t,n);t+=n;r-=n}if(r){for(i=0;i<r;i++)this.buffer[this.leftover+i]=e[t+i];this.leftover+=r}};function crypto_onetimeauth(e,t,r,i,n,a){var o=new poly1305(a);o.update(r,i,n);o.finish(e,t);return 0}function crypto_onetimeauth_verify(e,t,r,i,n,a){var o=new Uint8Array(16);crypto_onetimeauth(o,0,r,i,n,a);return crypto_verify_16(e,t,o,0)}function crypto_secretbox(e,t,r,i,n){var a;if(r<32)return-1;crypto_stream_xor(e,0,t,0,r,i,n);crypto_onetimeauth(e,16,e,32,r-32,e);for(a=0;a<16;a++)e[a]=0;return 0}function crypto_secretbox_open(e,t,r,i,n){var a;var o=new Uint8Array(32);if(r<32)return-1;crypto_stream(o,0,32,i,n);if(crypto_onetimeauth_verify(t,16,t,32,r-32,o)!==0)return-1;crypto_stream_xor(e,0,t,0,r,i,n);for(a=0;a<32;a++)e[a]=0;return 0}function set25519(e,t){var r;for(r=0;r<16;r++)e[r]=t[r]|0}function car25519(e){var t,r,i=1;for(t=0;t<16;t++){r=e[t]+i+65535;i=Math.floor(r/65536);e[t]=r-i*65536}e[0]+=i-1+37*(i-1)}function sel25519(e,t,r){var i,n=~(r-1);for(var a=0;a<16;a++){i=n&(e[a]^t[a]);e[a]^=i;t[a]^=i}}function pack25519(e,t){var r,i,n;var a=gf(),o=gf();for(r=0;r<16;r++)o[r]=t[r];car25519(o);car25519(o);car25519(o);for(i=0;i<2;i++){a[0]=o[0]-65517;for(r=1;r<15;r++){a[r]=o[r]-65535-(a[r-1]>>16&1);a[r-1]&=65535}a[15]=o[15]-32767-(a[14]>>16&1);n=a[15]>>16&1;a[14]&=65535;sel25519(o,a,1-n)}for(r=0;r<16;r++){e[2*r]=o[r]&255;e[2*r+1]=o[r]>>8}}function neq25519(e,t){var r=new Uint8Array(32),i=new Uint8Array(32);pack25519(r,e);pack25519(i,t);return crypto_verify_32(r,0,i,0)}function par25519(e){var t=new Uint8Array(32);pack25519(t,e);return t[0]&1}function unpack25519(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function A(e,t,r){for(var i=0;i<16;i++)e[i]=t[i]+r[i]}function Z(e,t,r){for(var i=0;i<16;i++)e[i]=t[i]-r[i]}function M(e,t,r){var i,n,a=0,o=0,s=0,c=0,u=0,l=0,d=0,h=0,p=0,v=0,m=0,g=0,y=0,C=0,T=0,E=0,D=0,_=0,I=0,b=0,w=0,R=0,N=0,U=0,P=0,O=0,L=0,B=0,x=0,k=0,V=0,H=r[0],j=r[1],W=r[2],G=r[3],X=r[4],q=r[5],Y=r[6],K=r[7],$=r[8],z=r[9],J=r[10],ee=r[11],te=r[12],re=r[13],ie=r[14],ne=r[15];i=t[0];a+=i*H;o+=i*j;s+=i*W;c+=i*G;u+=i*X;l+=i*q;d+=i*Y;h+=i*K;p+=i*$;v+=i*z;m+=i*J;g+=i*ee;y+=i*te;C+=i*re;T+=i*ie;E+=i*ne;i=t[1];o+=i*H;s+=i*j;c+=i*W;u+=i*G;l+=i*X;d+=i*q;h+=i*Y;p+=i*K;v+=i*$;m+=i*z;g+=i*J;y+=i*ee;C+=i*te;T+=i*re;E+=i*ie;D+=i*ne;i=t[2];s+=i*H;c+=i*j;u+=i*W;l+=i*G;d+=i*X;h+=i*q;p+=i*Y;v+=i*K;m+=i*$;g+=i*z;y+=i*J;C+=i*ee;T+=i*te;E+=i*re;D+=i*ie;_+=i*ne;i=t[3];c+=i*H;u+=i*j;l+=i*W;d+=i*G;h+=i*X;p+=i*q;v+=i*Y;m+=i*K;g+=i*$;y+=i*z;C+=i*J;T+=i*ee;E+=i*te;D+=i*re;_+=i*ie;I+=i*ne;i=t[4];u+=i*H;l+=i*j;d+=i*W;h+=i*G;p+=i*X;v+=i*q;m+=i*Y;g+=i*K;y+=i*$;C+=i*z;T+=i*J;E+=i*ee;D+=i*te;_+=i*re;I+=i*ie;b+=i*ne;i=t[5];l+=i*H;d+=i*j;h+=i*W;p+=i*G;v+=i*X;m+=i*q;g+=i*Y;y+=i*K;C+=i*$;T+=i*z;E+=i*J;D+=i*ee;_+=i*te;I+=i*re;b+=i*ie;w+=i*ne;i=t[6];d+=i*H;h+=i*j;p+=i*W;v+=i*G;m+=i*X;g+=i*q;y+=i*Y;C+=i*K;T+=i*$;E+=i*z;D+=i*J;_+=i*ee;I+=i*te;b+=i*re;w+=i*ie;R+=i*ne;i=t[7];h+=i*H;p+=i*j;v+=i*W;m+=i*G;g+=i*X;y+=i*q;C+=i*Y;T+=i*K;E+=i*$;D+=i*z;_+=i*J;I+=i*ee;b+=i*te;w+=i*re;R+=i*ie;N+=i*ne;i=t[8];p+=i*H;v+=i*j;m+=i*W;g+=i*G;y+=i*X;C+=i*q;T+=i*Y;E+=i*K;D+=i*$;_+=i*z;I+=i*J;b+=i*ee;w+=i*te;R+=i*re;N+=i*ie;U+=i*ne;i=t[9];v+=i*H;m+=i*j;g+=i*W;y+=i*G;C+=i*X;T+=i*q;E+=i*Y;D+=i*K;_+=i*$;I+=i*z;b+=i*J;w+=i*ee;R+=i*te;N+=i*re;U+=i*ie;P+=i*ne;i=t[10];m+=i*H;g+=i*j;y+=i*W;C+=i*G;T+=i*X;E+=i*q;D+=i*Y;_+=i*K;I+=i*$;b+=i*z;w+=i*J;R+=i*ee;N+=i*te;U+=i*re;P+=i*ie;O+=i*ne;i=t[11];g+=i*H;y+=i*j;C+=i*W;T+=i*G;E+=i*X;D+=i*q;_+=i*Y;I+=i*K;b+=i*$;w+=i*z;R+=i*J;N+=i*ee;U+=i*te;P+=i*re;O+=i*ie;L+=i*ne;i=t[12];y+=i*H;C+=i*j;T+=i*W;E+=i*G;D+=i*X;_+=i*q;I+=i*Y;b+=i*K;w+=i*$;R+=i*z;N+=i*J;U+=i*ee;P+=i*te;O+=i*re;L+=i*ie;B+=i*ne;i=t[13];C+=i*H;T+=i*j;E+=i*W;D+=i*G;_+=i*X;I+=i*q;b+=i*Y;w+=i*K;R+=i*$;N+=i*z;U+=i*J;P+=i*ee;O+=i*te;L+=i*re;B+=i*ie;x+=i*ne;i=t[14];T+=i*H;E+=i*j;D+=i*W;_+=i*G;I+=i*X;b+=i*q;w+=i*Y;R+=i*K;N+=i*$;U+=i*z;P+=i*J;O+=i*ee;L+=i*te;B+=i*re;x+=i*ie;k+=i*ne;i=t[15];E+=i*H;D+=i*j;_+=i*W;I+=i*G;b+=i*X;w+=i*q;R+=i*Y;N+=i*K;U+=i*$;P+=i*z;O+=i*J;L+=i*ee;B+=i*te;x+=i*re;k+=i*ie;V+=i*ne;a+=38*D;o+=38*_;s+=38*I;c+=38*b;u+=38*w;l+=38*R;d+=38*N;h+=38*U;p+=38*P;v+=38*O;m+=38*L;g+=38*B;y+=38*x;C+=38*k;T+=38*V;n=1;i=a+n+65535;n=Math.floor(i/65536);a=i-n*65536;i=o+n+65535;n=Math.floor(i/65536);o=i-n*65536;i=s+n+65535;n=Math.floor(i/65536);s=i-n*65536;i=c+n+65535;n=Math.floor(i/65536);c=i-n*65536;i=u+n+65535;n=Math.floor(i/65536);u=i-n*65536;i=l+n+65535;n=Math.floor(i/65536);l=i-n*65536;i=d+n+65535;n=Math.floor(i/65536);d=i-n*65536;i=h+n+65535;n=Math.floor(i/65536);h=i-n*65536;i=p+n+65535;n=Math.floor(i/65536);p=i-n*65536;i=v+n+65535;n=Math.floor(i/65536);v=i-n*65536;i=m+n+65535;n=Math.floor(i/65536);m=i-n*65536;i=g+n+65535;n=Math.floor(i/65536);g=i-n*65536;i=y+n+65535;n=Math.floor(i/65536);y=i-n*65536;i=C+n+65535;n=Math.floor(i/65536);C=i-n*65536;i=T+n+65535;n=Math.floor(i/65536);T=i-n*65536;i=E+n+65535;n=Math.floor(i/65536);E=i-n*65536;a+=n-1+37*(n-1);n=1;i=a+n+65535;n=Math.floor(i/65536);a=i-n*65536;i=o+n+65535;n=Math.floor(i/65536);o=i-n*65536;i=s+n+65535;n=Math.floor(i/65536);s=i-n*65536;i=c+n+65535;n=Math.floor(i/65536);c=i-n*65536;i=u+n+65535;n=Math.floor(i/65536);u=i-n*65536;i=l+n+65535;n=Math.floor(i/65536);l=i-n*65536;i=d+n+65535;n=Math.floor(i/65536);d=i-n*65536;i=h+n+65535;n=Math.floor(i/65536);h=i-n*65536;i=p+n+65535;n=Math.floor(i/65536);p=i-n*65536;i=v+n+65535;n=Math.floor(i/65536);v=i-n*65536;i=m+n+65535;n=Math.floor(i/65536);m=i-n*65536;i=g+n+65535;n=Math.floor(i/65536);g=i-n*65536;i=y+n+65535;n=Math.floor(i/65536);y=i-n*65536;i=C+n+65535;n=Math.floor(i/65536);C=i-n*65536;i=T+n+65535;n=Math.floor(i/65536);T=i-n*65536;i=E+n+65535;n=Math.floor(i/65536);E=i-n*65536;a+=n-1+37*(n-1);e[0]=a;e[1]=o;e[2]=s;e[3]=c;e[4]=u;e[5]=l;e[6]=d;e[7]=h;e[8]=p;e[9]=v;e[10]=m;e[11]=g;e[12]=y;e[13]=C;e[14]=T;e[15]=E}function S(e,t){M(e,t,t)}function inv25519(e,t){var r=gf();var i;for(i=0;i<16;i++)r[i]=t[i];for(i=253;i>=0;i--){S(r,r);if(i!==2&&i!==4)M(r,r,t)}for(i=0;i<16;i++)e[i]=r[i]}function pow2523(e,t){var r=gf();var i;for(i=0;i<16;i++)r[i]=t[i];for(i=250;i>=0;i--){S(r,r);if(i!==1)M(r,r,t)}for(i=0;i<16;i++)e[i]=r[i]}function crypto_scalarmult(e,t,r){var i=new Uint8Array(32);var n=new Float64Array(80),a,s;var c=gf(),u=gf(),l=gf(),d=gf(),h=gf(),p=gf();for(s=0;s<31;s++)i[s]=t[s];i[31]=t[31]&127|64;i[0]&=248;unpack25519(n,r);for(s=0;s<16;s++){u[s]=n[s];d[s]=c[s]=l[s]=0}c[0]=d[0]=1;for(s=254;s>=0;--s){a=i[s>>>3]>>>(s&7)&1;sel25519(c,u,a);sel25519(l,d,a);A(h,c,l);Z(c,c,l);A(l,u,d);Z(u,u,d);S(d,h);S(p,c);M(c,l,c);M(l,u,h);A(h,c,l);Z(c,c,l);S(u,c);Z(l,d,p);M(c,l,o);A(c,c,d);M(l,l,c);M(c,d,p);M(d,u,n);S(u,h);sel25519(c,u,a);sel25519(l,d,a)}for(s=0;s<16;s++){n[s+16]=c[s];n[s+32]=l[s];n[s+48]=u[s];n[s+64]=d[s]}var v=n.subarray(32);var m=n.subarray(16);inv25519(v,v);M(m,m,v);pack25519(e,m);return 0}function crypto_scalarmult_base(e,t){return crypto_scalarmult(e,t,i)}function crypto_box_keypair(e,t){randombytes(t,32);return crypto_scalarmult_base(e,t)}function crypto_box_beforenm(e,r,i){var n=new Uint8Array(32);crypto_scalarmult(n,i,r);return crypto_core_hsalsa20(e,t,n,h)}var p=crypto_secretbox;var v=crypto_secretbox_open;function crypto_box(e,t,r,i,n,a){var o=new Uint8Array(32);crypto_box_beforenm(o,n,a);return p(e,t,r,i,o)}function crypto_box_open(e,t,r,i,n,a){var o=new Uint8Array(32);crypto_box_beforenm(o,n,a);return v(e,t,r,i,o)}var m=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function crypto_hashblocks_hl(e,t,r,i){var n=new Int32Array(16),a=new Int32Array(16),o,s,c,u,l,d,h,p,v,g,y,C,T,E,D,_,I,b,w,R,N,U,P,O,L,B;var x=e[0],k=e[1],V=e[2],H=e[3],j=e[4],W=e[5],G=e[6],X=e[7],q=t[0],Y=t[1],K=t[2],$=t[3],z=t[4],J=t[5],ee=t[6],te=t[7];var re=0;while(i>=128){for(w=0;w<16;w++){R=8*w+re;n[w]=r[R+0]<<24|r[R+1]<<16|r[R+2]<<8|r[R+3];a[w]=r[R+4]<<24|r[R+5]<<16|r[R+6]<<8|r[R+7]}for(w=0;w<80;w++){o=x;s=k;c=V;u=H;l=j;d=W;h=G;p=X;v=q;g=Y;y=K;C=$;T=z;E=J;D=ee;_=te;N=X;U=te;P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=(j>>>14|z<<32-14)^(j>>>18|z<<32-18)^(z>>>41-32|j<<32-(41-32));U=(z>>>14|j<<32-14)^(z>>>18|j<<32-18)^(j>>>41-32|z<<32-(41-32));P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;N=j&W^~j&G;U=z&J^~z&ee;P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;N=m[w*2];U=m[w*2+1];P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;N=n[w%16];U=a[w%16];P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;I=L&65535|B<<16;b=P&65535|O<<16;N=I;U=b;P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=(x>>>28|q<<32-28)^(q>>>34-32|x<<32-(34-32))^(q>>>39-32|x<<32-(39-32));U=(q>>>28|x<<32-28)^(x>>>34-32|q<<32-(34-32))^(x>>>39-32|q<<32-(39-32));P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;N=x&k^x&V^k&V;U=q&Y^q&K^Y&K;P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;p=L&65535|B<<16;_=P&65535|O<<16;N=u;U=C;P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=I;U=b;P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;u=L&65535|B<<16;C=P&65535|O<<16;k=o;V=s;H=c;j=u;W=l;G=d;X=h;x=p;Y=v;K=g;$=y;z=C;J=T;ee=E;te=D;q=_;if(w%16===15){for(R=0;R<16;R++){N=n[R];U=a[R];P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=n[(R+9)%16];U=a[(R+9)%16];P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;I=n[(R+1)%16];b=a[(R+1)%16];N=(I>>>1|b<<32-1)^(I>>>8|b<<32-8)^I>>>7;U=(b>>>1|I<<32-1)^(b>>>8|I<<32-8)^(b>>>7|I<<32-7);P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;I=n[(R+14)%16];b=a[(R+14)%16];N=(I>>>19|b<<32-19)^(b>>>61-32|I<<32-(61-32))^I>>>6;U=(b>>>19|I<<32-19)^(I>>>61-32|b<<32-(61-32))^(b>>>6|I<<32-6);P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;n[R]=L&65535|B<<16;a[R]=P&65535|O<<16}}}N=x;U=q;P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=e[0];U=t[0];P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;e[0]=x=L&65535|B<<16;t[0]=q=P&65535|O<<16;N=k;U=Y;P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=e[1];U=t[1];P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;e[1]=k=L&65535|B<<16;t[1]=Y=P&65535|O<<16;N=V;U=K;P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=e[2];U=t[2];P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;e[2]=V=L&65535|B<<16;t[2]=K=P&65535|O<<16;N=H;U=$;P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=e[3];U=t[3];P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;e[3]=H=L&65535|B<<16;t[3]=$=P&65535|O<<16;N=j;U=z;P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=e[4];U=t[4];P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;e[4]=j=L&65535|B<<16;t[4]=z=P&65535|O<<16;N=W;U=J;P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=e[5];U=t[5];P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;e[5]=W=L&65535|B<<16;t[5]=J=P&65535|O<<16;N=G;U=ee;P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=e[6];U=t[6];P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;e[6]=G=L&65535|B<<16;t[6]=ee=P&65535|O<<16;N=X;U=te;P=U&65535;O=U>>>16;L=N&65535;B=N>>>16;N=e[7];U=t[7];P+=U&65535;O+=U>>>16;L+=N&65535;B+=N>>>16;O+=P>>>16;L+=O>>>16;B+=L>>>16;e[7]=X=L&65535|B<<16;t[7]=te=P&65535|O<<16;re+=128;i-=128}return i}function crypto_hash(e,t,r){var i=new Int32Array(8),n=new Int32Array(8),a=new Uint8Array(256),o,s=r;i[0]=1779033703;i[1]=3144134277;i[2]=1013904242;i[3]=2773480762;i[4]=1359893119;i[5]=2600822924;i[6]=528734635;i[7]=1541459225;n[0]=4089235720;n[1]=2227873595;n[2]=4271175723;n[3]=1595750129;n[4]=2917565137;n[5]=725511199;n[6]=4215389547;n[7]=327033209;crypto_hashblocks_hl(i,n,t,r);r%=128;for(o=0;o<r;o++)a[o]=t[s-r+o];a[r]=128;r=256-128*(r<112?1:0);a[r-9]=0;ts64(a,r-8,s/536870912|0,s<<3);crypto_hashblocks_hl(i,n,a,r);for(o=0;o<8;o++)ts64(e,8*o,i[o],n[o]);return 0}function add(e,t){var r=gf(),i=gf(),n=gf(),a=gf(),o=gf(),s=gf(),u=gf(),l=gf(),d=gf();Z(r,e[1],e[0]);Z(d,t[1],t[0]);M(r,r,d);A(i,e[0],e[1]);A(d,t[0],t[1]);M(i,i,d);M(n,e[3],t[3]);M(n,n,c);M(a,e[2],t[2]);A(a,a,a);Z(o,i,r);Z(s,a,n);A(u,a,n);A(l,i,r);M(e[0],o,s);M(e[1],l,u);M(e[2],u,s);M(e[3],o,l)}function cswap(e,t,r){var i;for(i=0;i<4;i++){sel25519(e[i],t[i],r)}}function pack(e,t){var r=gf(),i=gf(),n=gf();inv25519(n,t[2]);M(r,t[0],n);M(i,t[1],n);pack25519(e,i);e[31]^=par25519(r)<<7}function scalarmult(e,t,r){var i,o;set25519(e[0],n);set25519(e[1],a);set25519(e[2],a);set25519(e[3],n);for(o=255;o>=0;--o){i=r[o/8|0]>>(o&7)&1;cswap(e,t,i);add(t,e);add(e,e);cswap(e,t,i)}}function scalarbase(e,t){var r=[gf(),gf(),gf(),gf()];set25519(r[0],u);set25519(r[1],l);set25519(r[2],a);M(r[3],u,l);scalarmult(e,r,t)}function crypto_sign_keypair(e,t,r){var i=new Uint8Array(64);var n=[gf(),gf(),gf(),gf()];var a;if(!r)randombytes(t,32);crypto_hash(i,t,32);i[0]&=248;i[31]&=127;i[31]|=64;scalarbase(n,i);pack(e,n);for(a=0;a<32;a++)t[a+32]=e[a];return 0}var g=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function modL(e,t){var r,i,n,a;for(i=63;i>=32;--i){r=0;for(n=i-32,a=i-12;n<a;++n){t[n]+=r-16*t[i]*g[n-(i-32)];r=Math.floor((t[n]+128)/256);t[n]-=r*256}t[n]+=r;t[i]=0}r=0;for(n=0;n<32;n++){t[n]+=r-(t[31]>>4)*g[n];r=t[n]>>8;t[n]&=255}for(n=0;n<32;n++)t[n]-=r*g[n];for(i=0;i<32;i++){t[i+1]+=t[i]>>8;e[i]=t[i]&255}}function reduce(e){var t=new Float64Array(64),r;for(r=0;r<64;r++)t[r]=e[r];for(r=0;r<64;r++)e[r]=0;modL(e,t)}function crypto_sign(e,t,r,i){var n=new Uint8Array(64),a=new Uint8Array(64),o=new Uint8Array(64);var s,c,u=new Float64Array(64);var l=[gf(),gf(),gf(),gf()];crypto_hash(n,i,32);n[0]&=248;n[31]&=127;n[31]|=64;var d=r+64;for(s=0;s<r;s++)e[64+s]=t[s];for(s=0;s<32;s++)e[32+s]=n[32+s];crypto_hash(o,e.subarray(32),r+32);reduce(o);scalarbase(l,o);pack(e,l);for(s=32;s<64;s++)e[s]=i[s];crypto_hash(a,e,r+64);reduce(a);for(s=0;s<64;s++)u[s]=0;for(s=0;s<32;s++)u[s]=o[s];for(s=0;s<32;s++){for(c=0;c<32;c++){u[s+c]+=a[s]*n[c]}}modL(e.subarray(32),u);return d}function unpackneg(e,t){var r=gf(),i=gf(),o=gf(),c=gf(),u=gf(),l=gf(),h=gf();set25519(e[2],a);unpack25519(e[1],t);S(o,e[1]);M(c,o,s);Z(o,o,e[2]);A(c,e[2],c);S(u,c);S(l,u);M(h,l,u);M(r,h,o);M(r,r,c);pow2523(r,r);M(r,r,o);M(r,r,c);M(r,r,c);M(e[0],r,c);S(i,e[0]);M(i,i,c);if(neq25519(i,o))M(e[0],e[0],d);S(i,e[0]);M(i,i,c);if(neq25519(i,o))return-1;if(par25519(e[0])===t[31]>>7)Z(e[0],n,e[0]);M(e[3],e[0],e[1]);return 0}function crypto_sign_open(e,t,r,i){var n;var a=new Uint8Array(32),o=new Uint8Array(64);var s=[gf(),gf(),gf(),gf()],c=[gf(),gf(),gf(),gf()];if(r<64)return-1;if(unpackneg(c,i))return-1;for(n=0;n<r;n++)e[n]=t[n];for(n=0;n<32;n++)e[n+32]=i[n];crypto_hash(o,e,r);reduce(o);scalarmult(s,c,o);scalarbase(c,t.subarray(32));add(s,c);pack(a,s);r-=64;if(crypto_verify_32(t,0,a,0)){for(n=0;n<r;n++)e[n]=0;return-1}for(n=0;n<r;n++)e[n]=t[n+64];return r}var y=32,C=24,T=32,E=16,D=32,_=32,I=32,b=32,w=32,R=C,N=T,U=E,P=64,O=32,L=64,B=32,x=64;e.lowlevel={crypto_core_hsalsa20:crypto_core_hsalsa20,crypto_stream_xor:crypto_stream_xor,crypto_stream:crypto_stream,crypto_stream_salsa20_xor:crypto_stream_salsa20_xor,crypto_stream_salsa20:crypto_stream_salsa20,crypto_onetimeauth:crypto_onetimeauth,crypto_onetimeauth_verify:crypto_onetimeauth_verify,crypto_verify_16:crypto_verify_16,crypto_verify_32:crypto_verify_32,crypto_secretbox:crypto_secretbox,crypto_secretbox_open:crypto_secretbox_open,crypto_scalarmult:crypto_scalarmult,crypto_scalarmult_base:crypto_scalarmult_base,crypto_box_beforenm:crypto_box_beforenm,crypto_box_afternm:p,crypto_box:crypto_box,crypto_box_open:crypto_box_open,crypto_box_keypair:crypto_box_keypair,crypto_hash:crypto_hash,crypto_sign:crypto_sign,crypto_sign_keypair:crypto_sign_keypair,crypto_sign_open:crypto_sign_open,crypto_secretbox_KEYBYTES:y,crypto_secretbox_NONCEBYTES:C,crypto_secretbox_ZEROBYTES:T,crypto_secretbox_BOXZEROBYTES:E,crypto_scalarmult_BYTES:D,crypto_scalarmult_SCALARBYTES:_,crypto_box_PUBLICKEYBYTES:I,crypto_box_SECRETKEYBYTES:b,crypto_box_BEFORENMBYTES:w,crypto_box_NONCEBYTES:R,crypto_box_ZEROBYTES:N,crypto_box_BOXZEROBYTES:U,crypto_sign_BYTES:P,crypto_sign_PUBLICKEYBYTES:O,crypto_sign_SECRETKEYBYTES:L,crypto_sign_SEEDBYTES:B,crypto_hash_BYTES:x,gf:gf,D:s,L:g,pack25519:pack25519,unpack25519:unpack25519,M:M,A:A,S:S,Z:Z,pow2523:pow2523,add:add,set25519:set25519,modL:modL,scalarmult:scalarmult,scalarbase:scalarbase};function checkLengths(e,t){if(e.length!==y)throw new Error("bad key size");if(t.length!==C)throw new Error("bad nonce size")}function checkBoxLengths(e,t){if(e.length!==I)throw new Error("bad public key size");if(t.length!==b)throw new Error("bad secret key size")}function checkArrayTypes(){for(var e=0;e<arguments.length;e++){if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}}function cleanup(e){for(var t=0;t<e.length;t++)e[t]=0}e.randomBytes=function(e){var t=new Uint8Array(e);randombytes(t,e);return t};e.secretbox=function(e,t,r){checkArrayTypes(e,t,r);checkLengths(r,t);var i=new Uint8Array(T+e.length);var n=new Uint8Array(i.length);for(var a=0;a<e.length;a++)i[a+T]=e[a];crypto_secretbox(n,i,i.length,t,r);return n.subarray(E)};e.secretbox.open=function(e,t,r){checkArrayTypes(e,t,r);checkLengths(r,t);var i=new Uint8Array(E+e.length);var n=new Uint8Array(i.length);for(var a=0;a<e.length;a++)i[a+E]=e[a];if(i.length<32)return null;if(crypto_secretbox_open(n,i,i.length,t,r)!==0)return null;return n.subarray(T)};e.secretbox.keyLength=y;e.secretbox.nonceLength=C;e.secretbox.overheadLength=E;e.scalarMult=function(e,t){checkArrayTypes(e,t);if(e.length!==_)throw new Error("bad n size");if(t.length!==D)throw new Error("bad p size");var r=new Uint8Array(D);crypto_scalarmult(r,e,t);return r};e.scalarMult.base=function(e){checkArrayTypes(e);if(e.length!==_)throw new Error("bad n size");var t=new Uint8Array(D);crypto_scalarmult_base(t,e);return t};e.scalarMult.scalarLength=_;e.scalarMult.groupElementLength=D;e.box=function(t,r,i,n){var a=e.box.before(i,n);return e.secretbox(t,r,a)};e.box.before=function(e,t){checkArrayTypes(e,t);checkBoxLengths(e,t);var r=new Uint8Array(w);crypto_box_beforenm(r,e,t);return r};e.box.after=e.secretbox;e.box.open=function(t,r,i,n){var a=e.box.before(i,n);return e.secretbox.open(t,r,a)};e.box.open.after=e.secretbox.open;e.box.keyPair=function(){var e=new Uint8Array(I);var t=new Uint8Array(b);crypto_box_keypair(e,t);return{publicKey:e,secretKey:t}};e.box.keyPair.fromSecretKey=function(e){checkArrayTypes(e);if(e.length!==b)throw new Error("bad secret key size");var t=new Uint8Array(I);crypto_scalarmult_base(t,e);return{publicKey:t,secretKey:new Uint8Array(e)}};e.box.publicKeyLength=I;e.box.secretKeyLength=b;e.box.sharedKeyLength=w;e.box.nonceLength=R;e.box.overheadLength=e.secretbox.overheadLength;e.sign=function(e,t){checkArrayTypes(e,t);if(t.length!==L)throw new Error("bad secret key size");var r=new Uint8Array(P+e.length);crypto_sign(r,e,e.length,t);return r};e.sign.open=function(e,t){checkArrayTypes(e,t);if(t.length!==O)throw new Error("bad public key size");var r=new Uint8Array(e.length);var i=crypto_sign_open(r,e,e.length,t);if(i<0)return null;var n=new Uint8Array(i);for(var a=0;a<n.length;a++)n[a]=r[a];return n};e.sign.detached=function(t,r){var i=e.sign(t,r);var n=new Uint8Array(P);for(var a=0;a<n.length;a++)n[a]=i[a];return n};e.sign.detached.verify=function(e,t,r){checkArrayTypes(e,t,r);if(t.length!==P)throw new Error("bad signature size");if(r.length!==O)throw new Error("bad public key size");var i=new Uint8Array(P+e.length);var n=new Uint8Array(P+e.length);var a;for(a=0;a<P;a++)i[a]=t[a];for(a=0;a<e.length;a++)i[a+P]=e[a];return crypto_sign_open(n,i,i.length,r)>=0};e.sign.keyPair=function(){var e=new Uint8Array(O);var t=new Uint8Array(L);crypto_sign_keypair(e,t);return{publicKey:e,secretKey:t}};e.sign.keyPair.fromSecretKey=function(e){checkArrayTypes(e);if(e.length!==L)throw new Error("bad secret key size");var t=new Uint8Array(O);for(var r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}};e.sign.keyPair.fromSeed=function(e){checkArrayTypes(e);if(e.length!==B)throw new Error("bad seed size");var t=new Uint8Array(O);var r=new Uint8Array(L);for(var i=0;i<32;i++)r[i]=e[i];crypto_sign_keypair(t,r,true);return{publicKey:t,secretKey:r}};e.sign.publicKeyLength=O;e.sign.secretKeyLength=L;e.sign.seedLength=B;e.sign.signatureLength=P;e.hash=function(e){checkArrayTypes(e);var t=new Uint8Array(x);crypto_hash(t,e,e.length);return t};e.hash.hashLength=x;e.verify=function(e,t){checkArrayTypes(e,t);if(e.length===0||t.length===0)return false;if(e.length!==t.length)return false;return vn(e,0,t,0,e.length)===0?true:false};e.setPRNG=function(e){randombytes=e};(function(){var t=typeof self!=="undefined"?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){var i=65536;e.setPRNG((function(e,r){var n,a=new Uint8Array(r);for(n=0;n<r;n+=i){t.getRandomValues(a.subarray(n,n+Math.min(r-n,i)))}for(n=0;n<r;n++)e[n]=a[n];cleanup(a)}))}else if(true){t=r(6113);if(t&&t.randomBytes){e.setPRNG((function(e,r){var i,n=t.randomBytes(r);for(i=0;i<r;i++)e[i]=n[i];cleanup(n)}))}}})()})(true&&e.exports?e.exports:self.nacl=self.nacl||{})},4135:(e,t,r)=>{"use strict";var i=r(4264);var n=r(39);var a=r(2385);var o=r(2154);var s=r(4111);e.exports=function whichBoxedPrimitive(e){if(e==null||typeof e!=="object"&&typeof e!=="function"){return null}if(i(e)){return"String"}if(n(e)){return"Number"}if(a(e)){return"Boolean"}if(o(e)){return"Symbol"}if(s(e)){return"BigInt"}}},7538:(e,t,r)=>{"use strict";var i=r(8958);var n=r(8285);var a=r(6379);var o=r(3833);var s=a("Object.prototype.toString");var c=r(3192)();var u=typeof globalThis==="undefined"?global:globalThis;var l=n();var d=a("String.prototype.slice");var h={};var p=Object.getPrototypeOf;if(c&&o&&p){i(l,(function(e){if(typeof u[e]==="function"){var t=new u[e];if(Symbol.toStringTag in t){var r=p(t);var i=o(r,Symbol.toStringTag);if(!i){var n=p(r);i=o(n,Symbol.toStringTag)}h[e]=i.get}}}))}var v=function tryAllTypedArrays(e){var t=false;i(h,(function(r,i){if(!t){try{var n=r.call(e);if(n===i){t=n}}catch(e){}}}));return t};var m=r(9159);e.exports=function whichTypedArray(e){if(!m(e)){return false}if(!c||!(Symbol.toStringTag in e)){return d(s(e),8,-1)}return v(e)}},8795:function(e,t){(function(){"use strict";t.stripBOM=function(e){if(e[0]==="\ufeff"){return e.substring(1)}else{return e}}}).call(this)},1789:function(e,t,r){(function(){"use strict";var e,i,n,a,o,s={}.hasOwnProperty;e=r(5845);i=r(7906).defaults;a=function(e){return typeof e==="string"&&(e.indexOf("&")>=0||e.indexOf(">")>=0||e.indexOf("<")>=0)};o=function(e){return"<![CDATA["+n(e)+"]]>"};n=function(e){return e.replace("]]>","]]]]><![CDATA[>")};t.Builder=function(){function Builder(e){var t,r,n;this.options={};r=i["0.2"];for(t in r){if(!s.call(r,t))continue;n=r[t];this.options[t]=n}for(t in e){if(!s.call(e,t))continue;n=e[t];this.options[t]=n}}Builder.prototype.buildObject=function(t){var r,n,c,u,l;r=this.options.attrkey;n=this.options.charkey;if(Object.keys(t).length===1&&this.options.rootName===i["0.2"].rootName){l=Object.keys(t)[0];t=t[l]}else{l=this.options.rootName}c=function(e){return function(t,i){var u,l,d,h,p,v;if(typeof i!=="object"){if(e.options.cdata&&a(i)){t.raw(o(i))}else{t.txt(i)}}else if(Array.isArray(i)){for(h in i){if(!s.call(i,h))continue;l=i[h];for(p in l){d=l[p];t=c(t.ele(p),d).up()}}}else{for(p in i){if(!s.call(i,p))continue;l=i[p];if(p===r){if(typeof l==="object"){for(u in l){v=l[u];t=t.att(u,v)}}}else if(p===n){if(e.options.cdata&&a(l)){t=t.raw(o(l))}else{t=t.txt(l)}}else if(Array.isArray(l)){for(h in l){if(!s.call(l,h))continue;d=l[h];if(typeof d==="string"){if(e.options.cdata&&a(d)){t=t.ele(p).raw(o(d)).up()}else{t=t.ele(p,d).up()}}else{t=c(t.ele(p),d).up()}}}else if(typeof l==="object"){t=c(t.ele(p),l).up()}else{if(typeof l==="string"&&e.options.cdata&&a(l)){t=t.ele(p).raw(o(l)).up()}else{if(l==null){l=""}t=t.ele(p,l.toString()).up()}}}}return t}}(this);u=e.create(l,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars});return c(u,t).end(this.options.renderOpts)};return Builder}()}).call(this)},7906:function(e,t){(function(){t.defaults={.1:{explicitCharkey:false,trim:true,normalize:true,normalizeTags:false,attrkey:"@",charkey:"#",explicitArray:false,ignoreAttrs:false,mergeAttrs:false,explicitRoot:false,validator:null,xmlns:false,explicitChildren:false,childkey:"@@",charsAsChildren:false,includeWhiteChars:false,async:false,strict:true,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:false,trim:false,normalize:false,normalizeTags:false,attrkey:"$",charkey:"_",explicitArray:true,ignoreAttrs:false,mergeAttrs:false,explicitRoot:true,validator:null,xmlns:false,explicitChildren:false,preserveChildrenOrder:false,childkey:"$$",charsAsChildren:false,includeWhiteChars:false,async:false,strict:true,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:true},doctype:null,renderOpts:{pretty:true,indent:"  ",newline:"\n"},headless:false,chunkSize:1e4,emptyTag:"",cdata:false}}}).call(this)},2354:function(e,t,r){(function(){"use strict";var e,i,n,a,o,s,c,u,bind=function(e,t){return function(){return e.apply(t,arguments)}},extend=function(e,t){for(var r in t){if(l.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},l={}.hasOwnProperty;c=r(740);n=r(2361);e=r(8795);s=r(2582);u=r(9512).setImmediate;i=r(7906).defaults;a=function(e){return typeof e==="object"&&e!=null&&Object.keys(e).length===0};o=function(e,t,r){var i,n,a;for(i=0,n=e.length;i<n;i++){a=e[i];t=a(t,r)}return t};t.Parser=function(r){extend(Parser,r);function Parser(e){this.parseStringPromise=bind(this.parseStringPromise,this);this.parseString=bind(this.parseString,this);this.reset=bind(this.reset,this);this.assignOrPush=bind(this.assignOrPush,this);this.processAsync=bind(this.processAsync,this);var r,n,a;if(!(this instanceof t.Parser)){return new t.Parser(e)}this.options={};n=i["0.2"];for(r in n){if(!l.call(n,r))continue;a=n[r];this.options[r]=a}for(r in e){if(!l.call(e,r))continue;a=e[r];this.options[r]=a}if(this.options.xmlns){this.options.xmlnskey=this.options.attrkey+"ns"}if(this.options.normalizeTags){if(!this.options.tagNameProcessors){this.options.tagNameProcessors=[]}this.options.tagNameProcessors.unshift(s.normalize)}this.reset()}Parser.prototype.processAsync=function(){var e,t;try{if(this.remaining.length<=this.options.chunkSize){e=this.remaining;this.remaining="";this.saxParser=this.saxParser.write(e);return this.saxParser.close()}else{e=this.remaining.substr(0,this.options.chunkSize);this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length);this.saxParser=this.saxParser.write(e);return u(this.processAsync)}}catch(e){t=e;if(!this.saxParser.errThrown){this.saxParser.errThrown=true;return this.emit(t)}}};Parser.prototype.assignOrPush=function(e,t,r){if(!(t in e)){if(!this.options.explicitArray){return e[t]=r}else{return e[t]=[r]}}else{if(!(e[t]instanceof Array)){e[t]=[e[t]]}return e[t].push(r)}};Parser.prototype.reset=function(){var e,t,r,i;this.removeAllListeners();this.saxParser=c.parser(this.options.strict,{trim:false,normalize:false,xmlns:this.options.xmlns});this.saxParser.errThrown=false;this.saxParser.onerror=function(e){return function(t){e.saxParser.resume();if(!e.saxParser.errThrown){e.saxParser.errThrown=true;return e.emit("error",t)}}}(this);this.saxParser.onend=function(e){return function(){if(!e.saxParser.ended){e.saxParser.ended=true;return e.emit("end",e.resultObject)}}}(this);this.saxParser.ended=false;this.EXPLICIT_CHARKEY=this.options.explicitCharkey;this.resultObject=null;i=[];e=this.options.attrkey;t=this.options.charkey;this.saxParser.onopentag=function(r){return function(n){var a,s,c,u,d;c={};c[t]="";if(!r.options.ignoreAttrs){d=n.attributes;for(a in d){if(!l.call(d,a))continue;if(!(e in c)&&!r.options.mergeAttrs){c[e]={}}s=r.options.attrValueProcessors?o(r.options.attrValueProcessors,n.attributes[a],a):n.attributes[a];u=r.options.attrNameProcessors?o(r.options.attrNameProcessors,a):a;if(r.options.mergeAttrs){r.assignOrPush(c,u,s)}else{c[e][u]=s}}}c["#name"]=r.options.tagNameProcessors?o(r.options.tagNameProcessors,n.name):n.name;if(r.options.xmlns){c[r.options.xmlnskey]={uri:n.uri,local:n.local}}return i.push(c)}}(this);this.saxParser.onclosetag=function(e){return function(){var r,n,s,c,u,d,h,p,v,m;d=i.pop();u=d["#name"];if(!e.options.explicitChildren||!e.options.preserveChildrenOrder){delete d["#name"]}if(d.cdata===true){r=d.cdata;delete d.cdata}v=i[i.length-1];if(d[t].match(/^\s*$/)&&!r){n=d[t];delete d[t]}else{if(e.options.trim){d[t]=d[t].trim()}if(e.options.normalize){d[t]=d[t].replace(/\s{2,}/g," ").trim()}d[t]=e.options.valueProcessors?o(e.options.valueProcessors,d[t],u):d[t];if(Object.keys(d).length===1&&t in d&&!e.EXPLICIT_CHARKEY){d=d[t]}}if(a(d)){d=e.options.emptyTag!==""?e.options.emptyTag:n}if(e.options.validator!=null){m="/"+function(){var e,t,r;r=[];for(e=0,t=i.length;e<t;e++){c=i[e];r.push(c["#name"])}return r}().concat(u).join("/");(function(){var t;try{return d=e.options.validator(m,v&&v[u],d)}catch(r){t=r;return e.emit("error",t)}})()}if(e.options.explicitChildren&&!e.options.mergeAttrs&&typeof d==="object"){if(!e.options.preserveChildrenOrder){c={};if(e.options.attrkey in d){c[e.options.attrkey]=d[e.options.attrkey];delete d[e.options.attrkey]}if(!e.options.charsAsChildren&&e.options.charkey in d){c[e.options.charkey]=d[e.options.charkey];delete d[e.options.charkey]}if(Object.getOwnPropertyNames(d).length>0){c[e.options.childkey]=d}d=c}else if(v){v[e.options.childkey]=v[e.options.childkey]||[];h={};for(s in d){if(!l.call(d,s))continue;h[s]=d[s]}v[e.options.childkey].push(h);delete d["#name"];if(Object.keys(d).length===1&&t in d&&!e.EXPLICIT_CHARKEY){d=d[t]}}}if(i.length>0){return e.assignOrPush(v,u,d)}else{if(e.options.explicitRoot){p=d;d={};d[u]=p}e.resultObject=d;e.saxParser.ended=true;return e.emit("end",e.resultObject)}}}(this);r=function(e){return function(r){var n,a;a=i[i.length-1];if(a){a[t]+=r;if(e.options.explicitChildren&&e.options.preserveChildrenOrder&&e.options.charsAsChildren&&(e.options.includeWhiteChars||r.replace(/\\n/g,"").trim()!=="")){a[e.options.childkey]=a[e.options.childkey]||[];n={"#name":"__text__"};n[t]=r;if(e.options.normalize){n[t]=n[t].replace(/\s{2,}/g," ").trim()}a[e.options.childkey].push(n)}return a}}}(this);this.saxParser.ontext=r;return this.saxParser.oncdata=function(e){return function(e){var t;t=r(e);if(t){return t.cdata=true}}}(this)};Parser.prototype.parseString=function(t,r){var i;if(r!=null&&typeof r==="function"){this.on("end",(function(e){this.reset();return r(null,e)}));this.on("error",(function(e){this.reset();return r(e)}))}try{t=t.toString();if(t.trim()===""){this.emit("end",null);return true}t=e.stripBOM(t);if(this.options.async){this.remaining=t;u(this.processAsync);return this.saxParser}return this.saxParser.write(t).close()}catch(e){i=e;if(!(this.saxParser.errThrown||this.saxParser.ended)){this.emit("error",i);return this.saxParser.errThrown=true}else if(this.saxParser.ended){throw i}}};Parser.prototype.parseStringPromise=function(e){return new Promise(function(t){return function(r,i){return t.parseString(e,(function(e,t){if(e){return i(e)}else{return r(t)}}))}}(this))};return Parser}(n);t.parseString=function(e,r,i){var n,a,o;if(i!=null){if(typeof i==="function"){n=i}if(typeof r==="object"){a=r}}else{if(typeof r==="function"){n=r}a={}}o=new t.Parser(a);return o.parseString(e,n)};t.parseStringPromise=function(e,r){var i,n;if(typeof r==="object"){i=r}n=new t.Parser(i);return n.parseStringPromise(e)}}).call(this)},2582:function(e,t){(function(){"use strict";var e;e=new RegExp(/(?!xmlns)^.*:/);t.normalize=function(e){return e.toLowerCase()};t.firstCharLowerCase=function(e){return e.charAt(0).toLowerCase()+e.slice(1)};t.stripPrefix=function(t){return t.replace(e,"")};t.parseNumbers=function(e){if(!isNaN(e)){e=e%1===0?parseInt(e,10):parseFloat(e)}return e};t.parseBooleans=function(e){if(/^(?:true|false)$/i.test(e)){e=e.toLowerCase()==="true"}return e}}).call(this)},6682:function(e,t,r){(function(){"use strict";var e,i,n,a,extend=function(e,t){for(var r in t){if(o.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},o={}.hasOwnProperty;i=r(7906);e=r(1789);n=r(2354);a=r(2582);t.defaults=i.defaults;t.processors=a;t.ValidationError=function(e){extend(ValidationError,e);function ValidationError(e){this.message=e}return ValidationError}(Error);t.Builder=e.Builder;t.Parser=n.Parser;t.parseString=n.parseString;t.parseStringPromise=n.parseStringPromise}).call(this)},2161:function(e){(function(){e.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},8052:function(e){(function(){e.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},1962:function(e){(function(){var t,r,i,n,a,o,s,c=[].slice,u={}.hasOwnProperty;t=function(){var e,t,r,i,n,o;o=arguments[0],n=2<=arguments.length?c.call(arguments,1):[];if(a(Object.assign)){Object.assign.apply(null,arguments)}else{for(e=0,r=n.length;e<r;e++){i=n[e];if(i!=null){for(t in i){if(!u.call(i,t))continue;o[t]=i[t]}}}}return o};a=function(e){return!!e&&Object.prototype.toString.call(e)==="[object Function]"};o=function(e){var t;return!!e&&((t=typeof e)==="function"||t==="object")};i=function(e){if(a(Array.isArray)){return Array.isArray(e)}else{return Object.prototype.toString.call(e)==="[object Array]"}};n=function(e){var t;if(i(e)){return!e.length}else{for(t in e){if(!u.call(e,t))continue;return false}return true}};s=function(e){var t,r;return o(e)&&(r=Object.getPrototypeOf(e))&&(t=r.constructor)&&typeof t==="function"&&t instanceof t&&Function.prototype.toString.call(t)===Function.prototype.toString.call(Object)};r=function(e){if(a(e.valueOf)){return e.valueOf()}else{return e}};e.exports.assign=t;e.exports.isFunction=a;e.exports.isObject=o;e.exports.isArray=i;e.exports.isEmpty=n;e.exports.isPlainObject=s;e.exports.getValue=r}).call(this)},6933:function(e){(function(){e.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},7295:function(e,t,r){(function(){var t,i,n;t=r(8052);n=r(8196);e.exports=i=function(){function XMLAttribute(e,r,i){this.parent=e;if(this.parent){this.options=this.parent.options;this.stringify=this.parent.stringify}if(r==null){throw new Error("Missing attribute name. "+this.debugInfo(r))}this.name=this.stringify.name(r);this.value=this.stringify.attValue(i);this.type=t.Attribute;this.isId=false;this.schemaTypeInfo=null}Object.defineProperty(XMLAttribute.prototype,"nodeType",{get:function(){return this.type}});Object.defineProperty(XMLAttribute.prototype,"ownerElement",{get:function(){return this.parent}});Object.defineProperty(XMLAttribute.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}});Object.defineProperty(XMLAttribute.prototype,"namespaceURI",{get:function(){return""}});Object.defineProperty(XMLAttribute.prototype,"prefix",{get:function(){return""}});Object.defineProperty(XMLAttribute.prototype,"localName",{get:function(){return this.name}});Object.defineProperty(XMLAttribute.prototype,"specified",{get:function(){return true}});XMLAttribute.prototype.clone=function(){return Object.create(this)};XMLAttribute.prototype.toString=function(e){return this.options.writer.attribute(this,this.options.writer.filterOptions(e))};XMLAttribute.prototype.debugInfo=function(e){e=e||this.name;if(e==null){return"parent: <"+this.parent.name+">"}else{return"attribute: {"+e+"}, parent: <"+this.parent.name+">"}};XMLAttribute.prototype.isEqualNode=function(e){if(e.namespaceURI!==this.namespaceURI){return false}if(e.prefix!==this.prefix){return false}if(e.localName!==this.localName){return false}if(e.value!==this.value){return false}return true};return XMLAttribute}()}).call(this)},6249:function(e,t,r){(function(){var t,i,n,extend=function(e,t){for(var r in t){if(a.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},a={}.hasOwnProperty;t=r(8052);n=r(5775);e.exports=i=function(e){extend(XMLCData,e);function XMLCData(e,r){XMLCData.__super__.constructor.call(this,e);if(r==null){throw new Error("Missing CDATA text. "+this.debugInfo())}this.name="#cdata-section";this.type=t.CData;this.value=this.stringify.cdata(r)}XMLCData.prototype.clone=function(){return Object.create(this)};XMLCData.prototype.toString=function(e){return this.options.writer.cdata(this,this.options.writer.filterOptions(e))};return XMLCData}(n)}).call(this)},5775:function(e,t,r){(function(){var t,i,extend=function(e,t){for(var r in t){if(n.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},n={}.hasOwnProperty;i=r(8196);e.exports=t=function(e){extend(XMLCharacterData,e);function XMLCharacterData(e){XMLCharacterData.__super__.constructor.call(this,e);this.value=""}Object.defineProperty(XMLCharacterData.prototype,"data",{get:function(){return this.value},set:function(e){return this.value=e||""}});Object.defineProperty(XMLCharacterData.prototype,"length",{get:function(){return this.value.length}});Object.defineProperty(XMLCharacterData.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}});XMLCharacterData.prototype.clone=function(){return Object.create(this)};XMLCharacterData.prototype.substringData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLCharacterData.prototype.appendData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLCharacterData.prototype.insertData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLCharacterData.prototype.deleteData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLCharacterData.prototype.replaceData=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLCharacterData.prototype.isEqualNode=function(e){if(!XMLCharacterData.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)){return false}if(e.data!==this.data){return false}return true};return XMLCharacterData}(i)}).call(this)},1740:function(e,t,r){(function(){var t,i,n,extend=function(e,t){for(var r in t){if(a.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},a={}.hasOwnProperty;t=r(8052);i=r(5775);e.exports=n=function(e){extend(XMLComment,e);function XMLComment(e,r){XMLComment.__super__.constructor.call(this,e);if(r==null){throw new Error("Missing comment text. "+this.debugInfo())}this.name="#comment";this.type=t.Comment;this.value=this.stringify.comment(r)}XMLComment.prototype.clone=function(){return Object.create(this)};XMLComment.prototype.toString=function(e){return this.options.writer.comment(this,this.options.writer.filterOptions(e))};return XMLComment}(i)}).call(this)},4864:function(e,t,r){(function(){var t,i,n;i=r(7981);n=r(8911);e.exports=t=function(){function XMLDOMConfiguration(){var e;this.defaultParams={"canonical-form":false,"cdata-sections":false,comments:false,"datatype-normalization":false,"element-content-whitespace":true,entities:true,"error-handler":new i,infoset:true,"validate-if-schema":false,namespaces:true,"namespace-declarations":true,"normalize-characters":false,"schema-location":"","schema-type":"","split-cdata-sections":true,validate:false,"well-formed":true};this.params=e=Object.create(this.defaultParams)}Object.defineProperty(XMLDOMConfiguration.prototype,"parameterNames",{get:function(){return new n(Object.keys(this.defaultParams))}});XMLDOMConfiguration.prototype.getParameter=function(e){if(this.params.hasOwnProperty(e)){return this.params[e]}else{return null}};XMLDOMConfiguration.prototype.canSetParameter=function(e,t){return true};XMLDOMConfiguration.prototype.setParameter=function(e,t){if(t!=null){return this.params[e]=t}else{return delete this.params[e]}};return XMLDOMConfiguration}()}).call(this)},7981:function(e){(function(){var t;e.exports=t=function(){function XMLDOMErrorHandler(){}XMLDOMErrorHandler.prototype.handleError=function(e){throw new Error(e)};return XMLDOMErrorHandler}()}).call(this)},2699:function(e){(function(){var t;e.exports=t=function(){function XMLDOMImplementation(){}XMLDOMImplementation.prototype.hasFeature=function(e,t){return true};XMLDOMImplementation.prototype.createDocumentType=function(e,t,r){throw new Error("This DOM method is not implemented.")};XMLDOMImplementation.prototype.createDocument=function(e,t,r){throw new Error("This DOM method is not implemented.")};XMLDOMImplementation.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")};XMLDOMImplementation.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented.")};return XMLDOMImplementation}()}).call(this)},8911:function(e){(function(){var t;e.exports=t=function(){function XMLDOMStringList(e){this.arr=e||[]}Object.defineProperty(XMLDOMStringList.prototype,"length",{get:function(){return this.arr.length}});XMLDOMStringList.prototype.item=function(e){return this.arr[e]||null};XMLDOMStringList.prototype.contains=function(e){return this.arr.indexOf(e)!==-1};return XMLDOMStringList}()}).call(this)},1997:function(e,t,r){(function(){var t,i,n,extend=function(e,t){for(var r in t){if(a.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},a={}.hasOwnProperty;n=r(8196);t=r(8052);e.exports=i=function(e){extend(XMLDTDAttList,e);function XMLDTDAttList(e,r,i,n,a,o){XMLDTDAttList.__super__.constructor.call(this,e);if(r==null){throw new Error("Missing DTD element name. "+this.debugInfo())}if(i==null){throw new Error("Missing DTD attribute name. "+this.debugInfo(r))}if(!n){throw new Error("Missing DTD attribute type. "+this.debugInfo(r))}if(!a){throw new Error("Missing DTD attribute default. "+this.debugInfo(r))}if(a.indexOf("#")!==0){a="#"+a}if(!a.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/)){throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(r))}if(o&&!a.match(/^(#FIXED|#DEFAULT)$/)){throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(r))}this.elementName=this.stringify.name(r);this.type=t.AttributeDeclaration;this.attributeName=this.stringify.name(i);this.attributeType=this.stringify.dtdAttType(n);if(o){this.defaultValue=this.stringify.dtdAttDefault(o)}this.defaultValueType=a}XMLDTDAttList.prototype.toString=function(e){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(e))};return XMLDTDAttList}(n)}).call(this)},1088:function(e,t,r){(function(){var t,i,n,extend=function(e,t){for(var r in t){if(a.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},a={}.hasOwnProperty;n=r(8196);t=r(8052);e.exports=i=function(e){extend(XMLDTDElement,e);function XMLDTDElement(e,r,i){XMLDTDElement.__super__.constructor.call(this,e);if(r==null){throw new Error("Missing DTD element name. "+this.debugInfo())}if(!i){i="(#PCDATA)"}if(Array.isArray(i)){i="("+i.join(",")+")"}this.name=this.stringify.name(r);this.type=t.ElementDeclaration;this.value=this.stringify.dtdElementValue(i)}XMLDTDElement.prototype.toString=function(e){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(e))};return XMLDTDElement}(n)}).call(this)},1821:function(e,t,r){(function(){var t,i,n,a,extend=function(e,t){for(var r in t){if(o.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},o={}.hasOwnProperty;a=r(1962).isObject;n=r(8196);t=r(8052);e.exports=i=function(e){extend(XMLDTDEntity,e);function XMLDTDEntity(e,r,i,n){XMLDTDEntity.__super__.constructor.call(this,e);if(i==null){throw new Error("Missing DTD entity name. "+this.debugInfo(i))}if(n==null){throw new Error("Missing DTD entity value. "+this.debugInfo(i))}this.pe=!!r;this.name=this.stringify.name(i);this.type=t.EntityDeclaration;if(!a(n)){this.value=this.stringify.dtdEntityValue(n);this.internal=true}else{if(!n.pubID&&!n.sysID){throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(i))}if(n.pubID&&!n.sysID){throw new Error("System identifier is required for a public external entity. "+this.debugInfo(i))}this.internal=false;if(n.pubID!=null){this.pubID=this.stringify.dtdPubID(n.pubID)}if(n.sysID!=null){this.sysID=this.stringify.dtdSysID(n.sysID)}if(n.nData!=null){this.nData=this.stringify.dtdNData(n.nData)}if(this.pe&&this.nData){throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(i))}}}Object.defineProperty(XMLDTDEntity.prototype,"publicId",{get:function(){return this.pubID}});Object.defineProperty(XMLDTDEntity.prototype,"systemId",{get:function(){return this.sysID}});Object.defineProperty(XMLDTDEntity.prototype,"notationName",{get:function(){return this.nData||null}});Object.defineProperty(XMLDTDEntity.prototype,"inputEncoding",{get:function(){return null}});Object.defineProperty(XMLDTDEntity.prototype,"xmlEncoding",{get:function(){return null}});Object.defineProperty(XMLDTDEntity.prototype,"xmlVersion",{get:function(){return null}});XMLDTDEntity.prototype.toString=function(e){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(e))};return XMLDTDEntity}(n)}).call(this)},9142:function(e,t,r){(function(){var t,i,n,extend=function(e,t){for(var r in t){if(a.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},a={}.hasOwnProperty;n=r(8196);t=r(8052);e.exports=i=function(e){extend(XMLDTDNotation,e);function XMLDTDNotation(e,r,i){XMLDTDNotation.__super__.constructor.call(this,e);if(r==null){throw new Error("Missing DTD notation name. "+this.debugInfo(r))}if(!i.pubID&&!i.sysID){throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(r))}this.name=this.stringify.name(r);this.type=t.NotationDeclaration;if(i.pubID!=null){this.pubID=this.stringify.dtdPubID(i.pubID)}if(i.sysID!=null){this.sysID=this.stringify.dtdSysID(i.sysID)}}Object.defineProperty(XMLDTDNotation.prototype,"publicId",{get:function(){return this.pubID}});Object.defineProperty(XMLDTDNotation.prototype,"systemId",{get:function(){return this.sysID}});XMLDTDNotation.prototype.toString=function(e){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(e))};return XMLDTDNotation}(n)}).call(this)},720:function(e,t,r){(function(){var t,i,n,a,extend=function(e,t){for(var r in t){if(o.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},o={}.hasOwnProperty;a=r(1962).isObject;n=r(8196);t=r(8052);e.exports=i=function(e){extend(XMLDeclaration,e);function XMLDeclaration(e,r,i,n){var o;XMLDeclaration.__super__.constructor.call(this,e);if(a(r)){o=r,r=o.version,i=o.encoding,n=o.standalone}if(!r){r="1.0"}this.type=t.Declaration;this.version=this.stringify.xmlVersion(r);if(i!=null){this.encoding=this.stringify.xmlEncoding(i)}if(n!=null){this.standalone=this.stringify.xmlStandalone(n)}}XMLDeclaration.prototype.toString=function(e){return this.options.writer.declaration(this,this.options.writer.filterOptions(e))};return XMLDeclaration}(n)}).call(this)},7719:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,l,extend=function(e,t){for(var r in t){if(d.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},d={}.hasOwnProperty;l=r(1962).isObject;u=r(8196);t=r(8052);i=r(1997);a=r(1821);n=r(1088);o=r(9142);c=r(9854);e.exports=s=function(e){extend(XMLDocType,e);function XMLDocType(e,r,i){var n,a,o,s,c,u;XMLDocType.__super__.constructor.call(this,e);this.type=t.DocType;if(e.children){s=e.children;for(a=0,o=s.length;a<o;a++){n=s[a];if(n.type===t.Element){this.name=n.name;break}}}this.documentObject=e;if(l(r)){c=r,r=c.pubID,i=c.sysID}if(i==null){u=[r,i],i=u[0],r=u[1]}if(r!=null){this.pubID=this.stringify.dtdPubID(r)}if(i!=null){this.sysID=this.stringify.dtdSysID(i)}}Object.defineProperty(XMLDocType.prototype,"entities",{get:function(){var e,r,i,n,a;n={};a=this.children;for(r=0,i=a.length;r<i;r++){e=a[r];if(e.type===t.EntityDeclaration&&!e.pe){n[e.name]=e}}return new c(n)}});Object.defineProperty(XMLDocType.prototype,"notations",{get:function(){var e,r,i,n,a;n={};a=this.children;for(r=0,i=a.length;r<i;r++){e=a[r];if(e.type===t.NotationDeclaration){n[e.name]=e}}return new c(n)}});Object.defineProperty(XMLDocType.prototype,"publicId",{get:function(){return this.pubID}});Object.defineProperty(XMLDocType.prototype,"systemId",{get:function(){return this.sysID}});Object.defineProperty(XMLDocType.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}});XMLDocType.prototype.element=function(e,t){var r;r=new n(this,e,t);this.children.push(r);return this};XMLDocType.prototype.attList=function(e,t,r,n,a){var o;o=new i(this,e,t,r,n,a);this.children.push(o);return this};XMLDocType.prototype.entity=function(e,t){var r;r=new a(this,false,e,t);this.children.push(r);return this};XMLDocType.prototype.pEntity=function(e,t){var r;r=new a(this,true,e,t);this.children.push(r);return this};XMLDocType.prototype.notation=function(e,t){var r;r=new o(this,e,t);this.children.push(r);return this};XMLDocType.prototype.toString=function(e){return this.options.writer.docType(this,this.options.writer.filterOptions(e))};XMLDocType.prototype.ele=function(e,t){return this.element(e,t)};XMLDocType.prototype.att=function(e,t,r,i,n){return this.attList(e,t,r,i,n)};XMLDocType.prototype.ent=function(e,t){return this.entity(e,t)};XMLDocType.prototype.pent=function(e,t){return this.pEntity(e,t)};XMLDocType.prototype.not=function(e,t){return this.notation(e,t)};XMLDocType.prototype.up=function(){return this.root()||this.documentObject};XMLDocType.prototype.isEqualNode=function(e){if(!XMLDocType.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)){return false}if(e.name!==this.name){return false}if(e.publicId!==this.publicId){return false}if(e.systemId!==this.systemId){return false}return true};return XMLDocType}(u)}).call(this)},2914:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,extend=function(e,t){for(var r in t){if(l.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},l={}.hasOwnProperty;u=r(1962).isPlainObject;n=r(2699);i=r(4864);o=r(8196);t=r(8052);c=r(6892);s=r(5023);e.exports=a=function(e){extend(XMLDocument,e);function XMLDocument(e){XMLDocument.__super__.constructor.call(this,null);this.name="#document";this.type=t.Document;this.documentURI=null;this.domConfig=new i;e||(e={});if(!e.writer){e.writer=new s}this.options=e;this.stringify=new c(e)}Object.defineProperty(XMLDocument.prototype,"implementation",{value:new n});Object.defineProperty(XMLDocument.prototype,"doctype",{get:function(){var e,r,i,n;n=this.children;for(r=0,i=n.length;r<i;r++){e=n[r];if(e.type===t.DocType){return e}}return null}});Object.defineProperty(XMLDocument.prototype,"documentElement",{get:function(){return this.rootObject||null}});Object.defineProperty(XMLDocument.prototype,"inputEncoding",{get:function(){return null}});Object.defineProperty(XMLDocument.prototype,"strictErrorChecking",{get:function(){return false}});Object.defineProperty(XMLDocument.prototype,"xmlEncoding",{get:function(){if(this.children.length!==0&&this.children[0].type===t.Declaration){return this.children[0].encoding}else{return null}}});Object.defineProperty(XMLDocument.prototype,"xmlStandalone",{get:function(){if(this.children.length!==0&&this.children[0].type===t.Declaration){return this.children[0].standalone==="yes"}else{return false}}});Object.defineProperty(XMLDocument.prototype,"xmlVersion",{get:function(){if(this.children.length!==0&&this.children[0].type===t.Declaration){return this.children[0].version}else{return"1.0"}}});Object.defineProperty(XMLDocument.prototype,"URL",{get:function(){return this.documentURI}});Object.defineProperty(XMLDocument.prototype,"origin",{get:function(){return null}});Object.defineProperty(XMLDocument.prototype,"compatMode",{get:function(){return null}});Object.defineProperty(XMLDocument.prototype,"characterSet",{get:function(){return null}});Object.defineProperty(XMLDocument.prototype,"contentType",{get:function(){return null}});XMLDocument.prototype.end=function(e){var t;t={};if(!e){e=this.options.writer}else if(u(e)){t=e;e=this.options.writer}return e.document(this,e.filterOptions(t))};XMLDocument.prototype.toString=function(e){return this.options.writer.document(this,this.options.writer.filterOptions(e))};XMLDocument.prototype.createElement=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createTextNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createComment=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createCDATASection=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createProcessingInstruction=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createAttribute=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createEntityReference=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.importNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createElementNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.getElementById=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.adoptNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.renameNode=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createEvent=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createNodeIterator=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLDocument.prototype.createTreeWalker=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())};return XMLDocument}(o)}).call(this)},5974:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,l,d,h,p,v,m,g,y,C,T,E,D,_,I,b,w,R={}.hasOwnProperty;w=r(1962),I=w.isObject,_=w.isFunction,b=w.isPlainObject,D=w.getValue;t=r(8052);p=r(2914);m=r(6717);a=r(6249);o=r(1740);y=r(3737);E=r(8685);g=r(6085);d=r(720);h=r(7719);s=r(1997);u=r(1821);c=r(1088);l=r(9142);n=r(7295);T=r(6892);C=r(5023);i=r(6933);e.exports=v=function(){function XMLDocumentCB(e,r,i){var n;this.name="?xml";this.type=t.Document;e||(e={});n={};if(!e.writer){e.writer=new C}else if(b(e.writer)){n=e.writer;e.writer=new C}this.options=e;this.writer=e.writer;this.writerOptions=this.writer.filterOptions(n);this.stringify=new T(e);this.onDataCallback=r||function(){};this.onEndCallback=i||function(){};this.currentNode=null;this.currentLevel=-1;this.openTags={};this.documentStarted=false;this.documentCompleted=false;this.root=null}XMLDocumentCB.prototype.createChildNode=function(e){var r,i,n,a,o,s,c,u;switch(e.type){case t.CData:this.cdata(e.value);break;case t.Comment:this.comment(e.value);break;case t.Element:n={};c=e.attribs;for(i in c){if(!R.call(c,i))continue;r=c[i];n[i]=r.value}this.node(e.name,n);break;case t.Dummy:this.dummy();break;case t.Raw:this.raw(e.value);break;case t.Text:this.text(e.value);break;case t.ProcessingInstruction:this.instruction(e.target,e.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+e.constructor.name)}u=e.children;for(o=0,s=u.length;o<s;o++){a=u[o];this.createChildNode(a);if(a.type===t.Element){this.up()}}return this};XMLDocumentCB.prototype.dummy=function(){return this};XMLDocumentCB.prototype.node=function(e,t,r){var i;if(e==null){throw new Error("Missing node name.")}if(this.root&&this.currentLevel===-1){throw new Error("Document can only have one root node. "+this.debugInfo(e))}this.openCurrent();e=D(e);if(t==null){t={}}t=D(t);if(!I(t)){i=[t,r],r=i[0],t=i[1]}this.currentNode=new m(this,e,t);this.currentNode.children=false;this.currentLevel++;this.openTags[this.currentLevel]=this.currentNode;if(r!=null){this.text(r)}return this};XMLDocumentCB.prototype.element=function(e,r,i){var n,a,o,s,c,u;if(this.currentNode&&this.currentNode.type===t.DocType){this.dtdElement.apply(this,arguments)}else{if(Array.isArray(e)||I(e)||_(e)){s=this.options.noValidation;this.options.noValidation=true;u=new p(this.options).element("TEMP_ROOT");u.element(e);this.options.noValidation=s;c=u.children;for(a=0,o=c.length;a<o;a++){n=c[a];this.createChildNode(n);if(n.type===t.Element){this.up()}}}else{this.node(e,r,i)}}return this};XMLDocumentCB.prototype.attribute=function(e,t){var r,i;if(!this.currentNode||this.currentNode.children){throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(e))}if(e!=null){e=D(e)}if(I(e)){for(r in e){if(!R.call(e,r))continue;i=e[r];this.attribute(r,i)}}else{if(_(t)){t=t.apply()}if(this.options.keepNullAttributes&&t==null){this.currentNode.attribs[e]=new n(this,e,"")}else if(t!=null){this.currentNode.attribs[e]=new n(this,e,t)}}return this};XMLDocumentCB.prototype.text=function(e){var t;this.openCurrent();t=new E(this,e);this.onData(this.writer.text(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this};XMLDocumentCB.prototype.cdata=function(e){var t;this.openCurrent();t=new a(this,e);this.onData(this.writer.cdata(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this};XMLDocumentCB.prototype.comment=function(e){var t;this.openCurrent();t=new o(this,e);this.onData(this.writer.comment(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this};XMLDocumentCB.prototype.raw=function(e){var t;this.openCurrent();t=new y(this,e);this.onData(this.writer.raw(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this};XMLDocumentCB.prototype.instruction=function(e,t){var r,i,n,a,o;this.openCurrent();if(e!=null){e=D(e)}if(t!=null){t=D(t)}if(Array.isArray(e)){for(r=0,a=e.length;r<a;r++){i=e[r];this.instruction(i)}}else if(I(e)){for(i in e){if(!R.call(e,i))continue;n=e[i];this.instruction(i,n)}}else{if(_(t)){t=t.apply()}o=new g(this,e,t);this.onData(this.writer.processingInstruction(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1)}return this};XMLDocumentCB.prototype.declaration=function(e,t,r){var i;this.openCurrent();if(this.documentStarted){throw new Error("declaration() must be the first node.")}i=new d(this,e,t,r);this.onData(this.writer.declaration(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this};XMLDocumentCB.prototype.doctype=function(e,t,r){this.openCurrent();if(e==null){throw new Error("Missing root node name.")}if(this.root){throw new Error("dtd() must come before the root node.")}this.currentNode=new h(this,t,r);this.currentNode.rootNodeName=e;this.currentNode.children=false;this.currentLevel++;this.openTags[this.currentLevel]=this.currentNode;return this};XMLDocumentCB.prototype.dtdElement=function(e,t){var r;this.openCurrent();r=new c(this,e,t);this.onData(this.writer.dtdElement(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this};XMLDocumentCB.prototype.attList=function(e,t,r,i,n){var a;this.openCurrent();a=new s(this,e,t,r,i,n);this.onData(this.writer.dtdAttList(a,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this};XMLDocumentCB.prototype.entity=function(e,t){var r;this.openCurrent();r=new u(this,false,e,t);this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this};XMLDocumentCB.prototype.pEntity=function(e,t){var r;this.openCurrent();r=new u(this,true,e,t);this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this};XMLDocumentCB.prototype.notation=function(e,t){var r;this.openCurrent();r=new l(this,e,t);this.onData(this.writer.dtdNotation(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this};XMLDocumentCB.prototype.up=function(){if(this.currentLevel<0){throw new Error("The document node has no parent.")}if(this.currentNode){if(this.currentNode.children){this.closeNode(this.currentNode)}else{this.openNode(this.currentNode)}this.currentNode=null}else{this.closeNode(this.openTags[this.currentLevel])}delete this.openTags[this.currentLevel];this.currentLevel--;return this};XMLDocumentCB.prototype.end=function(){while(this.currentLevel>=0){this.up()}return this.onEnd()};XMLDocumentCB.prototype.openCurrent=function(){if(this.currentNode){this.currentNode.children=true;return this.openNode(this.currentNode)}};XMLDocumentCB.prototype.openNode=function(e){var r,n,a,o;if(!e.isOpen){if(!this.root&&this.currentLevel===0&&e.type===t.Element){this.root=e}n="";if(e.type===t.Element){this.writerOptions.state=i.OpenTag;n=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<"+e.name;o=e.attribs;for(a in o){if(!R.call(o,a))continue;r=o[a];n+=this.writer.attribute(r,this.writerOptions,this.currentLevel)}n+=(e.children?">":"/>")+this.writer.endline(e,this.writerOptions,this.currentLevel);this.writerOptions.state=i.InsideTag}else{this.writerOptions.state=i.OpenTag;n=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+e.rootNodeName;if(e.pubID&&e.sysID){n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'}else if(e.sysID){n+=' SYSTEM "'+e.sysID+'"'}if(e.children){n+=" [";this.writerOptions.state=i.InsideTag}else{this.writerOptions.state=i.CloseTag;n+=">"}n+=this.writer.endline(e,this.writerOptions,this.currentLevel)}this.onData(n,this.currentLevel);return e.isOpen=true}};XMLDocumentCB.prototype.closeNode=function(e){var r;if(!e.isClosed){r="";this.writerOptions.state=i.CloseTag;if(e.type===t.Element){r=this.writer.indent(e,this.writerOptions,this.currentLevel)+"</"+e.name+">"+this.writer.endline(e,this.writerOptions,this.currentLevel)}else{r=this.writer.indent(e,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(e,this.writerOptions,this.currentLevel)}this.writerOptions.state=i.None;this.onData(r,this.currentLevel);return e.isClosed=true}};XMLDocumentCB.prototype.onData=function(e,t){this.documentStarted=true;return this.onDataCallback(e,t+1)};XMLDocumentCB.prototype.onEnd=function(){this.documentCompleted=true;return this.onEndCallback()};XMLDocumentCB.prototype.debugInfo=function(e){if(e==null){return""}else{return"node: <"+e+">"}};XMLDocumentCB.prototype.ele=function(){return this.element.apply(this,arguments)};XMLDocumentCB.prototype.nod=function(e,t,r){return this.node(e,t,r)};XMLDocumentCB.prototype.txt=function(e){return this.text(e)};XMLDocumentCB.prototype.dat=function(e){return this.cdata(e)};XMLDocumentCB.prototype.com=function(e){return this.comment(e)};XMLDocumentCB.prototype.ins=function(e,t){return this.instruction(e,t)};XMLDocumentCB.prototype.dec=function(e,t,r){return this.declaration(e,t,r)};XMLDocumentCB.prototype.dtd=function(e,t,r){return this.doctype(e,t,r)};XMLDocumentCB.prototype.e=function(e,t,r){return this.element(e,t,r)};XMLDocumentCB.prototype.n=function(e,t,r){return this.node(e,t,r)};XMLDocumentCB.prototype.t=function(e){return this.text(e)};XMLDocumentCB.prototype.d=function(e){return this.cdata(e)};XMLDocumentCB.prototype.c=function(e){return this.comment(e)};XMLDocumentCB.prototype.r=function(e){return this.raw(e)};XMLDocumentCB.prototype.i=function(e,t){return this.instruction(e,t)};XMLDocumentCB.prototype.att=function(){if(this.currentNode&&this.currentNode.type===t.DocType){return this.attList.apply(this,arguments)}else{return this.attribute.apply(this,arguments)}};XMLDocumentCB.prototype.a=function(){if(this.currentNode&&this.currentNode.type===t.DocType){return this.attList.apply(this,arguments)}else{return this.attribute.apply(this,arguments)}};XMLDocumentCB.prototype.ent=function(e,t){return this.entity(e,t)};XMLDocumentCB.prototype.pent=function(e,t){return this.pEntity(e,t)};XMLDocumentCB.prototype.not=function(e,t){return this.notation(e,t)};return XMLDocumentCB}()}).call(this)},6913:function(e,t,r){(function(){var t,i,n,extend=function(e,t){for(var r in t){if(a.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},a={}.hasOwnProperty;n=r(8196);t=r(8052);e.exports=i=function(e){extend(XMLDummy,e);function XMLDummy(e){XMLDummy.__super__.constructor.call(this,e);this.type=t.Dummy}XMLDummy.prototype.clone=function(){return Object.create(this)};XMLDummy.prototype.toString=function(e){return""};return XMLDummy}(n)}).call(this)},6717:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,l,extend=function(e,t){for(var r in t){if(d.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},d={}.hasOwnProperty;l=r(1962),u=l.isObject,c=l.isFunction,s=l.getValue;o=r(8196);t=r(8052);i=r(7295);a=r(9854);e.exports=n=function(e){extend(XMLElement,e);function XMLElement(e,r,i){var n,a,o,s;XMLElement.__super__.constructor.call(this,e);if(r==null){throw new Error("Missing element name. "+this.debugInfo())}this.name=this.stringify.name(r);this.type=t.Element;this.attribs={};this.schemaTypeInfo=null;if(i!=null){this.attribute(i)}if(e.type===t.Document){this.isRoot=true;this.documentObject=e;e.rootObject=this;if(e.children){s=e.children;for(a=0,o=s.length;a<o;a++){n=s[a];if(n.type===t.DocType){n.name=this.name;break}}}}}Object.defineProperty(XMLElement.prototype,"tagName",{get:function(){return this.name}});Object.defineProperty(XMLElement.prototype,"namespaceURI",{get:function(){return""}});Object.defineProperty(XMLElement.prototype,"prefix",{get:function(){return""}});Object.defineProperty(XMLElement.prototype,"localName",{get:function(){return this.name}});Object.defineProperty(XMLElement.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}});Object.defineProperty(XMLElement.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}});Object.defineProperty(XMLElement.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}});Object.defineProperty(XMLElement.prototype,"attributes",{get:function(){if(!this.attributeMap||!this.attributeMap.nodes){this.attributeMap=new a(this.attribs)}return this.attributeMap}});XMLElement.prototype.clone=function(){var e,t,r,i;r=Object.create(this);if(r.isRoot){r.documentObject=null}r.attribs={};i=this.attribs;for(t in i){if(!d.call(i,t))continue;e=i[t];r.attribs[t]=e.clone()}r.children=[];this.children.forEach((function(e){var t;t=e.clone();t.parent=r;return r.children.push(t)}));return r};XMLElement.prototype.attribute=function(e,t){var r,n;if(e!=null){e=s(e)}if(u(e)){for(r in e){if(!d.call(e,r))continue;n=e[r];this.attribute(r,n)}}else{if(c(t)){t=t.apply()}if(this.options.keepNullAttributes&&t==null){this.attribs[e]=new i(this,e,"")}else if(t!=null){this.attribs[e]=new i(this,e,t)}}return this};XMLElement.prototype.removeAttribute=function(e){var t,r,i;if(e==null){throw new Error("Missing attribute name. "+this.debugInfo())}e=s(e);if(Array.isArray(e)){for(r=0,i=e.length;r<i;r++){t=e[r];delete this.attribs[t]}}else{delete this.attribs[e]}return this};XMLElement.prototype.toString=function(e){return this.options.writer.element(this,this.options.writer.filterOptions(e))};XMLElement.prototype.att=function(e,t){return this.attribute(e,t)};XMLElement.prototype.a=function(e,t){return this.attribute(e,t)};XMLElement.prototype.getAttribute=function(e){if(this.attribs.hasOwnProperty(e)){return this.attribs[e].value}else{return null}};XMLElement.prototype.setAttribute=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.getAttributeNode=function(e){if(this.attribs.hasOwnProperty(e)){return this.attribs[e]}else{return null}};XMLElement.prototype.setAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.removeAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.getAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.setAttributeNS=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.removeAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.getAttributeNodeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.setAttributeNodeNS=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.hasAttribute=function(e){return this.attribs.hasOwnProperty(e)};XMLElement.prototype.hasAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.setIdAttribute=function(e,t){if(this.attribs.hasOwnProperty(e)){return this.attribs[e].isId}else{return t}};XMLElement.prototype.setIdAttributeNS=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.setIdAttributeNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLElement.prototype.isEqualNode=function(e){var t,r,i;if(!XMLElement.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)){return false}if(e.namespaceURI!==this.namespaceURI){return false}if(e.prefix!==this.prefix){return false}if(e.localName!==this.localName){return false}if(e.attribs.length!==this.attribs.length){return false}for(t=r=0,i=this.attribs.length-1;0<=i?r<=i:r>=i;t=0<=i?++r:--r){if(!this.attribs[t].isEqualNode(e.attribs[t])){return false}}return true};return XMLElement}(o)}).call(this)},9854:function(e){(function(){var t;e.exports=t=function(){function XMLNamedNodeMap(e){this.nodes=e}Object.defineProperty(XMLNamedNodeMap.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}});XMLNamedNodeMap.prototype.clone=function(){return this.nodes=null};XMLNamedNodeMap.prototype.getNamedItem=function(e){return this.nodes[e]};XMLNamedNodeMap.prototype.setNamedItem=function(e){var t;t=this.nodes[e.nodeName];this.nodes[e.nodeName]=e;return t||null};XMLNamedNodeMap.prototype.removeNamedItem=function(e){var t;t=this.nodes[e];delete this.nodes[e];return t||null};XMLNamedNodeMap.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null};XMLNamedNodeMap.prototype.getNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")};XMLNamedNodeMap.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")};XMLNamedNodeMap.prototype.removeNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")};return XMLNamedNodeMap}()}).call(this)},8196:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,l,d,h,p,v,m,g,y,C,T,E,D={}.hasOwnProperty;E=r(1962),T=E.isObject,C=E.isFunction,y=E.isEmpty,g=E.getValue;u=null;n=null;a=null;o=null;s=null;v=null;m=null;p=null;c=null;i=null;h=null;l=null;t=null;e.exports=d=function(){function XMLNode(e){this.parent=e;if(this.parent){this.options=this.parent.options;this.stringify=this.parent.stringify}this.value=null;this.children=[];this.baseURI=null;if(!u){u=r(6717);n=r(6249);a=r(1740);o=r(720);s=r(7719);v=r(3737);m=r(8685);p=r(6085);c=r(6913);i=r(8052);h=r(6409);l=r(9854);t=r(2161)}}Object.defineProperty(XMLNode.prototype,"nodeName",{get:function(){return this.name}});Object.defineProperty(XMLNode.prototype,"nodeType",{get:function(){return this.type}});Object.defineProperty(XMLNode.prototype,"nodeValue",{get:function(){return this.value}});Object.defineProperty(XMLNode.prototype,"parentNode",{get:function(){return this.parent}});Object.defineProperty(XMLNode.prototype,"childNodes",{get:function(){if(!this.childNodeList||!this.childNodeList.nodes){this.childNodeList=new h(this.children)}return this.childNodeList}});Object.defineProperty(XMLNode.prototype,"firstChild",{get:function(){return this.children[0]||null}});Object.defineProperty(XMLNode.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}});Object.defineProperty(XMLNode.prototype,"previousSibling",{get:function(){var e;e=this.parent.children.indexOf(this);return this.parent.children[e-1]||null}});Object.defineProperty(XMLNode.prototype,"nextSibling",{get:function(){var e;e=this.parent.children.indexOf(this);return this.parent.children[e+1]||null}});Object.defineProperty(XMLNode.prototype,"ownerDocument",{get:function(){return this.document()||null}});Object.defineProperty(XMLNode.prototype,"textContent",{get:function(){var e,t,r,n,a;if(this.nodeType===i.Element||this.nodeType===i.DocumentFragment){a="";n=this.children;for(t=0,r=n.length;t<r;t++){e=n[t];if(e.textContent){a+=e.textContent}}return a}else{return null}},set:function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}});XMLNode.prototype.setParent=function(e){var t,r,i,n,a;this.parent=e;if(e){this.options=e.options;this.stringify=e.stringify}n=this.children;a=[];for(r=0,i=n.length;r<i;r++){t=n[r];a.push(t.setParent(this))}return a};XMLNode.prototype.element=function(e,t,r){var i,n,a,o,s,c,u,l,d,h,p;c=null;if(t===null&&r==null){d=[{},null],t=d[0],r=d[1]}if(t==null){t={}}t=g(t);if(!T(t)){h=[t,r],r=h[0],t=h[1]}if(e!=null){e=g(e)}if(Array.isArray(e)){for(a=0,u=e.length;a<u;a++){n=e[a];c=this.element(n)}}else if(C(e)){c=this.element(e.apply())}else if(T(e)){for(s in e){if(!D.call(e,s))continue;p=e[s];if(C(p)){p=p.apply()}if(!this.options.ignoreDecorators&&this.stringify.convertAttKey&&s.indexOf(this.stringify.convertAttKey)===0){c=this.attribute(s.substr(this.stringify.convertAttKey.length),p)}else if(!this.options.separateArrayItems&&Array.isArray(p)&&y(p)){c=this.dummy()}else if(T(p)&&y(p)){c=this.element(s)}else if(!this.options.keepNullNodes&&p==null){c=this.dummy()}else if(!this.options.separateArrayItems&&Array.isArray(p)){for(o=0,l=p.length;o<l;o++){n=p[o];i={};i[s]=n;c=this.element(i)}}else if(T(p)){if(!this.options.ignoreDecorators&&this.stringify.convertTextKey&&s.indexOf(this.stringify.convertTextKey)===0){c=this.element(p)}else{c=this.element(s);c.element(p)}}else{c=this.element(s,p)}}}else if(!this.options.keepNullNodes&&r===null){c=this.dummy()}else{if(!this.options.ignoreDecorators&&this.stringify.convertTextKey&&e.indexOf(this.stringify.convertTextKey)===0){c=this.text(r)}else if(!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&e.indexOf(this.stringify.convertCDataKey)===0){c=this.cdata(r)}else if(!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&e.indexOf(this.stringify.convertCommentKey)===0){c=this.comment(r)}else if(!this.options.ignoreDecorators&&this.stringify.convertRawKey&&e.indexOf(this.stringify.convertRawKey)===0){c=this.raw(r)}else if(!this.options.ignoreDecorators&&this.stringify.convertPIKey&&e.indexOf(this.stringify.convertPIKey)===0){c=this.instruction(e.substr(this.stringify.convertPIKey.length),r)}else{c=this.node(e,t,r)}}if(c==null){throw new Error("Could not create any elements with: "+e+". "+this.debugInfo())}return c};XMLNode.prototype.insertBefore=function(e,t,r){var i,n,a,o,s;if(e!=null?e.type:void 0){a=e;o=t;a.setParent(this);if(o){n=children.indexOf(o);s=children.splice(n);children.push(a);Array.prototype.push.apply(children,s)}else{children.push(a)}return a}else{if(this.isRoot){throw new Error("Cannot insert elements at root level. "+this.debugInfo(e))}n=this.parent.children.indexOf(this);s=this.parent.children.splice(n);i=this.parent.element(e,t,r);Array.prototype.push.apply(this.parent.children,s);return i}};XMLNode.prototype.insertAfter=function(e,t,r){var i,n,a;if(this.isRoot){throw new Error("Cannot insert elements at root level. "+this.debugInfo(e))}n=this.parent.children.indexOf(this);a=this.parent.children.splice(n+1);i=this.parent.element(e,t,r);Array.prototype.push.apply(this.parent.children,a);return i};XMLNode.prototype.remove=function(){var e,t;if(this.isRoot){throw new Error("Cannot remove the root element. "+this.debugInfo())}e=this.parent.children.indexOf(this);[].splice.apply(this.parent.children,[e,e-e+1].concat(t=[])),t;return this.parent};XMLNode.prototype.node=function(e,t,r){var i,n;if(e!=null){e=g(e)}t||(t={});t=g(t);if(!T(t)){n=[t,r],r=n[0],t=n[1]}i=new u(this,e,t);if(r!=null){i.text(r)}this.children.push(i);return i};XMLNode.prototype.text=function(e){var t;if(T(e)){this.element(e)}t=new m(this,e);this.children.push(t);return this};XMLNode.prototype.cdata=function(e){var t;t=new n(this,e);this.children.push(t);return this};XMLNode.prototype.comment=function(e){var t;t=new a(this,e);this.children.push(t);return this};XMLNode.prototype.commentBefore=function(e){var t,r,i;r=this.parent.children.indexOf(this);i=this.parent.children.splice(r);t=this.parent.comment(e);Array.prototype.push.apply(this.parent.children,i);return this};XMLNode.prototype.commentAfter=function(e){var t,r,i;r=this.parent.children.indexOf(this);i=this.parent.children.splice(r+1);t=this.parent.comment(e);Array.prototype.push.apply(this.parent.children,i);return this};XMLNode.prototype.raw=function(e){var t;t=new v(this,e);this.children.push(t);return this};XMLNode.prototype.dummy=function(){var e;e=new c(this);return e};XMLNode.prototype.instruction=function(e,t){var r,i,n,a,o;if(e!=null){e=g(e)}if(t!=null){t=g(t)}if(Array.isArray(e)){for(a=0,o=e.length;a<o;a++){r=e[a];this.instruction(r)}}else if(T(e)){for(r in e){if(!D.call(e,r))continue;i=e[r];this.instruction(r,i)}}else{if(C(t)){t=t.apply()}n=new p(this,e,t);this.children.push(n)}return this};XMLNode.prototype.instructionBefore=function(e,t){var r,i,n;i=this.parent.children.indexOf(this);n=this.parent.children.splice(i);r=this.parent.instruction(e,t);Array.prototype.push.apply(this.parent.children,n);return this};XMLNode.prototype.instructionAfter=function(e,t){var r,i,n;i=this.parent.children.indexOf(this);n=this.parent.children.splice(i+1);r=this.parent.instruction(e,t);Array.prototype.push.apply(this.parent.children,n);return this};XMLNode.prototype.declaration=function(e,t,r){var n,a;n=this.document();a=new o(n,e,t,r);if(n.children.length===0){n.children.unshift(a)}else if(n.children[0].type===i.Declaration){n.children[0]=a}else{n.children.unshift(a)}return n.root()||n};XMLNode.prototype.dtd=function(e,t){var r,n,a,o,c,u,l,d,h,p;n=this.document();a=new s(n,e,t);h=n.children;for(o=c=0,l=h.length;c<l;o=++c){r=h[o];if(r.type===i.DocType){n.children[o]=a;return a}}p=n.children;for(o=u=0,d=p.length;u<d;o=++u){r=p[o];if(r.isRoot){n.children.splice(o,0,a);return a}}n.children.push(a);return a};XMLNode.prototype.up=function(){if(this.isRoot){throw new Error("The root node has no parent. Use doc() if you need to get the document object.")}return this.parent};XMLNode.prototype.root=function(){var e;e=this;while(e){if(e.type===i.Document){return e.rootObject}else if(e.isRoot){return e}else{e=e.parent}}};XMLNode.prototype.document=function(){var e;e=this;while(e){if(e.type===i.Document){return e}else{e=e.parent}}};XMLNode.prototype.end=function(e){return this.document().end(e)};XMLNode.prototype.prev=function(){var e;e=this.parent.children.indexOf(this);if(e<1){throw new Error("Already at the first node. "+this.debugInfo())}return this.parent.children[e-1]};XMLNode.prototype.next=function(){var e;e=this.parent.children.indexOf(this);if(e===-1||e===this.parent.children.length-1){throw new Error("Already at the last node. "+this.debugInfo())}return this.parent.children[e+1]};XMLNode.prototype.importDocument=function(e){var t;t=e.root().clone();t.parent=this;t.isRoot=false;this.children.push(t);return this};XMLNode.prototype.debugInfo=function(e){var t,r;e=e||this.name;if(e==null&&!((t=this.parent)!=null?t.name:void 0)){return""}else if(e==null){return"parent: <"+this.parent.name+">"}else if(!((r=this.parent)!=null?r.name:void 0)){return"node: <"+e+">"}else{return"node: <"+e+">, parent: <"+this.parent.name+">"}};XMLNode.prototype.ele=function(e,t,r){return this.element(e,t,r)};XMLNode.prototype.nod=function(e,t,r){return this.node(e,t,r)};XMLNode.prototype.txt=function(e){return this.text(e)};XMLNode.prototype.dat=function(e){return this.cdata(e)};XMLNode.prototype.com=function(e){return this.comment(e)};XMLNode.prototype.ins=function(e,t){return this.instruction(e,t)};XMLNode.prototype.doc=function(){return this.document()};XMLNode.prototype.dec=function(e,t,r){return this.declaration(e,t,r)};XMLNode.prototype.e=function(e,t,r){return this.element(e,t,r)};XMLNode.prototype.n=function(e,t,r){return this.node(e,t,r)};XMLNode.prototype.t=function(e){return this.text(e)};XMLNode.prototype.d=function(e){return this.cdata(e)};XMLNode.prototype.c=function(e){return this.comment(e)};XMLNode.prototype.r=function(e){return this.raw(e)};XMLNode.prototype.i=function(e,t){return this.instruction(e,t)};XMLNode.prototype.u=function(){return this.up()};XMLNode.prototype.importXMLBuilder=function(e){return this.importDocument(e)};XMLNode.prototype.replaceChild=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.removeChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.appendChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.hasChildNodes=function(){return this.children.length!==0};XMLNode.prototype.cloneNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.isSupported=function(e,t){return true};XMLNode.prototype.hasAttributes=function(){return this.attribs.length!==0};XMLNode.prototype.compareDocumentPosition=function(e){var r,i;r=this;if(r===e){return 0}else if(this.document()!==e.document()){i=t.Disconnected|t.ImplementationSpecific;if(Math.random()<.5){i|=t.Preceding}else{i|=t.Following}return i}else if(r.isAncestor(e)){return t.Contains|t.Preceding}else if(r.isDescendant(e)){return t.Contains|t.Following}else if(r.isPreceding(e)){return t.Preceding}else{return t.Following}};XMLNode.prototype.isSameNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.lookupPrefix=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.isDefaultNamespace=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.lookupNamespaceURI=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.isEqualNode=function(e){var t,r,i;if(e.nodeType!==this.nodeType){return false}if(e.children.length!==this.children.length){return false}for(t=r=0,i=this.children.length-1;0<=i?r<=i:r>=i;t=0<=i?++r:--r){if(!this.children[t].isEqualNode(e.children[t])){return false}}return true};XMLNode.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.setUserData=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.getUserData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLNode.prototype.contains=function(e){if(!e){return false}return e===this||this.isDescendant(e)};XMLNode.prototype.isDescendant=function(e){var t,r,i,n,a;a=this.children;for(i=0,n=a.length;i<n;i++){t=a[i];if(e===t){return true}r=t.isDescendant(e);if(r){return true}}return false};XMLNode.prototype.isAncestor=function(e){return e.isDescendant(this)};XMLNode.prototype.isPreceding=function(e){var t,r;t=this.treePosition(e);r=this.treePosition(this);if(t===-1||r===-1){return false}else{return t<r}};XMLNode.prototype.isFollowing=function(e){var t,r;t=this.treePosition(e);r=this.treePosition(this);if(t===-1||r===-1){return false}else{return t>r}};XMLNode.prototype.treePosition=function(e){var t,r;r=0;t=false;this.foreachTreeNode(this.document(),(function(i){r++;if(!t&&i===e){return t=true}}));if(t){return r}else{return-1}};XMLNode.prototype.foreachTreeNode=function(e,t){var r,i,n,a,o;e||(e=this.document());a=e.children;for(i=0,n=a.length;i<n;i++){r=a[i];if(o=t(r)){return o}else{o=this.foreachTreeNode(r,t);if(o){return o}}}};return XMLNode}()}).call(this)},6409:function(e){(function(){var t;e.exports=t=function(){function XMLNodeList(e){this.nodes=e}Object.defineProperty(XMLNodeList.prototype,"length",{get:function(){return this.nodes.length||0}});XMLNodeList.prototype.clone=function(){return this.nodes=null};XMLNodeList.prototype.item=function(e){return this.nodes[e]||null};return XMLNodeList}()}).call(this)},6085:function(e,t,r){(function(){var t,i,n,extend=function(e,t){for(var r in t){if(a.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},a={}.hasOwnProperty;t=r(8052);i=r(5775);e.exports=n=function(e){extend(XMLProcessingInstruction,e);function XMLProcessingInstruction(e,r,i){XMLProcessingInstruction.__super__.constructor.call(this,e);if(r==null){throw new Error("Missing instruction target. "+this.debugInfo())}this.type=t.ProcessingInstruction;this.target=this.stringify.insTarget(r);this.name=this.target;if(i){this.value=this.stringify.insValue(i)}}XMLProcessingInstruction.prototype.clone=function(){return Object.create(this)};XMLProcessingInstruction.prototype.toString=function(e){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(e))};XMLProcessingInstruction.prototype.isEqualNode=function(e){if(!XMLProcessingInstruction.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)){return false}if(e.target!==this.target){return false}return true};return XMLProcessingInstruction}(i)}).call(this)},3737:function(e,t,r){(function(){var t,i,n,extend=function(e,t){for(var r in t){if(a.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},a={}.hasOwnProperty;t=r(8052);i=r(8196);e.exports=n=function(e){extend(XMLRaw,e);function XMLRaw(e,r){XMLRaw.__super__.constructor.call(this,e);if(r==null){throw new Error("Missing raw text. "+this.debugInfo())}this.type=t.Raw;this.value=this.stringify.raw(r)}XMLRaw.prototype.clone=function(){return Object.create(this)};XMLRaw.prototype.toString=function(e){return this.options.writer.raw(this,this.options.writer.filterOptions(e))};return XMLRaw}(i)}).call(this)},6275:function(e,t,r){(function(){var t,i,n,a,extend=function(e,t){for(var r in t){if(o.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},o={}.hasOwnProperty;t=r(8052);a=r(5447);i=r(6933);e.exports=n=function(e){extend(XMLStreamWriter,e);function XMLStreamWriter(e,t){this.stream=e;XMLStreamWriter.__super__.constructor.call(this,t)}XMLStreamWriter.prototype.endline=function(e,t,r){if(e.isLastRootNode&&t.state===i.CloseTag){return""}else{return XMLStreamWriter.__super__.endline.call(this,e,t,r)}};XMLStreamWriter.prototype.document=function(e,t){var r,i,n,a,o,s,c,u,l;c=e.children;for(i=n=0,o=c.length;n<o;i=++n){r=c[i];r.isLastRootNode=i===e.children.length-1}t=this.filterOptions(t);u=e.children;l=[];for(a=0,s=u.length;a<s;a++){r=u[a];l.push(this.writeChildNode(r,t,0))}return l};XMLStreamWriter.prototype.attribute=function(e,t,r){return this.stream.write(XMLStreamWriter.__super__.attribute.call(this,e,t,r))};XMLStreamWriter.prototype.cdata=function(e,t,r){return this.stream.write(XMLStreamWriter.__super__.cdata.call(this,e,t,r))};XMLStreamWriter.prototype.comment=function(e,t,r){return this.stream.write(XMLStreamWriter.__super__.comment.call(this,e,t,r))};XMLStreamWriter.prototype.declaration=function(e,t,r){return this.stream.write(XMLStreamWriter.__super__.declaration.call(this,e,t,r))};XMLStreamWriter.prototype.docType=function(e,t,r){var n,a,o,s;r||(r=0);this.openNode(e,t,r);t.state=i.OpenTag;this.stream.write(this.indent(e,t,r));this.stream.write("<!DOCTYPE "+e.root().name);if(e.pubID&&e.sysID){this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"')}else if(e.sysID){this.stream.write(' SYSTEM "'+e.sysID+'"')}if(e.children.length>0){this.stream.write(" [");this.stream.write(this.endline(e,t,r));t.state=i.InsideTag;s=e.children;for(a=0,o=s.length;a<o;a++){n=s[a];this.writeChildNode(n,t,r+1)}t.state=i.CloseTag;this.stream.write("]")}t.state=i.CloseTag;this.stream.write(t.spaceBeforeSlash+">");this.stream.write(this.endline(e,t,r));t.state=i.None;return this.closeNode(e,t,r)};XMLStreamWriter.prototype.element=function(e,r,n){var a,s,c,u,l,d,h,p,v,m;n||(n=0);this.openNode(e,r,n);r.state=i.OpenTag;this.stream.write(this.indent(e,r,n)+"<"+e.name);v=e.attribs;for(h in v){if(!o.call(v,h))continue;a=v[h];this.attribute(a,r,n)}c=e.children.length;u=c===0?null:e.children[0];if(c===0||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&e.value===""}))){if(r.allowEmpty){this.stream.write(">");r.state=i.CloseTag;this.stream.write("</"+e.name+">")}else{r.state=i.CloseTag;this.stream.write(r.spaceBeforeSlash+"/>")}}else if(r.pretty&&c===1&&(u.type===t.Text||u.type===t.Raw)&&u.value!=null){this.stream.write(">");r.state=i.InsideTag;r.suppressPrettyCount++;p=true;this.writeChildNode(u,r,n+1);r.suppressPrettyCount--;p=false;r.state=i.CloseTag;this.stream.write("</"+e.name+">")}else{this.stream.write(">"+this.endline(e,r,n));r.state=i.InsideTag;m=e.children;for(l=0,d=m.length;l<d;l++){s=m[l];this.writeChildNode(s,r,n+1)}r.state=i.CloseTag;this.stream.write(this.indent(e,r,n)+"</"+e.name+">")}this.stream.write(this.endline(e,r,n));r.state=i.None;return this.closeNode(e,r,n)};XMLStreamWriter.prototype.processingInstruction=function(e,t,r){return this.stream.write(XMLStreamWriter.__super__.processingInstruction.call(this,e,t,r))};XMLStreamWriter.prototype.raw=function(e,t,r){return this.stream.write(XMLStreamWriter.__super__.raw.call(this,e,t,r))};XMLStreamWriter.prototype.text=function(e,t,r){return this.stream.write(XMLStreamWriter.__super__.text.call(this,e,t,r))};XMLStreamWriter.prototype.dtdAttList=function(e,t,r){return this.stream.write(XMLStreamWriter.__super__.dtdAttList.call(this,e,t,r))};XMLStreamWriter.prototype.dtdElement=function(e,t,r){return this.stream.write(XMLStreamWriter.__super__.dtdElement.call(this,e,t,r))};XMLStreamWriter.prototype.dtdEntity=function(e,t,r){return this.stream.write(XMLStreamWriter.__super__.dtdEntity.call(this,e,t,r))};XMLStreamWriter.prototype.dtdNotation=function(e,t,r){return this.stream.write(XMLStreamWriter.__super__.dtdNotation.call(this,e,t,r))};return XMLStreamWriter}(a)}).call(this)},5023:function(e,t,r){(function(){var t,i,extend=function(e,t){for(var r in t){if(n.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},n={}.hasOwnProperty;i=r(5447);e.exports=t=function(e){extend(XMLStringWriter,e);function XMLStringWriter(e){XMLStringWriter.__super__.constructor.call(this,e)}XMLStringWriter.prototype.document=function(e,t){var r,i,n,a,o;t=this.filterOptions(t);a="";o=e.children;for(i=0,n=o.length;i<n;i++){r=o[i];a+=this.writeChildNode(r,t,0)}if(t.pretty&&a.slice(-t.newline.length)===t.newline){a=a.slice(0,-t.newline.length)}return a};return XMLStringWriter}(i)}).call(this)},6892:function(e){(function(){var t,bind=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty;e.exports=t=function(){function XMLStringifier(e){this.assertLegalName=bind(this.assertLegalName,this);this.assertLegalChar=bind(this.assertLegalChar,this);var t,i,n;e||(e={});this.options=e;if(!this.options.version){this.options.version="1.0"}i=e.stringify||{};for(t in i){if(!r.call(i,t))continue;n=i[t];this[t]=n}}XMLStringifier.prototype.name=function(e){if(this.options.noValidation){return e}return this.assertLegalName(""+e||"")};XMLStringifier.prototype.text=function(e){if(this.options.noValidation){return e}return this.assertLegalChar(this.textEscape(""+e||""))};XMLStringifier.prototype.cdata=function(e){if(this.options.noValidation){return e}e=""+e||"";e=e.replace("]]>","]]]]><![CDATA[>");return this.assertLegalChar(e)};XMLStringifier.prototype.comment=function(e){if(this.options.noValidation){return e}e=""+e||"";if(e.match(/--/)){throw new Error("Comment text cannot contain double-hypen: "+e)}return this.assertLegalChar(e)};XMLStringifier.prototype.raw=function(e){if(this.options.noValidation){return e}return""+e||""};XMLStringifier.prototype.attValue=function(e){if(this.options.noValidation){return e}return this.assertLegalChar(this.attEscape(e=""+e||""))};XMLStringifier.prototype.insTarget=function(e){if(this.options.noValidation){return e}return this.assertLegalChar(""+e||"")};XMLStringifier.prototype.insValue=function(e){if(this.options.noValidation){return e}e=""+e||"";if(e.match(/\?>/)){throw new Error("Invalid processing instruction value: "+e)}return this.assertLegalChar(e)};XMLStringifier.prototype.xmlVersion=function(e){if(this.options.noValidation){return e}e=""+e||"";if(!e.match(/1\.[0-9]+/)){throw new Error("Invalid version number: "+e)}return e};XMLStringifier.prototype.xmlEncoding=function(e){if(this.options.noValidation){return e}e=""+e||"";if(!e.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/)){throw new Error("Invalid encoding: "+e)}return this.assertLegalChar(e)};XMLStringifier.prototype.xmlStandalone=function(e){if(this.options.noValidation){return e}if(e){return"yes"}else{return"no"}};XMLStringifier.prototype.dtdPubID=function(e){if(this.options.noValidation){return e}return this.assertLegalChar(""+e||"")};XMLStringifier.prototype.dtdSysID=function(e){if(this.options.noValidation){return e}return this.assertLegalChar(""+e||"")};XMLStringifier.prototype.dtdElementValue=function(e){if(this.options.noValidation){return e}return this.assertLegalChar(""+e||"")};XMLStringifier.prototype.dtdAttType=function(e){if(this.options.noValidation){return e}return this.assertLegalChar(""+e||"")};XMLStringifier.prototype.dtdAttDefault=function(e){if(this.options.noValidation){return e}return this.assertLegalChar(""+e||"")};XMLStringifier.prototype.dtdEntityValue=function(e){if(this.options.noValidation){return e}return this.assertLegalChar(""+e||"")};XMLStringifier.prototype.dtdNData=function(e){if(this.options.noValidation){return e}return this.assertLegalChar(""+e||"")};XMLStringifier.prototype.convertAttKey="@";XMLStringifier.prototype.convertPIKey="?";XMLStringifier.prototype.convertTextKey="#text";XMLStringifier.prototype.convertCDataKey="#cdata";XMLStringifier.prototype.convertCommentKey="#comment";XMLStringifier.prototype.convertRawKey="#raw";XMLStringifier.prototype.assertLegalChar=function(e){var t,r;if(this.options.noValidation){return e}t="";if(this.options.version==="1.0"){t=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/;if(r=e.match(t)){throw new Error("Invalid character in string: "+e+" at index "+r.index)}}else if(this.options.version==="1.1"){t=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/;if(r=e.match(t)){throw new Error("Invalid character in string: "+e+" at index "+r.index)}}return e};XMLStringifier.prototype.assertLegalName=function(e){var t;if(this.options.noValidation){return e}this.assertLegalChar(e);t=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/;if(!e.match(t)){throw new Error("Invalid character in name")}return e};XMLStringifier.prototype.textEscape=function(e){var t;if(this.options.noValidation){return e}t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g;return e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")};XMLStringifier.prototype.attEscape=function(e){var t;if(this.options.noValidation){return e}t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g;return e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")};return XMLStringifier}()}).call(this)},8685:function(e,t,r){(function(){var t,i,n,extend=function(e,t){for(var r in t){if(a.call(t,r))e[r]=t[r]}function ctor(){this.constructor=e}ctor.prototype=t.prototype;e.prototype=new ctor;e.__super__=t.prototype;return e},a={}.hasOwnProperty;t=r(8052);i=r(5775);e.exports=n=function(e){extend(XMLText,e);function XMLText(e,r){XMLText.__super__.constructor.call(this,e);if(r==null){throw new Error("Missing element text. "+this.debugInfo())}this.name="#text";this.type=t.Text;this.value=this.stringify.text(r)}Object.defineProperty(XMLText.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}});Object.defineProperty(XMLText.prototype,"wholeText",{get:function(){var e,t,r;r="";t=this.previousSibling;while(t){r=t.data+r;t=t.previousSibling}r+=this.data;e=this.nextSibling;while(e){r=r+e.data;e=e.nextSibling}return r}});XMLText.prototype.clone=function(){return Object.create(this)};XMLText.prototype.toString=function(e){return this.options.writer.text(this,this.options.writer.filterOptions(e))};XMLText.prototype.splitText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};XMLText.prototype.replaceWholeText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())};return XMLText}(i)}).call(this)},5447:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,l,d,h,p,v,m,g,y,C,T={}.hasOwnProperty;C=r(1962).assign;t=r(8052);l=r(720);d=r(7719);n=r(6249);a=r(1740);p=r(6717);m=r(3737);g=r(8685);v=r(6085);h=r(6913);o=r(1997);s=r(1088);c=r(1821);u=r(9142);i=r(6933);e.exports=y=function(){function XMLWriterBase(e){var t,r,i;e||(e={});this.options=e;r=e.writer||{};for(t in r){if(!T.call(r,t))continue;i=r[t];this["_"+t]=this[t];this[t]=i}}XMLWriterBase.prototype.filterOptions=function(e){var t,r,n,a,o,s,c,u;e||(e={});e=C({},this.options,e);t={writer:this};t.pretty=e.pretty||false;t.allowEmpty=e.allowEmpty||false;t.indent=(r=e.indent)!=null?r:"  ";t.newline=(n=e.newline)!=null?n:"\n";t.offset=(a=e.offset)!=null?a:0;t.dontPrettyTextNodes=(o=(s=e.dontPrettyTextNodes)!=null?s:e.dontprettytextnodes)!=null?o:0;t.spaceBeforeSlash=(c=(u=e.spaceBeforeSlash)!=null?u:e.spacebeforeslash)!=null?c:"";if(t.spaceBeforeSlash===true){t.spaceBeforeSlash=" "}t.suppressPrettyCount=0;t.user={};t.state=i.None;return t};XMLWriterBase.prototype.indent=function(e,t,r){var i;if(!t.pretty||t.suppressPrettyCount){return""}else if(t.pretty){i=(r||0)+t.offset+1;if(i>0){return new Array(i).join(t.indent)}}return""};XMLWriterBase.prototype.endline=function(e,t,r){if(!t.pretty||t.suppressPrettyCount){return""}else{return t.newline}};XMLWriterBase.prototype.attribute=function(e,t,r){var i;this.openAttribute(e,t,r);i=" "+e.name+'="'+e.value+'"';this.closeAttribute(e,t,r);return i};XMLWriterBase.prototype.cdata=function(e,t,r){var n;this.openNode(e,t,r);t.state=i.OpenTag;n=this.indent(e,t,r)+"<![CDATA[";t.state=i.InsideTag;n+=e.value;t.state=i.CloseTag;n+="]]>"+this.endline(e,t,r);t.state=i.None;this.closeNode(e,t,r);return n};XMLWriterBase.prototype.comment=function(e,t,r){var n;this.openNode(e,t,r);t.state=i.OpenTag;n=this.indent(e,t,r)+"\x3c!-- ";t.state=i.InsideTag;n+=e.value;t.state=i.CloseTag;n+=" --\x3e"+this.endline(e,t,r);t.state=i.None;this.closeNode(e,t,r);return n};XMLWriterBase.prototype.declaration=function(e,t,r){var n;this.openNode(e,t,r);t.state=i.OpenTag;n=this.indent(e,t,r)+"<?xml";t.state=i.InsideTag;n+=' version="'+e.version+'"';if(e.encoding!=null){n+=' encoding="'+e.encoding+'"'}if(e.standalone!=null){n+=' standalone="'+e.standalone+'"'}t.state=i.CloseTag;n+=t.spaceBeforeSlash+"?>";n+=this.endline(e,t,r);t.state=i.None;this.closeNode(e,t,r);return n};XMLWriterBase.prototype.docType=function(e,t,r){var n,a,o,s,c;r||(r=0);this.openNode(e,t,r);t.state=i.OpenTag;s=this.indent(e,t,r);s+="<!DOCTYPE "+e.root().name;if(e.pubID&&e.sysID){s+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'}else if(e.sysID){s+=' SYSTEM "'+e.sysID+'"'}if(e.children.length>0){s+=" [";s+=this.endline(e,t,r);t.state=i.InsideTag;c=e.children;for(a=0,o=c.length;a<o;a++){n=c[a];s+=this.writeChildNode(n,t,r+1)}t.state=i.CloseTag;s+="]"}t.state=i.CloseTag;s+=t.spaceBeforeSlash+">";s+=this.endline(e,t,r);t.state=i.None;this.closeNode(e,t,r);return s};XMLWriterBase.prototype.element=function(e,r,n){var a,o,s,c,u,l,d,h,p,v,m,g,y,C;n||(n=0);v=false;m="";this.openNode(e,r,n);r.state=i.OpenTag;m+=this.indent(e,r,n)+"<"+e.name;g=e.attribs;for(p in g){if(!T.call(g,p))continue;a=g[p];m+=this.attribute(a,r,n)}s=e.children.length;c=s===0?null:e.children[0];if(s===0||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&e.value===""}))){if(r.allowEmpty){m+=">";r.state=i.CloseTag;m+="</"+e.name+">"+this.endline(e,r,n)}else{r.state=i.CloseTag;m+=r.spaceBeforeSlash+"/>"+this.endline(e,r,n)}}else if(r.pretty&&s===1&&(c.type===t.Text||c.type===t.Raw)&&c.value!=null){m+=">";r.state=i.InsideTag;r.suppressPrettyCount++;v=true;m+=this.writeChildNode(c,r,n+1);r.suppressPrettyCount--;v=false;r.state=i.CloseTag;m+="</"+e.name+">"+this.endline(e,r,n)}else{if(r.dontPrettyTextNodes){y=e.children;for(u=0,d=y.length;u<d;u++){o=y[u];if((o.type===t.Text||o.type===t.Raw)&&o.value!=null){r.suppressPrettyCount++;v=true;break}}}m+=">"+this.endline(e,r,n);r.state=i.InsideTag;C=e.children;for(l=0,h=C.length;l<h;l++){o=C[l];m+=this.writeChildNode(o,r,n+1)}r.state=i.CloseTag;m+=this.indent(e,r,n)+"</"+e.name+">";if(v){r.suppressPrettyCount--}m+=this.endline(e,r,n);r.state=i.None}this.closeNode(e,r,n);return m};XMLWriterBase.prototype.writeChildNode=function(e,r,i){switch(e.type){case t.CData:return this.cdata(e,r,i);case t.Comment:return this.comment(e,r,i);case t.Element:return this.element(e,r,i);case t.Raw:return this.raw(e,r,i);case t.Text:return this.text(e,r,i);case t.ProcessingInstruction:return this.processingInstruction(e,r,i);case t.Dummy:return"";case t.Declaration:return this.declaration(e,r,i);case t.DocType:return this.docType(e,r,i);case t.AttributeDeclaration:return this.dtdAttList(e,r,i);case t.ElementDeclaration:return this.dtdElement(e,r,i);case t.EntityDeclaration:return this.dtdEntity(e,r,i);case t.NotationDeclaration:return this.dtdNotation(e,r,i);default:throw new Error("Unknown XML node type: "+e.constructor.name)}};XMLWriterBase.prototype.processingInstruction=function(e,t,r){var n;this.openNode(e,t,r);t.state=i.OpenTag;n=this.indent(e,t,r)+"<?";t.state=i.InsideTag;n+=e.target;if(e.value){n+=" "+e.value}t.state=i.CloseTag;n+=t.spaceBeforeSlash+"?>";n+=this.endline(e,t,r);t.state=i.None;this.closeNode(e,t,r);return n};XMLWriterBase.prototype.raw=function(e,t,r){var n;this.openNode(e,t,r);t.state=i.OpenTag;n=this.indent(e,t,r);t.state=i.InsideTag;n+=e.value;t.state=i.CloseTag;n+=this.endline(e,t,r);t.state=i.None;this.closeNode(e,t,r);return n};XMLWriterBase.prototype.text=function(e,t,r){var n;this.openNode(e,t,r);t.state=i.OpenTag;n=this.indent(e,t,r);t.state=i.InsideTag;n+=e.value;t.state=i.CloseTag;n+=this.endline(e,t,r);t.state=i.None;this.closeNode(e,t,r);return n};XMLWriterBase.prototype.dtdAttList=function(e,t,r){var n;this.openNode(e,t,r);t.state=i.OpenTag;n=this.indent(e,t,r)+"<!ATTLIST";t.state=i.InsideTag;n+=" "+e.elementName+" "+e.attributeName+" "+e.attributeType;if(e.defaultValueType!=="#DEFAULT"){n+=" "+e.defaultValueType}if(e.defaultValue){n+=' "'+e.defaultValue+'"'}t.state=i.CloseTag;n+=t.spaceBeforeSlash+">"+this.endline(e,t,r);t.state=i.None;this.closeNode(e,t,r);return n};XMLWriterBase.prototype.dtdElement=function(e,t,r){var n;this.openNode(e,t,r);t.state=i.OpenTag;n=this.indent(e,t,r)+"<!ELEMENT";t.state=i.InsideTag;n+=" "+e.name+" "+e.value;t.state=i.CloseTag;n+=t.spaceBeforeSlash+">"+this.endline(e,t,r);t.state=i.None;this.closeNode(e,t,r);return n};XMLWriterBase.prototype.dtdEntity=function(e,t,r){var n;this.openNode(e,t,r);t.state=i.OpenTag;n=this.indent(e,t,r)+"<!ENTITY";t.state=i.InsideTag;if(e.pe){n+=" %"}n+=" "+e.name;if(e.value){n+=' "'+e.value+'"'}else{if(e.pubID&&e.sysID){n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'}else if(e.sysID){n+=' SYSTEM "'+e.sysID+'"'}if(e.nData){n+=" NDATA "+e.nData}}t.state=i.CloseTag;n+=t.spaceBeforeSlash+">"+this.endline(e,t,r);t.state=i.None;this.closeNode(e,t,r);return n};XMLWriterBase.prototype.dtdNotation=function(e,t,r){var n;this.openNode(e,t,r);t.state=i.OpenTag;n=this.indent(e,t,r)+"<!NOTATION";t.state=i.InsideTag;n+=" "+e.name;if(e.pubID&&e.sysID){n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'}else if(e.pubID){n+=' PUBLIC "'+e.pubID+'"'}else if(e.sysID){n+=' SYSTEM "'+e.sysID+'"'}t.state=i.CloseTag;n+=t.spaceBeforeSlash+">"+this.endline(e,t,r);t.state=i.None;this.closeNode(e,t,r);return n};XMLWriterBase.prototype.openNode=function(e,t,r){};XMLWriterBase.prototype.closeNode=function(e,t,r){};XMLWriterBase.prototype.openAttribute=function(e,t,r){};XMLWriterBase.prototype.closeAttribute=function(e,t,r){};return XMLWriterBase}()}).call(this)},5845:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,l,d;d=r(1962),u=d.assign,l=d.isFunction;n=r(2699);a=r(2914);o=r(5974);c=r(5023);s=r(6275);t=r(8052);i=r(6933);e.exports.create=function(e,t,r,i){var n,o;if(e==null){throw new Error("Root element needs a name.")}i=u({},t,r,i);n=new a(i);o=n.element(e);if(!i.headless){n.declaration(i);if(i.pubID!=null||i.sysID!=null){n.dtd(i)}}return o};e.exports.begin=function(e,t,r){var i;if(l(e)){i=[e,t],t=i[0],r=i[1];e={}}if(t){return new o(e,t,r)}else{return new a(e)}};e.exports.stringWriter=function(e){return new c(e)};e.exports.streamWriter=function(e,t){return new s(e,t)};e.exports.implementation=new n;e.exports.nodeType=t;e.exports.writerState=i}).call(this)},9958:module=>{module.exports=eval("require")("abstract-socket")},430:module=>{module.exports=eval("require")("supports-color")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},1891:e=>{"use strict";e.exports=require("dgram")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},9512:e=>{"use strict";e.exports=require("timers")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},1143:(e,t,r)=>{var i=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;
/**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   */var t=null;try{if(r(2037).cpus().find((e=>cpus.model.toLowerCase().includes("armv6")))){throw new Error("Workaround for V8 crashing on ARMv6 platform when using WASM")}t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Long(e,t,r){this.low=e|0;this.high=t|0;this.unsigned=!!r}Long.prototype.__isLong__;Object.defineProperty(Long.prototype,"__isLong__",{value:true});function isLong(e){return(e&&e["__isLong__"])===true}function ctz32(e){var t=Math.clz32(e&-e);return e?31-t:t}Long.isLong=isLong;var i={};var n={};function fromInt(e,t){var r,a,o;if(t){e>>>=0;if(o=0<=e&&e<256){a=n[e];if(a)return a}r=fromBits(e,0,true);if(o)n[e]=r;return r}else{e|=0;if(o=-128<=e&&e<128){a=i[e];if(a)return a}r=fromBits(e,e<0?-1:0,false);if(o)i[e]=r;return r}}Long.fromInt=fromInt;function fromNumber(e,t){if(isNaN(e))return t?p:h;if(t){if(e<0)return p;if(e>=u)return C}else{if(e<=-l)return T;if(e+1>=l)return y}if(e<0)return fromNumber(-e,t).neg();return fromBits(e%c|0,e/c|0,t)}Long.fromNumber=fromNumber;function fromBits(e,t,r){return new Long(e,t,r)}Long.fromBits=fromBits;var a=Math.pow;function fromString(e,t,r){if(e.length===0)throw Error("empty string");if(typeof t==="number"){r=t;t=false}else{t=!!t}if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return t?p:h;r=r||10;if(r<2||36<r)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");else if(i===0){return fromString(e.substring(1),t,r).neg()}var n=fromNumber(a(r,8));var o=h;for(var s=0;s<e.length;s+=8){var c=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+c),r);if(c<8){var l=fromNumber(a(r,c));o=o.mul(l).add(fromNumber(u))}else{o=o.mul(n);o=o.add(fromNumber(u))}}o.unsigned=t;return o}Long.fromString=fromString;function fromValue(e,t){if(typeof e==="number")return fromNumber(e,t);if(typeof e==="string")return fromString(e,t);return fromBits(e.low,e.high,typeof t==="boolean"?t:e.unsigned)}Long.fromValue=fromValue;var o=1<<16;var s=1<<24;var c=o*o;var u=c*c;var l=u/2;var d=fromInt(s);var h=fromInt(0);Long.ZERO=h;var p=fromInt(0,true);Long.UZERO=p;var v=fromInt(1);Long.ONE=v;var m=fromInt(1,true);Long.UONE=m;var g=fromInt(-1);Long.NEG_ONE=g;var y=fromBits(4294967295|0,2147483647|0,false);Long.MAX_VALUE=y;var C=fromBits(4294967295|0,4294967295|0,true);Long.MAX_UNSIGNED_VALUE=C;var T=fromBits(0,2147483648|0,false);Long.MIN_VALUE=T;var E=Long.prototype;E.toInt=function toInt(){return this.unsigned?this.low>>>0:this.low};E.toNumber=function toNumber(){if(this.unsigned)return(this.high>>>0)*c+(this.low>>>0);return this.high*c+(this.low>>>0)};E.toString=function toString(e){e=e||10;if(e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(T)){var t=fromNumber(e),r=this.div(t),i=r.mul(t).sub(this);return r.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e)}var n=fromNumber(a(e,6),this.unsigned),o=this;var s="";while(true){var c=o.div(n),u=o.sub(c.mul(n)).toInt()>>>0,l=u.toString(e);o=c;if(o.isZero())return l+s;else{while(l.length<6)l="0"+l;s=""+l+s}}};E.getHighBits=function getHighBits(){return this.high};E.getHighBitsUnsigned=function getHighBitsUnsigned(){return this.high>>>0};E.getLowBits=function getLowBits(){return this.low};E.getLowBitsUnsigned=function getLowBitsUnsigned(){return this.low>>>0};E.getNumBitsAbs=function getNumBitsAbs(){if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();var e=this.high!=0?this.high:this.low;for(var t=31;t>0;t--)if((e&1<<t)!=0)break;return this.high!=0?t+33:t+1};E.isZero=function isZero(){return this.high===0&&this.low===0};E.eqz=E.isZero;E.isNegative=function isNegative(){return!this.unsigned&&this.high<0};E.isPositive=function isPositive(){return this.unsigned||this.high>=0};E.isOdd=function isOdd(){return(this.low&1)===1};E.isEven=function isEven(){return(this.low&1)===0};E.equals=function equals(e){if(!isLong(e))e=fromValue(e);if(this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1)return false;return this.high===e.high&&this.low===e.low};E.eq=E.equals;E.notEquals=function notEquals(e){return!this.eq(e)};E.neq=E.notEquals;E.ne=E.notEquals;E.lessThan=function lessThan(e){return this.comp(e)<0};E.lt=E.lessThan;E.lessThanOrEqual=function lessThanOrEqual(e){return this.comp(e)<=0};E.lte=E.lessThanOrEqual;E.le=E.lessThanOrEqual;E.greaterThan=function greaterThan(e){return this.comp(e)>0};E.gt=E.greaterThan;E.greaterThanOrEqual=function greaterThanOrEqual(e){return this.comp(e)>=0};E.gte=E.greaterThanOrEqual;E.ge=E.greaterThanOrEqual;E.compare=function compare(e){if(!isLong(e))e=fromValue(e);if(this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();if(t&&!r)return-1;if(!t&&r)return 1;if(!this.unsigned)return this.sub(e).isNegative()?-1:1;return e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1};E.comp=E.compare;E.negate=function negate(){if(!this.unsigned&&this.eq(T))return T;return this.not().add(v)};E.neg=E.negate;E.add=function add(e){if(!isLong(e))e=fromValue(e);var t=this.high>>>16;var r=this.high&65535;var i=this.low>>>16;var n=this.low&65535;var a=e.high>>>16;var o=e.high&65535;var s=e.low>>>16;var c=e.low&65535;var u=0,l=0,d=0,h=0;h+=n+c;d+=h>>>16;h&=65535;d+=i+s;l+=d>>>16;d&=65535;l+=r+o;u+=l>>>16;l&=65535;u+=t+a;u&=65535;return fromBits(d<<16|h,u<<16|l,this.unsigned)};E.subtract=function subtract(e){if(!isLong(e))e=fromValue(e);return this.add(e.neg())};E.sub=E.subtract;E.multiply=function multiply(e){if(this.isZero())return this;if(!isLong(e))e=fromValue(e);if(t){var r=t["mul"](this.low,this.high,e.low,e.high);return fromBits(r,t["get_high"](),this.unsigned)}if(e.isZero())return this.unsigned?p:h;if(this.eq(T))return e.isOdd()?T:h;if(e.eq(T))return this.isOdd()?T:h;if(this.isNegative()){if(e.isNegative())return this.neg().mul(e.neg());else return this.neg().mul(e).neg()}else if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(d)&&e.lt(d))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16;var n=this.high&65535;var a=this.low>>>16;var o=this.low&65535;var s=e.high>>>16;var c=e.high&65535;var u=e.low>>>16;var l=e.low&65535;var v=0,m=0,g=0,y=0;y+=o*l;g+=y>>>16;y&=65535;g+=a*l;m+=g>>>16;g&=65535;g+=o*u;m+=g>>>16;g&=65535;m+=n*l;v+=m>>>16;m&=65535;m+=a*u;v+=m>>>16;m&=65535;m+=o*c;v+=m>>>16;m&=65535;v+=i*l+n*u+a*c+o*s;v&=65535;return fromBits(g<<16|y,v<<16|m,this.unsigned)};E.mul=E.multiply;E.divide=function divide(e){if(!isLong(e))e=fromValue(e);if(e.isZero())throw Error("division by zero");if(t){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1){return this}var r=(this.unsigned?t["div_u"]:t["div_s"])(this.low,this.high,e.low,e.high);return fromBits(r,t["get_high"](),this.unsigned)}if(this.isZero())return this.unsigned?p:h;var i,n,o;if(!this.unsigned){if(this.eq(T)){if(e.eq(v)||e.eq(g))return T;else if(e.eq(T))return v;else{var s=this.shr(1);i=s.div(e).shl(1);if(i.eq(h)){return e.isNegative()?v:g}else{n=this.sub(e.mul(i));o=i.add(n.div(e));return o}}}else if(e.eq(T))return this.unsigned?p:h;if(this.isNegative()){if(e.isNegative())return this.neg().div(e.neg());return this.neg().div(e).neg()}else if(e.isNegative())return this.div(e.neg()).neg();o=h}else{if(!e.unsigned)e=e.toUnsigned();if(e.gt(this))return p;if(e.gt(this.shru(1)))return m;o=p}n=this;while(n.gte(e)){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));var c=Math.ceil(Math.log(i)/Math.LN2),u=c<=48?1:a(2,c-48),l=fromNumber(i),d=l.mul(e);while(d.isNegative()||d.gt(n)){i-=u;l=fromNumber(i,this.unsigned);d=l.mul(e)}if(l.isZero())l=v;o=o.add(l);n=n.sub(d)}return o};E.div=E.divide;E.modulo=function modulo(e){if(!isLong(e))e=fromValue(e);if(t){var r=(this.unsigned?t["rem_u"]:t["rem_s"])(this.low,this.high,e.low,e.high);return fromBits(r,t["get_high"](),this.unsigned)}return this.sub(this.div(e).mul(e))};E.mod=E.modulo;E.rem=E.modulo;E.not=function not(){return fromBits(~this.low,~this.high,this.unsigned)};E.countLeadingZeros=function countLeadingZeros(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};E.clz=E.countLeadingZeros;E.countTrailingZeros=function countTrailingZeros(){return this.low?ctz32(this.low):ctz32(this.high)+32};E.ctz=E.countTrailingZeros;E.and=function and(e){if(!isLong(e))e=fromValue(e);return fromBits(this.low&e.low,this.high&e.high,this.unsigned)};E.or=function or(e){if(!isLong(e))e=fromValue(e);return fromBits(this.low|e.low,this.high|e.high,this.unsigned)};E.xor=function xor(e){if(!isLong(e))e=fromValue(e);return fromBits(this.low^e.low,this.high^e.high,this.unsigned)};E.shiftLeft=function shiftLeft(e){if(isLong(e))e=e.toInt();if((e&=63)===0)return this;else if(e<32)return fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned);else return fromBits(0,this.low<<e-32,this.unsigned)};E.shl=E.shiftLeft;E.shiftRight=function shiftRight(e){if(isLong(e))e=e.toInt();if((e&=63)===0)return this;else if(e<32)return fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned);else return fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};E.shr=E.shiftRight;E.shiftRightUnsigned=function shiftRightUnsigned(e){if(isLong(e))e=e.toInt();if((e&=63)===0)return this;if(e<32)return fromBits(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned);if(e===32)return fromBits(this.high,0,this.unsigned);return fromBits(this.high>>>e-32,0,this.unsigned)};E.shru=E.shiftRightUnsigned;E.shr_u=E.shiftRightUnsigned;E.rotateLeft=function rotateLeft(e){var t;if(isLong(e))e=e.toInt();if((e&=63)===0)return this;if(e===32)return fromBits(this.high,this.low,this.unsigned);if(e<32){t=32-e;return fromBits(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)}e-=32;t=32-e;return fromBits(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned)};E.rotl=E.rotateLeft;E.rotateRight=function rotateRight(e){var t;if(isLong(e))e=e.toInt();if((e&=63)===0)return this;if(e===32)return fromBits(this.high,this.low,this.unsigned);if(e<32){t=32-e;return fromBits(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)}e-=32;t=32-e;return fromBits(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)};E.rotr=E.rotateRight;E.toSigned=function toSigned(){if(!this.unsigned)return this;return fromBits(this.low,this.high,false)};E.toUnsigned=function toUnsigned(){if(this.unsigned)return this;return fromBits(this.low,this.high,true)};E.toBytes=function toBytes(e){return e?this.toBytesLE():this.toBytesBE()};E.toBytesLE=function toBytesLE(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};E.toBytesBE=function toBytesBE(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Long.fromBytes=function fromBytes(e,t,r){return r?Long.fromBytesLE(e,t):Long.fromBytesBE(e,t)};Long.fromBytesLE=function fromBytesLE(e,t){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Long.fromBytesBE=function fromBytesBE(e,t){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var D=Long;e.default=D;return"default"in e?e.default:e}({});if(typeof define==="function"&&define.amd)define([],(function(){return i}));else if(true)e.exports=i},8285:e=>{"use strict";var t=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"];var r=typeof globalThis==="undefined"?global:globalThis;e.exports=function availableTypedArrays(){var e=[];for(var i=0;i<t.length;i++){if(typeof r[t[i]]==="function"){e[e.length]=t[i]}}return e}},3870:e=>{"use strict";var t=Symbol.iterator;e.exports=function getIterator(e){if(e!=null&&typeof e[t]!=="undefined"){return e[t]()}}},4991:(e,t,r)=>{"use strict";var i=r(2050);var n=r(8181);var a=r(9682);var o=r(6077);e.exports=function whichCollection(e){if(e&&typeof e==="object"){if(i(e)){return"Map"}if(n(e)){return"Set"}if(a(e)){return"WeakMap"}if(o(e)){return"WeakSet"}}return false}},6341:e=>{var t=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.decode=decode;e.encode=encode;e.familyOf=familyOf;e.name=void 0;e.sizeOf=sizeOf;e.v6=e.v4=void 0;const t=/^(\d{1,3}\.){3,3}\d{1,3}$/;const r=4;const i=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;const n=16;const a={name:"v4",size:r,isFormat:e=>t.test(e),encode(e,t,i){i=~~i;t=t||new Uint8Array(i+r);const n=e.length;let a=0;for(let r=0;r<n;){const n=e.charCodeAt(r++);if(n===46){t[i++]=a;a=0}else{a=a*10+(n-48)}}t[i]=a;return t},decode(e,t){t=~~t;return`${e[t++]}.${e[t++]}.${e[t++]}.${e[t]}`}};e.v4=a;const o={name:"v6",size:n,isFormat:e=>e.length>0&&i.test(e),encode(e,t,r){r=~~r;let i=r+n;let a=-1;let o=0;let s=0;let c=true;let u=false;t=t||new Uint8Array(r+n);for(let n=0;n<e.length;n++){let l=e.charCodeAt(n);if(l===58){if(c){if(a!==-1){if(r<i)t[r]=0;if(r<i-1)t[r+1]=0;r+=2}else if(r<i){a=r}}else{if(u===true){if(r<i)t[r]=s;r++}else{if(r<i)t[r]=o>>8;if(r<i-1)t[r+1]=o&255;r+=2}o=0;s=0}c=true;u=false}else if(l===46){if(r<i)t[r]=s;r++;s=0;o=0;c=false;u=true}else{c=false;if(l>=97){l-=87}else if(l>=65){l-=55}else{l-=48;s=s*10+l}o=(o<<4)+l}}if(c===false){if(u===true){if(r<i)t[r]=s;r++}else{if(r<i)t[r]=o>>8;if(r<i-1)t[r+1]=o&255;r+=2}}else if(a===0){if(r<i)t[r]=0;if(r<i-1)t[r+1]=0;r+=2}else if(a!==-1){r+=2;for(let e=Math.min(r-1,i-1);e>=a+2;e--){t[e]=t[e-2]}t[a]=0;t[a+1]=0;a=r}if(a!==r&&a!==-1){if(r>i-2){r=i-2}while(i>a){t[--i]=r<i&&r>a?t[--r]:0}}else{while(r<i){t[r++]=0}}return t},decode(e,t){t=~~t;let r="";for(let i=0;i<n;i+=2){if(i!==0){r+=":"}r+=(e[t+i]<<8|e[t+i+1]).toString(16)}return r.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};e.v6=o;const s="ip";e.name=s;function sizeOf(e){if(a.isFormat(e))return a.size;if(o.isFormat(e))return o.size;throw Error(`Invalid ip address: ${e}`)}function familyOf(e){return sizeOf(e)===a.size?1:2}function encode(e,t,r){r=~~r;const i=sizeOf(e);if(typeof t==="function"){t=t(r+i)}if(i===a.size){return a.encode(e,t,r)}return o.encode(e,t,r)}function decode(e,t,r){t=~~t;r=r||e.length-t;if(r===a.size){return a.decode(e,t,r)}if(r===o.size){return o.decode(e,t,r)}throw Error(`Invalid buffer size needs to be ${a.size} for v4 or ${o.size} for v6.`)}return"default"in e?e.default:e}({});if(typeof define==="function"&&define.amd)define([],(function(){return t}));else if(true)e.exports=t},1663:e=>{"use strict";e.exports={i8:"1.1.5"}},6608:e=>{"use strict";e.exports=JSON.parse('[{"type":"a","child":[{"type":"(","child":[{"type":"y","child":[]},{"type":"v","child":[]}]}]}]')},6064:e=>{"use strict";e.exports=JSON.parse('{"name":"hap-nodejs","version":"0.11.0","description":"HAP-NodeJS is a Node.js implementation of HomeKit Accessory Server.","main":"dist/index.js","types":"dist/index.d.ts","maintainers":["Andreas Bauer <mail@anderl-bauer.de>"],"author":"Khaos Tian <khaos.tian@gmail.com> (https://tz.is/)","homepage":"https://github.com/homebridge/HAP-NodeJS","license":"Apache-2.0","scripts":{"clean":"rimraf dist && rimraf coverage","lint":"eslint \'src/**/*.{js,ts,json}\'","build":"rimraf dist && tsc && node .github/node-persist-ignore.js","prepublishOnly":"npm run build","postpublish":"npm run clean","test":"jest","test-coverage":"jest --coverage","start":"node dist/BridgedCore.js","docs":"typedoc","lint-docs":"typedoc --emit none --treatWarningsAsErrors"},"keywords":["hap-nodejs","hap","homekit","homekit-accessory-protocol","homekit-server","homekit-protocol","homekit-device","homekit-accessory","hap-server","homekit-support","siri"],"repository":{"type":"git","url":"https://github.com/homebridge/HAP-NodeJS.git"},"bugs":{"url":"https://github.com/homebridge/HAP-NodeJS/issues"},"engines":{"node":">=10.17.0"},"files":["README.md","LICENSE","dist","@types"],"dependencies":{"@homebridge/ciao":"^1.1.5","@homebridge/dbus-native":"^0.5.0","bonjour-hap":"~3.6.4","debug":"^4.3.4","fast-srp-hap":"~2.0.4","futoin-hkdf":"~1.4.3","node-persist":"^0.0.11","source-map-support":"^0.5.21","tslib":"^2.4.0","tweetnacl":"^1.0.3"},"devDependencies":{"@types/debug":"^4.1.7","@types/escape-html":"^1.0.2","@types/jest":"^27.4.1","@types/node":"^10.17.60","@typescript-eslint/eslint-plugin":"^5.21.0","@typescript-eslint/parser":"^5.21.0","commander":"^6.2.1","escape-html":"^1.0.3","http-parser-js":"^0.5.8","eslint":"^8.14.0","jest":"^27.5.1","rimraf":"^3.0.2","semver":"^7.3.7","simple-plist":"1.1.1","ts-jest":"^27.1.4","ts-node":"^10.7.0","typedoc":"^0.23.21","typescript":"~4.9.3","axios":"^0.27.2"}}')}};var __webpack_module_cache__={};function __nccwpck_require__(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var r=__webpack_module_cache__[e]={id:e,loaded:false,exports:{}};var i=true;try{__webpack_modules__[e].call(r.exports,r,r.exports,__nccwpck_require__);i=false}finally{if(i)delete __webpack_module_cache__[e]}r.loaded=true;return r.exports}(()=>{__nccwpck_require__.nmd=e=>{e.paths=[];if(!e.children)e.children=[];return e}})();if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var __webpack_exports__=__nccwpck_require__(2601);module.exports=__webpack_exports__})();